/*
 Rangy Text Inputs, a cross-browser textarea and text input library plug-in for jQuery.

 Part of Rangy, a cross-browser JavaScript range and selection library
 http://code.google.com/p/rangy/

 Depends on jQuery 1.0 or later.

 Copyright 2010, Tim Down
 Licensed under the MIT license.
 Version: 0.1.205
 Build date: 5 November 2010
 under Apache license http://www.apache.org/licenses/LICENSE-2.0
 @author Bevis Zhao (i@bevis.me, http://bevis.me)
*/
Function.prototype.bind||(Function.prototype.bind=function(a){if(null==this)throw new TypeError("Cannot call method 'bind' of "+this);if("function"!==typeof this)throw new TypeError("Object "+this+"has no method 'bind'");var b=[].slice,e=b.call(arguments,1),d=this,g=function(){},f=function(){return d.apply(this instanceof g?this:a||{},e.concat(b.call(arguments)))};f.prototype=this.prototype;return f});String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
(function(){var a,b,e,d,g,f=[].slice;d=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};e=function(a){return/^\/(.+)\/([gimy]*)$/.exec(a)};b=function(a){if("string"===typeof a)return RegExp("^"+d(a));a=e(a);return RegExp("^"+a[1],a[2])};a=function(a){if("string"===typeof a)return RegExp(""+d(a)+"$");a=e(a);return RegExp(""+a[1]+"$",a[2])};g=function(a){var b,f,d,e,g;f=[];d=[];e=0;for(g=a.length;e<g;e++)b=a[e],(_.isRegExp(b)?f:d).push(b);return f.concat(_.sortBy(d,function(a){return-a.length}))};
String.prototype.lstrip=function(){var a,d,e,j;d=1<=arguments.length?f.call(arguments,0):[];j=g(d);d=0;for(e=j.length;d<e;d++)if(a=j[d],a=b(a).exec(this))return this.substr(a[0].length);return this.toString()};String.prototype.rstrip=function(){var b,d,e,j;d=1<=arguments.length?f.call(arguments,0):[];j=g(d);d=0;for(e=j.length;d<e;d++)if(b=j[d],b=a(b).exec(this))return this.substr(0,this.length-b[0].length);return this.toString()};String.prototype.startsWith=function(){var a,d,e,g;d=1<=arguments.length?
f.call(arguments,0):[];e=0;for(g=d.length;e<g;e++)if(a=d[e],b(a).test(this))return!0;return!1};String.prototype.endsWith=function(){var b,d,e,g;d=1<=arguments.length?f.call(arguments,0):[];e=0;for(g=d.length;e<g;e++)if(b=d[e],a(b).test(this))return!0;return!1}}).call(this);
(function(){var a,b,e,d=[].slice;a=String.prototype.format=function(){var e,f,c,h,i,j=this;e=1<=arguments.length?d.call(arguments,0):[];if(0===e.length)return function(){var a;a=1<=arguments.length?d.call(arguments,0):[];return j.format.apply(j,a)};h=0;c=i=!1;f="cannot switch from {} to {} numbering".format();return this.replace(/([{}])\1|[{](.*?)(?:!(.+?))?[}]/g,function(d,m,j,q){var p,w,r,x;if(m)return m;if(j.length){c=!0;if(i)throw f("implicit","explicit");d=null!=(w=b(e,j))?w:""}else{i=!0;if(c)throw f("explicit",
"implicit");d=null!=(r=e[h++])?r:""}d=d.toString();return(p=a.transformers[q])?null!=(x=p.call(d))?x:"":d})};b=function(a,b){var c;for(/^(\d+)([.]|$)/.test(b)||(b="0."+b);c=/(.+?)[.](.+)/.exec(b);)a=e(a,c[1]),b=c[2];return e(a,b)};e=function(a,b){var c;c=a[b];return"function"===typeof c?c.call(a):c};a.transformers={}}).call(this);!function(a){a.esc=function(){return _.escape(this)};a.s=function(){if(1!==+this)return"s"}}(String.prototype.format.transformers);
(function(a,b){function e(a,c,d){if(d===b&&1===a.nodeType)if(d="data-"+c.replace(Ga,"-$1").toLowerCase(),d=a.getAttribute(d),"string"===typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:k.isNumeric(d)?+d:ib.test(d)?k.parseJSON(d):d}catch(f){}k.data(a,c,d)}else d=b;return d}function d(a){for(var b in a)if(!("data"===b&&k.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function g(a,b,c){var d=b+"defer",f=b+"queue",e=b+"mark",g=k._data(a,d);g&&(("queue"===c||!k._data(a,f))&&("mark"===
c||!k._data(a,e)))&&setTimeout(function(){!k._data(a,f)&&!k._data(a,e)&&(k.removeData(a,d,!0),g.fire())},0)}function f(){return!1}function c(){return!0}function h(a,b,c){b=b||0;if(k.isFunction(b))return k.grep(a,function(a,d){return!!b.call(a,d,a)===c});if(b.nodeType)return k.grep(a,function(a){return a===b===c});if("string"===typeof b){var d=k.grep(a,function(a){return 1===a.nodeType});if(mc.test(b))return k.filter(b,d,!c);b=k.filter(b,d)}return k.grep(a,function(a){return 0<=k.inArray(a,b)===c})}
function i(a){var b=Sb.split("|"),a=a.createDocumentFragment();if(a.createElement)for(;b.length;)a.createElement(b.pop());return a}function j(a,b){if(1===b.nodeType&&k.hasData(a)){var c,d,f;d=k._data(a);var e=k._data(b,d),g=d.events;if(g)for(c in delete e.handle,e.events={},g){d=0;for(f=g[c].length;d<f;d++)k.event.add(b,c,g[c][d])}e.data&&(e.data=k.extend({},e.data))}}function l(a,b){var c;if(1===b.nodeType){b.clearAttributes&&b.clearAttributes();b.mergeAttributes&&b.mergeAttributes(a);c=b.nodeName.toLowerCase();
if("object"===c)b.outerHTML=a.outerHTML;else if("input"===c&&("checkbox"===a.type||"radio"===a.type)){if(a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value)b.value=a.value}else"option"===c?b.selected=a.defaultSelected:"input"===c||"textarea"===c?b.defaultValue=a.defaultValue:"script"===c&&b.text!==a.text&&(b.text=a.text);b.removeAttribute(k.expando);b.removeAttribute("_submit_attached");b.removeAttribute("_change_attached")}}function m(a){return"undefined"!==typeof a.getElementsByTagName?
a.getElementsByTagName("*"):"undefined"!==typeof a.querySelectorAll?a.querySelectorAll("*"):[]}function n(a){if("checkbox"===a.type||"radio"===a.type)a.defaultChecked=a.checked}function q(a){var b=(a.nodeName||"").toLowerCase();"input"===b?n(a):"script"!==b&&"undefined"!==typeof a.getElementsByTagName&&k.grep(a.getElementsByTagName("input"),n)}function p(a,b,c){var d="width"===b?a.offsetWidth:a.offsetHeight,f="width"===b?1:0;if(0<d){if("border"!==c)for(;4>f;f+=2)c||(d-=parseFloat(k.css(a,"padding"+
mb[f]))||0),d="margin"===c?d+(parseFloat(k.css(a,c+mb[f]))||0):d-(parseFloat(k.css(a,"border"+mb[f]+"Width"))||0);return d+"px"}d=vb(a,b);if(0>d||null==d)d=a.style[b];if(Kb.test(d))return d;d=parseFloat(d)||0;if(c)for(;4>f;f+=2)d+=parseFloat(k.css(a,"padding"+mb[f]))||0,"padding"!==c&&(d+=parseFloat(k.css(a,"border"+mb[f]+"Width"))||0),"margin"===c&&(d+=parseFloat(k.css(a,c+mb[f]))||0);return d+"px"}function w(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");if(k.isFunction(c))for(var d=b.toLowerCase().split(Tb),
f=0,e=d.length,g,h;f<e;f++)g=d[f],(h=/^\+/.test(g))&&(g=g.substr(1)||"*"),g=a[g]=a[g]||[],g[h?"unshift":"push"](c)}}function r(a,c,d,f,e,g){e=e||c.dataTypes[0];g=g||{};g[e]=!0;for(var e=a[e],h=0,k=e?e.length:0,i=a===Lb,m;h<k&&(i||!m);h++)m=e[h](c,d,f),"string"===typeof m&&(!i||g[m]?m=b:(c.dataTypes.unshift(m),m=r(a,c,d,f,m,g)));if((i||!m)&&!g["*"])m=r(a,c,d,f,"*",g);return m}function x(a,c){var d,f,e=k.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((e[d]?a:f||(f={}))[d]=c[d]);f&&k.extend(!0,a,
f)}function t(a,b,c,d){if(k.isArray(b))k.each(b,function(b,f){c||nc.test(a)?d(a,f):t(a+"["+("object"===typeof f?b:"")+"]",f,c,d)});else if(!c&&"object"===k.type(b))for(var f in b)t(a+"["+f+"]",b[f],c,d);else d(a,b)}function s(){try{return new a.XMLHttpRequest}catch(b){}}function v(){setTimeout(o,0);return Fb=k.now()}function o(){Fb=b}function y(a,b){var c={};k.each(Gb.concat.apply([],Gb.slice(0,b)),function(){c[this]=a});return c}function A(a){if(!Mb[a]){var b=u.body,c=k("<"+a+">").appendTo(b),d=
c.css("display");c.remove();if("none"===d||""===d){Xa||(Xa=u.createElement("iframe"),Xa.frameBorder=Xa.width=Xa.height=0);b.appendChild(Xa);if(!wb||!Xa.createElement)wb=(Xa.contentWindow||Xa.contentDocument).document,wb.write((k.support.boxModel?"<!doctype html>":"")+"<html><body>"),wb.close();c=wb.createElement(a);wb.body.appendChild(c);d=k.css(c,"display");b.removeChild(Xa)}Mb[a]=d}return Mb[a]}function B(a){return k.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var u=a.document,
D=a.location,k,E=function(){if(!z.isReady){try{u.documentElement.doScroll("left")}catch(a){setTimeout(E,1);return}z.ready()}},z=function(a,b){return new z.fn.init(a,b,F)},Q=a.jQuery,V=a.$,F,L=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,C=/\S/,W=/^\s+/,T=/\s+$/,K=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,H=/^[\],:{}\s]*$/,U=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,la=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,N=/(?:^|:|,)(?:\s*\[)+/g,M=/(webkit)[ \/]([\w.]+)/,ma=/(opera)(?:.*version)?[ \/]([\w.]+)/,
fa=/(msie) ([\w.]+)/,S=/(mozilla)(?:.*? rv:([\w.]+))?/,ha=/-([a-z]|[0-9])/ig,qa=/^-ms-/,za=function(a,b){return(b+"").toUpperCase()},na=a.navigator.userAgent,xa,ra,La,nb=Object.prototype.toString,db=Object.prototype.hasOwnProperty,eb=Array.prototype.push,Da=Array.prototype.slice,Ma=String.prototype.trim,xb=Array.prototype.indexOf,yb={};z.fn=z.prototype={constructor:z,init:function(a,c,d){var f;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if("body"===a&&!c&&u.body)return this.context=
u,this[0]=u.body,this.selector=a,this.length=1,this;if("string"===typeof a){if((f="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:L.exec(a))&&(f[1]||!c)){if(f[1])return d=(c=c instanceof z?c[0]:c)?c.ownerDocument||c:u,(a=K.exec(a))?z.isPlainObject(c)?(a=[u.createElement(a[1])],z.fn.attr.call(a,c,!0)):a=[d.createElement(a[1])]:(a=z.buildFragment([f[1]],[d]),a=(a.cacheable?z.clone(a.fragment):a.fragment).childNodes),z.merge(this,a);if((c=u.getElementById(f[2]))&&c.parentNode){if(c.id!==
f[2])return d.find(a);this.length=1;this[0]=c}this.context=u;this.selector=a;return this}return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}if(z.isFunction(a))return d.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return z.makeArray(a,this)},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return Da.call(this,0)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=
this.constructor();z.isArray(a)?eb.apply(d,a):z.merge(d,a);d.prevObject=this;d.context=this.context;"find"===b?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return z.each(this,a,b)},ready:function(a){z.bindReady();ra.add(a);return this},eq:function(a){a=+a;return-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Da.apply(this,
arguments),"slice",Da.call(arguments).join(","))},map:function(a){return this.pushStack(z.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:eb,sort:[].sort,splice:[].splice};z.fn.init.prototype=z.fn;z.extend=z.fn.extend=function(){var a,c,d,f,e,g=arguments[0]||{},h=1,k=arguments.length,i=!1;"boolean"===typeof g&&(i=g,g=arguments[1]||{},h=2);"object"!==typeof g&&!z.isFunction(g)&&(g={});k===h&&(g=this,--h);for(;h<k;h++)if(null!=(a=arguments[h]))for(c in a)d=
g[c],f=a[c],g!==f&&(i&&f&&(z.isPlainObject(f)||(e=z.isArray(f)))?(e?(e=!1,d=d&&z.isArray(d)?d:[]):d=d&&z.isPlainObject(d)?d:{},g[c]=z.extend(i,d,f)):f!==b&&(g[c]=f));return g};z.extend({noConflict:function(b){a.$===z&&(a.$=V);b&&a.jQuery===z&&(a.jQuery=Q);return z},isReady:!1,readyWait:1,holdReady:function(a){a?z.readyWait++:z.ready(!0)},ready:function(a){if(!0===a&&!--z.readyWait||!0!==a&&!z.isReady){if(!u.body)return setTimeout(z.ready,1);z.isReady=!0;!0!==a&&0<--z.readyWait||(ra.fireWith(u,[z]),
z.fn.trigger&&z(u).trigger("ready").off("ready"))}},bindReady:function(){if(!ra){ra=z.Callbacks("once memory");if("complete"===u.readyState)return setTimeout(z.ready,1);if(u.addEventListener)u.addEventListener("DOMContentLoaded",La,!1),a.addEventListener("load",z.ready,!1);else if(u.attachEvent){u.attachEvent("onreadystatechange",La);a.attachEvent("onload",z.ready);var b=!1;try{b=null==a.frameElement}catch(c){}u.documentElement.doScroll&&b&&E()}}},isFunction:function(a){return"function"===z.type(a)},
isArray:Array.isArray||function(a){return"array"===z.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):yb[nb.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==z.type(a)||a.nodeType||z.isWindow(a))return!1;try{if(a.constructor&&!db.call(a,"constructor")&&!db.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var d in a);return d===b||db.call(a,d)},
isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a);},parseJSON:function(b){if("string"!==typeof b||!b)return null;b=z.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(H.test(b.replace(U,"@").replace(la,"]").replace(N,"")))return(new Function("return "+b))();z.error("Invalid JSON: "+b)},parseXML:function(c){if("string"!==typeof c||!c)return null;var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),
d.async="false",d.loadXML(c))}catch(e){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&z.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&C.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(qa,"ms-").replace(ha,za)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,e=0,g=a.length,h=g===b||z.isFunction(a);if(d)if(h)for(f in a){if(!1===
c.apply(a[f],d))break}else for(;e<g&&!1!==c.apply(a[e++],d););else if(h)for(f in a){if(!1===c.call(a[f],f,a[f]))break}else for(;e<g&&!1!==c.call(a[e],e,a[e++]););return a},trim:Ma?function(a){return null==a?"":Ma.call(a)}:function(a){return null==a?"":a.toString().replace(W,"").replace(T,"")},makeArray:function(a,b){var c=b||[];if(null!=a){var d=z.type(a);null==a.length||"string"===d||"function"===d||"regexp"===d||z.isWindow(a)?eb.call(c,a):z.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(xb)return xb.call(b,
a,c);d=b.length;for(c=c?0>c?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,f=0;if("number"===typeof c.length)for(var e=c.length;f<e;f++)a[d++]=c[f];else for(;c[f]!==b;)a[d++]=c[f++];a.length=d;return a},grep:function(a,b,c){for(var d=[],f,c=!!c,e=0,g=a.length;e<g;e++)f=!!b(a[e],e),c!==f&&d.push(a[e]);return d},map:function(a,c,d){var f,e,g=[],h=0,k=a.length;if(a instanceof z||k!==b&&"number"===typeof k&&(0<k&&a[0]&&a[k-1]||0===k||z.isArray(a)))for(;h<
k;h++)f=c(a[h],h,d),null!=f&&(g[g.length]=f);else for(e in a)f=c(a[e],e,d),null!=f&&(g[g.length]=f);return g.concat.apply([],g)},guid:1,proxy:function(a,c){if("string"===typeof c)var d=a[c],c=a,a=d;if(!z.isFunction(a))return b;var f=Da.call(arguments,2),d=function(){return a.apply(c,f.concat(Da.call(arguments)))};d.guid=a.guid=a.guid||d.guid||z.guid++;return d},access:function(a,c,d,f,e,g,h){var k,i=null==d,m=0,l=a.length;if(d&&"object"===typeof d){for(m in d)z.access(a,c,m,d[m],1,g,f);e=1}else if(f!==
b){k=h===b&&z.isFunction(f);i&&(k?(k=c,c=function(a,b,c){return k.call(z(a),c)}):(c.call(a,f),c=null));if(c)for(;m<l;m++)c(a[m],d,k?f.call(a[m],m,c(a[m],d)):f,h);e=1}return e?a:i?c.call(a):l?c(a[0],d):g},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();a=M.exec(a)||ma.exec(a)||fa.exec(a)||0>a.indexOf("compatible")&&S.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}z.extend(!0,a,this);a.superclass=this;
a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,d){d&&(d instanceof z&&!(d instanceof a))&&(d=a(d));return z.fn.init.call(this,c,d,b)};a.fn.init.prototype=a.fn;var b=a(u);return a},browser:{}});z.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){yb["[object "+b+"]"]=b.toLowerCase()});xa=z.uaMatch(na);xa.browser&&(z.browser[xa.browser]=!0,z.browser.version=xa.version);z.browser.webkit&&(z.browser.safari=!0);C.test("\u00a0")&&(W=/^[\s\xA0]+/,
T=/[\s\xA0]+$/);F=z(u);u.addEventListener?La=function(){u.removeEventListener("DOMContentLoaded",La,false);z.ready()}:u.attachEvent&&(La=function(){if(u.readyState==="complete"){u.detachEvent("onreadystatechange",La);z.ready()}});k=z;var Ya={};k.Callbacks=function(a){var c;if(a){if(!(c=Ya[a])){c=a;var d=Ya[c]={},f,e;c=c.split(/\s+/);f=0;for(e=c.length;f<e;f++)d[c[f]]=true;c=d}}else c={};var a=c,g=[],h=[],i,m,l,j,p,n,u=function(b){var c,d,f,e;c=0;for(d=b.length;c<d;c++){f=b[c];e=k.type(f);e==="array"?
u(f):e==="function"&&(!a.unique||!q.has(f))&&g.push(f)}},ba=function(b,c){c=c||[];i=!a.memory||[b,c];l=m=true;n=j||0;j=0;for(p=g.length;g&&n<p;n++)if(g[n].apply(b,c)===false&&a.stopOnFalse){i=true;break}l=false;if(g)if(a.once)i===true?q.disable():g=[];else if(h&&h.length){i=h.shift();q.fireWith(i[0],i[1])}},q={add:function(){if(g){var a=g.length;u(arguments);if(l)p=g.length;else if(i&&i!==true){j=a;ba(i[0],i[1])}}return this},remove:function(){if(g)for(var b=arguments,c=0,d=b.length;c<d;c++)for(var f=
0;f<g.length;f++)if(b[c]===g[f]){if(l&&f<=p){p--;f<=n&&n--}g.splice(f--,1);if(a.unique)break}return this},has:function(a){if(g)for(var b=0,c=g.length;b<c;b++)if(a===g[b])return true;return false},empty:function(){g=[];return this},disable:function(){g=h=i=b;return this},disabled:function(){return!g},lock:function(){h=b;(!i||i===true)&&q.disable();return this},locked:function(){return!h},fireWith:function(b,c){h&&(l?a.once||h.push([b,c]):(!a.once||!i)&&ba(b,c));return this},fire:function(){q.fireWith(this,
arguments);return this},fired:function(){return!!m}};return q};var J=[].slice;k.extend({Deferred:function(a){var b=k.Callbacks("once memory"),c=k.Callbacks("once memory"),d=k.Callbacks("memory"),f="pending",e={resolve:b,reject:c,notify:d},g={done:b.add,fail:c.add,progress:d.add,state:function(){return f},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){h.done(a).fail(b).progress(c);return this},always:function(){h.done.apply(h,arguments).fail.apply(h,arguments);return this},pipe:function(a,
b,c){return k.Deferred(function(d){k.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],f=b[1],e;if(k.isFunction(c))h[a](function(){if((e=c.apply(this,arguments))&&k.isFunction(e.promise))e.promise().then(d.resolve,d.reject,d.notify);else d[f+"With"](this===h?d:this,[e])});else h[a](d[f])})}).promise()},promise:function(a){if(a==null)a=g;else for(var b in g)a[b]=g[b];return a}},h=g.promise({}),i;for(i in e){h[i]=e[i].fire;h[i+"With"]=e[i].fireWith}h.done(function(){f=
"resolved"},c.disable,d.lock).fail(function(){f="rejected"},b.disable,d.lock);a&&a.call(h,h);return h},when:function(a){function b(a){return function(b){d[a]=arguments.length>1?J.call(arguments,0):b;--h||i.resolveWith(i,d)}}function c(a){return function(b){g[a]=arguments.length>1?J.call(arguments,0):b;i.notifyWith(m,g)}}var d=J.call(arguments,0),f=0,e=d.length,g=Array(e),h=e,i=e<=1&&a&&k.isFunction(a.promise)?a:k.Deferred(),m=i.promise();if(e>1){for(;f<e;f++)d[f]&&d[f].promise&&k.isFunction(d[f].promise)?
d[f].promise().then(b(f),i.reject,c(f)):--h;h||i.resolveWith(i,d)}else i!==a&&i.resolveWith(i,e?[a]:[]);return m}});var Na=k,ca;var X,sa,ea,ia,Aa,Z,Ea,Za,$a,ja,ua,I=u.createElement("div");I.setAttribute("className","t");I.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";sa=I.getElementsByTagName("*");ea=I.getElementsByTagName("a")[0];if(!sa||!sa.length||!ea)ca={};else{ia=u.createElement("select");Aa=ia.appendChild(u.createElement("option"));
Z=I.getElementsByTagName("input")[0];X={leadingWhitespace:3===I.firstChild.nodeType,tbody:!I.getElementsByTagName("tbody").length,htmlSerialize:!!I.getElementsByTagName("link").length,style:/top/.test(ea.getAttribute("style")),hrefNormalized:"/a"===ea.getAttribute("href"),opacity:/^0.55/.test(ea.style.opacity),cssFloat:!!ea.style.cssFloat,checkOn:"on"===Z.value,optSelected:Aa.selected,getSetAttribute:"t"!==I.className,enctype:!!u.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==u.createElement("nav").cloneNode(!0).outerHTML,
submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0};k.boxModel=X.boxModel="CSS1Compat"===u.compatMode;Z.checked=!0;X.noCloneChecked=Z.cloneNode(!0).checked;ia.disabled=!0;X.optDisabled=!Aa.disabled;try{delete I.test}catch(ya){X.deleteExpando=!1}!I.addEventListener&&(I.attachEvent&&I.fireEvent)&&(I.attachEvent("onclick",function(){X.noCloneEvent=false}),I.cloneNode(!0).fireEvent("onclick"));
Z=u.createElement("input");Z.value="t";Z.setAttribute("type","radio");X.radioValue="t"===Z.value;Z.setAttribute("checked","checked");Z.setAttribute("name","t");I.appendChild(Z);Ea=u.createDocumentFragment();Ea.appendChild(I.lastChild);X.checkClone=Ea.cloneNode(!0).cloneNode(!0).lastChild.checked;X.appendChecked=Z.checked;Ea.removeChild(Z);Ea.appendChild(I);if(I.attachEvent)for(ja in{submit:1,change:1,focusin:1})$a="on"+ja,ua=$a in I,ua||(I.setAttribute($a,"return;"),ua="function"===typeof I[$a]),
X[ja+"Bubbles"]=ua;Ea.removeChild(I);Ea=ia=Aa=I=Z=null;k(function(){var b,c,d,f,e=u.getElementsByTagName("body")[0];if(e){b=u.createElement("div");b.style.cssText="padding:0;margin:0;border:0;visibility:hidden;width:0;height:0;position:static;top:0;margin-top:1px";e.insertBefore(b,e.firstChild);I=u.createElement("div");b.appendChild(I);I.innerHTML="<table><tr><td style='padding:0;margin:0;border:0;display:none'></td><td>t</td></tr></table>";Za=I.getElementsByTagName("td");ua=Za[0].offsetHeight===
0;Za[0].style.display="";Za[1].style.display="none";X.reliableHiddenOffsets=ua&&Za[0].offsetHeight===0;if(a.getComputedStyle){I.innerHTML="";c=u.createElement("div");c.style.width="0";c.style.marginRight="0";I.style.width="2px";I.appendChild(c);X.reliableMarginRight=(parseInt((a.getComputedStyle(c,null)||{marginRight:0}).marginRight,10)||0)===0}if(typeof I.style.zoom!=="undefined"){I.innerHTML="";I.style.width=I.style.padding="1px";I.style.border=0;I.style.overflow="hidden";I.style.display="inline";
I.style.zoom=1;X.inlineBlockNeedsLayout=I.offsetWidth===3;I.style.display="block";I.style.overflow="visible";I.innerHTML="<div style='width:5px;'></div>";X.shrinkWrapBlocks=I.offsetWidth!==3}I.style.cssText="position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:0;visibility:hidden;";I.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;display:block;'><div style='padding:0;margin:0;border:0;display:block;overflow:hidden;'></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
c=I.firstChild;d=c.firstChild;f=c.nextSibling.firstChild.firstChild;f={doesNotAddBorder:d.offsetTop!==5,doesAddBorderForTableAndCells:f.offsetTop===5};d.style.position="fixed";d.style.top="20px";f.fixedPosition=d.offsetTop===20||d.offsetTop===15;d.style.position=d.style.top="";c.style.overflow="hidden";c.style.position="relative";f.subtractsBorderForOverflowNotVisible=d.offsetTop===-5;f.doesNotIncludeMarginInBodyOffset=e.offsetTop!==1;if(a.getComputedStyle){I.style.marginTop="1%";X.pixelMargin=(a.getComputedStyle(I,
null)||{marginTop:0}).marginTop!=="1%"}if(typeof b.style.zoom!=="undefined")b.style.zoom=1;e.removeChild(b);I=null;k.extend(X,f)}});ca=X}Na.support=ca;var ib=/^(?:\{.*\}|\[.*\])$/,Ga=/([A-Z])/g;k.extend({cache:{},uuid:0,expando:"jQuery"+(k.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?k.cache[a[k.expando]]:a[k.expando];return!!a&&!d(a)},data:function(a,c,d,f){if(k.acceptData(a)){var e;e=k.expando;
var g=typeof c==="string",h=a.nodeType,i=h?k.cache:a,m=h?a[e]:a[e]&&e,l=c==="events";if(m&&i[m]&&(l||f||i[m].data)||!(g&&d===b)){m||(h?a[e]=m=++k.uuid:m=e);if(!i[m]){i[m]={};if(!h)i[m].toJSON=k.noop}if(typeof c==="object"||typeof c==="function")f?i[m]=k.extend(i[m],c):i[m].data=k.extend(i[m].data,c);e=a=i[m];if(!f){if(!a.data)a.data={};a=a.data}d!==b&&(a[k.camelCase(c)]=d);if(l&&!a[c])return e.events;if(g){d=a[c];d==null&&(d=a[k.camelCase(c)])}else d=a;return d}}},removeData:function(a,b,c){if(k.acceptData(a)){var f,
e,g,h=k.expando,i=a.nodeType,m=i?k.cache:a,l=i?a[h]:h;if(m[l]){if(b)if(f=c?m[l]:m[l].data){if(!k.isArray(b))if(b in f)b=[b];else{b=k.camelCase(b);b=b in f?[b]:b.split(" ")}e=0;for(g=b.length;e<g;e++)delete f[b[e]];if(!(c?d:k.isEmptyObject)(f))return}if(!c){delete m[l].data;if(!d(m[l]))return}k.support.deleteExpando||!m.setInterval?delete m[l]:m[l]=null;i&&(k.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}}},_data:function(a,b,c){return k.data(a,b,c,true)},acceptData:function(a){if(a.nodeName){var b=
k.noData[a.nodeName.toLowerCase()];if(b)return!(b===true||a.getAttribute("classid")!==b)}return true}});k.fn.extend({data:function(a,c){var d,f,g,h,i,m=this[0],l=0,j=null;if(a===b){if(this.length){j=k.data(m);if(m.nodeType===1&&!k._data(m,"parsedAttrs")){g=m.attributes;for(i=g.length;l<i;l++){h=g[l].name;if(h.indexOf("data-")===0){h=k.camelCase(h.substring(5));e(m,h,j[h])}}k._data(m,"parsedAttrs",true)}}return j}if(typeof a==="object")return this.each(function(){k.data(this,a)});d=a.split(".",2);
d[1]=d[1]?"."+d[1]:"";f=d[1]+"!";return k.access(this,function(c){if(c===b){j=this.triggerHandler("getData"+f,[d[0]]);if(j===b&&m){j=k.data(m,a);j=e(m,a,j)}return j===b&&d[1]?this.data(d[0]):j}d[1]=c;this.each(function(){var b=k(this);b.triggerHandler("setData"+f,d);k.data(this,a,c);b.triggerHandler("changeData"+f,d)})},null,c,arguments.length>1,null,false)},removeData:function(a){return this.each(function(){k.removeData(this,a)})}});k.extend({_mark:function(a,b){if(a){b=(b||"fx")+"mark";k._data(a,
b,(k._data(a,b)||0)+1)}},_unmark:function(a,b,c){if(a!==true){c=b;b=a;a=false}if(b){var c=c||"fx",d=c+"mark";if(a=a?0:(k._data(b,d)||1)-1)k._data(b,d,a);else{k.removeData(b,d,true);g(b,c,"mark")}}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue";d=k._data(a,b);c&&(!d||k.isArray(c)?d=k._data(a,b,k.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){var b=b||"fx",c=k.queue(a,b),d=c.shift(),f={};d==="inprogress"&&(d=c.shift());if(d){b==="fx"&&c.unshift("inprogress");k._data(a,b+".run",
f);d.call(a,function(){k.dequeue(a,b)},f)}if(!c.length){k.removeData(a,b+"queue "+b+".run",true);g(a,b,"queue")}}});k.fn.extend({queue:function(a,c){var d=2;if(typeof a!=="string"){c=a;a="fx";d--}return arguments.length<d?k.queue(this[0],a):c===b?this:this.each(function(){var b=k.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&k.dequeue(this,a)})},dequeue:function(a){return this.each(function(){k.dequeue(this,a)})},delay:function(a,b){a=k.fx?k.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,
c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function d(){--h||f.resolveWith(e,[e])}if(typeof a!=="string"){c=a;a=b}for(var a=a||"fx",f=k.Deferred(),e=this,g=e.length,h=1,i=a+"defer",m=a+"queue",l=a+"mark",j;g--;)if(j=k.data(e[g],i,b,true)||(k.data(e[g],m,b,true)||k.data(e[g],l,b,true))&&k.data(e[g],i,k.Callbacks("once memory"),true)){h++;j.add(d)}d();return f.promise(c)}});var Fa=/[\n\t\r]/g,fb=/\s+/,ab=
/\r/g,Oa=/^(?:button|input)$/i,bb=/^(?:button|input|object|select|textarea)$/i,jb=/^a(?:rea)?$/i,kb=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ta=k.support.getSetAttribute,ka,ob,oa;k.fn.extend({attr:function(a,b){return k.access(this,k.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){k.removeAttr(this,a)})},prop:function(a,b){return k.access(this,k.prop,a,b,arguments.length>1)},removeProp:function(a){a=
k.propFix[a]||a;return this.each(function(){try{this[a]=b;delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,f,e,g,h;if(k.isFunction(a))return this.each(function(b){k(this).addClass(a.call(this,b,this.className))});if(a&&typeof a==="string"){b=a.split(fb);c=0;for(d=this.length;c<d;c++){f=this[c];if(f.nodeType===1)if(!f.className&&b.length===1)f.className=a;else{e=" "+f.className+" ";g=0;for(h=b.length;g<h;g++)~e.indexOf(" "+b[g]+" ")||(e=e+(b[g]+" "));f.className=k.trim(e)}}}return this},
removeClass:function(a){var c,d,f,e,g,h,i;if(k.isFunction(a))return this.each(function(b){k(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a==="string"||a===b){c=(a||"").split(fb);d=0;for(f=this.length;d<f;d++){e=this[d];if(e.nodeType===1&&e.className)if(a){g=(" "+e.className+" ").replace(Fa," ");h=0;for(i=c.length;h<i;h++)g=g.replace(" "+c[h]+" "," ");e.className=k.trim(g)}else e.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b==="boolean";return k.isFunction(a)?
this.each(function(c){k(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string")for(var f,e=0,g=k(this),h=b,i=a.split(fb);f=i[e++];){h=d?h:!g.hasClass(f);g[h?"addClass":"removeClass"](f)}else if(c==="undefined"||c==="boolean"){this.className&&k._data(this,"__className__",this.className);this.className=this.className||a===false?"":k._data(this,"__className__")||""}})},hasClass:function(a){for(var a=" "+a+" ",b=0,c=this.length;b<c;b++)if(this[b].nodeType===1&&(" "+
this[b].className+" ").replace(Fa," ").indexOf(a)>-1)return true;return false},val:function(a){var c,d,f,e=this[0];if(arguments.length){f=k.isFunction(a);return this.each(function(d){var e=k(this);if(this.nodeType===1){d=f?a.call(this,d,e.val()):a;d==null?d="":typeof d==="number"?d=d+"":k.isArray(d)&&(d=k.map(d,function(a){return a==null?"":a+""}));c=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()];if(!c||!("set"in c)||c.set(this,d,"value")===b)this.value=d}})}if(e){if((c=k.valHooks[e.type]||
k.valHooks[e.nodeName.toLowerCase()])&&"get"in c&&(d=c.get(e,"value"))!==b)return d;d=e.value;return typeof d==="string"?d.replace(ab,""):d==null?"":d}}});k.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d=a.selectedIndex,f=[],e=a.options,g=a.type==="select-one";if(d<0)return null;a=g?d:0;for(c=g?d+1:e.length;a<c;a++){b=e[a];if(b.selected&&(k.support.optDisabled?!b.disabled:b.getAttribute("disabled")===null)&&
(!b.parentNode.disabled||!k.nodeName(b.parentNode,"optgroup"))){b=k(b).val();if(g)return b;f.push(b)}}return g&&!f.length&&e.length?k(e[d]).val():f},set:function(a,b){var c=k.makeArray(b);k(a).find("option").each(function(){this.selected=k.inArray(k(this).val(),c)>=0});if(!c.length)a.selectedIndex=-1;return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,f){var e,g,h=a.nodeType;if(a&&!(h===3||h===8||h===2)){if(f&&c in k.attrFn)return k(a)[c](d);
if(typeof a.getAttribute==="undefined")return k.prop(a,c,d);if(f=h!==1||!k.isXMLDoc(a)){c=c.toLowerCase();g=k.attrHooks[c]||(kb.test(c)?ob:ka)}if(d!==b)if(d===null)k.removeAttr(a,c);else{if(g&&"set"in g&&f&&(e=g.set(a,d,c))!==b)return e;a.setAttribute(c,""+d);return d}else{if(g&&"get"in g&&f&&(e=g.get(a,c))!==null)return e;e=a.getAttribute(c);return e===null?b:e}}},removeAttr:function(a,b){var c,d,f,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(fb);for(e=d.length;h<e;h++)if(f=d[h]){c=k.propFix[f]||
f;(g=kb.test(f))||k.attr(a,f,"");a.removeAttribute(ta?f:c);g&&c in a&&(a[c]=false)}}},attrHooks:{type:{set:function(a,b){if(Oa.test(a.nodeName)&&a.parentNode)k.error("type property can't be changed");else if(!k.support.radioValue&&b==="radio"&&k.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);if(c)a.value=c;return b}}},value:{get:function(a,b){return ka&&k.nodeName(a,"button")?ka.get(a,b):b in a?a.value:null},set:function(a,b,c){if(ka&&k.nodeName(a,"button"))return ka.set(a,b,c);a.value=
b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var f,e,g;g=a.nodeType;if(a&&!(g===3||g===8||g===2)){if(g=g!==1||!k.isXMLDoc(a)){c=k.propFix[c]||c;e=k.propHooks[c]}return d!==b?e&&"set"in e&&(f=e.set(a,d,c))!==b?f:a[c]=d:e&&"get"in e&&(f=e.get(a,c))!==
null?f:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):bb.test(a.nodeName)||jb.test(a.nodeName)&&a.href?0:b}}}});k.attrHooks.tabindex=k.propHooks.tabIndex;ob={get:function(a,c){var d,f=k.prop(a,c);return f===true||typeof f!=="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==false?c.toLowerCase():b},set:function(a,b,c){if(b===false)k.removeAttr(a,c);else{b=k.propFix[c]||c;b in a&&(a[b]=true);a.setAttribute(c,c.toLowerCase())}return c}};
ta||(oa={name:!0,id:!0,coords:!0},ka=k.valHooks.button={get:function(a,c){var d;return(d=a.getAttributeNode(c))&&(oa[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,c){var d=a.getAttributeNode(c);if(!d){d=u.createAttribute(c);a.setAttributeNode(d)}return d.nodeValue=b+""}},k.attrHooks.tabindex.set=ka.set,k.each(["width","height"],function(a,b){k.attrHooks[b]=k.extend(k.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),k.attrHooks.contenteditable={get:ka.get,
set:function(a,b,c){b===""&&(b="false");ka.set(a,b,c)}});k.support.hrefNormalized||k.each(["href","src","width","height"],function(a,c){k.attrHooks[c]=k.extend(k.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return a===null?b:a}})});k.support.style||(k.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}});k.support.optSelected||(k.propHooks.selected=k.extend(k.propHooks.selected,{get:function(a){if(a=a.parentNode){a.selectedIndex;
a.parentNode&&a.parentNode.selectedIndex}return null}}));k.support.enctype||(k.propFix.enctype="encoding");k.support.checkOn||k.each(["radio","checkbox"],function(){k.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}});k.each(["radio","checkbox"],function(){k.valHooks[this]=k.extend(k.valHooks[this],{set:function(a,b){if(k.isArray(b))return a.checked=k.inArray(k(a).val(),b)>=0}})});var Ra=/^(?:textarea|input|select)$/i,gb=/^([^\.]*)?(?:\.(.+))?$/,hb=/(?:^|\s)hover(\.\S+)?\b/,
pb=/^key/,zb=/^(?:mouse|contextmenu)|click/,qb=/^(?:focusinfocus|focusoutblur)$/,Sa=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,Ta=function(a){if(a=Sa.exec(a)){a[1]=(a[1]||"").toLowerCase();a[3]=a[3]&&RegExp("(?:^|\\s)"+a[3]+"(?:\\s|$)")}return a},Ha=function(a){return k.event.special.hover?a:a.replace(hb,"mouseenter$1 mouseleave$1")};k.event={add:function(a,c,d,f,e){var g,h,i,m,l,j,p,n,u;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(g=k._data(a)))){if(d.handler){p=d;d=p.handler;e=p.selector}if(!d.guid)d.guid=
k.guid++;i=g.events;if(!i)g.events=i={};h=g.handle;if(!h){g.handle=h=function(a){return typeof k!=="undefined"&&(!a||k.event.triggered!==a.type)?k.event.dispatch.apply(h.elem,arguments):b};h.elem=a}c=k.trim(Ha(c)).split(" ");for(g=0;g<c.length;g++){m=gb.exec(c[g])||[];l=m[1];j=(m[2]||"").split(".").sort();u=k.event.special[l]||{};l=(e?u.delegateType:u.bindType)||l;u=k.event.special[l]||{};m=k.extend({type:l,origType:m[1],data:f,handler:d,guid:d.guid,selector:e,quick:e&&Ta(e),namespace:j.join(".")},
p);n=i[l];if(!n){n=i[l]=[];n.delegateCount=0;if(!u.setup||u.setup.call(a,f,j,h)===false)a.addEventListener?a.addEventListener(l,h,false):a.attachEvent&&a.attachEvent("on"+l,h)}if(u.add){u.add.call(a,m);if(!m.handler.guid)m.handler.guid=d.guid}e?n.splice(n.delegateCount++,0,m):n.push(m);k.event.global[l]=true}a=null}},global:{},remove:function(a,b,c,d,f){var e=k.hasData(a)&&k._data(a),g,h,i,m,l,j,p,n,u,ba;if(e&&(p=e.events)){b=k.trim(Ha(b||"")).split(" ");for(g=0;g<b.length;g++){h=gb.exec(b[g])||[];
i=m=h[1];h=h[2];if(i){n=k.event.special[i]||{};i=(d?n.delegateType:n.bindType)||i;u=p[i]||[];l=u.length;h=h?RegExp("(^|\\.)"+h.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(j=0;j<u.length;j++){ba=u[j];if((f||m===ba.origType)&&(!c||c.guid===ba.guid)&&(!h||h.test(ba.namespace))&&(!d||d===ba.selector||d==="**"&&ba.selector)){u.splice(j--,1);ba.selector&&u.delegateCount--;n.remove&&n.remove.call(a,ba)}}if(u.length===0&&l!==u.length){(!n.teardown||n.teardown.call(a,h)===false)&&k.removeEvent(a,
i,e.handle);delete p[i]}}else for(i in p)k.event.remove(a,i+b[g],c,d,true)}if(k.isEmptyObject(p)){if(b=e.handle)b.elem=null;k.removeData(a,["events","handle"],true)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,f,e){if(!f||!(f.nodeType===3||f.nodeType===8)){var g=c.type||c,h=[],i,m,l,j,p;if(!qb.test(g+k.event.triggered)){if(g.indexOf("!")>=0){g=g.slice(0,-1);i=true}if(g.indexOf(".")>=0){h=g.split(".");g=h.shift();h.sort()}if(f&&!k.event.customEvent[g]||k.event.global[g]){c=
typeof c==="object"?c[k.expando]?c:new k.Event(g,c):new k.Event(g);c.type=g;c.isTrigger=true;c.exclusive=i;c.namespace=h.join(".");c.namespace_re=c.namespace?RegExp("(^|\\.)"+h.join("\\.(?:.*\\.)?")+"(\\.|$)"):null;i=g.indexOf(":")<0?"on"+g:"";if(f){c.result=b;if(!c.target)c.target=f;d=d!=null?k.makeArray(d):[];d.unshift(c);l=k.event.special[g]||{};if(!(l.trigger&&l.trigger.apply(f,d)===false)){p=[[f,l.bindType||g]];if(!e&&!l.noBubble&&!k.isWindow(f)){j=l.delegateType||g;h=qb.test(j+g)?f:f.parentNode;
for(m=null;h;h=h.parentNode){p.push([h,j]);m=h}m&&m===f.ownerDocument&&p.push([m.defaultView||m.parentWindow||a,j])}for(m=0;m<p.length&&!c.isPropagationStopped();m++){h=p[m][0];c.type=p[m][1];(j=(k._data(h,"events")||{})[c.type]&&k._data(h,"handle"))&&j.apply(h,d);(j=i&&h[i])&&(k.acceptData(h)&&j.apply(h,d)===false)&&c.preventDefault()}c.type=g;if(!e&&!c.isDefaultPrevented()&&(!l._default||l._default.apply(f.ownerDocument,d)===false)&&!(g==="click"&&k.nodeName(f,"a"))&&k.acceptData(f))if(i&&f[g]&&
(g!=="focus"&&g!=="blur"||c.target.offsetWidth!==0)&&!k.isWindow(f)){(m=f[i])&&(f[i]=null);k.event.triggered=g;f[g]();k.event.triggered=b;m&&(f[i]=m)}return c.result}}else{f=k.cache;for(m in f)f[m].events&&f[m].events[g]&&k.event.trigger(c,d,f[m].handle.elem,true)}}}}},dispatch:function(c){var c=k.event.fix(c||a.event),d=(k._data(this,"events")||{})[c.type]||[],f=d.delegateCount,e=[].slice.call(arguments,0),g=!c.exclusive&&!c.namespace,h=k.event.special[c.type]||{},i=[],m,l,j,p,n,u,ba;e[0]=c;c.delegateTarget=
this;if(!(h.preDispatch&&h.preDispatch.call(this,c)===false)){if(f&&!(c.button&&c.type==="click")){j=k(this);j.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this)if(l.disabled!==true){n={};u=[];j[0]=l;for(m=0;m<f;m++){p=d[m];ba=p.selector;if(n[ba]===b){var q=n,E=ba,z;if(p.quick){z=p.quick;var w=l.attributes||{};z=(!z[1]||l.nodeName.toLowerCase()===z[1])&&(!z[2]||(w.id||{}).value===z[2])&&(!z[3]||z[3].test((w["class"]||{}).value))}else z=j.is(ba);q[E]=z}n[ba]&&u.push(p)}u.length&&
i.push({elem:l,matches:u})}}d.length>f&&i.push({elem:this,matches:d.slice(f)});for(m=0;m<i.length&&!c.isPropagationStopped();m++){f=i[m];c.currentTarget=f.elem;for(d=0;d<f.matches.length&&!c.isImmediatePropagationStopped();d++){p=f.matches[d];if(g||!c.namespace&&!p.namespace||c.namespace_re&&c.namespace_re.test(p.namespace)){c.data=p.data;c.handleObj=p;p=((k.event.special[p.origType]||{}).handle||p.handler).apply(f.elem,e);if(p!==b){c.result=p;if(p===false){c.preventDefault();c.stopPropagation()}}}}}h.postDispatch&&
h.postDispatch.call(this,c);return c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){if(a.which==null)a.which=b.charCode!=null?b.charCode:b.keyCode;return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(a,c){var d,f,e=c.button,g=c.fromElement;if(a.pageX==null&&c.clientX!=null){d=a.target.ownerDocument||u;f=d.documentElement;d=d.body;a.pageX=c.clientX+(f&&f.scrollLeft||d&&d.scrollLeft||0)-(f&&f.clientLeft||d&&d.clientLeft||0);a.pageY=c.clientY+(f&&f.scrollTop||d&&d.scrollTop||0)-(f&&f.clientTop||d&&d.clientTop||0)}if(!a.relatedTarget&&g)a.relatedTarget=g===a.target?c.toElement:g;if(!a.which&&e!==b)a.which=e&1?1:e&2?3:e&4?2:0;return a}},fix:function(a){if(a[k.expando])return a;var c,
d,f=a,e=k.event.fixHooks[a.type]||{},g=e.props?this.props.concat(e.props):this.props,a=k.Event(f);for(c=g.length;c;){d=g[--c];a[d]=f[d]}if(!a.target)a.target=f.srcElement||u;if(a.target.nodeType===3)a.target=a.target.parentNode;if(a.metaKey===b)a.metaKey=a.ctrlKey;return e.filter?e.filter(a,f):a},special:{ready:{setup:k.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){if(k.isWindow(this))this.onbeforeunload=c},teardown:function(a,
b){if(this.onbeforeunload===b)this.onbeforeunload=null}}},simulate:function(a,b,c,d){a=k.extend(new k.Event,c,{type:a,isSimulated:true,originalEvent:{}});d?k.event.trigger(a,null,b):k.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};k.event.handle=k.event.dispatch;k.removeEvent=u.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,false)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};k.Event=function(a,b){if(!(this instanceof k.Event))return new k.Event(a,
b);if(a&&a.type){this.originalEvent=a;this.type=a.type;this.isDefaultPrevented=a.defaultPrevented||a.returnValue===false||a.getPreventDefault&&a.getPreventDefault()?c:f}else this.type=a;b&&k.extend(this,b);this.timeStamp=a&&a.timeStamp||k.now();this[k.expando]=true};k.Event.prototype={preventDefault:function(){this.isDefaultPrevented=c;var a=this.originalEvent;if(a)a.preventDefault?a.preventDefault():a.returnValue=false},stopPropagation:function(){this.isPropagationStopped=c;var a=this.originalEvent;
if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=c;this.stopPropagation()},isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f};k.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){k.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=a.relatedTarget,d=a.handleObj,f;if(!c||c!==this&&!k.contains(this,c)){a.type=d.origType;f=d.handler.apply(this,arguments);
a.type=b}return f}}});k.support.submitBubbles||(k.event.special.submit={setup:function(){if(k.nodeName(this,"form"))return false;k.event.add(this,"click._submit keypress._submit",function(a){a=a.target;if((a=k.nodeName(a,"input")||k.nodeName(a,"button")?a.form:b)&&!a._submit_attached){k.event.add(a,"submit._submit",function(a){a._submit_bubble=true});a._submit_attached=true}})},postDispatch:function(a){if(a._submit_bubble){delete a._submit_bubble;this.parentNode&&!a.isTrigger&&k.event.simulate("submit",
this.parentNode,a,true)}},teardown:function(){if(k.nodeName(this,"form"))return false;k.event.remove(this,"._submit")}});k.support.changeBubbles||(k.event.special.change={setup:function(){if(Ra.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){k.event.add(this,"propertychange._change",function(a){if(a.originalEvent.propertyName==="checked")this._just_changed=true});k.event.add(this,"click._change",function(a){if(this._just_changed&&!a.isTrigger){this._just_changed=false;k.event.simulate("change",
this,a,true)}})}return false}k.event.add(this,"beforeactivate._change",function(a){a=a.target;if(Ra.test(a.nodeName)&&!a._change_attached){k.event.add(a,"change._change",function(a){this.parentNode&&(!a.isSimulated&&!a.isTrigger)&&k.event.simulate("change",this.parentNode,a,true)});a._change_attached=true}})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){k.event.remove(this,
"._change");return Ra.test(this.nodeName)}});k.support.focusinBubbles||k.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){k.event.simulate(b,a.target,k.event.fix(a),true)};k.event.special[b]={setup:function(){c++===0&&u.addEventListener(a,d,true)},teardown:function(){--c===0&&u.removeEventListener(a,d,true)}}});k.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a==="object"){if(typeof c!=="string"){d=d||c;c=b}for(i in a)this.on(i,c,d,a[i],g);return this}if(d==null&&e==
null){e=c;d=c=b}else if(e==null)if(typeof c==="string"){e=d;d=b}else{e=d;d=c;c=b}if(e===false)e=f;else if(!e)return this;if(g===1){h=e;e=function(a){k().off(a);return h.apply(this,arguments)};e.guid=h.guid||(h.guid=k.guid++)}return this.each(function(){k.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;k(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler);
return this}if(typeof a==="object"){for(e in a)this.off(e,c,a[e]);return this}if(c===false||typeof c==="function"){d=c;c=b}d===false&&(d=f);return this.each(function(){k.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){k(this.context).on(a,this.selector,b,c);return this},die:function(a,b){k(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,
b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){k.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return k.event.trigger(a,b,this[0],true)},toggle:function(a){var b=arguments,c=a.guid||k.guid++,d=0,f=function(c){var f=(k._data(this,"lastToggle"+a.guid)||0)%d;k._data(this,"lastToggle"+a.guid,f+1);c.preventDefault();return b[f].apply(this,arguments)||false};for(f.guid=c;d<b.length;)b[d++].guid=c;return this.click(f)},
hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});k.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){k.fn[b]=function(a,c){if(c==null){c=a;a=null}return arguments.length>0?this.on(b,null,a,c):this.trigger(b)};k.attrFn&&(k.attrFn[b]=true);if(pb.test(b))k.event.fixHooks[b]=k.event.keyHooks;if(zb.test(b))k.event.fixHooks[b]=
k.event.mouseHooks});var Pa=function(a,b,c,d,f,e){for(var f=0,g=d.length;f<g;f++){var h=d[f];if(h){for(var i=false,h=h[a];h;){if(h[da]===c){i=d[h.sizset];break}if(h.nodeType===1&&!e){h[da]=c;h.sizset=f}if(h.nodeName.toLowerCase()===b){i=h;break}h=h[a]}d[f]=i}}},cb=function(a,b,c,d,f,e){for(var f=0,g=d.length;f<g;f++){var h=d[f];if(h){for(var i=false,h=h[a];h;){if(h[da]===c){i=d[h.sizset];break}if(h.nodeType===1){if(!e){h[da]=c;h.sizset=f}if(typeof b!=="string"){if(h===b){i=true;break}}else if(G.filter(b,
[h]).length>0){i=h;break}}h=h[a]}d[f]=i}}},R=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,da="sizcache"+(Math.random()+"").replace(".",""),va=0,aa=Object.prototype.toString,Y=!1,Ua=!0,O=/\\/g,Qa=/\r\n/g,ga=/\W/;[0,0].sort(function(){Ua=false;return 0});var G=function(a,b,c,d){var c=c||[],f=b=b||u;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!=="string")return c;var e,g,h,i,m,k=true,l=G.isXML(b),j=
[],p=a;do{R.exec("");if(e=R.exec(p)){p=e[3];j.push(e[1]);if(e[2]){i=e[3];break}}}while(e);if(j.length>1&&Ab.exec(a))if(j.length===2&&P.relative[j[0]])g=Ub(j[0]+j[1],b,d);else for(g=P.relative[j[0]]?[b]:G(j.shift(),b);j.length;){a=j.shift();P.relative[a]&&(a=a+j.shift());g=Ub(a,g,d)}else{if(!d&&j.length>1&&b.nodeType===9&&!l&&P.match.ID.test(j[0])&&!P.match.ID.test(j[j.length-1])){e=G.find(j.shift(),b,l);b=e.expr?G.filter(e.expr,e.set)[0]:e.set[0]}if(b){e=d?{expr:j.pop(),set:Ba(d)}:G.find(j.pop(),
j.length===1&&(j[0]==="~"||j[0]==="+")&&b.parentNode?b.parentNode:b,l);g=e.expr?G.filter(e.expr,e.set):e.set;for(j.length>0?h=Ba(g):k=false;j.length;){e=m=j.pop();P.relative[m]?e=j.pop():m="";e==null&&(e=b);P.relative[m](h,e,l)}}else h=[]}h||(h=g);h||G.error(m||a);if(aa.call(h)==="[object Array]")if(k)if(b&&b.nodeType===1)for(a=0;h[a]!=null;a++)h[a]&&(h[a]===true||h[a].nodeType===1&&G.contains(b,h[a]))&&c.push(g[a]);else for(a=0;h[a]!=null;a++)h[a]&&h[a].nodeType===1&&c.push(g[a]);else c.push.apply(c,
h);else Ba(h,c);if(i){G(i,f,c,d);G.uniqueSort(c)}return c};G.uniqueSort=function(a){if(Bb){Y=Ua;a.sort(Bb);if(Y)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a};G.matches=function(a,b){return G(a,null,null,b)};G.matchesSelector=function(a,b){return G(b,null,null,[a]).length>0};G.find=function(a,b,c){var d,f,e,g,h,i;if(!a)return[];f=0;for(e=P.order.length;f<e;f++){h=P.order[f];if(g=P.leftMatch[h].exec(a)){i=g[1];g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(O,
"");d=P.find[h](g,b,c);if(d!=null){a=a.replace(P.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!=="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}};G.filter=function(a,c,d,f){for(var e,g,h,i,m,k,l,j,p=a,n=[],u=c,ba=c&&c[0]&&G.isXML(c[0]);a&&c.length;){for(h in P.filter)if((e=P.leftMatch[h].exec(a))!=null&&e[2]){k=P.filter[h];m=e[1];g=false;e.splice(1,1);if(m.substr(m.length-1)!=="\\"){u===n&&(n=[]);if(P.preFilter[h])if(e=P.preFilter[h](e,u,d,n,f,ba)){if(e===true)continue}else g=
i=true;if(e)for(l=0;(m=u[l])!=null;l++)if(m){i=k(m,e,l,u);j=f^i;if(d&&i!=null)j?g=true:u[l]=false;else if(j){n.push(m);g=true}}if(i!==b){d||(u=n);a=a.replace(P.match[h],"");if(!g)return[];break}}}if(a===p)if(g==null)G.error(a);else break;p=a}return u};G.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};var Ca=G.getText=function(a){var b,c;b=a.nodeType;var d="";if(b)if(b===1||b===9||b===11){if(typeof a.textContent==="string")return a.textContent;if(typeof a.innerText==="string")return a.innerText.replace(Qa,
"");for(a=a.firstChild;a;a=a.nextSibling)d=d+Ca(a)}else{if(b===3||b===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(d=d+Ca(c));return d},P=G.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b==="string",d=c&&!ga.test(b),c=c&&!d;d&&(b=b.toLowerCase());for(var d=0,f=a.length,e;d<f;d++)if(e=a[d]){for(;(e=e.previousSibling)&&e.nodeType!==
1;);a[d]=c||e&&e.nodeName.toLowerCase()===b?e||false:e===b}c&&G.filter(b,a,true)},">":function(a,b){var c,d=typeof b==="string",f=0,e=a.length;if(d&&!ga.test(b))for(b=b.toLowerCase();f<e;f++){if(c=a[f]){c=c.parentNode;a[f]=c.nodeName.toLowerCase()===b?c:false}}else{for(;f<e;f++)(c=a[f])&&(a[f]=d?c.parentNode:c.parentNode===b);d&&G.filter(b,a,true)}},"":function(a,b,c){var d,f=va++,e=cb;if(typeof b==="string"&&!ga.test(b)){d=b=b.toLowerCase();e=Pa}e("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,
f=va++,e=cb;if(typeof b==="string"&&!ga.test(b)){d=b=b.toLowerCase();e=Pa}e("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!=="undefined"&&!c)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!=="undefined"){for(var c=[],d=b.getElementsByName(a[1]),f=0,e=d.length;f<e;f++)d[f].getAttribute("name")===a[1]&&c.push(d[f]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!=="undefined")return b.getElementsByTagName(a[1])}},
preFilter:{CLASS:function(a,b,c,d,f,e){a=" "+a[1].replace(O,"")+" ";if(e)return a;for(var e=0,g;(g=b[e])!=null;e++)g&&(f^(g.className&&(" "+g.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(g):c&&(b[e]=false));return false},ID:function(a){return a[1].replace(O,"")},TAG:function(a){return a[1].replace(O,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||G.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&
"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}else a[2]&&G.error(a[0]);a[0]=va++;return a},ATTR:function(a,b,c,d,f,e){b=a[1]=a[1].replace(O,"");!e&&P.attrMap[b]&&(a[1]=P.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(O,"");a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(a,b,c,d,f){if(a[1]==="not")if((R.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=G(a[3],null,null,b);else{a=G.filter(a[3],b,c,1^f);c||d.push.apply(d,a);return false}else if(P.match.POS.test(a[0])||
P.match.CHILD.test(a[0]))return true;return a},POS:function(a){a.unshift(true);return a}},filters:{enabled:function(a){return a.disabled===false&&a.type!=="hidden"},disabled:function(a){return a.disabled===true},checked:function(a){return a.checked===true},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===true},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!G(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},
text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();
return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,
b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var f=b[1],e=P.filters[f];if(e)return e(a,c,b,d);if(f==="contains")return(a.textContent||a.innerText||Ca([a])||"").indexOf(b[3])>=0;if(f==="not"){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===
a)return false;return true}G.error(f)},CHILD:function(a,b){var c,d,f,e,g,h;c=b[1];h=a;switch(c){case "only":case "first":for(;h=h.previousSibling;)if(h.nodeType===1)return false;if(c==="first")return true;h=a;case "last":for(;h=h.nextSibling;)if(h.nodeType===1)return false;return true;case "nth":c=b[2];d=b[3];if(c===1&&d===0)return true;f=b[0];if((e=a.parentNode)&&(e[da]!==f||!a.nodeIndex)){g=0;for(h=e.firstChild;h;h=h.nextSibling)if(h.nodeType===1)h.nodeIndex=++g;e[da]=f}h=a.nodeIndex-d;return c===
0?h===0:h%c===0&&h/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],c=G.attr?G.attr(a,c):P.attrHandle[c]?P.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),d=c+"",f=b[2],e=b[4];return c==null?f==="!=":!f&&G.attr?c!=null:f==="="?d===e:f==="*="?d.indexOf(e)>=0:f===
"~="?(" "+d+" ").indexOf(e)>=0:!e?d&&c!==false:f==="!="?d!==e:f==="^="?d.indexOf(e)===0:f==="$="?d.substr(d.length-e.length)===e:f==="|="?d===e||d.substr(0,e.length+1)===e+"-":false},POS:function(a,b,c,d){var f=P.setFilters[b[2]];if(f)return f(a,c,b,d)}}},Ab=P.match.POS,lb=function(a,b){return"\\"+(b-0+1)},pa;for(pa in P.match)P.match[pa]=RegExp(P.match[pa].source+/(?![^\[]*\])(?![^\(]*\))/.source),P.leftMatch[pa]=RegExp(/(^(?:.|\r|\n)*?)/.source+P.match[pa].source.replace(/\\(\d+)/g,lb));P.match.globalPOS=
Ab;var Ba=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(u.documentElement.childNodes,0)[0].nodeType}catch(Vb){Ba=function(a,b){var c=0,d=b||[];if(aa.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length==="number")for(var f=a.length;c<f;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var Bb,Ia;u.documentElement.compareDocumentPosition?Bb=function(a,b){if(a===b){Y=true;return 0}return!a.compareDocumentPosition||
!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(Bb=function(a,b){if(a===b){Y=true;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,f=[],e=[];c=a.parentNode;d=b.parentNode;var g=c;if(c===d)return Ia(a,b);if(c){if(!d)return 1}else return-1;for(;g;){f.unshift(g);g=g.parentNode}for(g=d;g;){e.unshift(g);g=g.parentNode}c=f.length;d=e.length;for(g=0;g<c&&g<d;g++)if(f[g]!==e[g])return Ia(f[g],e[g]);return g===c?Ia(a,e[g],-1):
Ia(f[g],b,1)},Ia=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});var rb=u.createElement("div"),Eb="script"+(new Date).getTime(),ba=u.documentElement;rb.innerHTML="<a name='"+Eb+"'/>";ba.insertBefore(rb,ba.firstChild);u.getElementById(Eb)&&(P.find.ID=function(a,c,d){if(typeof c.getElementById!=="undefined"&&!d)return(c=c.getElementById(a[1]))?c.id===a[1]||typeof c.getAttributeNode!=="undefined"&&c.getAttributeNode("id").nodeValue===a[1]?[c]:b:
[]},P.filter.ID=function(a,b){var c=typeof a.getAttributeNode!=="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b});ba.removeChild(rb);var ba=rb=null,wa=u.createElement("div");wa.appendChild(u.createComment(""));0<wa.getElementsByTagName("*").length&&(P.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){for(var d=[],f=0;c[f];f++)c[f].nodeType===1&&d.push(c[f]);c=d}return c});wa.innerHTML="<a href='#'></a>";wa.firstChild&&("undefined"!==typeof wa.firstChild.getAttribute&&
"#"!==wa.firstChild.getAttribute("href"))&&(P.attrHandle.href=function(a){return a.getAttribute("href",2)});wa=null;if(u.querySelectorAll){var sb=G,Ja=u.createElement("div");Ja.innerHTML="<p class='TEST'></p>";if(!(Ja.querySelectorAll&&0===Ja.querySelectorAll(".TEST").length)){var G=function(a,b,c,d){b=b||u;if(!d&&!G.isXML(b)){var f=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(a);if(f&&(b.nodeType===1||b.nodeType===9)){if(f[1])return Ba(b.getElementsByTagName(a),c);if(f[2]&&P.find.CLASS&&b.getElementsByClassName)return Ba(b.getElementsByClassName(f[2]),
c)}if(b.nodeType===9){if(a==="body"&&b.body)return Ba([b.body],c);if(f&&f[3]){var e=b.getElementById(f[3]);if(e&&e.parentNode){if(e.id===f[3])return Ba([e],c)}else return Ba([],c)}try{return Ba(b.querySelectorAll(a),c)}catch(g){}}else if(b.nodeType===1&&b.nodeName.toLowerCase()!=="object"){var f=b,h=(e=b.getAttribute("id"))||"__sizzle__",i=b.parentNode,m=/^\s*[+~]/.test(a);e?h=h.replace(/'/g,"\\$&"):b.setAttribute("id",h);if(m&&i)b=b.parentNode;try{if(!m||i)return Ba(b.querySelectorAll("[id='"+h+
"'] "+a),c)}catch(k){}finally{e||f.removeAttribute("id")}}}return sb(a,b,c,d)},Va;for(Va in sb)G[Va]=sb[Va];Ja=null}}var Wa=u.documentElement,Hb=Wa.matchesSelector||Wa.mozMatchesSelector||Wa.webkitMatchesSelector||Wa.msMatchesSelector;if(Hb){var oc=!Hb.call(u.createElement("div"),"div"),Wb=!1;try{Hb.call(u.documentElement,"[test!='']:sizzle")}catch(Uc){Wb=!0}G.matchesSelector=function(a,b){b=b.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!G.isXML(a))try{if(Wb||!P.match.PSEUDO.test(b)&&!/!=/.test(b)){var c=
Hb.call(a,b);if(c||!oc||a.document&&a.document.nodeType!==11)return c}}catch(d){}return G(b,null,null,[a]).length>0}}var Cb=u.createElement("div");Cb.innerHTML="<div class='test e'></div><div class='test'></div>";Cb.getElementsByClassName&&0!==Cb.getElementsByClassName("e").length&&(Cb.lastChild.className="e",1!==Cb.getElementsByClassName("e").length&&(P.order.splice(1,0,"CLASS"),P.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!=="undefined"&&!c)return b.getElementsByClassName(a[1])},
Cb=null));G.contains=u.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):true)}:u.documentElement.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(){return false};G.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":false};var Ub=function(a,b,c){for(var d,f=[],e="",b=b.nodeType?[b]:b;d=P.match.PSEUDO.exec(a);){e=e+d[0];a=a.replace(P.match.PSEUDO,"")}a=P.relative[a]?a+"*":a;d=0;for(var g=b.length;d<
g;d++)G(a,b[d],f,c);return G.filter(e,f)};G.attr=k.attr;G.selectors.attrMap={};k.find=G;k.expr=G.selectors;k.expr[":"]=k.expr.filters;k.unique=G.uniqueSort;k.text=G.getText;k.isXMLDoc=G.isXML;k.contains=G.contains;var pc=/Until$/,qc=/^(?:parents|prevUntil|prevAll)/,rc=/,/,mc=/^.[^:#\[\.,]*$/,sc=Array.prototype.slice,Xb=k.expr.match.globalPOS,tc={children:!0,contents:!0,next:!0,prev:!0};k.fn.extend({find:function(a){var b=this,c,d;if(typeof a!=="string")return k(a).filter(function(){c=0;for(d=b.length;c<
d;c++)if(k.contains(b[c],this))return true});var f=this.pushStack("","find",a),e,g,h;c=0;for(d=this.length;c<d;c++){e=f.length;k.find(a,this[c],f);if(c>0)for(g=e;g<f.length;g++)for(h=0;h<e;h++)if(f[h]===f[g]){f.splice(g--,1);break}}return f},has:function(a){var b=k(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(k.contains(this,b[a]))return true})},not:function(a){return this.pushStack(h(this,a,false),"not",a)},filter:function(a){return this.pushStack(h(this,a,true),"filter",a)},
is:function(a){return!!a&&(typeof a==="string"?Xb.test(a)?k(a,this.context).index(this[0])>=0:k.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,f,e=this[0];if(k.isArray(a)){for(f=1;e&&e.ownerDocument&&e!==b;){for(d=0;d<a.length;d++)k(e).is(a[d])&&c.push({selector:a[d],elem:e,level:f});e=e.parentNode;f++}return c}var g=Xb.test(a)||typeof a!=="string"?k(a,b||this.context):0;d=0;for(f=this.length;d<f;d++)for(e=this[d];e;)if(g?g.index(e)>-1:k.find.matchesSelector(e,
a)){c.push(e);break}else{e=e.parentNode;if(!e||!e.ownerDocument||e===b||e.nodeType===11)break}c=c.length>1?k.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){return!a?this[0]&&this[0].parentNode?this.prevAll().length:-1:typeof a==="string"?k.inArray(this[0],k(a)):k.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a==="string"?k(a,b):k.makeArray(a&&a.nodeType?[a]:a),d=k.merge(this.get(),c);return this.pushStack(!c[0]||!c[0].parentNode||c[0].parentNode.nodeType===11||
!d[0]||!d[0].parentNode||d[0].parentNode.nodeType===11?d:k.unique(d))},andSelf:function(){return this.add(this.prevObject)}});k.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return k.dir(a,"parentNode")},parentsUntil:function(a,b,c){return k.dir(a,"parentNode",c)},next:function(a){return k.nth(a,2,"nextSibling")},prev:function(a){return k.nth(a,2,"previousSibling")},nextAll:function(a){return k.dir(a,"nextSibling")},prevAll:function(a){return k.dir(a,
"previousSibling")},nextUntil:function(a,b,c){return k.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return k.dir(a,"previousSibling",c)},siblings:function(a){return k.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return k.sibling(a.firstChild)},contents:function(a){return k.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:k.makeArray(a.childNodes)}},function(a,b){k.fn[a]=function(c,d){var f=k.map(this,b,c);pc.test(a)||(d=c);d&&typeof d==="string"&&(f=k.filter(d,
f));f=this.length>1&&!tc[a]?k.unique(f):f;if((this.length>1||rc.test(d))&&qc.test(a))f=f.reverse();return this.pushStack(f,a,sc.call(arguments).join(","))}});k.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?k.find.matchesSelector(b[0],a)?[b[0]]:[]:k.find.matches(a,b)},dir:function(a,c,d){for(var f=[],a=a[c];a&&a.nodeType!==9&&(d===b||a.nodeType!==1||!k(a).is(d));){a.nodeType===1&&f.push(a);a=a[c]}return f},nth:function(a,b,c){for(var b=b||1,d=0;a;a=a[c])if(a.nodeType===1&&
++d===b)break;return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var Sb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",uc=/ jQuery\d+="(?:\d+|null)"/g,Nb=/^\s+/,Yb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Zb=/<([\w:]+)/,vc=/<tbody/i,wc=/<|&#?\w+;/,xc=/<(?:script|style)/i,yc=/<(?:script|object|embed|option|style)/i,
$b=RegExp("<(?:"+Sb+")[\\s/>]","i"),ac=/checked\s*(?:[^=]|=\s*.checked.)/i,bc=/\/(java|ecma)script/i,zc=/^\s*<!(?:\[CDATA\[|\-\-)/,Ka={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ob=i(u);Ka.optgroup=Ka.option;Ka.tbody=
Ka.tfoot=Ka.colgroup=Ka.caption=Ka.thead;Ka.th=Ka.td;k.support.htmlSerialize||(Ka._default=[1,"div<div>","</div>"]);k.fn.extend({text:function(a){return k.access(this,function(a){return a===b?k.text(this):this.empty().append((this[0]&&this[0].ownerDocument||u).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(k.isFunction(a))return this.each(function(b){k(this).wrapAll(a.call(this,b))});if(this[0]){var b=k(a,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&&b.insertBefore(this[0]);
b.map(function(){for(var a=this;a.firstChild&&a.firstChild.nodeType===1;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return k.isFunction(a)?this.each(function(b){k(this).wrapInner(a.call(this,b))}):this.each(function(){var b=k(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=k.isFunction(a);return this.each(function(c){k(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){k.nodeName(this,"body")||
k(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=k.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,
"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,k.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||k.filter(a,[d]).length){if(!b&&d.nodeType===1){k.cleanData(d.getElementsByTagName("*"));k.cleanData([d])}d.parentNode&&d.parentNode.removeChild(d)}return this},
empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&k.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a,b){a=a==null?false:a;b=b==null?a:b;return this.map(function(){return k.clone(this,a,b)})},html:function(a){return k.access(this,function(a){var c=this[0]||{},d=0,f=this.length;if(a===b)return c.nodeType===1?c.innerHTML.replace(uc,""):null;if(typeof a==="string"&&!xc.test(a)&&(k.support.leadingWhitespace||!Nb.test(a))&&
!Ka[(Zb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Yb,"<$1></$2>");try{for(;d<f;d++){c=this[d]||{};if(c.nodeType===1){k.cleanData(c.getElementsByTagName("*"));c.innerHTML=a}}c=0}catch(e){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(k.isFunction(a))return this.each(function(b){var c=k(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!=="string"&&(a=k(a).detach());return this.each(function(){var b=this.nextSibling,
c=this.parentNode;k(this).remove();b?k(b).before(a):k(c).append(a)})}return this.length?this.pushStack(k(k.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,true)},domManip:function(a,c,d){var f,e,g,h=a[0],i=[];if(!k.support.checkClone&&arguments.length===3&&typeof h==="string"&&ac.test(h))return this.each(function(){k(this).domManip(a,c,d,true)});if(k.isFunction(h))return this.each(function(f){var e=k(this);a[0]=h.call(this,f,c?e.html():b);e.domManip(a,c,d)});if(this[0]){f=
h&&h.parentNode;f=k.support.parentNode&&f&&f.nodeType===11&&f.childNodes.length===this.length?{fragment:f}:k.buildFragment(a,this,i);g=f.fragment;if(e=g.childNodes.length===1?g=g.firstChild:g.firstChild){c=c&&k.nodeName(e,"tr");e=0;for(var m=this.length,l=m-1;e<m;e++)d.call(c?k.nodeName(this[e],"table")?this[e].getElementsByTagName("tbody")[0]||this[e].appendChild(this[e].ownerDocument.createElement("tbody")):this[e]:this[e],f.cacheable||m>1&&e<l?k.clone(g,true,true):g)}i.length&&k.each(i,function(a,
b){b.src?k.ajax({type:"GET",global:false,url:b.src,async:false,dataType:"script"}):k.globalEval((b.text||b.textContent||b.innerHTML||"").replace(zc,"/*$0*/"));b.parentNode&&b.parentNode.removeChild(b)})}return this}});k.buildFragment=function(a,b,c){var d,f,e,g,h=a[0];b&&b[0]&&(g=b[0].ownerDocument||b[0]);g.createDocumentFragment||(g=u);if(a.length===1&&typeof h==="string"&&h.length<512&&g===u&&h.charAt(0)==="<"&&!yc.test(h)&&(k.support.checkClone||!ac.test(h))&&(k.support.html5Clone||!$b.test(h))){f=
true;(e=k.fragments[h])&&e!==1&&(d=e)}if(!d){d=g.createDocumentFragment();k.clean(a,g,d,c)}f&&(k.fragments[h]=e?d:1);return{fragment:d,cacheable:f}};k.fragments={};k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){k.fn[a]=function(c){var d=[],c=k(c),f=this.length===1&&this[0].parentNode;if(f&&f.nodeType===11&&f.childNodes.length===1&&c.length===1){c[b](this[0]);return this}for(var f=0,e=c.length;f<e;f++){var g=(f>0?this.clone(true):
this).get();k(c[f])[b](g);d=d.concat(g)}return this.pushStack(d,a,c.selector)}});k.extend({clone:function(a,b,c){var d,f,e;if(k.support.html5Clone||k.isXMLDoc(a)||!$b.test("<"+a.nodeName+">"))d=a.cloneNode(true);else{d=u.createElement("div");Ob.appendChild(d);d.innerHTML=a.outerHTML;d=d.firstChild}var g=d;if((!k.support.noCloneEvent||!k.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!k.isXMLDoc(a)){l(a,g);d=m(a);f=m(g);for(e=0;d[e];++e)f[e]&&l(d[e],f[e])}if(b){j(a,g);if(c){d=m(a);f=m(g);
for(e=0;d[e];++e)j(d[e],f[e])}}return g},clean:function(a,b,c,d){var f,e=[],b=b||u;typeof b.createElement==="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||u);for(var g=0,h;(h=a[g])!=null;g++){typeof h==="number"&&(h=h+"");if(h){if(typeof h==="string")if(wc.test(h)){h=h.replace(Yb,"<$1></$2>");f=(Zb.exec(h)||["",""])[1].toLowerCase();var m=Ka[f]||Ka._default,l=m[0],j=b.createElement("div"),p=Ob.childNodes;b===u?Ob.appendChild(j):i(b).appendChild(j);for(j.innerHTML=m[1]+h+m[2];l--;)j=j.lastChild;
if(!k.support.tbody){l=vc.test(h);m=f==="table"&&!l?j.firstChild&&j.firstChild.childNodes:m[1]==="<table>"&&!l?j.childNodes:[];for(f=m.length-1;f>=0;--f)k.nodeName(m[f],"tbody")&&!m[f].childNodes.length&&m[f].parentNode.removeChild(m[f])}!k.support.leadingWhitespace&&Nb.test(h)&&j.insertBefore(b.createTextNode(Nb.exec(h)[0]),j.firstChild);h=j.childNodes;if(j){j.parentNode.removeChild(j);if(p.length>0)(j=p[p.length-1])&&j.parentNode&&j.parentNode.removeChild(j)}}else h=b.createTextNode(h);var n;if(!k.support.appendChecked)if(h[0]&&
typeof(n=h.length)==="number")for(f=0;f<n;f++)q(h[f]);else q(h);h.nodeType?e.push(h):e=k.merge(e,h)}}if(c){a=function(a){return!a.type||bc.test(a.type)};for(g=0;e[g];g++){b=e[g];if(d&&k.nodeName(b,"script")&&(!b.type||bc.test(b.type)))d.push(b.parentNode?b.parentNode.removeChild(b):b);else{if(b.nodeType===1){h=k.grep(b.getElementsByTagName("script"),a);e.splice.apply(e,[g+1,0].concat(h))}c.appendChild(b)}}}return e},cleanData:function(a){for(var b,c,d=k.cache,f=k.event.special,e=k.support.deleteExpando,
g=0,h;(h=a[g])!=null;g++)if(!h.nodeName||!k.noData[h.nodeName.toLowerCase()])if(c=h[k.expando]){if((b=d[c])&&b.events){for(var i in b.events)f[i]?k.event.remove(h,i):k.removeEvent(h,i,b.handle);if(b.handle)b.handle.elem=null}e?delete h[k.expando]:h.removeAttribute&&h.removeAttribute(k.expando);delete d[c]}}});var Pb=/alpha\([^)]*\)/i,Ac=/opacity=([^)]*)/,Bc=/([A-Z]|^ms)/g,Cc=/^[\-+]?(?:\d*\.)?\d+$/i,Kb=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,Dc=/^([\-+])=([\-+.\de]+)/,Ec=/^margin/,Fc={position:"absolute",
visibility:"hidden",display:"block"},mb=["Top","Right","Bottom","Left"],vb,cc,dc;k.fn.css=function(a,c){return k.access(this,function(a,c,d){return d!==b?k.style(a,c,d):k.css(a,c)},a,c,arguments.length>1)};k.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=vb(a,"opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,
c,d,f){if(a&&!(a.nodeType===3||a.nodeType===8||!a.style)){var e,g=k.camelCase(c),h=a.style,i=k.cssHooks[g],c=k.cssProps[g]||g;if(d!==b){f=typeof d;if(f==="string"&&(e=Dc.exec(d))){d=+(e[1]+1)*+e[2]+parseFloat(k.css(a,c));f="number"}if(!(d==null||f==="number"&&isNaN(d))){f==="number"&&!k.cssNumber[g]&&(d=d+"px");if(!i||!("set"in i)||(d=i.set(a,d))!==b)try{h[c]=d}catch(m){}}}else return i&&"get"in i&&(e=i.get(a,false,f))!==b?e:h[c]}},css:function(a,c,d){var f,e,c=k.camelCase(c);e=k.cssHooks[c];c=k.cssProps[c]||
c;c==="cssFloat"&&(c="float");if(e&&"get"in e&&(f=e.get(a,true,d))!==b)return f;if(vb)return vb(a,c)},swap:function(a,b,c){var d={},f;for(f in b){d[f]=a.style[f];a.style[f]=b[f]}c=c.call(a);for(f in b)a.style[f]=d[f];return c}});k.curCSS=k.css;u.defaultView&&u.defaultView.getComputedStyle&&(cc=function(a,b){var c,d,f,e=a.style,b=b.replace(Bc,"-$1").toLowerCase();if((d=a.ownerDocument.defaultView)&&(f=d.getComputedStyle(a,null))){c=f.getPropertyValue(b);c===""&&!k.contains(a.ownerDocument.documentElement,
a)&&(c=k.style(a,b))}if(!k.support.pixelMargin&&f&&Ec.test(b)&&Kb.test(c)){d=e.width;e.width=c;c=f.width;e.width=d}return c});u.documentElement.currentStyle&&(dc=function(a,b){var c,d,f=a.currentStyle&&a.currentStyle[b],e=a.style;if(f==null&&e&&(c=e[b]))f=c;if(Kb.test(f)){c=e.left;if(d=a.runtimeStyle&&a.runtimeStyle.left)a.runtimeStyle.left=a.currentStyle.left;e.left=b==="fontSize"?"1em":f;f=e.pixelLeft+"px";e.left=c;if(d)a.runtimeStyle.left=d}return f===""?"auto":f});vb=cc||dc;k.each(["height","width"],
function(a,b){k.cssHooks[b]={get:function(a,c,d){if(c)return a.offsetWidth!==0?p(a,b,d):k.swap(a,Fc,function(){return p(a,b,d)})},set:function(a,b){return Cc.test(b)?b+"px":b}}});k.support.opacity||(k.cssHooks.opacity={get:function(a,b){return Ac.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,f=k.isNumeric(b)?"alpha(opacity="+b*100+")":"",e=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&k.trim(e.replace(Pb,
""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=Pb.test(e)?e.replace(Pb,f):e+" "+f}});k(function(){if(!k.support.reliableMarginRight)k.cssHooks.marginRight={get:function(a,b){return k.swap(a,{display:"inline-block"},function(){return b?vb(a,"margin-right"):a.style.marginRight})}}});k.expr&&k.expr.filters&&(k.expr.filters.hidden=function(a){var b=a.offsetHeight;return a.offsetWidth===0&&b===0||!k.support.reliableHiddenOffsets&&(a.style&&a.style.display||k.css(a,"display"))===
"none"},k.expr.filters.visible=function(a){return!k.expr.filters.hidden(a)});k.each({margin:"",padding:"",border:"Width"},function(a,b){k.cssHooks[a+b]={expand:function(c){for(var d=typeof c==="string"?c.split(" "):[c],f={},c=0;c<4;c++)f[a+mb[c]+b]=d[c]||d[c-2]||d[0];return f}}});var Gc=/%20/g,nc=/\[\]$/,ec=/\r?\n/g,Hc=/#.*$/,Ic=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Jc=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Kc=/^(?:GET|HEAD)$/,
Lc=/^\/\//,fc=/\?/,Mc=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Nc=/^(?:select|textarea)/i,Tb=/\s+/,Oc=/([?&])_=[^&]*/,gc=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,hc=k.fn.load,Lb={},ic={},tb,ub,jc=["*/"]+["*"];try{tb=D.href}catch(Vc){tb=u.createElement("a"),tb.href="",tb=tb.href}ub=gc.exec(tb.toLowerCase())||[];k.fn.extend({load:function(a,c,d){if(typeof a!=="string"&&hc)return hc.apply(this,arguments);if(!this.length)return this;var f=a.indexOf(" ");if(f>=0)var e=a.slice(f,a.length),
a=a.slice(0,f);f="GET";if(c)if(k.isFunction(c)){d=c;c=b}else if(typeof c==="object"){c=k.param(c,k.ajaxSettings.traditional);f="POST"}var g=this;k.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText;if(a.isResolved()){a.done(function(a){c=a});g.html(e?k("<div>").append(c.replace(Mc,"")).find(e):c)}d&&g.each(d,[c,b,a])}});return this},serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?
k.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Nc.test(this.nodeName)||Jc.test(this.type))}).map(function(a,b){var c=k(this).val();return c==null?null:k.isArray(c)?k.map(c,function(a){return{name:b.name,value:a.replace(ec,"\r\n")}}):{name:b.name,value:c.replace(ec,"\r\n")}}).get()}});k.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){k.fn[b]=function(a){return this.on(b,a)}});k.each(["get","post"],
function(a,c){k[c]=function(a,d,f,e){if(k.isFunction(d)){e=e||f;f=d;d=b}return k.ajax({type:c,url:a,data:d,success:f,dataType:e})}});k.extend({getScript:function(a,c){return k.get(a,b,c,"script")},getJSON:function(a,b,c){return k.get(a,b,c,"json")},ajaxSetup:function(a,b){if(b)x(a,k.ajaxSettings);else{b=a;a=k.ajaxSettings}x(a,b);return a},ajaxSettings:{url:tb,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(ub[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",
processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":jc},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":k.parseJSON,"text xml":k.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:w(Lb),ajaxTransport:w(ic),ajax:function(a,c){function d(a,c,j,p){if(z!==2){z=2;q&&clearTimeout(q);ba=b;n=p||"";s.readyState=
a>0?4:0;var u,E,D,p=c;if(j){var r=f,x=s,C=r.contents,wa=r.dataTypes,t=r.responseFields,o,B,Q,sb;for(B in t)B in j&&(x[t[B]]=j[B]);for(;wa[0]==="*";){wa.shift();o===b&&(o=r.mimeType||x.getResponseHeader("content-type"))}if(o)for(B in C)if(C[B]&&C[B].test(o)){wa.unshift(B);break}if(wa[0]in j)Q=wa[0];else{for(B in j){if(!wa[0]||r.converters[B+" "+wa[0]]){Q=B;break}sb||(sb=B)}Q=Q||sb}if(Q){Q!==wa[0]&&wa.unshift(Q);j=j[Q]}else j=void 0}else j=b;if(a>=200&&a<300||a===304){if(f.ifModified){if(o=s.getResponseHeader("Last-Modified"))k.lastModified[l]=
o;if(o=s.getResponseHeader("Etag"))k.etag[l]=o}if(a===304){p="notmodified";u=true}else try{o=f;o.dataFilter&&(j=o.dataFilter(j,o.dataType));var v=o.dataTypes;B={};var A,W,V=v.length,F,Ja=v[0],Wa,y,T,Va,fa;for(A=1;A<V;A++){if(A===1)for(W in o.converters)typeof W==="string"&&(B[W.toLowerCase()]=o.converters[W]);Wa=Ja;Ja=v[A];if(Ja==="*")Ja=Wa;else if(Wa!=="*"&&Wa!==Ja){y=Wa+" "+Ja;T=B[y]||B["* "+Ja];if(!T){fa=b;for(Va in B){F=Va.split(" ");if(F[0]===Wa||F[0]==="*")if(fa=B[F[1]+" "+Ja]){Va=B[Va];Va===
true?T=fa:fa===true&&(T=Va);break}}}!T&&!fa&&k.error("No conversion from "+y.replace(" "," to "));T!==true&&(j=T?T(j):fa(Va(j)))}}E=j;p="success";u=true}catch(K){p="parsererror";D=K}}else{D=p;if(!p||a){p="error";a<0&&(a=0)}}s.status=a;s.statusText=""+(c||p);u?h.resolveWith(e,[E,p,s]):h.rejectWith(e,[s,p,D]);s.statusCode(m);m=b;w&&g.trigger("ajax"+(u?"Success":"Error"),[s,f,u?E:D]);i.fireWith(e,[s,p]);if(w){g.trigger("ajaxComplete",[s,f]);--k.active||k.event.trigger("ajaxStop")}}}if(typeof a==="object"){c=
a;a=b}var c=c||{},f=k.ajaxSetup({},c),e=f.context||f,g=e!==f&&(e.nodeType||e instanceof k)?k(e):k.event,h=k.Deferred(),i=k.Callbacks("once memory"),m=f.statusCode||{},l,j={},p={},n,u,ba,q,E,z=0,w,D,s={readyState:0,setRequestHeader:function(a,b){if(!z){var c=a.toLowerCase(),a=p[c]=p[c]||a;j[a]=b}return this},getAllResponseHeaders:function(){return z===2?n:null},getResponseHeader:function(a){var c;if(z===2){if(!u)for(u={};c=Ic.exec(n);)u[c[1].toLowerCase()]=c[2];c=u[a.toLowerCase()]}return c===b?null:
c},overrideMimeType:function(a){if(!z)f.mimeType=a;return this},abort:function(a){a=a||"abort";ba&&ba.abort(a);d(0,a);return this}};h.promise(s);s.success=s.done;s.error=s.fail;s.complete=i.add;s.statusCode=function(a){if(a){var b;if(z<2)for(b in a)m[b]=[m[b],a[b]];else{b=a[s.status];s.then(b,b)}}return this};f.url=((a||f.url)+"").replace(Hc,"").replace(Lc,ub[1]+"//");f.dataTypes=k.trim(f.dataType||"*").toLowerCase().split(Tb);if(f.crossDomain==null){E=gc.exec(f.url.toLowerCase());f.crossDomain=!(!E||
!(E[1]!=ub[1]||E[2]!=ub[2]||(E[3]||(E[1]==="http:"?80:443))!=(ub[3]||(ub[1]==="http:"?80:443))))}if(f.data&&f.processData&&typeof f.data!=="string")f.data=k.param(f.data,f.traditional);r(Lb,f,c,s);if(z===2)return false;w=f.global;f.type=f.type.toUpperCase();f.hasContent=!Kc.test(f.type);w&&k.active++===0&&k.event.trigger("ajaxStart");if(!f.hasContent){if(f.data){f.url=f.url+((fc.test(f.url)?"&":"?")+f.data);delete f.data}l=f.url;if(f.cache===false){E=k.now();var x=f.url.replace(Oc,"$1_="+E);f.url=
x+(x===f.url?(fc.test(f.url)?"&":"?")+"_="+E:"")}}(f.data&&f.hasContent&&f.contentType!==false||c.contentType)&&s.setRequestHeader("Content-Type",f.contentType);if(f.ifModified){l=l||f.url;k.lastModified[l]&&s.setRequestHeader("If-Modified-Since",k.lastModified[l]);k.etag[l]&&s.setRequestHeader("If-None-Match",k.etag[l])}s.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+(f.dataTypes[0]!=="*"?", "+jc+"; q=0.01":""):f.accepts["*"]);for(D in f.headers)s.setRequestHeader(D,
f.headers[D]);if(f.beforeSend&&(f.beforeSend.call(e,s,f)===false||z===2)){s.abort();return false}for(D in{success:1,error:1,complete:1})s[D](f[D]);if(ba=r(ic,f,c,s)){s.readyState=1;w&&g.trigger("ajaxSend",[s,f]);f.async&&f.timeout>0&&(q=setTimeout(function(){s.abort("timeout")},f.timeout));try{z=1;ba.send(j,d)}catch(C){if(z<2)d(-1,C);else throw C;}}else d(-1,"No Transport");return s},param:function(a,c){var d=[],f=function(a,b){b=k.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};
if(c===b)c=k.ajaxSettings.traditional;if(k.isArray(a)||a.jquery&&!k.isPlainObject(a))k.each(a,function(){f(this.name,this.value)});else for(var e in a)t(e,a[e],c,f);return d.join("&").replace(Gc,"+")}});k.extend({active:0,lastModified:{},etag:{}});var Pc=k.now(),Ib=/(\=)\?(&|$)|\?\?/i;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return k.expando+"_"+Pc++}});k.ajaxPrefilter("json jsonp",function(b,c,d){c=typeof b.data==="string"&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);
if(b.dataTypes[0]==="jsonp"||b.jsonp!==false&&(Ib.test(b.url)||c&&Ib.test(b.data))){var f,e=b.jsonpCallback=k.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,g=a[e],h=b.url,i=b.data,m="$1"+e+"$2";if(b.jsonp!==false){h=h.replace(Ib,m);if(b.url===h){c&&(i=i.replace(Ib,m));b.data===i&&(h=h+((/\?/.test(h)?"&":"?")+b.jsonp+"="+e))}}b.url=h;b.data=i;a[e]=function(a){f=[a]};d.always(function(){a[e]=g;if(f&&k.isFunction(g))a[e](f[0])});b.converters["script json"]=function(){f||k.error(e+" was not called");
return f[0]};b.dataTypes[0]="json";return"script"}});k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){k.globalEval(a);return a}}});k.ajaxPrefilter("script",function(a){if(a.cache===b)a.cache=false;if(a.crossDomain){a.type="GET";a.global=false}});k.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=u.head||u.getElementsByTagName("head")[0]||
u.documentElement;return{send:function(f,e){c=u.createElement("script");c.async="async";if(a.scriptCharset)c.charset=a.scriptCharset;c.src=a.url;c.onload=c.onreadystatechange=function(a,f){if(f||!c.readyState||/loaded|complete/.test(c.readyState)){c.onload=c.onreadystatechange=null;d&&c.parentNode&&d.removeChild(c);c=b;f||e(200,"success")}};d.insertBefore(c,d.firstChild)},abort:function(){if(c)c.onload(0,1)}}}});var Qb=a.ActiveXObject?function(){for(var a in Db)Db[a](0,1)}:!1,Qc=0,Db;k.ajaxSettings.xhr=
a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&s()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:s;var Rb=k.ajaxSettings.xhr();k.extend(k.support,{ajax:!!Rb,cors:!!Rb&&"withCredentials"in Rb});k.support.ajax&&k.ajaxTransport(function(c){if(!c.crossDomain||k.support.cors){var d;return{send:function(f,e){var g=c.xhr(),h,i;c.username?g.open(c.type,c.url,c.async,c.username,c.password):g.open(c.type,c.url,c.async);if(c.xhrFields)for(i in c.xhrFields)g[i]=
c.xhrFields[i];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType);!c.crossDomain&&!f["X-Requested-With"]&&(f["X-Requested-With"]="XMLHttpRequest");try{for(i in f)g.setRequestHeader(i,f[i])}catch(m){}g.send(c.hasContent&&c.data||null);d=function(a,f){var i,m,l,j,p;try{if(d&&(f||g.readyState===4)){d=b;if(h){g.onreadystatechange=k.noop;Qb&&delete Db[h]}if(f)g.readyState!==4&&g.abort();else{i=g.status;l=g.getAllResponseHeaders();j={};if((p=g.responseXML)&&p.documentElement)j.xml=p;try{j.text=
g.responseText}catch(u){}try{m=g.statusText}catch(n){m=""}!i&&c.isLocal&&!c.crossDomain?i=j.text?200:404:i===1223&&(i=204)}}}catch(ba){f||e(-1,ba)}j&&e(i,m,j,l)};if(!c.async||g.readyState===4)d();else{h=++Qc;if(Qb){if(!Db){Db={};k(a).unload(Qb)}Db[h]=d}g.onreadystatechange=d}},abort:function(){d&&d(0,1)}}}});var Mb={},Xa,wb,Rc=/^(?:toggle|show|hide)$/,Sc=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,Jb,Gb=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight",
"paddingLeft","paddingRight"],["opacity"]],Fb;k.fn.extend({show:function(a,b,c){if(a||a===0)return this.animate(y("show",3),a,b,c);for(var c=0,d=this.length;c<d;c++){a=this[c];if(a.style){b=a.style.display;if(!k._data(a,"olddisplay")&&b==="none")b=a.style.display="";(b===""&&k.css(a,"display")==="none"||!k.contains(a.ownerDocument.documentElement,a))&&k._data(a,"olddisplay",A(a.nodeName))}}for(c=0;c<d;c++){a=this[c];if(a.style){b=a.style.display;if(b===""||b==="none")a.style.display=k._data(a,"olddisplay")||
""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(y("hide",3),a,b,c);for(var c=0,d=this.length;c<d;c++){a=this[c];if(a.style){b=k.css(a,"display");b!=="none"&&!k._data(a,"olddisplay")&&k._data(a,"olddisplay",b)}}for(c=0;c<d;c++)if(this[c].style)this[c].style.display="none";return this},_toggle:k.fn.toggle,toggle:function(a,b,c){var d=typeof a==="boolean";k.isFunction(a)&&k.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:k(this).is(":hidden");
k(this)[b?"show":"hide"]()}):this.animate(y("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function f(){e.queue===false&&k._mark(this);var b=k.extend({},e),c=this.nodeType===1,d=c&&k(this).is(":hidden"),g,h,i,m,l;b.animatedProperties={};for(i in a){g=k.camelCase(i);if(i!==g){a[g]=a[i];delete a[i]}if((h=k.cssHooks[g])&&"expand"in h){m=h.expand(a[g]);delete a[g];for(i in m)i in
a||(a[i]=m[i])}}for(g in a){h=a[g];if(k.isArray(h)){b.animatedProperties[g]=h[1];h=a[g]=h[0]}else b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);if(c&&(g==="height"||g==="width")){b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(k.css(this,"display")==="inline"&&k.css(this,"float")==="none")!k.support.inlineBlockNeedsLayout||A(this.nodeName)==="inline"?this.style.display="inline-block":
this.style.zoom=1}}if(b.overflow!=null)this.style.overflow="hidden";for(i in a){c=new k.fx(this,b,i);h=a[i];if(Rc.test(h))if(g=k._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0)){k._data(this,"toggle"+i,g==="show"?"hide":"show");c[g]()}else c[h]();else{g=Sc.exec(h);m=c.cur();if(g){h=parseFloat(g[2]);l=g[3]||(k.cssNumber[i]?"":"px");if(l!=="px"){k.style(this,i,(h||1)+l);m=(h||1)/c.cur()*m;k.style(this,i,m+l)}g[1]&&(h=(g[1]==="-="?-1:1)*h+m);c.custom(m,h,l)}else c.custom(m,h,"")}}return true}
var e=k.speed(b,c,d);if(k.isEmptyObject(a))return this.each(e.complete,[false]);a=k.extend({},a);return e.queue===false?this.each(f):this.queue(e.queue,f)},stop:function(a,c,d){if(typeof a!=="string"){d=c;c=a;a=b}c&&a!==false&&this.queue(a||"fx",[]);return this.each(function(){var b,c=false,f=k.timers,e=k._data(this);d||k._unmark(true,this);if(a==null)for(b in e){if(e[b]&&e[b].stop&&b.indexOf(".run")===b.length-4){var g=e[b];k.removeData(this,b,true);g.stop(d)}}else if(e[b=a+".run"]&&e[b].stop){e=
e[b];k.removeData(this,b,true);e.stop(d)}for(b=f.length;b--;)if(f[b].elem===this&&(a==null||f[b].queue===a)){if(d)f[b](true);else f[b].saveState();c=true;f.splice(b,1)}(!d||!c)&&k.dequeue(this,a)})}});k.each({slideDown:y("show",1),slideUp:y("hide",1),slideToggle:y("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){k.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});k.extend({speed:function(a,b,c){var d=a&&typeof a==="object"?k.extend({},a):
{complete:c||!c&&b||k.isFunction(a)&&a,duration:a,easing:c&&b||b&&!k.isFunction(b)&&b};d.duration=k.fx.off?0:typeof d.duration==="number"?d.duration:d.duration in k.fx.speeds?k.fx.speeds[d.duration]:k.fx.speeds._default;if(d.queue==null||d.queue===true)d.queue="fx";d.old=d.complete;d.complete=function(a){k.isFunction(d.old)&&d.old.call(this);d.queue?k.dequeue(this,d.queue):a!==false&&k._unmark(this)};return d},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+0.5}},
timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});k.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(k.fx.step[this.prop]||k.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=k.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function f(a){return e.step(a)}
var e=this,g=k.fx;this.startTime=Fb||v();this.end=c;this.now=this.start=a;this.pos=this.state=0;this.unit=d||this.unit||(k.cssNumber[this.prop]?"":"px");f.queue=this.options.queue;f.elem=this.elem;f.saveState=function(){k._data(e.elem,"fxshow"+e.prop)===b&&(e.options.hide?k._data(e.elem,"fxshow"+e.prop,e.start):e.options.show&&k._data(e.elem,"fxshow"+e.prop,e.end))};f()&&(k.timers.push(f)&&!Jb)&&(Jb=setInterval(g.tick,g.interval))},show:function(){var a=k._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=
a||k.style(this.elem,this.prop);this.options.show=true;a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());k(this.elem).show()},hide:function(){this.options.orig[this.prop]=k._data(this.elem,"fxshow"+this.prop)||k.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(a){var b,c=Fb||v(),d=true,f=this.elem,e=this.options;if(a||c>=e.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();e.animatedProperties[this.prop]=
true;for(b in e.animatedProperties)e.animatedProperties[b]!==true&&(d=false);if(d){e.overflow!=null&&!k.support.shrinkWrapBlocks&&k.each(["","X","Y"],function(a,b){f.style["overflow"+b]=e.overflow[a]});e.hide&&k(f).hide();if(e.hide||e.show)for(b in e.animatedProperties){k.style(f,b,e.orig[b]);k.removeData(f,"fxshow"+b,true);k.removeData(f,"toggle"+b,true)}if(a=e.complete){e.complete=false;a.call(f)}}return false}if(e.duration==Infinity)this.now=c;else{a=c-this.startTime;this.state=a/e.duration;this.pos=
k.easing[e.animatedProperties[this.prop]](this.state,a,0,1,e.duration);this.now=this.start+(this.end-this.start)*this.pos}this.update();return true}};k.extend(k.fx,{tick:function(){for(var a,b=k.timers,c=0;c<b.length;c++){a=b[c];!a()&&b[c]===a&&b.splice(c--,1)}b.length||k.fx.stop()},interval:13,stop:function(){clearInterval(Jb);Jb=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){k.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=
a.now+a.unit:a.elem[a.prop]=a.now}}});k.each(Gb.concat.apply([],Gb),function(a,b){b.indexOf("margin")&&(k.fx.step[b]=function(a){k.style(a.elem,b,Math.max(0,a.now)+a.unit)})});k.expr&&k.expr.filters&&(k.expr.filters.animated=function(a){return k.grep(k.timers,function(b){return a===b.elem}).length});var kc,Tc=/^t(?:able|d|h)$/i,lc=/^(?:body|html)$/i;kc="getBoundingClientRect"in u.documentElement?function(a,b,c,d){try{d=a.getBoundingClientRect()}catch(f){}if(!d||!k.contains(c,a))return d?{top:d.top,
left:d.left}:{top:0,left:0};a=b.body;b=B(b);return{top:d.top+(b.pageYOffset||k.support.boxModel&&c.scrollTop||a.scrollTop)-(c.clientTop||a.clientTop||0),left:d.left+(b.pageXOffset||k.support.boxModel&&c.scrollLeft||a.scrollLeft)-(c.clientLeft||a.clientLeft||0)}}:function(a,b,c){var d,f=a.offsetParent,e=b.body;d=(b=b.defaultView)?b.getComputedStyle(a,null):a.currentStyle;for(var g=a.offsetTop,h=a.offsetLeft;(a=a.parentNode)&&a!==e&&a!==c;){if(k.support.fixedPosition&&d.position==="fixed")break;d=b?
b.getComputedStyle(a,null):a.currentStyle;g=g-a.scrollTop;h=h-a.scrollLeft;if(a===f){g=g+a.offsetTop;h=h+a.offsetLeft;if(k.support.doesNotAddBorder&&(!k.support.doesAddBorderForTableAndCells||!Tc.test(a.nodeName))){g=g+(parseFloat(d.borderTopWidth)||0);h=h+(parseFloat(d.borderLeftWidth)||0)}f=a.offsetParent}if(k.support.subtractsBorderForOverflowNotVisible&&d.overflow!=="visible"){g=g+(parseFloat(d.borderTopWidth)||0);h=h+(parseFloat(d.borderLeftWidth)||0)}}if(d.position==="relative"||d.position===
"static"){g=g+e.offsetTop;h=h+e.offsetLeft}if(k.support.fixedPosition&&d.position==="fixed"){g=g+Math.max(c.scrollTop,e.scrollTop);h=h+Math.max(c.scrollLeft,e.scrollLeft)}return{top:g,left:h}};k.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){k.offset.setOffset(this,a,b)});var c=this[0],d=c&&c.ownerDocument;return!d?null:c===d.body?k.offset.bodyOffset(c):kc(c,d,d.documentElement)};k.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;if(k.support.doesNotIncludeMarginInBodyOffset){b=
b+(parseFloat(k.css(a,"marginTop"))||0);c=c+(parseFloat(k.css(a,"marginLeft"))||0)}return{top:b,left:c}},setOffset:function(a,b,c){var d=k.css(a,"position");if(d==="static")a.style.position="relative";var f=k(a),e=f.offset(),g=k.css(a,"top"),h=k.css(a,"left"),i={},m={};if((d==="absolute"||d==="fixed")&&k.inArray("auto",[g,h])>-1){m=f.position();d=m.top;h=m.left}else{d=parseFloat(g)||0;h=parseFloat(h)||0}k.isFunction(b)&&(b=b.call(a,c,e));if(b.top!=null)i.top=b.top-e.top+d;if(b.left!=null)i.left=b.left-
e.left+h;"using"in b?b.using.call(a,i):f.css(i)}};k.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=lc.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top=c.top-(parseFloat(k.css(a,"marginTop"))||0);c.left=c.left-(parseFloat(k.css(a,"marginLeft"))||0);d.top=d.top+(parseFloat(k.css(b[0],"borderTopWidth"))||0);d.left=d.left+(parseFloat(k.css(b[0],"borderLeftWidth"))||0);return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=
this.offsetParent||u.body;a&&!lc.test(a.nodeName)&&k.css(a,"position")==="static";)a=a.offsetParent;return a})}});k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);k.fn[a]=function(f){return k.access(this,function(a,f,e){var g=B(a);if(e===b)return g?c in g?g[c]:k.support.boxModel&&g.document.documentElement[f]||g.document.body[f]:a[f];g?g.scrollTo(!d?e:k(g).scrollLeft(),d?e:k(g).scrollTop()):a[f]=e},a,f,arguments.length,null)}});k.each({Height:"height",Width:"width"},
function(a,c){var d="client"+a,f="scroll"+a,e="offset"+a;k.fn["inner"+a]=function(){var a=this[0];return a?a.style?parseFloat(k.css(a,c,"padding")):this[c]():null};k.fn["outer"+a]=function(a){var b=this[0];return b?b.style?parseFloat(k.css(b,c,a?"margin":"border")):this[c]():null};k.fn[c]=function(a){return k.access(this,function(a,c,g){if(k.isWindow(a)){c=a.document;a=c.documentElement[d];return k.support.boxModel&&a||c.body&&c.body[d]||a}if(a.nodeType===9){c=a.documentElement;return c[d]>=c[f]?
c[d]:Math.max(a.body[f],c[f],a.body[e],c[e])}if(g===b){a=k.css(a,c);c=parseFloat(a);return k.isNumeric(c)?c:a}k(a).css(c,g)},c,a,arguments.length,null)}});a.jQuery=a.$=k;"function"===typeof define&&(define.amd&&define.amd.jQuery)&&define("jquery",[],function(){return k})})(window);
(function(a){var b=/[\.\/]/,e=function(){},d=function(a,b){return a-b},g,f,c={n:{}},h=function(a,b){var c=f,e=Array.prototype.slice.call(arguments,2),n=h.listeners(a),q=0,p,w=[],r={},x=[],t=g;g=a;for(var s=f=0,v=n.length;s<v;s++)"zIndex"in n[s]&&(w.push(n[s].zIndex),0>n[s].zIndex&&(r[n[s].zIndex]=n[s]));for(w.sort(d);0>w[q];)if(p=r[w[q++]],x.push(p.apply(b,e)),f)return f=c,x;for(s=0;s<v;s++)if(p=n[s],"zIndex"in p)if(p.zIndex==w[q]){x.push(p.apply(b,e));if(f)break;do if(q++,(p=r[w[q]])&&x.push(p.apply(b,
e)),f)break;while(p)}else r[p.zIndex]=p;else if(x.push(p.apply(b,e)),f)break;f=c;g=t;return x.length?x:null};h.listeners=function(a){var a=a.split(b),d=c,f,e,g,h,p,w,r,x=[d],t=[];g=0;for(h=a.length;g<h;g++){r=[];p=0;for(w=x.length;p<w;p++){d=x[p].n;f=[d[a[g]],d["*"]];for(e=2;e--;)if(d=f[e])r.push(d),t=t.concat(d.f||[])}x=r}return t};h.on=function(a,d){for(var f=a.split(b),g=c,h=0,q=f.length;h<q;h++)g=g.n,!g[f[h]]&&(g[f[h]]={n:{}}),g=g[f[h]];g.f=g.f||[];h=0;for(q=g.f.length;h<q;h++)if(g.f[h]==d)return e;
g.f.push(d);return function(a){+a==+a&&(d.zIndex=+a)}};h.stop=function(){f=1};h.nt=function(a){return a?RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)").test(g):g};h.off=h.unbind=function(a,d){var f=a.split(b),e,g,h,p,w,r,x=[c];p=0;for(w=f.length;p<w;p++)for(r=0;r<x.length;r+=h.length-2){h=[r,1];e=x[r].n;if("*"!=f[p])e[f[p]]&&h.push(e[f[p]]);else for(g in e)e.hasOwnProperty(g)&&h.push(e[g]);x.splice.apply(x,h)}p=0;for(w=x.length;p<w;p++)for(e=x[p];e.n;){if(d){if(e.f){r=0;for(f=e.f.length;r<f;r++)if(e.f[r]==
d){e.f.splice(r,1);break}!e.f.length&&delete e.f}for(g in e.n)if(e.n.hasOwnProperty(g)&&e.n[g].f){h=e.n[g].f;r=0;for(f=h.length;r<f;r++)if(h[r]==d){h.splice(r,1);break}!h.length&&delete e.n[g].f}}else for(g in delete e.f,e.n)e.n.hasOwnProperty(g)&&e.n[g].f&&delete e.n[g].f;e=e.n}};h.once=function(a,b){var c=function(){var d=b.apply(this,arguments);h.unbind(a,c);return d};return h.on(a,c)};h.version="0.3.4";h.toString=function(){return"You are running Eve 0.3.4"};"undefined"!=typeof module&&module.exports?
module.exports=h:"undefined"!=typeof define?define("eve",[],function(){return h}):a.eve=h})(this);
(function(){function a(b){if(a.is(b,"function"))return q?b():eve.on("raphael.DOMload",b);if(a.is(b,U))return a._engine.create[A](a,b.splice(0,3+a.is(b[0],H))).add(b);var c=Array.prototype.slice.call(arguments,0);if(a.is(c[c.length-1],"function")){var d=c.pop();return q?d.call(a._engine.create[A](a,c)):eve.on("raphael.DOMload",function(){d.call(a._engine.create[A](a,c))})}return a._engine.create[A](a,arguments)}function b(a){if(Object(a)!==a)return a;var c=new a.constructor,d;for(d in a)a[x](d)&&(c[d]=
b(a[d]));return c}function e(a,b,c){function d(){var f=Array.prototype.slice.call(arguments,0),e=f.join("\u2400"),g=d.cache=d.cache||{},h=d.count=d.count||[];if(g[x](e)){a:for(var f=h,h=e,i=0,m=f.length;i<m;i++)if(f[i]===h){f.push(f.splice(i,1)[0]);break a}return c?c(g[e]):g[e]}1E3<=h.length&&delete g[h.shift()];h.push(e);g[e]=a[A](b,f);return c?c(g[e]):g[e]}return d}function d(){return this.hex}function g(a,b){for(var c=[],d=0,f=a.length;f-2*!b>d;d+=2){var e=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+
1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?f-4==d?e[3]={x:+a[0],y:+a[1]}:f-2==d&&(e[2]={x:+a[0],y:+a[1]},e[3]={x:+a[2],y:+a[3]}):e[0]={x:+a[f-2],y:+a[f-1]}:f-4==d?e[3]=e[2]:d||(e[0]={x:+a[d],y:+a[d+1]});c.push(["C",(-e[0].x+6*e[1].x+e[2].x)/6,(-e[0].y+6*e[1].y+e[2].y)/6,(e[1].x+6*e[2].x-e[3].x)/6,(e[1].y+6*e[2].y-e[3].y)/6,e[2].x,e[2].y])}return c}function f(a,b,c,d,f,e,g,h,i){null==i&&(i=1);for(var i=(1<i?1:0>i?0:i)/2,m=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,
0.9041,-0.9816,0.9816],k=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],l=0,j=0;12>j;j++)var p=i*m[j]+i,u=p*(p*(-3*a+9*c-9*f+3*g)+6*a-12*c+6*f)-3*a+3*c,p=p*(p*(-3*b+9*d-9*e+3*h)+6*b-12*d+6*e)-3*b+3*d,l=l+k[j]*F.sqrt(u*u+p*p);return i*l}function c(a,b,c,d,e,g,h,i,m){if(!(0>m||f(a,b,c,d,e,g,h,i)<m)){var k=0.5,l=1-k,j;for(j=f(a,b,c,d,e,g,h,i,l);0.01<W(j-m);)k/=2,l+=(j<m?1:-1)*k,j=f(a,b,c,d,e,g,h,i,l);return l}}function h(b,c,d){for(var b=a._path2curve(b),c=a._path2curve(c),
e,g,h,i,m,k,l,j,p,u,n=d?0:[],q=0,E=b.length;q<E;q++)if(p=b[q],"M"==p[0])e=m=p[1],g=k=p[2];else{"C"==p[0]?(p=[e,g].concat(p.slice(1)),e=p[6],g=p[7]):(p=[e,g,e,g,m,k,m,k],e=m,g=k);for(var z=0,w=c.length;z<w;z++)if(u=c[z],"M"==u[0])h=l=u[1],i=j=u[2];else{"C"==u[0]?(u=[h,i].concat(u.slice(1)),h=u[6],i=u[7]):(u=[h,i,h,i,l,j,l,j],h=l,i=j);var D;var r=p,s=u;D=d;var x=a.bezierBBox(r),o=a.bezierBBox(s);if(a.isBBoxIntersect(x,o)){for(var x=f.apply(0,r),o=f.apply(0,s),x=~~(x/5),o=~~(o/5),B=[],t=[],Q={},v=D?
0:[],A=0;A<x+1;A++){var V=a.findDotsAtSegment.apply(a,r.concat(A/x));B.push({x:V.x,y:V.y,t:A/x})}for(A=0;A<o+1;A++)V=a.findDotsAtSegment.apply(a,s.concat(A/o)),t.push({x:V.x,y:V.y,t:A/o});for(A=0;A<x;A++)for(r=0;r<o;r++){var F=B[A],y=B[A+1],s=t[r],V=t[r+1],T=0.0010>W(y.x-F.x)?"y":"x",fa=0.0010>W(V.x-s.x)?"y":"x",K;K=F.x;var S=F.y,H=y.x,Ca=y.y,ha=s.x,U=s.y,P=V.x,la=V.y;if(L(K,H)<C(ha,P)||C(K,H)>L(ha,P)||L(S,Ca)<C(U,la)||C(S,Ca)>L(U,la))K=void 0;else{var qa=(K*Ca-S*H)*(ha-P)-(K-H)*(ha*la-U*P),N=(K*
Ca-S*H)*(U-la)-(S-Ca)*(ha*la-U*P),G=(K-H)*(U-la)-(S-Ca)*(ha-P);if(G){var qa=qa/G,N=N/G,G=+qa.toFixed(2),M=+N.toFixed(2);K=G<+C(K,H).toFixed(2)||G>+L(K,H).toFixed(2)||G<+C(ha,P).toFixed(2)||G>+L(ha,P).toFixed(2)||M<+C(S,Ca).toFixed(2)||M>+L(S,Ca).toFixed(2)||M<+C(U,la).toFixed(2)||M>+L(U,la).toFixed(2)?void 0:{x:qa,y:N}}else K=void 0}K&&Q[K.x.toFixed(4)]!=K.y.toFixed(4)&&(Q[K.x.toFixed(4)]=K.y.toFixed(4),F=F.t+W((K[T]-F[T])/(y[T]-F[T]))*(y.t-F.t),s=s.t+W((K[fa]-s[fa])/(V[fa]-s[fa]))*(V.t-s.t),0<=F&&
(1>=F&&0<=s&&1>=s)&&(D?v++:v.push({x:K.x,y:K.y,t1:F,t2:s})))}D=v}else D=D?0:[];if(d)n+=D;else{x=0;for(o=D.length;x<o;x++)D[x].segment1=q,D[x].segment2=z,D[x].bez1=p,D[x].bez2=u;n=n.concat(D)}}}return n}function i(a,b,c,d,f,e){null!=a?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+f,this.f=+e):(this.a=1,this.c=this.b=0,this.d=1,this.f=this.e=0)}function j(){return this.x+D+this.y+D+this.width+" \u00d7 "+this.height}function l(a,b){var c=[],d={};this.ms=b;this.times=1;if(a){for(var f in a)a[x](f)&&
(d[S(f)]=a[f],c.push(S(f)));c.sort(Ma)}this.anim=d;this.top=c[c.length-1];this.percents=c}function m(b,c,d,f,e,g){var d=S(d),h,m,l,j,u,n,q=b.ms,z={},w={},D={};if(f){n=0;for(s=G.length;n<s;n++){var r=G[n];if(r.el.id==c.id&&r.anim==b){r.percent!=d?(G.splice(n,1),l=1):m=r;c.attr(r.totalOrigin);break}}}else f=+w;n=0;for(var s=b.percents.length;n<s;n++)if(b.percents[n]==d||b.percents[n]>f*b.top){d=b.percents[n];u=b.percents[n-1]||0;q=q/b.top*(d-u);j=b.percents[n+1];h=b.anim[d];break}else f&&c.attr(b.anim[b.percents[n]]);
if(h){if(m)m.initstatus=f,m.start=new Date-m.ms*f;else{for(var C in h)if(h[x](C)&&(na[x](C)||c.paper.customAttributes[x](C)))switch(z[C]=c.attr(C),null==z[C]&&(z[C]=za[C]),w[C]=h[C],na[C]){case H:D[C]=(w[C]-z[C])/q;break;case "colour":z[C]=a.getRGB(z[C]);n=a.getRGB(w[C]);D[C]={r:(n.r-z[C].r)/q,g:(n.g-z[C].g)/q,b:(n.b-z[C].b)/q};break;case "path":n=bb(z[C],w[C]);r=n[1];z[C]=n[0];D[C]=[];n=0;for(s=z[C].length;n<s;n++){D[C][n]=[0];for(var o=1,t=z[C][n].length;o<t;o++)D[C][n][o]=(r[n][o]-z[C][n][o])/
q}break;case "transform":n=c._;if(s=ob(n[C],w[C])){z[C]=s.from;w[C]=s.to;D[C]=[];D[C].real=!0;n=0;for(s=z[C].length;n<s;n++){D[C][n]=[z[C][n][0]];o=1;for(t=z[C][n].length;o<t;o++)D[C][n][o]=(w[C][n][o]-z[C][n][o])/q}}else s=c.matrix||new i,n={_:{transform:n.transform},getBBox:function(){return c.getBBox(1)}},z[C]=[s.a,s.b,s.c,s.d,s.e,s.f],ta(n,w[C]),w[C]=n._.transform,D[C]=[(n.matrix.a-s.a)/q,(n.matrix.b-s.b)/q,(n.matrix.c-s.c)/q,(n.matrix.d-s.d)/q,(n.matrix.e-s.e)/q,(n.matrix.f-s.f)/q];break;case "csv":s=
k(h[C])[E](p);r=k(z[C])[E](p);if("clip-rect"==C){z[C]=r;D[C]=[];for(n=r.length;n--;)D[C][n]=(s[n]-z[C][n])/q}w[C]=s;break;default:s=[][B](h[C]);r=[][B](z[C]);D[C]=[];for(n=c.paper.customAttributes[C].length;n--;)D[C][n]=((s[n]||0)-(r[n]||0))/q}n=h.easing;C=a.easing_formulas[n];if(!C)if((C=k(n).match(ma))&&5==C.length){var Q=C;C=function(a){var b=+Q[1],c=+Q[2],d=3*b,f=3*(+Q[3]-b)-d,e=1-d-f,b=3*c,c=3*(+Q[4]-c)-b,g=1-b-c,a=function(a,b){var c,g,h,i;h=a;for(g=0;8>g;g++){i=((e*h+f)*h+d)*h-a;if(W(i)<b)return h;
c=(3*e*h+2*f)*h+d;if(1E-6>W(c))break;h-=i/c}c=0;g=1;h=a;if(h<c)return c;if(h>g)return g;for(;c<g;){i=((e*h+f)*h+d)*h;if(W(i-a)<b)break;a>i?c=h:g=h;h=(g-c)/2+c}return h}(a,1/(200*q));return((g*a+c)*a+b)*a}}else C=yb;n=h.start||b.start||+new Date;r={anim:b,percent:d,timestamp:n,start:n+(b.del||0),status:0,initstatus:f||0,stop:!1,ms:q,easing:C,from:z,diff:D,to:w,el:c,callback:h.callback,prev:u,next:j,repeat:g||b.times,origin:c.attr(),totalOrigin:e};G.push(r);if(f&&(!m&&!l)&&(r.stop=!0,r.start=new Date-
q*f,1==G.length))return P();l&&(r.start=new Date-r.ms*f);1==G.length&&Ca(P)}eve("raphael.anim.start."+c.id,c,b)}}function n(a){for(var b=0;b<G.length;b++)G[b].el.paper==a&&G.splice(b--,1)}a.version="2.1.0";a.eve=eve;var q,p=/[, ]+/,w={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},r=/\{(\d+)\}/g,x="hasOwnProperty",t={doc:document,win:window},s=Object.prototype[x].call(t.win,"Raphael"),v=t.win.Raphael,o=function(){this.ca=this.customAttributes={}},y,A="apply",B="concat",u="createTouch"in t.doc,D=
" ",k=String,E="split",z="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[E](D),Q={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},V=k.prototype.toLowerCase,F=Math,L=F.max,C=F.min,W=F.abs,T=F.pow,K=F.PI,H="number",U="array",la=Object.prototype.toString;a._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i;var N=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
M={NaN:1,Infinity:1,"-Infinity":1},ma=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,fa=F.round,S=parseFloat,ha=parseInt,qa=k.prototype.toUpperCase,za=a._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,
rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},na=a._availableAnimAttrs={blur:H,"clip-rect":"csv",cx:H,cy:H,fill:"colour","fill-opacity":H,"font-size":H,height:H,opacity:H,path:"path",r:H,rx:H,ry:H,stroke:"colour","stroke-opacity":H,"stroke-width":H,transform:"transform",width:H,x:H,y:H},xa=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,
ra={hs:1,rg:1},La=/,?([achlmqrstvxz]),?/gi,nb=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,
db=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,eb=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;
a._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/;var Da={},Ma=function(a,b){return S(a)-S(b)},xb=function(){},yb=function(a){return a},Ya=a._rectPath=function(a,b,c,d,f){return f?[["M",a+f,b],["l",c-2*f,0],["a",f,f,0,0,1,
f,f],["l",0,d-2*f],["a",f,f,0,0,1,-f,f],["l",2*f-c,0],["a",f,f,0,0,1,-f,-f],["l",0,2*f-d],["a",f,f,0,0,1,f,-f],["z"]]:[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]]},J=function(a,b,c,d){null==d&&(d=c);return[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]]},Na=a._getPath={path:function(a){return a.attr("path")},circle:function(a){a=a.attrs;return J(a.cx,a.cy,a.r)},ellipse:function(a){a=a.attrs;return J(a.cx,a.cy,a.rx,a.ry)},rect:function(a){a=a.attrs;return Ya(a.x,a.y,a.width,
a.height,a.r)},image:function(a){a=a.attrs;return Ya(a.x,a.y,a.width,a.height)},text:function(a){a=a._getBBox();return Ya(a.x,a.y,a.width,a.height)}},ca=a.mapPath=function(a,b){if(!b)return a;var c,d,f,e,g,h,i,a=bb(a);f=0;for(g=a.length;f<g;f++){i=a[f];e=1;for(h=i.length;e<h;e+=2)c=b.x(i[e],i[e+1]),d=b.y(i[e],i[e+1]),i[e]=c,i[e+1]=d}return a};a._g=t;a.type=t.win.SVGAngle||t.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if("VML"==a.type){var X=
t.doc.createElement("div"),sa;X.innerHTML='<v:shape adj="1"/>';sa=X.firstChild;sa.style.behavior="url(#default#VML)";if(!(sa&&"object"==typeof sa.adj))return a.type="";X=null}a.svg=!(a.vml="VML"==a.type);a._Paper=o;a.fn=y=o.prototype=a.prototype;a._id=0;a._oid=0;a.is=function(a,b){b=V.call(b);return"finite"==b?!M[x](+a):"array"==b?a instanceof Array:"null"==b&&null===a||b==typeof a&&null!==a||"object"==b&&a===Object(a)||"array"==b&&Array.isArray&&Array.isArray(a)||la.call(a).slice(8,-1).toLowerCase()==
b};a.angle=function(b,c,d,f,e,g){return null==e?(b-=d,c-=f,!b&&!c?0:(180*F.atan2(-c,-b)/K+540)%360):a.angle(b,c,e,g)-a.angle(d,f,e,g)};a.rad=function(a){return a%360*K/180};a.deg=function(a){return 180*a/K%360};a.snapTo=function(b,c,d){d=a.is(d,"finite")?d:10;if(a.is(b,U))for(var f=b.length;f--;){if(W(b[f]-c)<=d)return b[f]}else{b=+b;f=c%b;if(f<d)return c-f;if(f>b-d)return c-f+b}return c};var ea=/[xy]/g,ia=function(a){var b=16*F.random()|0;return("x"==a?b:b&3|8).toString(16)};a.createUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(ea,
ia).toUpperCase()};a.setWindow=function(b){eve("raphael.setWindow",a,t.win,b);t.win=b;t.doc=t.win.document;a._engine.initWin&&a._engine.initWin(t.win)};var Aa=function(b){if(a.vml){var c=/^\s+|\s+$/g,d;try{var f=new ActiveXObject("htmlfile");f.write("<body>");f.close();d=f.body}catch(g){d=createPopup().document.body}var h=d.createTextRange();Aa=e(function(a){try{d.style.color=k(a).replace(c,"");var b=h.queryCommandValue("ForeColor");return"#"+("000000"+((b&255)<<16|b&65280|(b&16711680)>>>16).toString(16)).slice(-6)}catch(f){return"none"}})}else{var i=
t.doc.createElement("i");i.title="Rapha\u00ebl Colour Picker";i.style.display="none";t.doc.body.appendChild(i);Aa=e(function(a){i.style.color=a;return t.doc.defaultView.getComputedStyle(i,"").getPropertyValue("color")})}return Aa(b)},Z=function(){return"hsb("+[this.h,this.s,this.b]+")"},Ea=function(){return"hsl("+[this.h,this.s,this.l]+")"},Za=function(){return this.hex},$a=function(b,c,d){null==c&&(a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b)&&(d=b.b,c=b.g,b=b.r);null==c&&a.is(b,"string")&&(d=a.getRGB(b),
b=d.r,c=d.g,d=d.b);if(1<b||1<c||1<d)b/=255,c/=255,d/=255;return[b,c,d]},ja=function(b,c,d,f){b*=255;c*=255;d*=255;b={r:b,g:c,b:d,hex:a.rgb(b,c,d),toString:Za};a.is(f,"finite")&&(b.opacity=f);return b};a.color=function(b){var c;a.is(b,"object")&&"h"in b&&"s"in b&&"b"in b?(c=a.hsb2rgb(b),b.r=c.r,b.g=c.g,b.b=c.b,b.hex=c.hex):a.is(b,"object")&&"h"in b&&"s"in b&&"l"in b?(c=a.hsl2rgb(b),b.r=c.r,b.g=c.g,b.b=c.b,b.hex=c.hex):(a.is(b,"string")&&(b=a.getRGB(b)),a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b?(c=
a.rgb2hsl(b),b.h=c.h,b.s=c.s,b.l=c.l,c=a.rgb2hsb(b),b.v=c.b):(b={hex:"none"},b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1));b.toString=Za;return b};a.hsb2rgb=function(a,b,c,d){this.is(a,"object")&&("h"in a&&"s"in a&&"b"in a)&&(c=a.b,b=a.s,a=a.h,d=a.o);var f,e,g,a=360*a%360/60;g=c*b;b=g*(1-W(a%2-1));c=f=e=c-g;a=~~a;c+=[g,b,0,0,b,g][a];f+=[b,g,g,b,0,0][a];e+=[0,0,b,g,g,b][a];return ja(c,f,e,d)};a.hsl2rgb=function(a,b,c,d){this.is(a,"object")&&("h"in a&&"s"in a&&"l"in a)&&(c=a.l,b=a.s,a=a.h);if(1<a||1<b||1<c)a/=360,
b/=100,c/=100;var f,e,g,a=360*a%360/60;g=2*b*(0.5>c?c:1-c);b=g*(1-W(a%2-1));c=f=e=c-g/2;a=~~a;c+=[g,b,0,0,b,g][a];f+=[b,g,g,b,0,0][a];e+=[0,0,b,g,g,b][a];return ja(c,f,e,d)};a.rgb2hsb=function(a,b,c){var c=$a(a,b,c),a=c[0],b=c[1],c=c[2],d,f;d=L(a,b,c);f=d-C(a,b,c);return{h:60*(((0==f?0:d==a?(b-c)/f:d==b?(c-a)/f+2:(a-b)/f+4)+360)%6)/360,s:0==f?0:f/d,b:d,toString:Z}};a.rgb2hsl=function(a,b,c){var c=$a(a,b,c),a=c[0],b=c[1],c=c[2],d,f,e;f=L(a,b,c);d=C(a,b,c);e=f-d;d=(f+d)/2;return{h:60*(((0==e?0:f==a?
(b-c)/e:f==b?(c-a)/e+2:(a-b)/e+4)+360)%6)/360,s:0==e?0:0.5>d?e/(2*d):e/(2-2*d),l:d,toString:Ea}};a._path2string=function(){return this.join(",").replace(La,"$1")};a._preload=function(a,b){var c=t.doc.createElement("img");c.style.cssText="position:absolute;left:-9999em;top:-9999em";c.onload=function(){b.call(this);this.onload=null;t.doc.body.removeChild(this)};c.onerror=function(){t.doc.body.removeChild(this)};t.doc.body.appendChild(c);c.src=a};a.getRGB=e(function(b){if(!b||(b=k(b)).indexOf("-")+1)return{r:-1,
g:-1,b:-1,hex:"none",error:1,toString:d};if("none"==b)return{r:-1,g:-1,b:-1,hex:"none",toString:d};!(ra[x](b.toLowerCase().substring(0,2))||"#"==b.charAt())&&(b=Aa(b));var c,f,e,g,h;if(b=b.match(N)){b[2]&&(e=ha(b[2].substring(5),16),f=ha(b[2].substring(3,5),16),c=ha(b[2].substring(1,3),16));b[3]&&(e=ha((h=b[3].charAt(3))+h,16),f=ha((h=b[3].charAt(2))+h,16),c=ha((h=b[3].charAt(1))+h,16));b[4]&&(h=b[4][E](xa),c=S(h[0]),"%"==h[0].slice(-1)&&(c*=2.55),f=S(h[1]),"%"==h[1].slice(-1)&&(f*=2.55),e=S(h[2]),
"%"==h[2].slice(-1)&&(e*=2.55),"rgba"==b[1].toLowerCase().slice(0,4)&&(g=S(h[3])),h[3]&&"%"==h[3].slice(-1)&&(g/=100));if(b[5])return h=b[5][E](xa),c=S(h[0]),"%"==h[0].slice(-1)&&(c*=2.55),f=S(h[1]),"%"==h[1].slice(-1)&&(f*=2.55),e=S(h[2]),"%"==h[2].slice(-1)&&(e*=2.55),("deg"==h[0].slice(-3)||"\u00b0"==h[0].slice(-1))&&(c/=360),"hsba"==b[1].toLowerCase().slice(0,4)&&(g=S(h[3])),h[3]&&"%"==h[3].slice(-1)&&(g/=100),a.hsb2rgb(c,f,e,g);if(b[6])return h=b[6][E](xa),c=S(h[0]),"%"==h[0].slice(-1)&&(c*=
2.55),f=S(h[1]),"%"==h[1].slice(-1)&&(f*=2.55),e=S(h[2]),"%"==h[2].slice(-1)&&(e*=2.55),("deg"==h[0].slice(-3)||"\u00b0"==h[0].slice(-1))&&(c/=360),"hsla"==b[1].toLowerCase().slice(0,4)&&(g=S(h[3])),h[3]&&"%"==h[3].slice(-1)&&(g/=100),a.hsl2rgb(c,f,e,g);b={r:c,g:f,b:e,toString:d};b.hex="#"+(16777216|e|f<<8|c<<16).toString(16).slice(1);a.is(g,"finite")&&(b.opacity=g);return b}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:d}},a);a.hsb=e(function(b,c,d){return a.hsb2rgb(b,c,d).hex});a.hsl=e(function(b,
c,d){return a.hsl2rgb(b,c,d).hex});a.rgb=e(function(a,b,c){return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)});a.getColor=function(a){var a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75},b=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;1<a.h&&(a.h=0,a.s-=0.2,0>=a.s&&(this.getColor.start={h:0,s:1,b:a.b}));return b.hex};a.getColor.reset=function(){delete this.start};a.parsePathString=function(b){if(!b)return null;var c=ua(b);if(c.arr)return ya(c.arr);var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,
t:2,v:1,z:0},f=[];a.is(b,U)&&a.is(b[0],U)&&(f=ya(b));f.length||k(b).replace(nb,function(a,b,c){var e=[],a=b.toLowerCase();c.replace(eb,function(a,b){b&&e.push(+b)});"m"==a&&2<e.length&&(f.push([b][B](e.splice(0,2))),a="l",b="m"==b?"l":"L");if("r"==a)f.push([b][B](e));else for(;e.length>=d[a]&&!(f.push([b][B](e.splice(0,d[a]))),!d[a]););});f.toString=a._path2string;c.arr=ya(f);return f};a.parseTransformString=e(function(b){if(!b)return null;var c=[];a.is(b,U)&&a.is(b[0],U)&&(c=ya(b));c.length||k(b).replace(db,
function(a,b,d){var f=[];V.call(b);d.replace(eb,function(a,b){b&&f.push(+b)});c.push([b][B](f))});c.toString=a._path2string;return c});var ua=function(a){var b=ua.ps=ua.ps||{};b[a]?b[a].sleep=100:b[a]={sleep:100};setTimeout(function(){for(var c in b)b[x](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])});return b[a]};a.findDotsAtSegment=function(a,b,c,d,f,e,g,h,i){var m=1-i,k=T(m,3),l=T(m,2),j=i*i,p=j*i,n=k*a+3*l*i*c+3*m*i*i*f+p*g,k=k*b+3*l*i*d+3*m*i*i*e+p*h,l=a+2*i*(c-a)+j*(f-2*c+a),p=b+2*i*(d-
b)+j*(e-2*d+b),u=c+2*i*(f-c)+j*(g-2*f+c),j=d+2*i*(e-d)+j*(h-2*e+d),a=m*a+i*c,b=m*b+i*d,f=m*f+i*g,e=m*e+i*h,h=90-180*F.atan2(l-u,p-j)/K;(l>u||p<j)&&(h+=180);return{x:n,y:k,m:{x:l,y:p},n:{x:u,y:j},start:{x:a,y:b},end:{x:f,y:e},alpha:h}};a.bezierBBox=function(b,c,d,f,e,g,h,i){a.is(b,"array")||(b=[b,c,d,f,e,g,h,i]);b=Oa.apply(null,b);return{x:b.min.x,y:b.min.y,x2:b.max.x,y2:b.max.y,width:b.max.x-b.min.x,height:b.max.y-b.min.y}};a.isPointInsideBBox=function(a,b,c){return b>=a.x&&b<=a.x2&&c>=a.y&&c<=a.y2};
a.isBBoxIntersect=function(b,c){var d=a.isPointInsideBBox;return d(c,b.x,b.y)||d(c,b.x2,b.y)||d(c,b.x,b.y2)||d(c,b.x2,b.y2)||d(b,c.x,c.y)||d(b,c.x2,c.y)||d(b,c.x,c.y2)||d(b,c.x2,c.y2)||(b.x<c.x2&&b.x>c.x||c.x<b.x2&&c.x>b.x)&&(b.y<c.y2&&b.y>c.y||c.y<b.y2&&c.y>b.y)};a.pathIntersection=function(a,b){return h(a,b)};a.pathIntersectionNumber=function(a,b){return h(a,b,1)};a.isPointInsidePath=function(b,c,d){var f=a.pathBBox(b);return a.isPointInsideBBox(f,c,d)&&1==h(b,[["M",c,d],["H",f.x2+10]],1)%2};a._removedFactory=
function(a){return function(){eve("raphael.log",null,"Rapha\u00ebl: you are calling to method \u201c"+a+"\u201d of removed object",a)}};var I=a.pathBBox=function(a){var c=ua(a);if(c.bbox)return c.bbox;if(!a)return{x:0,y:0,width:0,height:0,x2:0,y2:0};for(var a=bb(a),d=0,f=0,e=[],g=[],h,i=0,m=a.length;i<m;i++)h=a[i],"M"==h[0]?(d=h[1],f=h[2],e.push(d),g.push(f)):(d=Oa(d,f,h[1],h[2],h[3],h[4],h[5],h[6]),e=e[B](d.min.x,d.max.x),g=g[B](d.min.y,d.max.y),d=h[5],f=h[6]);a=C[A](0,e);h=C[A](0,g);e=L[A](0,e);
g=L[A](0,g);g={x:a,y:h,x2:e,y2:g,width:e-a,height:g-h};c.bbox=b(g);return g},ya=function(c){c=b(c);c.toString=a._path2string;return c},ib=a._pathToRelative=function(b){var c=ua(b);if(c.rel)return ya(c.rel);if(!a.is(b,U)||!a.is(b&&b[0],U))b=a.parsePathString(b);var d=[],f=0,e=0,g=0,h=0,i=0;"M"==b[0][0]&&(f=b[0][1],e=b[0][2],g=f,h=e,i++,d.push(["M",f,e]));for(var m=b.length;i<m;i++){var k=d[i]=[],l=b[i];if(l[0]!=V.call(l[0]))switch(k[0]=V.call(l[0]),k[0]){case "a":k[1]=l[1];k[2]=l[2];k[3]=l[3];k[4]=
l[4];k[5]=l[5];k[6]=+(l[6]-f).toFixed(3);k[7]=+(l[7]-e).toFixed(3);break;case "v":k[1]=+(l[1]-e).toFixed(3);break;case "m":g=l[1],h=l[2];default:for(var j=1,p=l.length;j<p;j++)k[j]=+(l[j]-(j%2?f:e)).toFixed(3)}else{d[i]=[];"m"==l[0]&&(g=l[1]+f,h=l[2]+e);k=0;for(j=l.length;k<j;k++)d[i][k]=l[k]}l=d[i].length;switch(d[i][0]){case "z":f=g;e=h;break;case "h":f+=+d[i][l-1];break;case "v":e+=+d[i][l-1];break;default:f+=+d[i][l-2],e+=+d[i][l-1]}}d.toString=a._path2string;c.rel=ya(d);return d},Ga=a._pathToAbsolute=
function(b){var c=ua(b);if(c.abs)return ya(c.abs);if(!a.is(b,U)||!a.is(b&&b[0],U))b=a.parsePathString(b);if(!b||!b.length)return[["M",0,0]];var d=[],f=0,e=0,h=0,i=0,m=0;"M"==b[0][0]&&(f=+b[0][1],e=+b[0][2],h=f,i=e,m++,d[0]=["M",f,e]);for(var k=3==b.length&&"M"==b[0][0]&&"R"==b[1][0].toUpperCase()&&"Z"==b[2][0].toUpperCase(),l,j=m,p=b.length;j<p;j++){d.push(m=[]);l=b[j];if(l[0]!=qa.call(l[0]))switch(m[0]=qa.call(l[0]),m[0]){case "A":m[1]=l[1];m[2]=l[2];m[3]=l[3];m[4]=l[4];m[5]=l[5];m[6]=+(l[6]+f);
m[7]=+(l[7]+e);break;case "V":m[1]=+l[1]+e;break;case "H":m[1]=+l[1]+f;break;case "R":for(var n=[f,e][B](l.slice(1)),u=2,q=n.length;u<q;u++)n[u]=+n[u]+f,n[++u]=+n[u]+e;d.pop();d=d[B](g(n,k));break;case "M":h=+l[1]+f,i=+l[2]+e;default:u=1;for(q=l.length;u<q;u++)m[u]=+l[u]+(u%2?f:e)}else if("R"==l[0])n=[f,e][B](l.slice(1)),d.pop(),d=d[B](g(n,k)),m=["R"][B](l.slice(-2));else{n=0;for(u=l.length;n<u;n++)m[n]=l[n]}switch(m[0]){case "Z":f=h;e=i;break;case "H":f=m[1];break;case "V":e=m[1];break;case "M":h=
m[m.length-2],i=m[m.length-1];default:f=m[m.length-2],e=m[m.length-1]}}d.toString=a._path2string;c.abs=ya(d);return d},Fa=function(a,b,c,d,f,e){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*f+h*c,g*e+h*d,f,e]},fb=function(a,b,c,d,f,g,h,i,m,k){var l=120*K/180,j=K/180*(+f||0),p=[],n,u=e(function(a,b,c){var d=a*F.cos(c)-b*F.sin(c),a=a*F.sin(c)+b*F.cos(c);return{x:d,y:a}});if(k)w=k[0],n=k[1],g=k[2],q=k[3];else{n=u(a,b,-j);a=n.x;b=n.y;n=u(i,m,-j);i=n.x;m=n.y;F.cos(K/180*f);F.sin(K/180*f);n=(a-i)/2;w=(b-m)/
2;q=n*n/(c*c)+w*w/(d*d);1<q&&(q=F.sqrt(q),c*=q,d*=q);var q=c*c,z=d*d,q=(g==h?-1:1)*F.sqrt(W((q*z-q*w*w-z*n*n)/(q*w*w+z*n*n))),g=q*c*w/d+(a+i)/2,q=q*-d*n/c+(b+m)/2,w=F.asin(((b-q)/d).toFixed(9));n=F.asin(((m-q)/d).toFixed(9));w=a<g?K-w:w;n=i<g?K-n:n;0>w&&(w=2*K+w);0>n&&(n=2*K+n);h&&w>n&&(w-=2*K);!h&&n>w&&(n-=2*K)}if(W(n-w)>l){var p=n,z=i,D=m;n=w+l*(h&&n>w?1:-1);i=g+c*F.cos(n);m=q+d*F.sin(n);p=fb(i,m,c,d,f,0,h,z,D,[n,p,g,q])}g=n-w;f=F.cos(w);l=F.sin(w);h=F.cos(n);n=F.sin(n);g=F.tan(g/4);c=4/3*c*g;g*=
4/3*d;d=[a,b];a=[a+c*l,b-g*f];b=[i+c*n,m-g*h];i=[i,m];a[0]=2*d[0]-a[0];a[1]=2*d[1]-a[1];if(k)return[a,b,i][B](p);p=[a,b,i][B](p).join()[E](",");k=[];i=0;for(m=p.length;i<m;i++)k[i]=i%2?u(p[i-1],p[i],j).y:u(p[i],p[i+1],j).x;return k},ab=function(a,b,c,d,f,e,g,h,i){var m=1-i;return{x:T(m,3)*a+3*T(m,2)*i*c+3*m*i*i*f+T(i,3)*g,y:T(m,3)*b+3*T(m,2)*i*d+3*m*i*i*e+T(i,3)*h}},Oa=e(function(a,b,c,d,f,e,g,h){var i=f-2*c+a-(g-2*f+c),m=2*(c-a)-2*(f-c),k=a-c,l=(-m+F.sqrt(m*m-4*i*k))/2/i,i=(-m-F.sqrt(m*m-4*i*k))/
2/i,j=[b,h],n=[a,g];"1e12"<W(l)&&(l=0.5);"1e12"<W(i)&&(i=0.5);0<l&&1>l&&(l=ab(a,b,c,d,f,e,g,h,l),n.push(l.x),j.push(l.y));0<i&&1>i&&(l=ab(a,b,c,d,f,e,g,h,i),n.push(l.x),j.push(l.y));i=e-2*d+b-(h-2*e+d);m=2*(d-b)-2*(e-d);k=b-d;l=(-m+F.sqrt(m*m-4*i*k))/2/i;i=(-m-F.sqrt(m*m-4*i*k))/2/i;"1e12"<W(l)&&(l=0.5);"1e12"<W(i)&&(i=0.5);0<l&&1>l&&(l=ab(a,b,c,d,f,e,g,h,l),n.push(l.x),j.push(l.y));0<i&&1>i&&(l=ab(a,b,c,d,f,e,g,h,i),n.push(l.x),j.push(l.y));return{min:{x:C[A](0,n),y:C[A](0,j)},max:{x:L[A](0,n),y:L[A](0,
j)}}}),bb=a._path2curve=e(function(a,b){var c=!b&&ua(a);if(!b&&c.curve)return ya(c.curve);var d=Ga(a),f=b&&Ga(b),e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=function(a,b){var c,d;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];!(a[0]in{T:1,Q:1})&&(b.qx=b.qy=null);switch(a[0]){case "M":b.X=a[1];b.Y=a[2];break;case "A":a=["C"][B](fb[A](0,[b.x,b.y][B](a.slice(1))));break;case "S":c=b.x+(b.x-(b.bx||b.x));d=b.y+(b.y-(b.by||b.y));a=["C",c,d][B](a.slice(1));break;
case "T":b.qx=b.x+(b.x-(b.qx||b.x));b.qy=b.y+(b.y-(b.qy||b.y));a=["C"][B](Fa(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case "Q":b.qx=a[1];b.qy=a[2];a=["C"][B](Fa(b.x,b.y,a[1],a[2],a[3],a[4]));break;case "L":a=["C"][B]([b.x,b.y,a[1],a[2],a[1],a[2]]);break;case "H":a=["C"][B]([b.x,b.y,a[1],b.y,a[1],b.y]);break;case "V":a=["C"][B]([b.x,b.y,b.x,a[1],b.x,a[1]]);break;case "Z":a=["C"][B]([b.x,b.y,b.X,b.Y,b.X,b.Y])}return a},i=function(a,b){if(7<a[b].length){a[b].shift();for(var c=a[b];c.length;)a.splice(b++,
0,["C"][B](c.splice(0,6)));a.splice(b,1);l=L(d.length,f&&f.length||0)}},m=function(a,b,c,e,g){a&&(b&&"M"==a[g][0]&&"M"!=b[g][0])&&(b.splice(g,0,["M",e.x,e.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],l=L(d.length,f&&f.length||0))},k=0,l=L(d.length,f&&f.length||0);for(;k<l;k++){d[k]=h(d[k],e);i(d,k);f&&(f[k]=h(f[k],g));f&&i(f,k);m(d,f,e,g,k);m(f,d,g,e,k);var j=d[k],n=f&&f[k],p=j.length,u=f&&n.length;e.x=j[p-2];e.y=j[p-1];e.bx=S(j[p-4])||e.x;e.by=S(j[p-3])||e.y;g.bx=f&&(S(n[u-4])||g.x);g.by=f&&(S(n[u-
3])||g.y);g.x=f&&n[u-2];g.y=f&&n[u-1]}f||(c.curve=ya(d));return f?[d,f]:d},null,ya);a._parseDots=e(function(b){for(var c=[],d=0,f=b.length;d<f;d++){var e={},g=b[d].match(/^([^:]*):?([\d\.]*)/);e.color=a.getRGB(g[1]);if(e.color.error)return null;e.color=e.color.hex;g[2]&&(e.offset=g[2]+"%");c.push(e)}d=1;for(f=c.length-1;d<f;d++)if(!c[d].offset){b=S(c[d-1].offset||0);g=0;for(e=d+1;e<f;e++)if(c[e].offset){g=c[e].offset;break}g||(g=100,e=f);g=S(g);for(g=(g-b)/(e-d+1);d<e;d++)b+=g,c[d].offset=b+"%"}return c});
var jb=a._tear=function(a,b){a==b.top&&(b.top=a.prev);a==b.bottom&&(b.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)};a._tofront=function(a,b){b.top!==a&&(jb(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)};a._toback=function(a,b){b.bottom!==a&&(jb(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)};a._insertafter=function(a,b,c){jb(a,c);b==c.top&&(c.top=a);b.next&&(b.next.prev=a);a.next=b.next;a.prev=b;b.next=a};a._insertbefore=function(a,b,c){jb(a,c);b==c.bottom&&
(c.bottom=a);b.prev&&(b.prev.next=a);a.prev=b.prev;b.prev=a;a.next=b};var kb=a.toMatrix=function(a,b){var c=I(a),d={_:{transform:""},getBBox:function(){return c}};ta(d,b);return d.matrix};a.transformPath=function(a,b){return ca(a,kb(a,b))};var ta=a._extractTransform=function(b,c){if(null==c)return b._.transform;var c=k(c).replace(/\.{3}|\u2026/g,b._.transform||""),d=a.parseTransformString(c),f=0,e=0,g=0,h=1,m=1,l=b._,g=new i;l.transform=d||[];if(d)for(var e=0,j=d.length;e<j;e++){var n=d[e],p=n.length,
u=k(n[0]).toLowerCase(),q=n[0]!=u,E=q?g.invert():0,z;"t"==u&&3==p?q?(p=E.x(0,0),u=E.y(0,0),q=E.x(n[1],n[2]),E=E.y(n[1],n[2]),g.translate(q-p,E-u)):g.translate(n[1],n[2]):"r"==u?2==p?(z=z||b.getBBox(1),g.rotate(n[1],z.x+z.width/2,z.y+z.height/2),f+=n[1]):4==p&&(q?(q=E.x(n[2],n[3]),E=E.y(n[2],n[3]),g.rotate(n[1],q,E)):g.rotate(n[1],n[2],n[3]),f+=n[1]):"s"==u?2==p||3==p?(z=z||b.getBBox(1),g.scale(n[1],n[p-1],z.x+z.width/2,z.y+z.height/2),h*=n[1],m*=n[p-1]):5==p&&(q?(q=E.x(n[3],n[4]),E=E.y(n[3],n[4]),
g.scale(n[1],n[2],q,E)):g.scale(n[1],n[2],n[3],n[4]),h*=n[1],m*=n[2]):"m"==u&&7==p&&g.add(n[1],n[2],n[3],n[4],n[5],n[6]);l.dirtyT=1;b.matrix=g}b.matrix=g;l.sx=h;l.sy=m;l.deg=f;l.dx=e=g.e;l.dy=g=g.f;1==h&&1==m&&!f&&l.bbox?(l.bbox.x+=+e,l.bbox.y+=+g):l.dirtyT=1},ka=function(a){var b=a[0];switch(b.toLowerCase()){case "t":return[b,0,0];case "m":return[b,1,0,0,1,0,0];case "r":return 4==a.length?[b,0,a[2],a[3]]:[b,0];case "s":return 5==a.length?[b,1,1,a[3],a[4]]:3==a.length?[b,1,1]:[b,1]}},ob=a._equaliseTransform=
function(b,c){for(var c=k(c).replace(/\.{3}|\u2026/g,b),b=a.parseTransformString(b)||[],c=a.parseTransformString(c)||[],d=L(b.length,c.length),f=[],e=[],g=0,h,i,m,l;g<d;g++){m=b[g]||ka(c[g]);l=c[g]||ka(m);if(m[0]!=l[0]||"r"==m[0].toLowerCase()&&(m[2]!=l[2]||m[3]!=l[3])||"s"==m[0].toLowerCase()&&(m[3]!=l[3]||m[4]!=l[4]))return;f[g]=[];e[g]=[];h=0;for(i=L(m.length,l.length);h<i;h++)h in m&&(f[g][h]=m[h]),h in l&&(e[g][h]=l[h])}return{from:f,to:e}};a._getContainer=function(b,c,d,f){var e;e=null==f&&
!a.is(b,"object")?t.doc.getElementById(b):b;if(null!=e)return e.tagName?null==c?{container:e,width:e.style.pixelWidth||e.offsetWidth,height:e.style.pixelHeight||e.offsetHeight}:{container:e,width:c,height:d}:{container:1,x:b,y:c,width:d,height:f}};a.pathToRelative=ib;a._engine={};a.path2curve=bb;a.matrix=function(a,b,c,d,f,e){return new i(a,b,c,d,f,e)};var oa=i.prototype,Ra=function(a){return a[0]*a[0]+a[1]*a[1]},gb=function(a){var b=F.sqrt(Ra(a));a[0]&&(a[0]/=b);a[1]&&(a[1]/=b)};oa.add=function(a,
b,c,d,f,e){var g=[[],[],[]],h=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],b=[[a,c,f],[b,d,e],[0,0,1]];a&&a instanceof i&&(b=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]);for(a=0;3>a;a++)for(c=0;3>c;c++){for(d=f=0;3>d;d++)f+=h[a][d]*b[d][c];g[a][c]=f}this.a=g[0][0];this.b=g[1][0];this.c=g[0][1];this.d=g[1][1];this.e=g[0][2];this.f=g[1][2]};oa.invert=function(){var a=this.a*this.d-this.b*this.c;return new i(this.d/a,-this.b/a,-this.c/a,this.a/a,(this.c*this.f-this.d*this.e)/a,(this.b*this.e-this.a*
this.f)/a)};oa.clone=function(){return new i(this.a,this.b,this.c,this.d,this.e,this.f)};oa.translate=function(a,b){this.add(1,0,0,1,a,b)};oa.scale=function(a,b,c,d){null==b&&(b=a);(c||d)&&this.add(1,0,0,1,c,d);this.add(a,0,0,b,0,0);(c||d)&&this.add(1,0,0,1,-c,-d)};oa.rotate=function(b,c,d){var b=a.rad(b),c=c||0,d=d||0,f=+F.cos(b).toFixed(9),b=+F.sin(b).toFixed(9);this.add(f,b,-b,f,c,d);this.add(1,0,0,1,-c,-d)};oa.x=function(a,b){return a*this.a+b*this.c+this.e};oa.y=function(a,b){return a*this.b+
b*this.d+this.f};oa.get=function(a){return+this[k.fromCharCode(97+a)].toFixed(4)};oa.toString=function(){return a.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};oa.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};oa.offset=
function(){return[this.e.toFixed(4),this.f.toFixed(4)]};oa.split=function(){var b={};b.dx=this.e;b.dy=this.f;var c=[[this.a,this.c],[this.b,this.d]];b.scalex=F.sqrt(Ra(c[0]));gb(c[0]);b.shear=c[0][0]*c[1][0]+c[0][1]*c[1][1];c[1]=[c[1][0]-c[0][0]*b.shear,c[1][1]-c[0][1]*b.shear];b.scaley=F.sqrt(Ra(c[1]));gb(c[1]);b.shear/=b.scaley;var d=-c[0][1],c=c[1][1];0>c?(b.rotate=a.deg(F.acos(c)),0>d&&(b.rotate=360-b.rotate)):b.rotate=a.deg(F.asin(d));b.isSimple=!+b.shear.toFixed(9)&&(b.scalex.toFixed(9)==b.scaley.toFixed(9)||
!b.rotate);b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate;b.noRotation=!+b.shear.toFixed(9)&&!b.rotate;return b};oa.toTransformString=function(a){a=a||this[E]();return a.isSimple?(a.scalex=+a.scalex.toFixed(4),a.scaley=+a.scaley.toFixed(4),a.rotate=+a.rotate.toFixed(4),(a.dx||a.dy?"t"+[a.dx,a.dy]:"")+(1!=a.scalex||1!=a.scaley?"s"+[a.scalex,a.scaley,0,0]:"")+(a.rotate?"r"+[a.rotate,0,0]:"")):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),
this.get(5)]};var hb=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);y.safari="Apple Computer, Inc."==navigator.vendor&&(hb&&4>hb[1]||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&hb&&8>hb[1]?function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){a.remove()})}:xb;var pb=function(){this.returnValue=!1},zb=function(){return this.originalEvent.preventDefault()},qb=function(){this.cancelBubble=
!0},Sa=function(){return this.originalEvent.stopPropagation()},Ta;Ta=t.doc.addEventListener?function(a,b,c,d){var f=u&&Q[b]?Q[b]:b,e=function(f){var e=f.clientX+(t.doc.documentElement.scrollLeft||t.doc.body.scrollLeft),g=f.clientY+(t.doc.documentElement.scrollTop||t.doc.body.scrollTop);if(u&&Q[x](b))for(var h=0,i=f.targetTouches&&f.targetTouches.length;h<i;h++)if(f.targetTouches[h].target==a){i=f;f=f.targetTouches[h];f.originalEvent=i;f.preventDefault=zb;f.stopPropagation=Sa;break}return c.call(d,
f,e,g)};a.addEventListener(f,e,!1);return function(){a.removeEventListener(f,e,!1);return!0}}:t.doc.attachEvent?function(a,b,c,d){var f=function(a){var a=a||t.win.event,b=a.clientX+(t.doc.documentElement.scrollLeft||t.doc.body.scrollLeft),f=a.clientY+(t.doc.documentElement.scrollTop||t.doc.body.scrollTop);a.preventDefault=a.preventDefault||pb;a.stopPropagation=a.stopPropagation||qb;return c.call(d,a,b,f)};a.attachEvent("on"+b,f);return function(){a.detachEvent("on"+b,f);return!0}}:void 0;for(var Ha=
[],Pa=function(a){for(var b=a.clientX,c=a.clientY,d=t.doc.documentElement.scrollTop||t.doc.body.scrollTop,f=t.doc.documentElement.scrollLeft||t.doc.body.scrollLeft,e,g=Ha.length;g--;){e=Ha[g];if(u)for(var h=a.touches.length,i;h--;){if(i=a.touches[h],i.identifier==e.el._drag.id){b=i.clientX;c=i.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();var h=e.el.node,m=h.nextSibling,k=h.parentNode,l=h.style.display;t.win.opera&&k.removeChild(h);h.style.display="none";
i=e.el.paper.getElementByPoint(b,c);h.style.display=l;t.win.opera&&(m?k.insertBefore(h,m):k.appendChild(h));i&&eve("raphael.drag.over."+e.el.id,e.el,i);b+=f;c+=d;eve("raphael.drag.move."+e.el.id,e.move_scope||e.el,b-e.el._drag.x,c-e.el._drag.y,b,c,a)}},cb=function(b){a.unmousemove(Pa).unmouseup(cb);for(var c=Ha.length,d;c--;)d=Ha[c],d.el._drag={},eve("raphael.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,b);Ha=[]},R=a.el={},da=z.length;da--;)(function(b){a[b]=R[b]=function(c,d){a.is(c,
"function")&&(this.events=this.events||[],this.events.push({name:b,f:c,unbind:Ta(this.shape||this.node||t.doc,b,c,d||this)}));return this};a["un"+b]=R["un"+b]=function(a){for(var c=this.events||[],d=c.length;d--;)if(c[d].name==b&&c[d].f==a){c[d].unbind();c.splice(d,1);!c.length&&delete this.events;break}return this}})(z[da]);R.data=function(b,c){var d=Da[this.id]=Da[this.id]||{};if(1==arguments.length){if(a.is(b,"object")){for(var f in b)b[x](f)&&this.data(f,b[f]);return this}eve("raphael.data.get."+
this.id,this,d[b],b);return d[b]}d[b]=c;eve("raphael.data.set."+this.id,this,c,b);return this};R.removeData=function(a){null==a?Da[this.id]={}:Da[this.id]&&delete Da[this.id][a];return this};R.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)};R.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var va=[];R.drag=function(b,c,d,f,e,g){function h(i){(i.originalEvent||i).preventDefault();var m=t.doc.documentElement.scrollTop||t.doc.body.scrollTop,k=t.doc.documentElement.scrollLeft||
t.doc.body.scrollLeft;this._drag.x=i.clientX+k;this._drag.y=i.clientY+m;this._drag.id=i.identifier;!Ha.length&&a.mousemove(Pa).mouseup(cb);Ha.push({el:this,move_scope:f,start_scope:e,end_scope:g});c&&eve.on("raphael.drag.start."+this.id,c);b&&eve.on("raphael.drag.move."+this.id,b);d&&eve.on("raphael.drag.end."+this.id,d);eve("raphael.drag.start."+this.id,e||f||this,i.clientX+k,i.clientY+m,i)}this._drag={};va.push({el:this,start:h});this.mousedown(h);return this};R.onDragOver=function(a){a?eve.on("raphael.drag.over."+
this.id,a):eve.unbind("raphael.drag.over."+this.id)};R.undrag=function(){for(var b=va.length;b--;)va[b].el==this&&(this.unmousedown(va[b].start),va.splice(b,1),eve.unbind("raphael.drag.*."+this.id));!va.length&&a.unmousemove(Pa).unmouseup(cb)};y.circle=function(b,c,d){b=a._engine.circle(this,b||0,c||0,d||0);this.__set__&&this.__set__.push(b);return b};y.rect=function(b,c,d,f,e){b=a._engine.rect(this,b||0,c||0,d||0,f||0,e||0);this.__set__&&this.__set__.push(b);return b};y.ellipse=function(b,c,d,f){b=
a._engine.ellipse(this,b||0,c||0,d||0,f||0);this.__set__&&this.__set__.push(b);return b};y.path=function(b){b&&!a.is(b,"string")&&!a.is(b[0],U)&&(b+="");var c=a._engine.path(a.format[A](a,arguments),this);this.__set__&&this.__set__.push(c);return c};y.image=function(b,c,d,f,e){b=a._engine.image(this,b||"about:blank",c||0,d||0,f||0,e||0);this.__set__&&this.__set__.push(b);return b};y.text=function(b,c,d){b=a._engine.text(this,b||0,c||0,k(d));this.__set__&&this.__set__.push(b);return b};y.set=function(b){!a.is(b,
"array")&&(b=Array.prototype.splice.call(arguments,0,arguments.length));var c=new lb(b);this.__set__&&this.__set__.push(c);return c};y.setStart=function(a){this.__set__=a||this.set()};y.setFinish=function(){var a=this.__set__;delete this.__set__;return a};y.setSize=function(b,c){return a._engine.setSize.call(this,b,c)};y.setViewBox=function(b,c,d,f,e){return a._engine.setViewBox.call(this,b,c,d,f,e)};y.top=y.bottom=null;y.raphael=a;y.getElementByPoint=function(a,b){var c,d,f=this.canvas,e=t.doc.elementFromPoint(a,
b);if(t.win.opera&&"svg"==e.tagName){d=f.getBoundingClientRect();c=f.ownerDocument;var g=c.body,h=c.documentElement;c=d.top+(t.win.pageYOffset||h.scrollTop||g.scrollTop)-(h.clientTop||g.clientTop||0);d=d.left+(t.win.pageXOffset||h.scrollLeft||g.scrollLeft)-(h.clientLeft||g.clientLeft||0);g=f.createSVGRect();g.x=a-d;g.y=b-c;g.width=g.height=1;c=f.getIntersectionList(g,null);c.length&&(e=c[c.length-1])}if(!e)return null;for(;e.parentNode&&e!=f.parentNode&&!e.raphael;)e=e.parentNode;e==this.canvas.parentNode&&
(e=f);return e=e&&e.raphael?this.getById(e.raphaelid):null};y.getById=function(a){for(var b=this.bottom;b;){if(b.id==a)return b;b=b.next}return null};y.forEach=function(a,b){for(var c=this.bottom;c&&!1!==a.call(b,c);)c=c.next;return this};y.getElementsByPoint=function(a,b){var c=this.set();this.forEach(function(d){d.isPointInside(a,b)&&c.push(d)});return c};R.isPointInside=function(b,c){var d=this.realPath=this.realPath||Na[this.type](this);return a.isPointInsidePath(d,b,c)};R.getBBox=function(a){if(this.removed)return{};
var b=this._;if(a){if(b.dirty||!b.bboxwt)this.realPath=Na[this.type](this),b.bboxwt=I(this.realPath),b.bboxwt.toString=j,b.dirty=0;return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath)b.bboxwt=0,this.realPath=Na[this.type](this);b.bbox=I(ca(this.realPath,this.matrix));b.bbox.toString=j;b.dirty=b.dirtyT=0}return b.bbox};R.clone=function(){if(this.removed)return null;var a=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(a);return a};R.glow=function(a){if("text"==
this.type)return null;for(var a=a||{},b=(a.width||10)+(+this.attr("stroke-width")||1),c=a.fill||!1,d=a.opacity||0.5,f=a.offsetx||0,e=a.offsety||0,a=a.color||"#000",g=b/2,h=this.paper,i=h.set(),m=this.realPath||Na[this.type](this),m=this.matrix?ca(m,this.matrix):m,k=1;k<g+1;k++)i.push(h.path(m).attr({stroke:a,fill:c?a:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(b/g*k).toFixed(3),opacity:+(d/g).toFixed(3)}));return i.insertBefore(this).translate(f,e)};var aa=function(b,
d,e,g,h,i,m,k,l){return null==l?f(b,d,e,g,h,i,m,k):a.findDotsAtSegment(b,d,e,g,h,i,m,k,c(b,d,e,g,h,i,m,k,l))},Y=function(b,c){return function(d,f,e){for(var d=bb(d),g,h,i,m,k="",l={},j=0,n=0,p=d.length;n<p;n++){i=d[n];if("M"==i[0])g=+i[1],h=+i[2];else{m=aa(g,h,i[1],i[2],i[3],i[4],i[5],i[6]);if(j+m>f){if(c&&!l.start){g=aa(g,h,i[1],i[2],i[3],i[4],i[5],i[6],f-j);k+=["C"+g.start.x,g.start.y,g.m.x,g.m.y,g.x,g.y];if(e)return k;l.start=k;k=["M"+g.x,g.y+"C"+g.n.x,g.n.y,g.end.x,g.end.y,i[5],i[6]].join();j+=
m;g=+i[5];h=+i[6];continue}if(!b&&!c)return g=aa(g,h,i[1],i[2],i[3],i[4],i[5],i[6],f-j),{x:g.x,y:g.y,alpha:g.alpha}}j+=m;g=+i[5];h=+i[6]}k+=i.shift()+i}l.end=k;g=b?j:c?l:a.findDotsAtSegment(g,h,i[0],i[1],i[2],i[3],i[4],i[5],1);g.alpha&&(g={x:g.x,y:g.y,alpha:g.alpha});return g}},Ua=Y(1),O=Y(),Qa=Y(0,1);a.getTotalLength=Ua;a.getPointAtLength=O;a.getSubpath=function(a,b,c){if(1E-6>this.getTotalLength(a)-c)return Qa(a,b).end;a=Qa(a,c,1);return b?Qa(a,b).end:a};R.getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?
this.node.getTotalLength():Ua(this.attrs.path)};R.getPointAtLength=function(a){if("path"==this.type)return O(this.attrs.path,a)};R.getSubpath=function(b,c){if("path"==this.type)return a.getSubpath(this.attrs.path,b,c)};var ga=a.easing_formulas={linear:function(a){return a},"<":function(a){return T(a,1.7)},">":function(a){return T(a,0.48)},"<>":function(a){var b=0.48-a/1.04,c=F.sqrt(0.1734+b*b),a=c-b,a=T(W(a),1/3)*(0>a?-1:1),b=-c-b,b=T(W(b),1/3)*(0>b?-1:1),a=a+b+0.5;return 3*(1-a)*a*a+a*a*a},backIn:function(a){return a*
a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){return a==!!a?a:T(2,-10*a)*F.sin((a-0.075)*2*K/0.3)+1},bounce:function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+0.75):a<2.5/2.75?(a-=2.25/2.75,a=7.5625*a*a+0.9375):(a-=2.625/2.75,a=7.5625*a*a+0.984375);return a}};ga.easeIn=ga["ease-in"]=ga["<"];ga.easeOut=ga["ease-out"]=ga[">"];ga.easeInOut=ga["ease-in-out"]=ga["<>"];ga["back-in"]=ga.backIn;ga["back-out"]=ga.backOut;var G=[],Ca=
window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,16)},P=function(){for(var b=+new Date,c=0;c<G.length;c++){var d=G[c];if(!d.el.removed&&!d.paused){var f=b-d.start,e=d.ms,g=d.easing,h=d.from,i=d.diff,k=d.to,l=d.el,j={},n,p={},u;d.initstatus?(f=(d.initstatus*d.anim.top-d.prev)/(d.percent-d.prev)*e,d.status=d.initstatus,delete d.initstatus,d.stop&&G.splice(c--,1)):
d.status=(d.prev+(d.percent-d.prev)*(f/e))/d.anim.top;if(!(0>f))if(f<e){var q=g(f/e),E;for(E in h)if(h[x](E)){switch(na[E]){case H:n=+h[E]+q*e*i[E];break;case "colour":n="rgb("+[Ab(fa(h[E].r+q*e*i[E].r)),Ab(fa(h[E].g+q*e*i[E].g)),Ab(fa(h[E].b+q*e*i[E].b))].join()+")";break;case "path":n=[];f=0;for(g=h[E].length;f<g;f++){n[f]=[h[E][f][0]];k=1;for(p=h[E][f].length;k<p;k++)n[f][k]=+h[E][f][k]+q*e*i[E][f][k];n[f]=n[f].join(D)}n=n.join(D);break;case "transform":if(i[E].real){n=[];f=0;for(g=h[E].length;f<
g;f++){n[f]=[h[E][f][0]];k=1;for(p=h[E][f].length;k<p;k++)n[f][k]=h[E][f][k]+q*e*i[E][f][k]}}else n=function(a){return+h[E][a]+q*e*i[E][a]},n=[["m",n(0),n(1),n(2),n(3),n(4),n(5)]];break;case "csv":if("clip-rect"==E){n=[];for(f=4;f--;)n[f]=+h[E][f]+q*e*i[E][f]}break;default:g=[][B](h[E]);n=[];for(f=l.paper.customAttributes[E].length;f--;)n[f]=+g[f]+q*e*i[E][f]}j[E]=n}l.attr(j);(function(a,b,c){setTimeout(function(){eve("raphael.anim.frame."+a,b,c)})})(l.id,l,d.anim)}else{(function(b,c,d){setTimeout(function(){eve("raphael.anim.frame."+
c.id,c,d);eve("raphael.anim.finish."+c.id,c,d);a.is(b,"function")&&b.call(c)})})(d.callback,l,d.anim);l.attr(k);G.splice(c--,1);if(1<d.repeat&&!d.next){for(u in k)k[x](u)&&(p[u]=d.totalOrigin[u]);d.el.attr(p);m(d.anim,d.el,d.anim.percents[0],null,d.totalOrigin,d.repeat-1)}d.next&&!d.stop&&m(d.anim,d.el,d.next,null,d.totalOrigin,d.repeat)}}}a.svg&&l&&l.paper&&l.paper.safari();G.length&&Ca(P)},Ab=function(a){return 255<a?255:0>a?0:a};R.animateWith=function(b,c,d,f,e,g){if(this.removed)return g&&g.call(this),
this;d=d instanceof l?d:a.animation(d,f,e,g);m(d,this,d.percents[0],null,this.attr());d=0;for(f=G.length;d<f;d++)if(G[d].anim==c&&G[d].el==b){G[f-1].start=G[d].start;break}return this};R.onAnimation=function(a){a?eve.on("raphael.anim.frame."+this.id,a):eve.unbind("raphael.anim.frame."+this.id);return this};l.prototype.delay=function(a){var b=new l(this.anim,this.ms);b.times=this.times;b.del=+a||0;return b};l.prototype.repeat=function(a){var b=new l(this.anim,this.ms);b.del=this.del;b.times=F.floor(L(a,
0))||1;return b};a.animation=function(b,c,d,f){if(b instanceof l)return b;if(a.is(d,"function")||!d)f=f||d||null,d=null;var b=Object(b),c=+c||0,e={},g,h;for(h in b)b[x](h)&&(S(h)!=h&&S(h)+"%"!=h)&&(g=!0,e[h]=b[h]);return g?(d&&(e.easing=d),f&&(e.callback=f),new l({100:e},c)):new l(b,c)};R.animate=function(b,c,d,f){if(this.removed)return f&&f.call(this),this;b=b instanceof l?b:a.animation(b,c,d,f);m(b,this,b.percents[0],null,this.attr());return this};R.setTime=function(a,b){a&&null!=b&&this.status(a,
C(b,a.ms)/a.ms);return this};R.status=function(a,b){var c=[],d=0,f,e;if(null!=b)return m(a,this,-1,C(b,1)),this;for(f=G.length;d<f;d++)if(e=G[d],e.el.id==this.id&&(!a||e.anim==a)){if(a)return e.status;c.push({anim:e.anim,status:e.status})}return a?0:c};R.pause=function(a){for(var b=0;b<G.length;b++)if(G[b].el.id==this.id&&(!a||G[b].anim==a)&&!1!==eve("raphael.anim.pause."+this.id,this,G[b].anim))G[b].paused=!0;return this};R.resume=function(a){for(var b=0;b<G.length;b++)if(G[b].el.id==this.id&&(!a||
G[b].anim==a)){var c=G[b];!1!==eve("raphael.anim.resume."+this.id,this,c.anim)&&(delete c.paused,this.status(c.anim,c.status))}return this};R.stop=function(a){for(var b=0;b<G.length;b++)G[b].el.id==this.id&&(!a||G[b].anim==a)&&!1!==eve("raphael.anim.stop."+this.id,this,G[b].anim)&&G.splice(b--,1);return this};eve.on("raphael.remove",n);eve.on("raphael.clear",n);R.toString=function(){return"Rapha\u00ebl\u2019s object"};var lb=function(a){this.items=[];this.length=0;this.type="set";if(a)for(var b=0,
c=a.length;b<c;b++)if(a[b]&&(a[b].constructor==R.constructor||a[b].constructor==lb))this[this.items.length]=this.items[this.items.length]=a[b],this.length++},pa=lb.prototype;pa.push=function(){for(var a,b,c=0,d=arguments.length;c<d;c++)if((a=arguments[c])&&(a.constructor==R.constructor||a.constructor==lb))b=this.items.length,this[b]=this.items[b]=a,this.length++;return this};pa.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};pa.forEach=function(a,b){for(var c=0,d=this.items.length;c<
d&&!1!==a.call(b,this.items[c],c);c++);return this};for(var Ba in R)R[x](Ba)&&(pa[Ba]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a][A](c,b)})}}(Ba));pa.attr=function(b,c){if(b&&a.is(b,U)&&a.is(b[0],"object"))for(var d=0,f=b.length;d<f;d++)this.items[d].attr(b[d]);else{d=0;for(f=this.items.length;d<f;d++)this.items[d].attr(b,c)}return this};pa.clear=function(){for(;this.length;)this.pop()};pa.splice=function(a,b,c){var a=0>a?L(this.length+a,0):a,b=L(0,C(this.length-
a,b)),d=[],f=[],e=[],g;for(g=2;g<arguments.length;g++)e.push(arguments[g]);for(g=0;g<b;g++)f.push(this[a+g]);for(;g<this.length-a;g++)d.push(this[a+g]);var h=e.length;for(g=0;g<h+d.length;g++)this.items[a+g]=this[a+g]=g<h?e[g]:d[g-h];for(g=this.items.length=this.length-=b-h;this[g];)delete this[g++];return new lb(f)};pa.exclude=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a)return this.splice(b,1),!0};pa.animate=function(b,c,d,f){(a.is(d,"function")||!d)&&(f=d||null);var e=this.items.length,
g=e,h=this,i;if(!e)return this;f&&(i=function(){!--e&&f.call(h)});d=a.is(d,"string")?d:i;c=a.animation(b,c,d,i);for(b=this.items[--g].animate(c);g--;)this.items[g]&&!this.items[g].removed&&this.items[g].animateWith(b,c,c);return this};pa.insertAfter=function(a){for(var b=this.items.length;b--;)this.items[b].insertAfter(a);return this};pa.getBBox=function(){for(var a=[],b=[],c=[],d=[],f=this.items.length;f--;)if(!this.items[f].removed){var e=this.items[f].getBBox();a.push(e.x);b.push(e.y);c.push(e.x+
e.width);d.push(e.y+e.height)}a=C[A](0,a);b=C[A](0,b);c=L[A](0,c);d=L[A](0,d);return{x:a,y:b,x2:c,y2:d,width:c-a,height:d-b}};pa.clone=function(a){for(var a=new lb,b=0,c=this.items.length;b<c;b++)a.push(this.items[b].clone());return a};pa.toString=function(){return"Rapha\u00ebl\u2018s set"};a.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face["font-family"],d;for(d in a.face)a.face[x](d)&&(b.face[d]=a.face[d]);this.fonts[c]?this.fonts[c].push(b):
this.fonts[c]=[b];if(!a.svg){b.face["units-per-em"]=ha(a.face["units-per-em"],10);for(var f in a.glyphs)if(a.glyphs[x](f)&&(c=a.glyphs[f],b.glyphs[f]={w:c.w,k:{},d:c.d&&"M"+c.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"},c.k))for(var e in c.k)c[x](e)&&(b.glyphs[f].k[e]=c.k[e])}return a};y.getFont=function(b,c,d,f){f=f||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(a.fonts){var e=a.fonts[b];if(!e){var b=RegExp("(^|\\s)"+
b.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i"),g;for(g in a.fonts)if(a.fonts[x](g)&&b.test(g)){e=a.fonts[g];break}}var h;if(e){g=0;for(b=e.length;g<b&&!(h=e[g],h.face["font-weight"]==c&&(h.face["font-style"]==d||!h.face["font-style"])&&h.face["font-stretch"]==f);g++);}return h}};y.print=function(b,c,d,f,e,g,h){var g=g||"middle",h=L(C(h||0,1),-1),i=k(d)[E](""),m=0,l=0,j="";a.is(f,d)&&(f=this.getFont(f));if(f)for(var d=(e||16)/f.face["units-per-em"],n=f.face.bbox[E](p),e=+n[0],u=n[3]-n[1],q=0,g=+n[1]+
("baseline"==g?u+ +f.face.descent:u/2),n=0,z=i.length;n<z;n++){if("\n"==i[n])l=D=m=0,q+=u;else var w=l&&f.glyphs[i[n-1]]||{},D=f.glyphs[i[n]],m=m+(l?(w.w||f.w)+(w.k&&w.k[i[n]]||0)+f.w*h:0),l=1;D&&D.d&&(j+=a.transformPath(D.d,["t",m*d,q*d,"s",d,d,e,g,"t",(b-e)/d,(c-g)/d]))}return this.path(j).attr({fill:"#000",stroke:"none"})};y.add=function(b){if(a.is(b,"array"))for(var c=this.set(),d=0,f=b.length,e;d<f;d++)e=b[d]||{},w[x](e.type)&&c.push(this[e.type]().attr(e));return c};a.format=function(b,c){var d=
a.is(c,U)?[0][B](c):arguments;b&&a.is(b,"string")&&d.length-1&&(b=b.replace(r,function(a,b){return null==d[++b]?"":d[b]}));return b||""};var Vb=/\{([^\}]+)\}/g,Bb=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;a.fullfill=function(a,b){return String(a).replace(Vb,function(a,c){var d=b;c.replace(Bb,function(a,b,c,f,e){b=b||f;d&&(b in d&&(d=d[b]),"function"==typeof d&&e&&(d=d()))});return d=(null==d||d==b?a:d)+""})};a.ninja=function(){s?t.win.Raphael=v:delete Raphael;return a};a.st=pa;var Ia=
document,rb=void 0,Eb=function(){/in/.test(Ia.readyState)?setTimeout(Eb,9):a.eve("raphael.DOMload")};null==Ia.readyState&&Ia.addEventListener&&(Ia.addEventListener("DOMContentLoaded",rb=function(){Ia.removeEventListener("DOMContentLoaded",rb,!1);Ia.readyState="complete"},!1),Ia.readyState="loading");Eb();s?t.win.Raphael=a:Raphael=a;eve.on("raphael.DOMload",function(){q=true})})();
window.Raphael.svg&&function(a){var b=String,e=parseFloat,d=parseInt,g=Math,f=g.max,c=g.abs,h=g.pow,i=/[, ]+/,j=a.eve,l={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},m={};a.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var n=function(c,d){if(d){"string"==typeof c&&(c=n(c));for(var f in d)d.hasOwnProperty(f)&&("xlink:"==
f.substring(0,6)?c.setAttributeNS("http://www.w3.org/1999/xlink",f.substring(6),b(d[f])):c.setAttribute(f,b(d[f])))}else c=a._g.doc.createElementNS("http://www.w3.org/2000/svg",c),c.style&&(c.style.webkitTapHighlightColor="rgba(0,0,0,0)");return c},q=function(d,i){var m="linear",k=d.id+i,l=0.5,j=0.5,p=d.node,q=d.paper,w=p.style,r=a._g.doc.getElementById(k);if(!r){i=b(i).replace(a._radial_gradient,function(a,b,c){m="radial";b&&c&&(l=e(b),j=e(c),a=2*(0.5<j)-1,0.25<h(l-0.5,2)+h(j-0.5,2)&&(j=g.sqrt(0.25-
h(l-0.5,2))*a+0.5)&&0.5!=j&&(j=j.toFixed(5)-1E-5*a));return""});i=i.split(/\s*\-\s*/);if("linear"==m){r=i.shift();r=-e(r);if(isNaN(r))return null;var s=[0,0,g.cos(a.rad(r)),g.sin(a.rad(r))],r=1/(f(c(s[2]),c(s[3]))||1);s[2]*=r;s[3]*=r;0>s[2]&&(s[0]=-s[2],s[2]=0);0>s[3]&&(s[1]=-s[3],s[3]=0)}var x=a._parseDots(i);if(!x)return null;k=k.replace(/[\(\)\s,\xb0#]/g,"_");d.gradient&&k!=d.gradient.id&&(q.defs.removeChild(d.gradient),delete d.gradient);if(!d.gradient){r=n(m+"Gradient",{id:k});d.gradient=r;n(r,
"radial"==m?{fx:l,fy:j}:{x1:s[0],y1:s[1],x2:s[2],y2:s[3],gradientTransform:d.matrix.invert()});q.defs.appendChild(r);q=0;for(s=x.length;q<s;q++)r.appendChild(n("stop",{offset:x[q].offset?x[q].offset:q?"100%":"0%","stop-color":x[q].color||"#fff"}))}}n(p,{fill:"url(#"+k+")",opacity:1,"fill-opacity":1});w.fill="";w.opacity=1;return w.fillOpacity=1},p=function(a){var b=a.getBBox(1);n(a.pattern,{patternTransform:a.matrix.invert()+" translate("+b.x+","+b.y+")"})},w=function(c,d,f){if("path"==c.type){for(var e=
b(d).toLowerCase().split("-"),g=c.paper,h=f?"end":"start",i=c.node,j=c.attrs,p=j["stroke-width"],q=e.length,w="classic",r,s,x=3,o=3,t=5;q--;)switch(e[q]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":w=e[q];break;case "wide":o=5;break;case "narrow":o=2;break;case "long":x=5;break;case "short":x=2}"open"==w?(x+=2,o+=2,t+=2,r=1,s=f?4:1,e={fill:"none",stroke:j.stroke}):(s=r=x/2,e={fill:j.stroke,stroke:"none"});c._.arrows?f?(c._.arrows.endPath&&m[c._.arrows.endPath]--,
c._.arrows.endMarker&&m[c._.arrows.endMarker]--):(c._.arrows.startPath&&m[c._.arrows.startPath]--,c._.arrows.startMarker&&m[c._.arrows.startMarker]--):c._.arrows={};if("none"!=w){var q="raphael-marker-"+w,v="raphael-marker-"+h+w+x+o;a._g.doc.getElementById(q)?m[q]++:(g.defs.appendChild(n(n("path"),{"stroke-linecap":"round",d:l[w],id:q})),m[q]=1);var A=a._g.doc.getElementById(v);A?(m[v]++,x=A.getElementsByTagName("use")[0]):(A=n(n("marker"),{id:v,markerHeight:o,markerWidth:x,orient:"auto",refX:s,refY:o/
2}),x=n(n("use"),{"xlink:href":"#"+q,transform:(f?"rotate(180 "+x/2+" "+o/2+") ":"")+"scale("+x/t+","+o/t+")","stroke-width":(1/((x/t+o/t)/2)).toFixed(4)}),A.appendChild(x),g.defs.appendChild(A),m[v]=1);n(x,e);g=r*("diamond"!=w&&"oval"!=w);f?(f=c._.arrows.startdx*p||0,p=a.getTotalLength(j.path)-g*p):(f=g*p,p=a.getTotalLength(j.path)-(c._.arrows.enddx*p||0));e={};e["marker-"+h]="url(#"+v+")";if(p||f)e.d=Raphael.getSubpath(j.path,f,p);n(i,e);c._.arrows[h+"Path"]=q;c._.arrows[h+"Marker"]=v;c._.arrows[h+
"dx"]=g;c._.arrows[h+"Type"]=w;c._.arrows[h+"String"]=d}else f?(f=c._.arrows.startdx*p||0,p=a.getTotalLength(j.path)-f):(f=0,p=a.getTotalLength(j.path)-(c._.arrows.enddx*p||0)),c._.arrows[h+"Path"]&&n(i,{d:Raphael.getSubpath(j.path,f,p)}),delete c._.arrows[h+"Path"],delete c._.arrows[h+"Marker"],delete c._.arrows[h+"dx"],delete c._.arrows[h+"Type"],delete c._.arrows[h+"String"];for(e in m)m.hasOwnProperty(e)&&!m[e]&&(c=a._g.doc.getElementById(e))&&c.parentNode.removeChild(c)}},r={"":[0],none:[0],
"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},x=function(a,c,d){if(c=r[b(c).toLowerCase()]){for(var f=a.attrs["stroke-width"]||"1",d={round:f,square:f,butt:0}[a.attrs["stroke-linecap"]||d["stroke-linecap"]]||0,e=[],g=c.length;g--;)e[g]=c[g]*f+(g%2?1:-1)*d;n(a.node,{"stroke-dasharray":e.join(",")})}},t=function(e,g){var h=e.node,m=e.attrs,l=h.style.visibility;h.style.visibility="hidden";for(var j in g)if(g.hasOwnProperty(j)&&
a._availableAttrs.hasOwnProperty(j)){var r=g[j];m[j]=r;switch(j){case "blur":e.blur(r);break;case "href":case "title":case "target":var o=h.parentNode;if("a"!=o.tagName.toLowerCase()){var t=n("a");o.insertBefore(t,h);t.appendChild(h);o=t}"target"==j?o.setAttributeNS("http://www.w3.org/1999/xlink","show","blank"==r?"new":r):o.setAttributeNS("http://www.w3.org/1999/xlink",j,r);break;case "cursor":h.style.cursor=r;break;case "transform":e.transform(r);break;case "arrow-start":w(e,r);break;case "arrow-end":w(e,
r,1);break;case "clip-rect":o=b(r).split(i);if(4==o.length){e.clip&&e.clip.parentNode.parentNode.removeChild(e.clip.parentNode);var t=n("clipPath"),v=n("rect");t.id=a.createUUID();n(v,{x:o[0],y:o[1],width:o[2],height:o[3]});t.appendChild(v);e.paper.defs.appendChild(t);n(h,{"clip-path":"url(#"+t.id+")"});e.clip=v}if(!r&&(r=h.getAttribute("clip-path")))(r=a._g.doc.getElementById(r.replace(/(^url\(#|\)$)/g,"")))&&r.parentNode.removeChild(r),n(h,{"clip-path":""}),delete e.clip;break;case "path":"path"==
e.type&&(n(h,{d:r?m.path=a._pathToAbsolute(r):"M0,0"}),e._.dirty=1,e._.arrows&&("startString"in e._.arrows&&w(e,e._.arrows.startString),"endString"in e._.arrows&&w(e,e._.arrows.endString,1)));break;case "width":if(h.setAttribute(j,r),e._.dirty=1,m.fx)j="x",r=m.x;else break;case "x":m.fx&&(r=-m.x-(m.width||0));case "rx":if("rx"==j&&"rect"==e.type)break;case "cx":h.setAttribute(j,r);e.pattern&&p(e);e._.dirty=1;break;case "height":if(h.setAttribute(j,r),e._.dirty=1,m.fy)j="y",r=m.y;else break;case "y":m.fy&&
(r=-m.y-(m.height||0));case "ry":if("ry"==j&&"rect"==e.type)break;case "cy":h.setAttribute(j,r);e.pattern&&p(e);e._.dirty=1;break;case "r":"rect"==e.type?n(h,{rx:r,ry:r}):h.setAttribute(j,r);e._.dirty=1;break;case "src":"image"==e.type&&h.setAttributeNS("http://www.w3.org/1999/xlink","href",r);break;case "stroke-width":if(1!=e._.sx||1!=e._.sy)r/=f(c(e._.sx),c(e._.sy))||1;e.paper._vbSize&&(r*=e.paper._vbSize);h.setAttribute(j,r);m["stroke-dasharray"]&&x(e,m["stroke-dasharray"],g);e._.arrows&&("startString"in
e._.arrows&&w(e,e._.arrows.startString),"endString"in e._.arrows&&w(e,e._.arrows.endString,1));break;case "stroke-dasharray":x(e,r,g);break;case "fill":var C=b(r).match(a._ISURL);if(C){var t=n("pattern"),A=n("image");t.id=a.createUUID();n(t,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});n(A,{x:0,y:0,"xlink:href":C[1]});t.appendChild(A);(function(b){a._preload(C[1],function(){var a=this.offsetWidth,c=this.offsetHeight;n(b,{width:a,height:c});n(A,{width:a,height:c});e.paper.safari()})})(t);
e.paper.defs.appendChild(t);n(h,{fill:"url(#"+t.id+")"});e.pattern=t;e.pattern&&p(e);break}o=a.getRGB(r);if(o.error){if(("circle"==e.type||"ellipse"==e.type||"r"!=b(r).charAt())&&q(e,r)){if("opacity"in m||"fill-opacity"in m)if(o=a._g.doc.getElementById(h.getAttribute("fill").replace(/^url\(#|\)$/g,"")))o=o.getElementsByTagName("stop"),n(o[o.length-1],{"stop-opacity":("opacity"in m?m.opacity:1)*("fill-opacity"in m?m["fill-opacity"]:1)});m.gradient=r;m.fill="none";break}}else delete g.gradient,delete m.gradient,
!a.is(m.opacity,"undefined")&&a.is(g.opacity,"undefined")&&n(h,{opacity:m.opacity}),!a.is(m["fill-opacity"],"undefined")&&a.is(g["fill-opacity"],"undefined")&&n(h,{"fill-opacity":m["fill-opacity"]});o.hasOwnProperty("opacity")&&n(h,{"fill-opacity":1<o.opacity?o.opacity/100:o.opacity});case "stroke":o=a.getRGB(r);h.setAttribute(j,o.hex);"stroke"==j&&o.hasOwnProperty("opacity")&&n(h,{"stroke-opacity":1<o.opacity?o.opacity/100:o.opacity});"stroke"==j&&e._.arrows&&("startString"in e._.arrows&&w(e,e._.arrows.startString),
"endString"in e._.arrows&&w(e,e._.arrows.endString,1));break;case "gradient":("circle"==e.type||"ellipse"==e.type||"r"!=b(r).charAt())&&q(e,r);break;case "opacity":m.gradient&&!m.hasOwnProperty("stroke-opacity")&&n(h,{"stroke-opacity":1<r?r/100:r});case "fill-opacity":if(m.gradient){if(o=a._g.doc.getElementById(h.getAttribute("fill").replace(/^url\(#|\)$/g,"")))o=o.getElementsByTagName("stop"),n(o[o.length-1],{"stop-opacity":r});break}default:"font-size"==j&&(r=d(r,10)+"px"),o=j.replace(/(\-.)/g,
function(a){return a.substring(1).toUpperCase()}),h.style[o]=r,e._.dirty=1,h.setAttribute(j,r)}}if(!("text"!=e.type||!g.hasOwnProperty("text")&&!g.hasOwnProperty("font")&&!g.hasOwnProperty("font-size")&&!g.hasOwnProperty("x")&&!g.hasOwnProperty("y"))){j=e.attrs;r=e.node;o=r.firstChild?d(a._g.doc.defaultView.getComputedStyle(r.firstChild,"").getPropertyValue("font-size"),10):10;if(g.hasOwnProperty("text")){for(j.text=g.text;r.firstChild;)r.removeChild(r.firstChild);for(var t=b(g.text).split("\n"),
m=[],y=0,K=t.length;y<K;y++)v=n("tspan"),y&&n(v,{dy:o*s,x:j.x}),v.appendChild(a._g.doc.createTextNode(t[y])),r.appendChild(v),m[y]=v}else{m=r.getElementsByTagName("tspan");y=0;for(K=m.length;y<K;y++)y?n(m[y],{dy:o*s,x:j.x}):n(m[0],{dy:0})}n(r,{x:j.x,y:j.y});e._.dirty=1;r=e._getBBox();(j=j.y-(r.y+r.height/2))&&a.is(j,"finite")&&n(m[0],{dy:j})}h.style.visibility=l},s=1.2,v=function(b,c){this[0]=this.node=b;b.raphael=!0;this.id=a._oid++;b.raphaelid=this.id;this.matrix=a.matrix();this.realPath=null;this.paper=
c;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},o=a.el;v.prototype=o;o.constructor=v;a._engine.path=function(a,b){var c=n("path");b.canvas&&b.canvas.appendChild(c);c=new v(c,b);c.type="path";t(c,{fill:"none",stroke:"#000",path:a});return c};o.rotate=function(a,c,d){if(this.removed)return this;a=b(a).split(i);a.length-1&&(c=e(a[1]),d=e(a[2]));a=e(a[0]);null==d&&(c=d);if(null==
c||null==d)d=this.getBBox(1),c=d.x+d.width/2,d=d.y+d.height/2;this.transform(this._.transform.concat([["r",a,c,d]]));return this};o.scale=function(a,c,d,f){if(this.removed)return this;a=b(a).split(i);a.length-1&&(c=e(a[1]),d=e(a[2]),f=e(a[3]));a=e(a[0]);null==c&&(c=a);null==f&&(d=f);if(null==d||null==f)var g=this.getBBox(1);d=null==d?g.x+g.width/2:d;f=null==f?g.y+g.height/2:f;this.transform(this._.transform.concat([["s",a,c,d,f]]));return this};o.translate=function(a,c){if(this.removed)return this;
a=b(a).split(i);a.length-1&&(c=e(a[1]));a=e(a[0])||0;this.transform(this._.transform.concat([["t",a,+c||0]]));return this};o.transform=function(b){var c=this._;if(null==b)return c.transform;a._extractTransform(this,b);this.clip&&n(this.clip,{transform:this.matrix.invert()});this.pattern&&p(this);this.node&&n(this.node,{transform:this.matrix});if(1!=c.sx||1!=c.sy)b=this.attrs.hasOwnProperty("stroke-width")?this.attrs["stroke-width"]:1,this.attr({"stroke-width":b});return this};o.hide=function(){!this.removed&&
this.paper.safari(this.node.style.display="none");return this};o.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};o.remove=function(){if(!this.removed&&this.node.parentNode){var b=this.paper;b.__set__&&b.__set__.exclude(this);j.unbind("raphael.*.*."+this.id);this.gradient&&b.defs.removeChild(this.gradient);a._tear(this,b);"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);
for(var c in this)this[c]="function"==typeof this[c]?a._removedFactory(c):null;this.removed=!0}};o._getBBox=function(){if("none"==this.node.style.display){this.show();var a=!0}var b={};try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}a&&this.hide();return b};o.attr=function(b,c){if(this.removed)return this;if(null==b){var d={},f;for(f in this.attrs)this.attrs.hasOwnProperty(f)&&(d[f]=this.attrs[f]);d.gradient&&"none"==d.fill&&(d.fill=d.gradient)&&delete d.gradient;d.transform=this._.transform;
return d}if(null==c&&a.is(b,"string")){if("fill"==b&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==b)return this._.transform;f=b.split(i);for(var d={},e=0,g=f.length;e<g;e++)b=f[e],d[b]=b in this.attrs?this.attrs[b]:a.is(this.paper.customAttributes[b],"function")?this.paper.customAttributes[b].def:a._availableAttrs[b];return g-1?d:d[f[0]]}if(null==c&&a.is(b,"array")){d={};e=0;for(g=b.length;e<g;e++)d[b[e]]=this.attr(b[e]);return d}null!=c?(d={},d[b]=c):null!=
b&&a.is(b,"object")&&(d=b);for(e in d)j("raphael.attr."+e+"."+this.id,this,d[e]);for(e in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(e)&&d.hasOwnProperty(e)&&a.is(this.paper.customAttributes[e],"function"))for(g in f=this.paper.customAttributes[e].apply(this,[].concat(d[e])),this.attrs[e]=d[e],f)f.hasOwnProperty(g)&&(d[g]=f[g]);t(this,d);return this};o.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):
this.node.parentNode.appendChild(this.node);var b=this.paper;b.top!=this&&a._tofront(this,b);return this};o.toBack=function(){if(this.removed)return this;var b=this.node.parentNode;"a"==b.tagName.toLowerCase()?b.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):b.firstChild!=this.node&&b.insertBefore(this.node,this.node.parentNode.firstChild);a._toback(this,this.paper);return this};o.insertAfter=function(b){if(this.removed)return this;var c=b.node||b[b.length-
1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);a._insertafter(this,b,this.paper);return this};o.insertBefore=function(b){if(this.removed)return this;var c=b.node||b[0].node;c.parentNode.insertBefore(this.node,c);a._insertbefore(this,b,this.paper);return this};o.blur=function(b){if(0!==+b){var c=n("filter"),d=n("feGaussianBlur");this.attrs.blur=b;c.id=a.createUUID();n(d,{stdDeviation:+b||1.5});c.appendChild(d);this.paper.defs.appendChild(c);
this._blur=c;n(this.node,{filter:"url(#"+c.id+")"})}else this._blur&&(this._blur.parentNode.removeChild(this._blur),delete this._blur,delete this.attrs.blur),this.node.removeAttribute("filter")};a._engine.circle=function(a,b,c,d){var f=n("circle");a.canvas&&a.canvas.appendChild(f);a=new v(f,a);a.attrs={cx:b,cy:c,r:d,fill:"none",stroke:"#000"};a.type="circle";n(f,a.attrs);return a};a._engine.rect=function(a,b,c,d,f,e){var g=n("rect");a.canvas&&a.canvas.appendChild(g);a=new v(g,a);a.attrs={x:b,y:c,
width:d,height:f,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};a.type="rect";n(g,a.attrs);return a};a._engine.ellipse=function(a,b,c,d,f){var e=n("ellipse");a.canvas&&a.canvas.appendChild(e);a=new v(e,a);a.attrs={cx:b,cy:c,rx:d,ry:f,fill:"none",stroke:"#000"};a.type="ellipse";n(e,a.attrs);return a};a._engine.image=function(a,b,c,d,f,e){var g=n("image");n(g,{x:c,y:d,width:f,height:e,preserveAspectRatio:"none"});g.setAttributeNS("http://www.w3.org/1999/xlink","href",b);a.canvas&&a.canvas.appendChild(g);
a=new v(g,a);a.attrs={x:c,y:d,width:f,height:e,src:b};a.type="image";return a};a._engine.text=function(b,c,d,f){var e=n("text");b.canvas&&b.canvas.appendChild(e);b=new v(e,b);b.attrs={x:c,y:d,"text-anchor":"middle",text:f,font:a._availableAttrs.font,stroke:"none",fill:"#000"};b.type="text";t(b,b.attrs);return b};a._engine.setSize=function(a,b){this.width=a||this.width;this.height=b||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);this._viewBox&&
this.setViewBox.apply(this,this._viewBox);return this};a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b&&b.container,d=b.x,f=b.y,e=b.width,b=b.height;if(!c)throw Error("SVG container not found.");var g=n("svg"),h,d=d||0,f=f||0,e=e||512,b=b||342;n(g,{height:b,version:1.1,width:e,xmlns:"http://www.w3.org/2000/svg"});1==c?(g.style.cssText="overflow:hidden;position:absolute;left:"+d+"px;top:"+f+"px",a._g.doc.body.appendChild(g),h=1):(g.style.cssText="overflow:hidden;position:relative",
c.firstChild?c.insertBefore(g,c.firstChild):c.appendChild(g));c=new a._Paper;c.width=e;c.height=b;c.canvas=g;c.clear();c._left=c._top=0;h&&(c.renderfix=function(){});c.renderfix();return c};a._engine.setViewBox=function(a,b,c,d,e){j("raphael.setViewBox",this,this._viewBox,[a,b,c,d,e]);var g=f(c/this.width,d/this.height),h=this.top,i=e?"meet":"xMinYMin",m;null==a?(this._vbSize&&(g=1),delete this._vbSize,m="0 0 "+this.width+" "+this.height):(this._vbSize=g,m=a+" "+b+" "+c+" "+d);for(n(this.canvas,{viewBox:m,
preserveAspectRatio:i});g&&h;)i="stroke-width"in h.attrs?h.attrs["stroke-width"]:1,h.attr({"stroke-width":i}),h._.dirty=1,h._.dirtyT=1,h=h.prev;this._viewBox=[a,b,c,d,!!e];return this};a.prototype.renderfix=function(){var a=this.canvas,b=a.style,c;try{c=a.getScreenCTM()||a.createSVGMatrix()}catch(d){c=a.createSVGMatrix()}a=-c.e%1;c=-c.f%1;if(a||c)if(a&&(this._left=(this._left+a)%1,b.left=this._left+"px"),c)this._top=(this._top+c)%1,b.top=this._top+"px"};a.prototype.clear=function(){a.eve("raphael.clear",
this);for(var b=this.canvas;b.firstChild;)b.removeChild(b.firstChild);this.bottom=this.top=null;(this.desc=n("desc")).appendChild(a._g.doc.createTextNode("Created with Rapha\u00ebl "+a.version));b.appendChild(this.desc);b.appendChild(this.defs=n("defs"))};a.prototype.remove=function(){j("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null};var y=a.st,A;for(A in o)o.hasOwnProperty(A)&&
!y.hasOwnProperty(A)&&(y[A]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(A))}(window.Raphael);
window.Raphael.vml&&function(a){var b=String,e=parseFloat,d=Math,g=d.round,f=d.max,c=d.min,h=d.abs,i=/[, ]+/,j=a.eve,l={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,n=/ progid:\S+Blur\([^\)]+\)/g,q=/-?[^,\s-]+/g,p={path:1,rect:1,image:1},w={circle:1,ellipse:1},r=function(b,c,d){var f=a.matrix();f.rotate(-b,0.5,0.5);return{dx:f.x(c,d),dy:f.y(c,d)}},x=function(a,b,c,d,f,e){var g=a._,i=a.matrix,m=g.fillpos,a=a.node,l=a.style,j=1,n="",p=21600/b,q=21600/c;l.visibility="hidden";
if(b&&c){a.coordsize=h(p)+" "+h(q);l.rotation=e*(0>b*c?-1:1);e&&(f=r(e,d,f),d=f.dx,f=f.dy);0>b&&(n+="x");0>c&&(n+=" y")&&(j=-1);l.flip=n;a.coordorigin=d*-p+" "+f*-q;if(m||g.fillsize)d=(d=a.getElementsByTagName("fill"))&&d[0],a.removeChild(d),m&&(f=r(e,i.x(m[0],m[1]),i.y(m[0],m[1])),d.position=f.dx*j+" "+f.dy*j),g.fillsize&&(d.size=g.fillsize[0]*h(b)+" "+g.fillsize[1]*h(c)),a.appendChild(d);l.visibility="visible"}};a.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+
this.version};var t=function(a,c,d){for(var c=b(c).toLowerCase().split("-"),d=d?"end":"start",f=c.length,e="classic",g="medium",h="medium";f--;)switch(c[f]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":e=c[f];break;case "wide":case "narrow":h=c[f];break;case "long":case "short":g=c[f]}a=a.node.getElementsByTagName("stroke")[0];a[d+"arrow"]=e;a[d+"arrowlength"]=g;a[d+"arrowwidth"]=h},s=function(h,j){h.attrs=h.attrs||{};var k=h.node,n=h.attrs,r=k.style,s=p[h.type]&&
(j.x!=n.x||j.y!=n.y||j.width!=n.width||j.height!=n.height||j.cx!=n.cx||j.cy!=n.cy||j.rx!=n.rx||j.ry!=n.ry||j.r!=n.r),o=w[h.type]&&(n.cx!=j.cx||n.cy!=j.cy||n.r!=j.r||n.rx!=j.rx||n.ry!=j.ry),v;for(v in j)j.hasOwnProperty(v)&&(n[v]=j[v]);s&&(n.path=a._getPath[h.type](h),h._.dirty=1);j.href&&(k.href=j.href);j.title&&(k.title=j.title);j.target&&(k.target=j.target);j.cursor&&(r.cursor=j.cursor);"blur"in j&&h.blur(j.blur);if(j.path&&"path"==h.type||s){r=~b(n.path).toLowerCase().indexOf("r")?a._pathToAbsolute(n.path):
n.path;s=/[ahqstv]/ig;v=a._pathToAbsolute;b(r).match(s)&&(v=a._path2curve);s=/[clmz]/g;if(v==a._pathToAbsolute&&!b(r).match(s))r=b(r).replace(m,function(a,b,c){var d=[],f=b.toLowerCase()=="m",e=l[b];c.replace(q,function(a){if(f&&d.length==2){e=e+(d+l[b=="m"?"l":"L"]);d=[]}d.push(g(a*21600))});return e+d});else{for(var s=v(r),A,r=[],C=0,W=s.length;C<W;C++){v=s[C];A=s[C][0].toLowerCase();"z"==A&&(A="x");for(var T=1,B=v.length;T<B;T++)A+=g(21600*v[T])+(T!=B-1?",":"");r.push(A)}r=r.join(" ")}k.path=r;
"image"==h.type&&(h._.fillpos=[n.x,n.y],h._.fillsize=[n.width,n.height],x(h,1,1,0,0,0))}"transform"in j&&h.transform(j.transform);o&&(o=+n.cx,r=+n.cy,s=+n.rx||+n.r||0,v=+n.ry||+n.r||0,k.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",g(21600*(o-s)),g(21600*(r-v)),g(21600*(o+s)),g(21600*(r+v)),g(21600*o)));if("clip-rect"in j&&(o=b(j["clip-rect"]).split(i),4==o.length&&(o[2]=+o[2]+ +o[0],o[3]=+o[3]+ +o[1],r=k.clipRect||a._g.doc.createElement("div"),s=r.style,s.clip=a.format("rect({1}px {2}px {3}px {0}px)",
o),k.clipRect||(s.position="absolute",s.top=0,s.left=0,s.width=h.paper.width+"px",s.height=h.paper.height+"px",k.parentNode.insertBefore(r,k),r.appendChild(k),k.clipRect=r)),!j["clip-rect"]))k.clipRect&&(k.clipRect.style.clip="auto");h.textpath&&(o=h.textpath.style,j.font&&(o.font=j.font),j["font-family"]&&(o.fontFamily='"'+j["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"'),j["font-size"]&&(o.fontSize=j["font-size"]),j["font-weight"]&&(o.fontWeight=j["font-weight"]),j["font-style"]&&
(o.fontStyle=j["font-style"]));"arrow-start"in j&&t(h,j["arrow-start"]);"arrow-end"in j&&t(h,j["arrow-end"],1);if(null!=j.opacity||null!=j["stroke-width"]||null!=j.fill||null!=j.src||null!=j.stroke||null!=j["stroke-width"]||null!=j["stroke-opacity"]||null!=j["fill-opacity"]||null!=j["stroke-dasharray"]||null!=j["stroke-miterlimit"]||null!=j["stroke-linejoin"]||null!=j["stroke-linecap"]){o=(o=k.getElementsByTagName("fill"))&&o[0];!o&&(o=y("fill"));"image"==h.type&&j.src&&(o.src=j.src);j.fill&&(o.on=
!0);if(null==o.on||"none"==j.fill||null===j.fill)o.on=!1;if(o.on&&j.fill)if(r=b(j.fill).match(a._ISURL)){o.parentNode==k&&k.removeChild(o);o.rotate=!0;o.src=r[1];o.type="tile";var H=h.getBBox(1);o.position=H.x+" "+H.y;h._.fillpos=[H.x,H.y];a._preload(r[1],function(){h._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{o.color=a.getRGB(j.fill).hex;o.src="";o.type="solid";if(r=a.getRGB(j.fill).error)if(r=h.type in{circle:1,ellipse:1}||"r"!=b(j.fill).charAt())a:{r=h;v=j.fill;s=o;r.attrs=r.attrs||
{};var U=Math.pow,la="linear",N=".5 .5";r.attrs.gradient=v;v=b(v).replace(a._radial_gradient,function(a,b,c){la="radial";if(b&&c){b=e(b);c=e(c);U(b-0.5,2)+U(c-0.5,2)>0.25&&(c=d.sqrt(0.25-U(b-0.5,2))*((c>0.5)*2-1)+0.5);N=b+" "+c}return""});v=v.split(/\s*\-\s*/);if("linear"==la&&(H=v.shift(),H=-e(H),isNaN(H))){r=null;break a}if(v=a._parseDots(v)){r=r.shape||r.node;if(v.length){r.removeChild(s);s.on=!0;s.method="none";s.color=v[0].color;s.color2=v[v.length-1].color;A=[];C=0;for(W=v.length;C<W;C++)v[C].offset&&
A.push(v[C].offset+" "+v[C].color);s.colors=A.length?A.join():"0% "+s.color;"radial"==la?(s.type="gradientTitle",s.focus="100%",s.focussize="0 0",s.focusposition=N,s.angle=0):(s.type="gradient",s.angle=(270-H)%360);r.appendChild(s)}r=1}else r=null}r&&(n.fill="none",n.gradient=j.fill,o.rotate=!1)}if("fill-opacity"in j||"opacity"in j)r=((+n["fill-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+a.getRGB(j.fill).o+1||2)-1),r=c(f(r,0),1),o.opacity=r,o.src&&(o.color="none");k.appendChild(o);H=k.getElementsByTagName("stroke")&&
k.getElementsByTagName("stroke")[0];o=!1;!H&&(o=H=y("stroke"));if(j.stroke&&"none"!=j.stroke||j["stroke-width"]||null!=j["stroke-opacity"]||j["stroke-dasharray"]||j["stroke-miterlimit"]||j["stroke-linejoin"]||j["stroke-linecap"])H.on=!0;("none"==j.stroke||null===j.stroke||null==H.on||0==j.stroke||0==j["stroke-width"])&&(H.on=!1);r=a.getRGB(j.stroke);H.on&&j.stroke&&(H.color=r.hex);r=((+n["stroke-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+r.o+1||2)-1);s=0.75*(e(j["stroke-width"])||1);r=c(f(r,0),1);
null==j["stroke-width"]&&(s=n["stroke-width"]);j["stroke-width"]&&(H.weight=s);s&&1>s&&(r*=s)&&(H.weight=1);H.opacity=r;j["stroke-linejoin"]&&(H.joinstyle=j["stroke-linejoin"]||"miter");H.miterlimit=j["stroke-miterlimit"]||8;j["stroke-linecap"]&&(H.endcap="butt"==j["stroke-linecap"]?"flat":"square"==j["stroke-linecap"]?"square":"round");j["stroke-dasharray"]&&(r={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot",
"--..":"longdashdotdot"},H.dashstyle=r.hasOwnProperty(j["stroke-dasharray"])?r[j["stroke-dasharray"]]:"");o&&k.appendChild(H)}if("text"==h.type){h.paper.canvas.style.display="";k=h.paper.span;H=n.font&&n.font.match(/\d+(?:\.\d*)?(?=px)/);r=k.style;n.font&&(r.font=n.font);n["font-family"]&&(r.fontFamily=n["font-family"]);n["font-weight"]&&(r.fontWeight=n["font-weight"]);n["font-style"]&&(r.fontStyle=n["font-style"]);H=e(n["font-size"]||H&&H[0])||10;r.fontSize=100*H+"px";h.textpath.string&&(k.innerHTML=
b(h.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));k=k.getBoundingClientRect();h.W=n.w=(k.right-k.left)/100;h.H=n.h=(k.bottom-k.top)/100;h.X=n.x;h.Y=n.y+h.H/2;("x"in j||"y"in j)&&(h.path.v=a.format("m{0},{1}l{2},{1}",g(21600*n.x),g(21600*n.y),g(21600*n.x)+1));k="x y text font font-family font-weight font-style font-size".split(" ");H=0;for(o=k.length;H<o;H++)if(k[H]in j){h._.dirty=1;break}switch(n["text-anchor"]){case "start":h.textpath.style["v-text-align"]="left";
h.bbx=h.W/2;break;case "end":h.textpath.style["v-text-align"]="right";h.bbx=-h.W/2;break;default:h.textpath.style["v-text-align"]="center",h.bbx=0}h.textpath.style["v-text-kern"]=!0}},v=function(b,c){this[0]=this.node=b;b.raphael=!0;this.id=a._oid++;b.raphaelid=this.id;this.Y=this.X=0;this.attrs={};this.paper=c;this.matrix=a.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},o=a.el;v.prototype=
o;o.constructor=v;o.transform=function(c){if(null==c)return this._.transform;var d=this.paper._viewBoxShift,f=d?"s"+[d.scale,d.scale]+"-1-1t"+[d.dx,d.dy]:"",e;d&&(e=c=b(c).replace(/\.{3}|\u2026/g,this._.transform||""));a._extractTransform(this,f+c);var d=this.matrix.clone(),g=this.skew,c=this.node,f=~b(this.attrs.fill).indexOf("-"),h=!b(this.attrs.fill).indexOf("url(");d.translate(-0.5,-0.5);h||f||"image"==this.type?(g.matrix="1 0 0 1",g.offset="0 0",g=d.split(),f&&g.noRotation||!g.isSimple?(c.style.filter=
d.toFilter(),f=this.getBBox(),g=this.getBBox(1),d=f.x-g.x,f=f.y-g.y,c.coordorigin=-21600*d+" "+-21600*f,x(this,1,1,d,f,0)):(c.style.filter="",x(this,g.scalex,g.scaley,g.dx,g.dy,g.rotate))):(c.style.filter="",g.matrix=b(d),g.offset=d.offset());e&&(this._.transform=e);return this};o.rotate=function(a,c,d){if(this.removed)return this;if(null!=a){a=b(a).split(i);a.length-1&&(c=e(a[1]),d=e(a[2]));a=e(a[0]);null==d&&(c=d);if(null==c||null==d)d=this.getBBox(1),c=d.x+d.width/2,d=d.y+d.height/2;this._.dirtyT=
1;this.transform(this._.transform.concat([["r",a,c,d]]));return this}};o.translate=function(a,c){if(this.removed)return this;a=b(a).split(i);a.length-1&&(c=e(a[1]));a=e(a[0])||0;c=+c||0;this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=c);this.transform(this._.transform.concat([["t",a,c]]));return this};o.scale=function(a,c,d,f){if(this.removed)return this;a=b(a).split(i);a.length-1&&(c=e(a[1]),d=e(a[2]),f=e(a[3]),isNaN(d)&&(d=null),isNaN(f)&&(f=null));a=e(a[0]);null==c&&(c=a);null==f&&(d=f);if(null==
d||null==f)var g=this.getBBox(1);d=null==d?g.x+g.width/2:d;f=null==f?g.y+g.height/2:f;this.transform(this._.transform.concat([["s",a,c,d,f]]));this._.dirtyT=1;return this};o.hide=function(){!this.removed&&(this.node.style.display="none");return this};o.show=function(){!this.removed&&(this.node.style.display="");return this};o._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};o.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&
this.paper.__set__.exclude(this);a.eve.unbind("raphael.*.*."+this.id);a._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null;this.removed=!0}};o.attr=function(b,c){if(this.removed)return this;if(null==b){var d={},f;for(f in this.attrs)this.attrs.hasOwnProperty(f)&&(d[f]=this.attrs[f]);d.gradient&&"none"==d.fill&&(d.fill=d.gradient)&&delete d.gradient;
d.transform=this._.transform;return d}if(null==c&&a.is(b,"string")){if("fill"==b&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;f=b.split(i);for(var d={},e=0,g=f.length;e<g;e++)b=f[e],d[b]=b in this.attrs?this.attrs[b]:a.is(this.paper.customAttributes[b],"function")?this.paper.customAttributes[b].def:a._availableAttrs[b];return g-1?d:d[f[0]]}if(this.attrs&&null==c&&a.is(b,"array")){d={};e=0;for(g=b.length;e<g;e++)d[b[e]]=this.attr(b[e]);return d}null!=c&&(d={},d[b]=c);null==
c&&a.is(b,"object")&&(d=b);for(e in d)j("raphael.attr."+e+"."+this.id,this,d[e]);if(d){for(e in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(e)&&d.hasOwnProperty(e)&&a.is(this.paper.customAttributes[e],"function"))for(g in f=this.paper.customAttributes[e].apply(this,[].concat(d[e])),this.attrs[e]=d[e],f)f.hasOwnProperty(g)&&(d[g]=f[g]);d.text&&"text"==this.type&&(this.textpath.string=d.text);s(this,d)}return this};o.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);
this.paper&&this.paper.top!=this&&a._tofront(this,this.paper);return this};o.toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper));return this};o.insertAfter=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[b.length-1]);b.node.nextSibling?b.node.parentNode.insertBefore(this.node,b.node.nextSibling):b.node.parentNode.appendChild(this.node);
a._insertafter(this,b,this.paper);return this};o.insertBefore=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[0]);b.node.parentNode.insertBefore(this.node,b.node);a._insertbefore(this,b,this.paper);return this};o.blur=function(b){var c=this.node.runtimeStyle,d=c.filter,d=d.replace(n,"");0!==+b?(this.attrs.blur=b,c.filter=d+"  progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+b||1.5)+")",c.margin=a.format("-{0}px 0 0 -{0}px",g(+b||1.5))):(c.filter=d,c.margin=0,delete this.attrs.blur)};
a._engine.path=function(a,b){var c=y("shape");c.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px";c.coordsize="21600 21600";c.coordorigin=b.coordorigin;var d=new v(c,b),f={fill:"none",stroke:"#000"};a&&(f.path=a);d.type="path";d.path=[];d.Path="";s(d,f);b.canvas.appendChild(c);f=y("skew");f.on=!0;c.appendChild(f);d.skew=f;d.transform("");return d};a._engine.rect=function(b,c,d,f,e,g){var h=a._rectPath(c,d,f,e,g),b=b.path(h),i=b.attrs;b.X=i.x=c;b.Y=i.y=d;b.W=i.width=f;b.H=i.height=
e;i.r=g;i.path=h;b.type="rect";return b};a._engine.ellipse=function(a,b,c,d,f){a=a.path();a.X=b-d;a.Y=c-f;a.W=2*d;a.H=2*f;a.type="ellipse";s(a,{cx:b,cy:c,rx:d,ry:f});return a};a._engine.circle=function(a,b,c,d){a=a.path();a.X=b-d;a.Y=c-d;a.W=a.H=2*d;a.type="circle";s(a,{cx:b,cy:c,r:d});return a};a._engine.image=function(b,c,d,f,e,g){var h=a._rectPath(d,f,e,g),b=b.path(h).attr({stroke:"none"}),i=b.attrs,m=b.node,j=m.getElementsByTagName("fill")[0];i.src=c;b.X=i.x=d;b.Y=i.y=f;b.W=i.width=e;b.H=i.height=
g;i.path=h;b.type="image";j.parentNode==m&&m.removeChild(j);j.rotate=!0;j.src=c;j.type="tile";b._.fillpos=[d,f];b._.fillsize=[e,g];m.appendChild(j);x(b,1,1,0,0,0);return b};a._engine.text=function(c,d,f,e){var h=y("shape"),i=y("path"),m=y("textpath"),d=d||0,f=f||0,e=e||"";i.v=a.format("m{0},{1}l{2},{1}",g(21600*d),g(21600*f),g(21600*d)+1);i.textpathok=!0;m.string=b(e);m.on=!0;h.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px";h.coordsize="21600 21600";h.coordorigin="0 0";var j=
new v(h,c),l={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:e};j.shape=h;j.path=i;j.textpath=m;j.type="text";j.attrs.text=b(e);j.attrs.x=d;j.attrs.y=f;j.attrs.w=1;j.attrs.h=1;s(j,l);h.appendChild(m);h.appendChild(i);c.canvas.appendChild(h);c=y("skew");c.on=!0;h.appendChild(c);j.skew=c;j.transform("");return j};a._engine.setSize=function(b,c){var d=this.canvas.style;this.width=b;this.height=c;b==+b&&(b+="px");c==+c&&(c+="px");d.width=b;d.height=c;d.clip="rect(0 "+b+" "+c+" 0)";this._viewBox&&
a._engine.setViewBox.apply(this,this._viewBox);return this};a._engine.setViewBox=function(b,c,d,e,g){a.eve("raphael.setViewBox",this,this._viewBox,[b,c,d,e,g]);var h=this.width,i=this.height,m=1/f(d/h,e/i),j,l;g&&(j=i/e,l=h/d,d*j<h&&(b-=(h-d*j)/2/j),e*l<i&&(c-=(i-e*l)/2/l));this._viewBox=[b,c,d,e,!!g];this._viewBoxShift={dx:-b,dy:-c,scale:m};this.forEach(function(a){a.transform("...")});return this};var y;a._engine.initWin=function(a){var b=a.document;b.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");
try{!b.namespaces.rvml&&b.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),y=function(a){return b.createElement("<rvml:"+a+' class="rvml">')}}catch(c){y=function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};a._engine.initWin(a._g.win);a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b.container,d=b.height,f=b.width,e=b.x,b=b.y;if(!c)throw Error("VML container not found.");var g=new a._Paper,h=g.canvas=a._g.doc.createElement("div"),
i=h.style,e=e||0,b=b||0,f=f||512,d=d||342;g.width=f;g.height=d;f==+f&&(f+="px");d==+d&&(d+="px");g.coordsize="21600000 21600000";g.coordorigin="0 0";g.span=a._g.doc.createElement("span");g.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";h.appendChild(g.span);i.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d);1==c?(a._g.doc.body.appendChild(h),i.left=e+"px",i.top=
b+"px",i.position="absolute"):c.firstChild?c.insertBefore(h,c.firstChild):c.appendChild(h);g.renderfix=function(){};return g};a.prototype.clear=function(){a.eve("raphael.clear",this);this.canvas.innerHTML="";this.span=a._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};a.prototype.remove=function(){a.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);
for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null;return!0};var A=a.st,B;for(B in o)o.hasOwnProperty(B)&&!A.hasOwnProperty(B)&&(A[B]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(B))}(window.Raphael);
(function(a,b){function e(b){return!a(b).parents().andSelf().filter(function(){return"hidden"===a.curCSS(this,"visibility")||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,e){return"number"===typeof b?this.each(function(){var f=this;setTimeout(function(){a(f).focus();e&&e.call(f)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;b=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,
"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(d){if(d!==b)return this.css("zIndex",d);if(this.length)for(var d=a(this[0]),e;d.length&&d[0]!==document;){e=d.css("position");if("absolute"===
e||"relative"===e||"fixed"===e)if(e=parseInt(d.css("zIndex"),10),!isNaN(e)&&0!==e)return e;d=d.parent()}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(d,e){function f(b,d,f,e){a.each(c,function(){d-=parseFloat(a.curCSS(b,"padding"+this,!0))||0;f&&(d-=parseFloat(a.curCSS(b,"border"+
this+"Width",!0))||0);e&&(d-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)});return d}var c="Width"===e?["Left","Right"]:["Top","Bottom"],h=e.toLowerCase(),i={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+e]=function(c){return c===b?i["inner"+e].call(this):this.each(function(){a(this).css(h,f(this,c)+"px")})};a.fn["outer"+e]=function(b,c){return"number"!==typeof b?i["outer"+e].call(this,b):this.each(function(){a(this).css(h,
f(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,e,f){return!!a.data(b,f[3])},focusable:function(b){var g=b.nodeName.toLowerCase(),f=a.attr(b,"tabindex");if("area"===g){g=b.parentNode;f=g.name;if(!b.href||!f||"map"!==g.nodeName.toLowerCase())return!1;b=a("img[usemap=#"+f+"]")[0];return!!b&&e(b)}return(/input|select|textarea|button|object/.test(g)?!b.disabled:"a"==g?b.href||!isNaN(f):!isNaN(f))&&e(b)},tabbable:function(b){var e=a.attr(b,"tabindex");return(isNaN(e)||0<=e)&&a(b).is(":focusable")}}),
a(function(){var b=document.body,e=b.appendChild(e=document.createElement("div"));a.extend(e.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=100===e.offsetHeight;a.support.selectstart="onselectstart"in e;b.removeChild(e).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,e,f){var b=a.ui[b].prototype,c;for(c in f)b.plugins[c]=b.plugins[c]||[],b.plugins[c].push([e,f[c]])},call:function(a,b,f){if((b=a.plugins[b])&&a.element[0].parentNode)for(var c=0;c<b.length;c++)a.options[b[c][0]]&&
b[c][1].apply(a.element,f)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,e){if("hidden"===a(b).css("overflow"))return!1;var f=e&&"left"===e?"scrollLeft":"scrollTop",c=!1;if(0<b[f])return!0;b[f]=1;c=0<b[f];b[f]=0;return c},isOverAxis:function(a,b,f){return a>b&&a<b+f},isOver:function(b,e,f,c,h,i){return a.ui.isOverAxis(b,f,h)&&a.ui.isOverAxis(e,c,i)}}))})(jQuery);
(function(a,b){if(a.cleanData){var e=a.cleanData;a.cleanData=function(b){for(var d=0,c;null!=(c=b[d]);d++)a(c).triggerHandler("remove");e(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,f){return this.each(function(){f||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")});return d.call(a(this),b,f)})}}a.widget=function(b,d,c){var e=b.split(".")[0],i,b=b.split(".")[1];i=e+"-"+b;c||(c=d,d=a.Widget);a.expr[":"][i]=function(c){return!!a.data(c,
b)};a[e]=a[e]||{};a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};d=new d;d.options=a.extend(!0,{},d.options);a[e][b].prototype=a.extend(!0,d,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:i},c);a.widget.bridge(b,a[e][b])};a.widget.bridge=function(d,f){a.fn[d]=function(c){var e="string"===typeof c,i=Array.prototype.slice.call(arguments,1),j=this,c=!e&&i.length?a.extend.apply(null,[!0,c].concat(i)):c;if(e&&"_"===c.charAt(0))return j;
e?this.each(function(){var f=a.data(this,d),e=f&&a.isFunction(f[c])?f[c].apply(f,i):f;if(e!==f&&e!==b)return j=e,!1}):this.each(function(){var b=a.data(this,d);b?b.option(c||{})._init():a.data(this,d,new f(c,this))});return j}};a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,d){a.data(d,this.widgetName,this);this.element=a(d);this.options=a.extend(!0,{},this.options,this._getCreateOptions(),
b);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},
option:function(d,f){var c=d;if(0===arguments.length)return a.extend({},this.options);if("string"===typeof d){if(f===b)return this.options[d];c={};c[d]=f}this._setOptions(c);return this},_setOptions:function(b){var d=this;a.each(b,function(a,b){d._setOption(a,b)});return this},_setOption:function(a,b){this.options[a]=b;"disabled"===a&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",b);return this},enable:function(){return this._setOption("disabled",
!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,d,c){var e=this.options[b],d=a.Event(d);d.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();c=c||{};if(d.originalEvent)for(var b=a.event.props.length,i;b;)i=a.event.props[--b],d[i]=d.originalEvent[i];this.element.trigger(d,c);return!(a.isFunction(e)&&!1===e.call(this.element[0],d,c)||d.isDefaultPrevented())}}})(jQuery);
(function(a){a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(e){if(!0===a.data(e.target,b.widgetName+".preventClickEvent"))return a.removeData(e.target,b.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){b.originalEvent=
b.originalEvent||{};if(!b.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(b);this._mouseDownEvent=b;var e=this,d=1==b.which,g="string"==typeof this.options.cancel?a(b.target).parents().add(b.target).filter(this.options.cancel).length:!1;if(!d||g||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=
!1!==this._mouseStart(b),!this._mouseStarted))return b.preventDefault(),!0;!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(a){return e._mouseMove(a)};this._mouseUpDelegate=function(a){return e._mouseUp(a)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);b.preventDefault();return b.originalEvent.mouseHandled=!0}},_mouseMove:function(b){if(a.browser.msie&&
!(9<=document.documentMode)&&!b.button)return this._mouseUp(b);if(this._mouseStarted)return this._mouseDrag(b),b.preventDefault();this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b))?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=
!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var e=this.options;if(this.helper||e.disabled||a(b.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(b);return!this.handle?!1:!0},_mouseStart:function(b){var e=this.options;this.helper=this._createHelper(b);this._cacheHelperProportions();a.ui.ddmanager&&(a.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:b.pageX-
this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt);e.containment&&this._setContainment();if(!1===this._trigger("start",b))return this._clear(),!1;this._cacheHelperProportions();a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b);this.helper.addClass("ui-draggable-dragging");
this._mouseDrag(b,!0);return!0},_mouseDrag:function(b,e){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!e){var d=this._uiHash();if(!1===this._trigger("drag",b,d))return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);return!1},
_mouseStop:function(b){var e=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(e=a.ui.ddmanager.drop(this,b));this.dropped&&(e=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&"original"==this.options.helper)return!1;if("invalid"==this.options.revert&&!e||"valid"==this.options.revert&&e||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,e)){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,
10),function(){d._trigger("stop",b)!==false&&d._clear()})}else!1!==this._trigger("stop",b)&&this._clear();return!1},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var e=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(e=!0)});return e},_createHelper:function(b){var e=this.options,b=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],
[b])):"clone"==e.helper?this.element.clone():this.element;b.parents("body").length||b.appendTo("parent"==e.appendTo?this.element[0].parentNode:e.appendTo);b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-
b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==
document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),
10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&
(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=[("document"==b.containment?0:a(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,("document"==b.containment?0:a(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,("document"==b.containment?0:a(window).scrollLeft())+a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==b.containment?0:a(window).scrollTop())+
(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var e=a(b.containment)[0];if(e){var b=a(b.containment).offset(),d="hidden"!=a(e).css("overflow");this.containment=[b.left+(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0),b.top+(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),
10)||0),b.left+(d?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,b.top+(d?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom]}}else b.containment.constructor==Array&&(this.containment=
b.containment)},_convertPositionTo:function(b,e){e||(e=this.position);var d="absolute"==b?1:-1,g="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(g[0].tagName);return{top:e.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:g.scrollTop())*
d),left:e.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:g.scrollLeft())*d)}},_generatePosition:function(b){var e=this.options,d="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(d[0].tagName),f=b.pageX,c=b.pageY;if(this.originalPosition&&
(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(c=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(c=this.containment[3]+this.offset.click.top)),e.grid))c=this.originalPageY+Math.round((c-this.originalPageY)/e.grid[1])*e.grid[1],c=this.containment?
!(c-this.offset.click.top<this.containment[1]||c-this.offset.click.top>this.containment[3])?c:!(c-this.offset.click.top<this.containment[1])?c-e.grid[1]:c+e.grid[1]:c,f=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?!(f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2])?f:!(f-this.offset.click.left<this.containment[0])?f-e.grid[0]:f+e.grid[0]:f;return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+
(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():g?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():g?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&
this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,e,d){d=d||this._uiHash();a.ui.plugin.call(this,b,[e,d]);"drag"==b&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,b,e,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.11"});a.ui.plugin.add("draggable","connectToSortable",{start:function(b,
e){var d=a(this).data("draggable"),g=d.options,f=a.extend({},e,{item:d.element});d.sortables=[];a(g.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,e){var d=a(this).data("draggable"),g=a.extend({},e,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=
!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"==d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,g))})},drag:function(b,e){var d=a(this).data("draggable"),g=this;a.each(d.sortables,function(){this.instance.positionAbs=d.positionAbs;this.instance.helperProportions=d.helperProportions;this.instance.offset.click=
d.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(g).clone().appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return e.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=
d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",
b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),e=a(this).data("draggable").options;b.css("cursor")&&(e._cursor=b.css("cursor"));b.css("cursor",e.cursor)},stop:function(){var b=a(this).data("draggable").options;
b._cursor&&a("body").css("cursor",b._cursor)}});a.ui.plugin.add("draggable","iframeFix",{start:function(){var b=a(this).data("draggable").options;a(!0===b.iframeFix?"iframe":b.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")})},stop:function(){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});
a.ui.plugin.add("draggable","opacity",{start:function(b,e){var d=a(e.helper),g=a(this).data("draggable").options;d.css("opacity")&&(g._opacity=d.css("opacity"));d.css("opacity",g.opacity)},stop:function(b,e){var d=a(this).data("draggable").options;d._opacity&&a(e.helper).css("opacity",d._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");b.scrollParent[0]!=document&&"HTML"!=b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var e=
a(this).data("draggable"),d=e.options,g=!1;if(e.scrollParent[0]!=document&&"HTML"!=e.scrollParent[0].tagName){if(!d.axis||"x"!=d.axis)e.overflowOffset.top+e.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?e.scrollParent[0].scrollTop=g=e.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-e.overflowOffset.top<d.scrollSensitivity&&(e.scrollParent[0].scrollTop=g=e.scrollParent[0].scrollTop-d.scrollSpeed);if(!d.axis||"y"!=d.axis)e.overflowOffset.left+e.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?
e.scrollParent[0].scrollLeft=g=e.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-e.overflowOffset.left<d.scrollSensitivity&&(e.scrollParent[0].scrollLeft=g=e.scrollParent[0].scrollLeft-d.scrollSpeed)}else{if(!d.axis||"x"!=d.axis)b.pageY-a(document).scrollTop()<d.scrollSensitivity?g=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(g=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed));if(!d.axis||"y"!=
d.axis)b.pageX-a(document).scrollLeft()<d.scrollSensitivity?g=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(g=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed))}!1!==g&&(a.ui.ddmanager&&!d.dropBehaviour)&&a.ui.ddmanager.prepareOffsets(e,b)}});a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("draggable"),e=b.options;b.snapElements=[];a(e.snap.constructor!=String?e.snap.items||
":data(draggable)":e.snap).each(function(){var d=a(this),e=d.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:d.outerWidth(),height:d.outerHeight(),top:e.top,left:e.left})})},drag:function(b,e){for(var d=a(this).data("draggable"),g=d.options,f=g.snapTolerance,c=e.offset.left,h=c+d.helperProportions.width,i=e.offset.top,j=i+d.helperProportions.height,l=d.snapElements.length-1;0<=l;l--){var m=d.snapElements[l].left,n=m+d.snapElements[l].width,q=d.snapElements[l].top,p=q+d.snapElements[l].height;
if(m-f<c&&c<n+f&&q-f<i&&i<p+f||m-f<c&&c<n+f&&q-f<j&&j<p+f||m-f<h&&h<n+f&&q-f<i&&i<p+f||m-f<h&&h<n+f&&q-f<j&&j<p+f){if("inner"!=g.snapMode){var w=Math.abs(q-j)<=f,r=Math.abs(p-i)<=f,x=Math.abs(m-h)<=f,t=Math.abs(n-c)<=f;w&&(e.position.top=d._convertPositionTo("relative",{top:q-d.helperProportions.height,left:0}).top-d.margins.top);r&&(e.position.top=d._convertPositionTo("relative",{top:p,left:0}).top-d.margins.top);x&&(e.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-
d.margins.left);t&&(e.position.left=d._convertPositionTo("relative",{top:0,left:n}).left-d.margins.left)}var s=w||r||x||t;if("outer"!=g.snapMode&&(w=Math.abs(q-i)<=f,r=Math.abs(p-j)<=f,x=Math.abs(m-c)<=f,t=Math.abs(n-h)<=f,w&&(e.position.top=d._convertPositionTo("relative",{top:q,left:0}).top-d.margins.top),r&&(e.position.top=d._convertPositionTo("relative",{top:p-d.helperProportions.height,left:0}).top-d.margins.top),x&&(e.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left),
t))e.position.left=d._convertPositionTo("relative",{top:0,left:n-d.helperProportions.width}).left-d.margins.left;!d.snapElements[l].snapping&&(w||r||x||t||s)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[l].item}));d.snapElements[l].snapping=w||r||x||t||s}else d.snapElements[l].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[l].item})),d.snapElements[l].snapping=!1}}});
a.ui.plugin.add("draggable","stack",{start:function(){var b=a(this).data("draggable").options,b=a.makeArray(a(b.stack)).sort(function(b,e){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(e).css("zIndex"),10)||0)});if(b.length){var e=parseInt(b[0].style.zIndex)||0;a(b).each(function(a){this.style.zIndex=e+a});this[0].style.zIndex=e+b.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(b,e){var d=a(e.helper),g=a(this).data("draggable").options;d.css("zIndex")&&(g._zIndex=d.css("zIndex"));
d.css("zIndex",g.zIndex)},stop:function(b,e){var d=a(this).data("draggable").options;d._zIndex&&a(e.helper).css("zIndex",d._zIndex)}})})(jQuery);
(function(a){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=
this.items.length?/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData("sortable-item");return this},_setOption:function(b,e){"disabled"===b?(this.options[b]=e,this.widget()[e?
"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,e){if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(b);var d=null,g=this;a(b.target).parents().each(function(){if(a.data(this,"sortable-item")==g)return d=a(this),!1});a.data(b.target,"sortable-item")==g&&(d=a(b.target));if(!d)return!1;if(this.options.handle&&!e){var f=!1;a(this.options.handle,d).find("*").andSelf().each(function(){this==
b.target&&(f=!0)});if(!f)return!1}this.currentItem=d;this._removeCurrentsFromItems();return!0},_mouseStart:function(b,e,d){e=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(b);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=
this.helper.css("position");a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();
e.containment&&this._setContainment();e.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",e.cursor));e.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",e.opacity));e.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",e.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());
this._trigger("start",b,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(d=this.containers.length-1;0<=d;d--)this.containers[d]._trigger("activate",b,this._uiHash(this));a.ui.ddmanager&&(a.ui.ddmanager.current=this);a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(b);return!0},_mouseDrag:function(b){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");
this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var e=this.options,d=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-this.overflowOffset.top<e.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-e.scrollSpeed),this.overflowOffset.left+
this.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity)?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-this.overflowOffset.left<e.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-e.scrollSpeed):(b.pageY-a(document).scrollTop()<e.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+
e.scrollSpeed)),b.pageX-a(document).scrollLeft()<e.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed)));!1!==d&&(a.ui.ddmanager&&!e.dropBehaviour)&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+
"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(e=this.items.length-1;0<=e;e--){var d=this.items[e],g=d.item[0],f=this._intersectsWithPointer(d);if(f&&g!=this.currentItem[0]&&this.placeholder[1==f?"next":"prev"]()[0]!=g&&!a.ui.contains(this.placeholder[0],g)&&("semi-dynamic"==this.options.type?!a.ui.contains(this.element[0],g):1)){this.direction=1==f?"down":"up";if("pointer"==this.options.tolerance||this._intersectsWithSides(d))this._rearrange(b,
d);else break;this._trigger("change",b,this._uiHash());break}}this._contactContainers(b);a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);this._trigger("sort",b,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(b,e){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,g=d.placeholder.offset();d.reverting=!0;a(this.helper).animate({left:g.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?
0:this.offsetParent[0].scrollLeft),top:g.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,e);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;0<=b;b--)this.containers[b]._trigger("deactivate",
null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&(this.helper&&this.helper[0].parentNode)&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):
a(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(b){var e=this._getItemsAsjQuery(b&&b.connected),d=[],b=b||{};a(e).each(function(){var e=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);e&&d.push((b.key||e[1]+"[]")+"="+(b.key&&b.expression?e[1]:e[2]))});!d.length&&b.key&&d.push(b.key+"=");return d.join("&")},toArray:function(b){var e=this._getItemsAsjQuery(b&&b.connected),d=[],b=b||{};e.each(function(){d.push(a(b.item||this).attr(b.attribute||
"id")||"")});return d},_intersectsWith:function(a){var e=this.positionAbs.left,d=e+this.helperProportions.width,g=this.positionAbs.top,f=g+this.helperProportions.height,c=a.left,h=c+a.width,i=a.top,j=i+a.height,l=this.offset.click.top,m=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?g+l>i&&g+l<j&&e+m>c&&e+m<h:c<e+this.helperProportions.width/
2&&d-this.helperProportions.width/2<h&&i<g+this.helperProportions.height/2&&f-this.helperProportions.height/2<j},_intersectsWithPointer:function(b){var e=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),e=e&&b,b=this._getDragVerticalDirection(),d=this._getDragHorizontalDirection();return!e?!1:this.floating?d&&"right"==d||"down"==b?2:1:b&&("down"==b?2:1)},_intersectsWithSides:function(b){var e=
a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),d=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return this.floating&&g?"right"==g&&b||"left"==g&&!b:d&&("down"==d&&e||"up"==d&&!e)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-
this.lastPositionAbs.left;return 0!=a&&(0<a?"right":"left")},refresh:function(a){this._refreshItems(a);this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var e=[],d=[],g=this._connectWith();if(g&&b)for(b=g.length-1;0<=b;b--)for(var f=a(g[b]),c=f.length-1;0<=c;c--){var h=a.data(f[c],"sortable");h&&(h!=this&&!h.options.disabled)&&d.push([a.isFunction(h.options.items)?h.options.items.call(h.element):
a(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}d.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=d.length-1;0<=b;b--)d[b][0].each(function(){e.push(this)});return a(e)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data(sortable-item)"),e=0;e<this.items.length;e++)for(var d=
0;d<a.length;d++)a[d]==this.items[e].item[0]&&this.items.splice(e,1)},_refreshItems:function(b){this.items=[];this.containers=[this];var e=this.items,d=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],g=this._connectWith();if(g)for(var f=g.length-1;0<=f;f--)for(var c=a(g[f]),h=c.length-1;0<=h;h--){var i=a.data(c[h],"sortable");i&&(i!=this&&!i.options.disabled)&&(d.push([a.isFunction(i.options.items)?i.options.items.call(i.element[0],
b,{item:this.currentItem}):a(i.options.items,i.element),i]),this.containers.push(i))}for(f=d.length-1;0<=f;f--){b=d[f][1];g=d[f][0];h=0;for(c=g.length;h<c;h++)i=a(g[h]),i.data("sortable-item",b),e.push({item:i,instance:b,width:0,height:0,left:0,top:0})}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var e=this.items.length-1;0<=e;e--){var d=this.items[e],g=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||
(d.width=g.outerWidth(),d.height=g.outerHeight());g=g.offset();d.left=g.left;d.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;0<=e;e--)g=this.containers[e].element.offset(),this.containers[e].containerCache.left=g.left,this.containers[e].containerCache.top=g.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();
return this},_createPlaceholder:function(b){var e=b||this,d=e.options;if(!d.placeholder||d.placeholder.constructor==String){var g=d.placeholder;d.placeholder={element:function(){var b=a(document.createElement(e.currentItem[0].nodeName)).addClass(g||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];g||(b.style.visibility="hidden");return b},update:function(a,b){if(!g||d.forcePlaceholderSize)b.height()||b.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||
0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}}}e.placeholder=a(d.placeholder.element.call(e.element,e.currentItem));e.currentItem.after(e.placeholder);d.placeholder.update(e,e.placeholder)},_contactContainers:function(b){for(var e=null,d=null,g=this.containers.length-1;0<=g;g--)if(!a.ui.contains(this.currentItem[0],this.containers[g].element[0]))if(this._intersectsWith(this.containers[g].containerCache)){if(!e||
!a.ui.contains(this.containers[g].element[0],e.element[0]))e=this.containers[g],d=g}else this.containers[g].containerCache.over&&(this.containers[g]._trigger("out",b,this._uiHash(this)),this.containers[g].containerCache.over=0);if(e)if(1===this.containers.length)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){for(var e=1E4,g=null,f=this.positionAbs[this.containers[d].floating?"left":"top"],c=this.items.length-
1;0<=c;c--)if(a.ui.contains(this.containers[d].element[0],this.items[c].item[0])){var h=this.items[c][this.containers[d].floating?"left":"top"];Math.abs(h-f)<e&&(e=Math.abs(h-f),g=this.items[c])}if(g||this.options.dropOnEmpty)this.currentContainer=this.containers[d],g?this._rearrange(b,g,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,
this.placeholder),this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var e=this.options,b=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[b,this.currentItem])):"clone"==e.helper?this.currentItem.clone():this.currentItem;b.parents("body").length||a("parent"!=e.appendTo?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]);b[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,
position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")});(""==b[0].style.width||e.forceHelperSize)&&b.width(this.currentItem.width());(""==b[0].style.height||e.forceHelperSize)&&b.height(this.currentItem.height());return b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-
b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==
document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),
10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=
[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var e=a(b.containment)[0],b=a(b.containment).offset(),d="hidden"!=a(e).css("overflow");this.containment=
[b.left+(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0)-this.margins.top,b.left+(d?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(d?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),
10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,e){e||(e=this.position);var d="absolute"==b?1:-1,g="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(g[0].tagName);return{top:e.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==
this.cssPosition?-this.scrollParent.scrollTop():f?0:g.scrollTop())*d),left:e.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:g.scrollLeft())*d)}},_generatePosition:function(b){var e=this.options,d="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(d[0].tagName);
"relative"==this.cssPosition&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,c=b.pageY;if(this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(c=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),
b.pageY-this.offset.click.top>this.containment[3]&&(c=this.containment[3]+this.offset.click.top)),e.grid))c=this.originalPageY+Math.round((c-this.originalPageY)/e.grid[1])*e.grid[1],c=this.containment?!(c-this.offset.click.top<this.containment[1]||c-this.offset.click.top>this.containment[3])?c:!(c-this.offset.click.top<this.containment[1])?c-e.grid[1]:c+e.grid[1]:c,f=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?!(f-this.offset.click.left<this.containment[0]||
f-this.offset.click.left>this.containment[2])?f:!(f-this.offset.click.left<this.containment[0])?f-e.grid[0]:f+e.grid[0]:f;return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():g?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():
g?0:d.scrollLeft())}},_rearrange:function(a,e,d,g){d?d[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?e.item[0]:e.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var f=this,c=this.counter;window.setTimeout(function(){c==f.counter&&f.refreshPositions(!g)},0)},_clear:function(b,e){this.reverting=!1;var d=[];!this._noFinalSort&&this.currentItem[0].parentNode&&this.placeholder.before(this.currentItem);this._noFinalSort=
null;if(this.helper[0]==this.currentItem[0]){for(var g in this._storedCSS)if("auto"==this._storedCSS[g]||"static"==this._storedCSS[g])this._storedCSS[g]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!e&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&
!e&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){e||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(g=this.containers.length-1;0<=g;g--)a.ui.contains(this.containers[g].element[0],this.currentItem[0])&&!e&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[g])),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,
this.containers[g])))}for(g=this.containers.length-1;0<=g;g--)e||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[g])),this.containers[g].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[g])),this.containers[g].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);
this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!e){this._trigger("beforeStop",b,this._uiHash());for(g=0;g<d.length;g++)d[g].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}e||this._trigger("beforeStop",b,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!e){for(g=0;g<d.length;g++)d[g].call(this,
b);this._trigger("stop",b,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var e=b||this;return{helper:e.helper,placeholder:e.placeholder||a([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:b?b.element:null}}});a.extend(a.ui.sortable,{version:"1.8.11"})})(jQuery);
(function(a){function b(b,e){this.$element=a(b);this.options=e;this.enabled=!0;this.fixTitle()}var e=0;b.prototype={show:function(){var b=this.getTitle();if(b&&this.enabled){var g=this.tip();g.find(".tipsy-inner")[this.options.html?"html":"text"](b);g[0].className="tipsy";g.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var f=this;this.options.hoverable&&g.hover(function(){f.hoverTooltip=!0},function(){"in"!=f.hoverState&&(f.hoverTooltip=!1,"manual"!=f.options.trigger&&
f.$element.trigger("hover"==f.options.trigger?"mouseleave.tipsy":"blur.tipsy"))});var b=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),c=g[0].offsetWidth,h=g[0].offsetHeight,i="function"==typeof this.options.gravity?this.options.gravity.call(this.$element[0]):this.options.gravity,j;switch(i.charAt(0)){case "n":j={top:b.top+b.height+this.options.offset,left:b.left+b.width/2-c/2};break;case "s":j={top:b.top-h-this.options.offset,left:b.left+
b.width/2-c/2};break;case "e":j={top:b.top+b.height/2-h/2,left:b.left-c-this.options.offset};break;case "w":j={top:b.top+b.height/2-h/2,left:b.left+b.width+this.options.offset}}2==i.length&&(j.left="w"==i.charAt(1)?b.left+b.width/2-15:b.left+b.width/2-c+15);g.css(j).addClass("tipsy-"+i);g.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+i.charAt(0);this.options.className&&g.addClass("function"==typeof this.options.className?this.options.className.call(this.$element[0]):this.options.className);
this.options.fade?g.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):g.css({visibility:"visible",opacity:this.options.opacity});this.options.aria&&(j="tipsyuid"+e++,g.attr("id",j),this.$element.attr("aria-describedby",j))}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove();this.options.aria&&this.$element.removeAttr("aria-describedby")},fixTitle:function(){var a=this.$element;if(a.attr("title")||
"string"!=typeof a.attr("original-title"))a.attr("original-title",a.attr("title")||"").removeAttr("title")},getTitle:function(){var a,b=this.$element,f=this.options;this.fixTitle();f=this.options;"string"==typeof f.title?a=b.attr("title"==f.title?"original-title":f.title):"function"==typeof f.title&&(a=f.title.call(b[0]));return(a=(""+a).replace(/(^\s*|\s*$)/,""))||f.fallback},tip:function(){this.$tip||(this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>').attr("role",
"tooltip"),this.$tip.data("tipsy-pointee",this.$element[0]));return this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}};a.fn.tipsy=function(d){function e(c){var f=a.data(c,"tipsy");f||(f=new b(c,a.fn.tipsy.elementOptions(c,d)),a.data(c,"tipsy",f));return f}function f(){var a=e(this);a.hoverState="in";0==d.delayIn?a.show():
(a.fixTitle(),setTimeout(function(){"in"==a.hoverState&&a.show()},d.delayIn))}function c(){var a=e(this);a.hoverState="out";0==d.delayOut?a.hide():setTimeout(function(){"out"==a.hoverState&&!a.hoverTooltip&&a.hide()},d.delayOut)}if(!0===d)return this.data("tipsy");if("string"==typeof d){var h=this.data("tipsy");if(h)h[d]();return this}d=a.extend({},a.fn.tipsy.defaults,d);d.hoverable&&(d.delayOut=d.delayOut||20);d.live||this.each(function(){e(this)});if("manual"!=d.trigger){var h="hover"==d.trigger?
"mouseenter.tipsy":"focus.tipsy",i="hover"==d.trigger?"mouseleave.tipsy":"blur.tipsy";if(d.live)a(this.context).on(h,this.selector,f).on(i,this.selector,c);else this.bind(h,f).bind(i,c)}return this};a.fn.tipsy.defaults={aria:!1,className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,hoverable:!1,offset:0,opacity:0.8,title:"title",trigger:"hover"};a.fn.tipsy.revalidate=function(){a(".tipsy").each(function(){var b=a.data(this,"tipsy-pointee"),e;if(!(e=!b)){a:{for(;b=b.parentNode;)if(b==
document){b=!0;break a}b=!1}e=!b}e&&a(this).remove()})};a.fn.tipsy.elementOptions=function(b,e){return a.metadata?a.extend({},e,a(b).metadata()):e};a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"};a.fn.tipsy.autoBounds=function(b,e){return function(){var f=e[0],c=1<e.length?e[1]:!1,h=a(document).scrollTop()+b,i=a(document).scrollLeft()+
b,j=a(this);j.offset().top<h&&(f="n");j.offset().left<i&&(c="w");a(window).width()+a(document).scrollLeft()-j.offset().left<b&&(c="e");a(window).height()+a(document).scrollTop()-j.offset().top<b&&(f="s");return f+(c?c:"")}}})(jQuery);jQuery.noConflict();
(function(a){function b(){if(a.fn.ajaxSubmit.debug){var b="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.postError&&window.opera.postError(b)}}a.fn.ajaxSubmit=function(e){function d(){function c(){var b=j.attr("target"),e=j.attr("action");f.setAttribute("target",h);"POST"!=f.getAttribute("method")&&f.setAttribute("method","POST");f.getAttribute("action")!=g.url&&f.setAttribute("action",g.url);g.skipEncodingOverride||
j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});g.timeout&&setTimeout(function(){o=!0;d()},g.timeout);var l=[];try{if(g.extraData)for(var k in g.extraData)l.push(a('<input type="hidden" name="'+k+'" value="'+g.extraData[k]+'" />').appendTo(f)[0]);i.appendTo("body");m.attachEvent?m.attachEvent("onload",d):m.addEventListener("load",d,!1);f.submit()}finally{f.setAttribute("action",e),b?f.setAttribute("target",b):j.removeAttr("target"),a(l).remove()}}function d(){if(!l.aborted){var c=
m.contentWindow?m.contentWindow.document:m.contentDocument?m.contentDocument:m.document;if(c&&c.location.href!=g.iframeSrc){m.detachEvent?m.detachEvent("onload",d):m.removeEventListener("load",d,!1);var f=!0;try{if(o)throw"timeout";var e="xml"==g.dataType||c.XMLDocument||a.isXMLDoc(c);b("isXml="+e);if(!e&&(window.opera&&(null==c.body||""==c.body.innerHTML))&&--u){b("requeing onLoad callback, DOM not available");setTimeout(d,250);return}l.responseText=c.body?c.body.innerHTML:c.documentElement?c.documentElement.innerHTML:
null;l.responseXML=c.XMLDocument?c.XMLDocument:c;l.getResponseHeader=function(a){return{"content-type":g.dataType}[a]};var h=/(json|script)/.test(g.dataType);if(h||g.textarea){var j=c.getElementsByTagName("textarea")[0];if(j)l.responseText=j.value;else if(h){var n=c.getElementsByTagName("pre")[0],p=c.getElementsByTagName("body")[0];n?l.responseText=n.textContent:p&&(l.responseText=p.innerHTML)}}else"xml"==g.dataType&&(!l.responseXML&&null!=l.responseText)&&(l.responseXML=D(l.responseText));var c=
l,r=g.dataType,e=g,A=c.getResponseHeader("content-type")||"",y="xml"===r||!r&&0<=A.indexOf("xml"),H=y?c.responseXML:c.responseText;y&&"parsererror"===H.documentElement.nodeName&&a.error&&a.error("parsererror");e&&e.dataFilter&&(H=e.dataFilter(H,r));"string"===typeof H&&("json"===r||!r&&0<=A.indexOf("json")?H=k(H):("script"===r||!r&&0<=A.indexOf("javascript"))&&a.globalEval(H));B=H}catch(U){b("error caught:",U),f=!1,l.error=U,g.error&&g.error.call(g.context,l,"error",U),v&&a.event.trigger("ajaxError",
[l,g,U])}l.aborted&&(b("upload aborted"),f=!1);f&&(g.success&&g.success.call(g.context,B,"success",l),v&&a.event.trigger("ajaxSuccess",[l,g]));v&&a.event.trigger("ajaxComplete",[l,g]);v&&!--a.active&&a.event.trigger("ajaxStop");g.complete&&g.complete.call(g.context,l,f?"success":"error");setTimeout(function(){i.removeData("form-plugin-onload");i.remove();l.responseXML=null},100)}}}var f=j[0];if(a(":input[name=submit],:input[id=submit]",f).length)alert('Error: Form elements must not have name or id of "submit".');
else{var g=a.extend(!0,{},a.ajaxSettings,e);g.context=g.context||g;var h="jqFormIO"+(new Date).getTime(),i=a('<iframe id="'+h+'" name="'+h+'" src="'+g.iframeSrc+'" />'),m=i[0];i.css({position:"absolute",top:"-1000px",left:"-1000px"});var l={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){b("aborting upload...");this.aborted=1;i.attr("src",g.iframeSrc);l.error="aborted";
g.error&&g.error.call(g.context,l,"error","aborted");v&&a.event.trigger("ajaxError",[l,g,"aborted"]);g.complete&&g.complete.call(g.context,l,"error")}},v=g.global;v&&!a.active++&&a.event.trigger("ajaxStart");v&&a.event.trigger("ajaxSend",[l,g]);if(g.beforeSend&&!1===g.beforeSend.call(g.context,l,g))g.global&&a.active--;else if(!l.aborted){var o=0,y=f.clk;if(y){var A=y.name;A&&!y.disabled&&(g.extraData=g.extraData||{},g.extraData[A]=y.value,"image"==y.type&&(g.extraData[A+".x"]=f.clk_x,g.extraData[A+
".y"]=f.clk_y))}g.forceSync?c():setTimeout(c,10);var B,u=50,D=a.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},k=a.parseJSON||function(a){return window.eval("("+a+")")}}}}if(!this.length)return b("ajaxSubmit: skipping submit process - no element selected"),this;"function"==typeof e&&(e={success:e});var g=
this.attr("action");(g="string"===typeof g?a.trim(g):"")&&(g=(g.match(/^([^#]+)/)||[])[1]);g=g||window.location.href||"";e=a.extend(!0,{url:g,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);g={};this.trigger("form-pre-serialize",[this,e,g]);if(g.veto)return b("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&!1===e.beforeSerialize(this,e))return b("ajaxSubmit: submit aborted via beforeSerialize callback"),
this;var f,c,h=this.formToArray(e.semantic);if(e.data)for(f in e.extraData=e.data,e.data)if(e.data[f]instanceof Array)for(var i in e.data[f])h.push({name:f,value:e.data[f][i]});else c=e.data[f],c=a.isFunction(c)?c():c,h.push({name:f,value:c});if(e.beforeSubmit&&!1===e.beforeSubmit(h,this,e))return b("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[h,this,e,g]);if(g.veto)return b("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;f=a.param(h);
"GET"==e.type.toUpperCase()?(e.url+=(0<=e.url.indexOf("?")?"&":"?")+f,e.data=null):e.data=f;var j=this,l=[];e.resetForm&&l.push(function(){j.resetForm()});e.clearForm&&l.push(function(){j.clearForm()});if(!e.dataType&&e.target){var m=e.success||function(){};l.push(function(b){var c=e.replaceTarget?"replaceWith":"html";a(e.target)[c](b).each(m,arguments)})}else e.success&&l.push(e.success);e.success=function(a,b,c){for(var d=e.context||e,f=0,g=l.length;f<g;f++)l[f].apply(d,[a,b,c||j,j])};f=0<a("input:file",
this).length;i="multipart/form-data"==j.attr("enctype")||"multipart/form-data"==j.attr("encoding");!1!==e.iframe&&(f||e.iframe||i)?e.closeKeepAlive?a.get(e.closeKeepAlive,d):d():a.ajax(e);this.trigger("form-submit-notify",[this,e]);return this};a.fn.ajaxForm=function(e){if(0===this.length){var d=this.selector,g=this.context;if(!a.isReady&&d)return b("DOM not ready, queuing ajaxForm"),a(function(){a(d,g).ajaxForm(e)}),this;b("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)"));
return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(b){b.isDefaultPrevented()||(b.preventDefault(),a(this).ajaxSubmit(e))}).bind("click.form-plugin",function(b){var c=b.target,d=a(c);if(!d.is(":submit,input:image")){c=d.closest(":submit");if(0==c.length)return;c=c[0]}var e=this;e.clk=c;"image"==c.type&&(void 0!=b.offsetX?(e.clk_x=b.offsetX,e.clk_y=b.offsetY):"function"==typeof a.fn.offset?(d=d.offset(),e.clk_x=b.pageX-d.left,e.clk_y=b.pageY-d.top):(e.clk_x=b.pageX-c.offsetLeft,
e.clk_y=b.pageY-c.offsetTop));setTimeout(function(){e.clk=e.clk_x=e.clk_y=null},100)})};a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};a.fn.formToArray=function(b){var d=[];if(0===this.length)return d;var g=this[0],f=b?g.getElementsByTagName("*"):g.elements;if(!f)return d;var c,h,i,j,l,m;c=0;for(l=f.length;c<l;c++)if(h=f[c],i=h.name)if(b&&g.clk&&"image"==h.type)!h.disabled&&g.clk==h&&(d.push({name:i,value:a(h).val()}),d.push({name:i+".x",value:g.clk_x},
{name:i+".y",value:g.clk_y}));else if((j=a.fieldValue(h,!0))&&j.constructor==Array){h=0;for(m=j.length;h<m;h++)d.push({name:i,value:j[h]})}else null!==j&&"undefined"!=typeof j&&d.push({name:i,value:j});if(!b&&g.clk&&(b=a(g.clk),f=b[0],(i=f.name)&&!f.disabled&&"image"==f.type))d.push({name:i,value:b.val()}),d.push({name:i+".x",value:g.clk_x},{name:i+".y",value:g.clk_y});return d};a.fn.formSerialize=function(b){return a.param(this.formToArray(b))};a.fn.fieldSerialize=function(b){var d=[];this.each(function(){var g=
this.name;if(g){var f=a.fieldValue(this,b);if(f&&f.constructor==Array)for(var c=0,h=f.length;c<h;c++)d.push({name:g,value:f[c]});else null!==f&&"undefined"!=typeof f&&d.push({name:this.name,value:f})}});return a.param(d)};a.fn.fieldValue=function(b){for(var d=[],g=0,f=this.length;g<f;g++){var c=a.fieldValue(this[g],b);null===c||("undefined"==typeof c||c.constructor==Array&&!c.length)||(c.constructor==Array?a.merge(d,c):d.push(c))}return d};a.fieldValue=function(b,d){var g=b.name,f=b.type,c=b.tagName.toLowerCase();
void 0===d&&(d=!0);if(d&&(!g||b.disabled||"reset"==f||"button"==f||("checkbox"==f||"radio"==f)&&!b.checked||("submit"==f||"image"==f)&&b.form&&b.form.clk!=b||"select"==c&&-1==b.selectedIndex))return null;if("select"==c){var h=b.selectedIndex;if(0>h)return null;for(var g=[],c=b.options,i=(f="select-one"==f)?h+1:c.length,h=f?h:0;h<i;h++){var j=c[h];if(j.selected){var l=j.value;l||(l=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if(f)return l;g.push(l)}}return g}return a(b).val()};
a.fn.clearForm=function(){return this.each(function(){a("input,select,textarea",this).clearFields()})};a.fn.clearFields=a.fn.clearInputs=function(){return this.each(function(){var a=this.type,b=this.tagName.toLowerCase();"text"==a||"password"==a||"textarea"==b?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==b&&(this.selectedIndex=-1)})};a.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};
a.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};a.fn.selected=function(b){void 0===b&&(b=!0);return this.each(function(){var d=this.type;"checkbox"==d||"radio"==d?this.checked=b:"option"==this.tagName.toLowerCase()&&(d=a(this).parent("select"),b&&(d[0]&&"select-one"==d[0].type)&&d.find("option").selected(!1),this.selected=b)})}})(jQuery);
(function(){for(var a=!0,b,e=Object.prototype.toString,d={},g={1:"element",3:"textnode",9:"document",11:"fragment"},f="Arguments Array Boolean Date Document Element Error Fragment Function NodeList Null Number Object RegExp String TextNode Undefined Window".split(" "),c=f.length;c--;){var h=f[c],i=window[h];if(i)try{d[e.call(new i)]=h.toLowerCase()}catch(j){}}b=function(a){return null==a&&(void 0===a?"undefined":"null")||a.nodeType&&g[a.nodeType]||"number"==typeof a.length&&(a.callee&&"arguments"||
a.alert&&"window"||a.item&&"nodelist")||d[e.call(a)]};var l=function(a,c,d){var f=a[c];6!=d.type&&"function"!=b(f)&&(f=function(){for(var a=0<arguments.length?"arguments[0]":"",b=1;b<arguments.length;b++)a+=",arguments["+b+"]";return eval("oldObject("+a+");")});var e;1==d.type||2==d.type||3==d.type?e=function(){var a,b=null;try{a=f.apply(this,arguments)}catch(e){b=e}if(1==d.type)if(null==b)a=d.value.apply(this,[a,c]);else throw b;else 2==d.type&&null!=b?a=d.value.apply(this,[b,c]):3==d.type&&(a=d.value.apply(this,
[a,b,c]));return a}:4==d.type?e=function(){d.value.apply(this,[arguments,c]);return f.apply(this,arguments)}:6==d.type?e=function(){return d.value.apply(this,arguments)}:5==d.type&&(e=function(){var a=this,b=Array.prototype.slice.call(arguments);return d.value.apply(a,[{arguments:b,method:c,proceed:function(){return f.apply(a,b)}}])});e.unweave=function(){a[c]=f;pointcut=a=e=f=null};return a[c]=e},m=function(a,c,d){var f=[],e;for(e in a){var g=null;try{g=a[e]}catch(h){}null!=g&&(e.match(c.method)&&
"function"==b(g))&&(f[f.length]={source:a,method:e,advice:d})}return f},n=function(b,c){var d="undefined"!=typeof b.target.prototype?b.target.prototype:b.target,f=[];if(6!=c.type&&"undefined"==typeof d[b.method]){var e=m(b.target,b,c);0==e.length&&(e=m(d,b,c));for(var g in e)f[f.length]=l(e[g].source,e[g].method,e[g].advice)}else f[0]=l(d,b.method,c);return a?f:f[0]};jQuery.aop={after:function(a,b){return n(a,{type:1,value:b})},afterThrow:function(a,b){return n(a,{type:2,value:b})},afterFinally:function(a,
b){return n(a,{type:3,value:b})},before:function(a,b){return n(a,{type:4,value:b})},around:function(a,b){return n(a,{type:5,value:b})},introduction:function(a,b){return n(a,{type:6,value:b})},setup:function(b){a=b.regexMatch}}})();
if("undefined"!=typeof jQuery){var AJS=function(){function a(a){switch(a){case "<":return"&lt;";case ">":return"&gt;";case "&":return"&amp;";case "'":return"&#39;";case "`":return"&#96;";default:return"&quot;"}}var b=[],e=/[&"'<>`]/g,d={version:"20130207",params:{},$:jQuery,log:function(){"undefined"!=typeof console&&console.log&&Function.prototype.apply.apply(console.log,[console,arguments])},I18n:{getText:function(a){return a}},stopEvent:function(a){a.stopPropagation();return!1},include:function(a){if(!this.contains(b,
a)){b.push(a);var d=document.createElement("script");d.src=a;this.$("body").append(d)}},toggleClassName:function(a,b){(a=this.$(a))&&a.toggleClass(b)},setVisible:function(a,b){if(a=this.$(a)){var d=this.$;d(a).each(function(){var a=d(this).hasClass("hidden");a&&b?d(this).removeClass("hidden"):!a&&!b&&d(this).addClass("hidden")})}},setCurrent:function(a,b){if(a=this.$(a))b?a.addClass("current"):a.removeClass("current")},isVisible:function(a){return!this.$(a).hasClass("hidden")},isClipped:function(a){a=
AJS.$(a);return a.prop("scrollWidth")>a.prop("clientWidth")},populateParameters:function(){var a=this;this.$(".parameters input").each(function(){var b=this.value,d=this.title||this.id;a.$(this).hasClass("list")?a.params[d]?a.params[d].push(b):a.params[d]=[b]:a.params[d]=b.match(/^(tru|fals)e$/i)?"true"==b.toLowerCase():b})},toInit:function(a){var b=this;this.$(function(){try{a.apply(this,arguments)}catch(d){b.log("Failed to run init function: "+d+"\n"+a.toString())}});return this},indexOf:function(a,
b,d){var f=a.length;for(null==d?d=0:0>d&&(d=Math.max(0,f+d));d<f;d++)if(a[d]===b)return d;return-1},contains:function(a,b){return-1<this.indexOf(a,b)},format:function(a){var b=/^((?:(?:[^']*'){2})*?[^']*?)\{(\d+)\}/,d=/'(?!')/g;AJS.format=function(a){for(var c=arguments,f="",e=a.match(b);e;)a=a.substring(e[0].length),f+=e[1].replace(d,"")+(c.length>++e[2]?c[e[2]]:""),e=a.match(b);return f+a.replace(d,"")};return AJS.format.apply(AJS,arguments)},firebug:function(){var a=this.$(document.createElement("script"));
a.attr("src","http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js");this.$("head").append(a);(function(){window.firebug?firebug.init():setTimeout(arguments.callee,0)})()},clone:function(a){return AJS.$(a).clone().removeAttr("id")},alphanum:function(a,b){for(var a=(a+"").toLowerCase(),b=(b+"").toLowerCase(),d=/(\d+|\D+)/g,f=a.match(d),d=b.match(d),e=Math.max(f.length,d.length),g=0;g<e;g++){if(g==f.length)return-1;if(g==d.length)return 1;var n=parseInt(f[g],10),q=parseInt(d[g],10);if(n==
f[g]&&q==d[g]&&n!=q)return(n-q)/Math.abs(n-q);if((n!=f[g]||q!=d[g])&&f[g]!=d[g])return f[g]<d[g]?-1:1}return 0},dim:function(a){if(!AJS.dim.$dim){AJS.dim.$dim=AJS("div").addClass("aui-blanket");AJS.$.browser.msie&&AJS.dim.$dim.css({width:"200%",height:Math.max(AJS.$(document).height(),AJS.$(window).height())+"px"});AJS.$("body").append(AJS.dim.$dim);AJS.hasFlash=!1;var b=/^[^:]*:\/*[^/]*|/,d=b.exec(location.href)[0];AJS.$.browser.msie&&("undefined"===typeof AJS.hasFlash&&!1===a)&&AJS.$("object, embed, iframe").each(function(){if("iframe"===
this.nodeName.toLowerCase()&&b.exec(this.src)[0]===d&&0===AJS.$(this).contents().find("object, embed").length)return!0;AJS.hasFlash=!0;return!1});if(AJS.$.browser.msie&&(!1!==a||AJS.hasFlash))AJS.dim.shim=AJS.$('<iframe frameBorder="0" class="aui-blanket-shim" src="javascript:false;"/>'),AJS.dim.shim.css({height:Math.max(AJS.$(document).height(),AJS.$(window).height())+"px"}),AJS.$("body").append(AJS.dim.shim);AJS.$.browser.msie&&8>parseInt(AJS.$.browser.version,10)?(AJS.dim.cachedOverflow=AJS.$("html").css("overflow"),
AJS.$("html").css("overflow","hidden")):(AJS.dim.cachedOverflow=AJS.$("body").css("overflow"),AJS.$("body").css("overflow","hidden"))}},undim:function(){if(AJS.dim.$dim&&(AJS.dim.$dim.remove(),AJS.dim.$dim=null,AJS.dim.shim&&AJS.dim.shim.remove(),AJS.$.browser.msie&&8>parseInt(AJS.$.browser.version,10)?AJS.$("html").css("overflow",AJS.dim.cachedOverflow):AJS.$("body").css("overflow",AJS.dim.cachedOverflow),AJS.$.browser.safari)){var a=AJS.$(window).scrollTop();AJS.$(window).scrollTop(10+5*(10==a)).scrollTop(a)}},
onTextResize:function(a){if("function"==typeof a)if(AJS.onTextResize["on-text-resize"])AJS.onTextResize["on-text-resize"].push(function(b){a(b)});else{var b=AJS("div");b.css({width:"1em",height:"1em",position:"absolute",top:"-9999em",left:"-9999em"});this.$("body").append(b);b.size=b.width();setInterval(function(){if(b.size!=b.width()){b.size=b.width();for(var a=0,c=AJS.onTextResize["on-text-resize"].length;a<c;a++)AJS.onTextResize["on-text-resize"][a](b.size)}},0);AJS.onTextResize.em=b;AJS.onTextResize["on-text-resize"]=
[function(b){a(b)}]}},unbindTextResize:function(a){for(var b=0,d=AJS.onTextResize["on-text-resize"].length;b<d;b++)if(AJS.onTextResize["on-text-resize"][b]==a)return AJS.onTextResize["on-text-resize"].splice(b,1)},escape:function(a){return escape(a).replace(/%u\w{4}/gi,function(a){return unescape(a)})},escapeHtml:function(b){return b.replace(e,a)},filterBySearch:function(a,b,d){if(""==b)return[];var f=this.$,e=d&&d.keywordsField||"keywords",g=d&&d.ignoreForCamelCase?"i":"",n=d&&d.matchBoundary?"\\b":
"",b=b.split(d&&d.splitRegex||/\s+/),q=[];f.each(b,function(){var a=[RegExp(n+this,"i")];if(/^([A-Z][a-z]*){2,}$/.test(this)){var b=this.replace(/([A-Z][a-z]*)/g,"\\b$1[^,]*");a.push(RegExp(b,g))}q.push(a)});var p=[];f.each(a,function(){for(var a=0;a<q.length;a++){for(var b=!1,c=0;c<q[a].length;c++)if(q[a][c].test(this[e])){b=!0;break}if(!b)return}p.push(this)});return p},drawLogo:function(a){options={};options=AJS.$.extend(a,options);var a=options.scaleFactor||1,b=options.fill||"#fff",d=options.stroke||
"#000",f=400*a,e=40*a;strokeWidth=options.strokeWidth||1;0==AJS.$(".aui-logo").size()&&AJS.$("body").append("<div id='aui-logo' class='aui-logo'><div>");strokeWidth=options.strokeWidth||1;containerID=options.containerID||".aui-logo";f=Raphael(containerID,f+50*a,e+100*a).path("M 0,0 c 3.5433333,-4.7243333 7.0866667,-9.4486667 10.63,-14.173 -14.173,0 -28.346,0 -42.519,0 C -35.432667,-9.4486667 -38.976333,-4.7243333 -42.52,0 -28.346667,0 -14.173333,0 0,0 z m 277.031,28.346 c -14.17367,0 -28.34733,0 -42.521,0 C 245.14,14.173 255.77,0 266.4,-14.173 c -14.17267,0 -28.34533,0 -42.518,0 C 213.25167,0 202.62133,14.173 191.991,28.346 c -14.17333,0 -28.34667,0 -42.52,0 14.17333,-18.8976667 28.34667,-37.7953333 42.52,-56.693 -7.08667,-9.448667 -14.17333,-18.897333 -21.26,-28.346 -14.173,0 -28.346,0 -42.519,0 7.08667,9.448667 14.17333,18.897333 21.26,28.346 -14.17333,18.8976667 -28.34667,37.7953333 -42.52,56.693 -14.173333,0 -28.346667,0 -42.52,0 10.63,-14.173 21.26,-28.346 31.89,-42.519 -14.390333,0 -28.780667,0 -43.171,0 C 42.520733,1.330715e-4 31.889933,14.174867 21.26,28.347 c -42.520624,6.24e-4 -85.039187,-8.13e-4 -127.559,-0.001 11.220667,-14.961 22.441333,-29.922 33.662,-44.883 -6.496,-8.661 -12.992,-17.322 -19.488,-25.983 5.905333,0 11.810667,0 17.716,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.173333,0 28.346667,0 42.52,0 10.63,14.173333 21.26,28.346667 31.89,42.52 14.173333,0 28.3466667,0 42.52,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.1733333,0 28.3466667,0 42.52,0 10.63,14.173333 21.26,28.346667 31.89,42.52 14.390333,0 28.780667,0 43.171,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 42.51967,0 85.03933,0 127.559,0 10.63033,14.173333 21.26067,28.346667 31.891,42.52 14.17267,0 28.34533,0 42.518,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.17367,0 28.34733,0 42.521,0 14.17333,18.897667 28.34667,37.795333 42.52,56.693 -14.17333,18.8976667 -28.34667,37.7953333 -42.52,56.693 z");
console.log(e);f.scale(a,-a,0,0);f.translate(120*a,e);f.attr("fill",b);f.attr("stroke",d);f.attr("stroke-width",strokeWidth)}};if("undefined"!=typeof AJS)for(var g in AJS)d[g]=AJS[g];var f=function(){var a=null;arguments.length&&"string"==typeof arguments[0]&&(a=arguments.callee.$(document.createElement(arguments[0])),2==arguments.length&&a.html(arguments[1]));return a};for(g in d)f[g]=d[g];return f}();AJS.$(function(){AJS.populateParameters()})}
"undefined"==typeof console?console={messages:[],log:function(a){this.messages.push(a)},show:function(){alert(this.messages.join("\n"));this.messages=[]}}:console.show=function(){};AJS.$.ajaxSettings.traditional=!0;AJS.containDropdown=function(a,b,e){var d;-1!==a.$.parents(b).length&&(d=jQuery(b),b=a.$.offset().top-jQuery(b).offset().top,d=d.outerHeight()-b-30,d<=parseInt(a.$.attr("scrollHeight"),10)?AJS.containDropdown.containHeight(a,d):e&&AJS.containDropdown.releaseContainment(a),a.reset())};
AJS.containDropdown.containHeight=function(a,b){a.$.css({height:b});"scroll"!==a.$.css("overflowY")&&a.$.css({width:15+a.$.attr("scrollWidth"),overflowY:"scroll",overflowX:"hidden"})};AJS.containDropdown.releaseContainment=function(a){a.$.css({height:"",width:"",overflowY:"",overflowX:""})};AJS=AJS||{};
(function(){var a="%CONTEXT_PATH%",a=0==a.indexOf("%_CONTEXT_PATH")?!1:a;AJS.contextPath=function(){for(var b=null,e=[a,window.contextPath,window.Confluence&&Confluence.getContextPath(),window.BAMBOO&&BAMBOO.contextPath,window.FECRU&&FECRU.pageContext],d=0;d<e.length;d++)if("string"===typeof e[d]){b=e[d];break}return b}})();
(function(){function a(a){a=RegExp("\\b"+a.replace(g,"\\$&")+"=((?:[^\\\\;]+|\\\\.)*)(?:;|$)");return(a=document.cookie.match(a))&&a[1].replace(b,"")}var b=/(\\|^"|"$)/g,e=/\|\|+/g,d=/"/g,g=/[.*+?|^$()[\]{\\]/g;AJS.Cookie={save:function(b,c,h){var i=a("AJS.conglomerate.cookie"),j=RegExp("(\\s|\\|)*\\b"+b.replace(g,"\\$&")+"=[^|]*[|]*"),i=(i||"").replace(j,"|");""!==c&&(b=b+"="+c,4020>i.length+b.length&&(i+="|"+b));i=i.replace(e,"|");h=h||365;b="";c='"'+i.replace(d,'\\"')+'"';h&&(b=new Date,b.setTime(+b+
864E5*h),b="; expires="+b.toGMTString());document.cookie="AJS.conglomerate.cookie="+c+b+";path=/"},read:function(b,c){var d;d=(d=a("AJS.conglomerate.cookie"))||"";var e=RegExp(b.replace(g,"\\$&")+"=([^|]+)");d=(d=d.match(e))&&d[1];return null!=d?d:c},erase:function(a){this.save(a,"")}}})();
AJS.popup=function(a,b,e,d){"object"!=typeof a&&(a={width:a,height:b,id:e},a=AJS.$.extend({},a,d));var a=AJS.$.extend({},{width:800,height:600,closeOnOutsideClick:!1,keypressListener:function(a){a.keyCode===27&&g.is(":visible")&&j.hide()}},a),g=AJS("div").addClass("aui-popup");a.id&&g.attr("id",a.id);var f=3E3;AJS.$(".aui-dialog").each(function(){var a=AJS.$(this);f=a.css("z-index")>f?a.css("z-index"):f});var c=function(b,c){a.width=b=b||a.width;a.height=c=c||a.height;g.toggleClass("auto-height",
c==="auto");var d={marginTop:-Math.round(c/2)+"px",marginLeft:-Math.round(b/2)+"px",width:b,height:c,"z-index":parseInt(f,10)+2};c!=="auto"?d.marginTop=-Math.round(c/2)+"px":d["max-height"]=this.maxHeight;g.css(d);return arguments.callee}(a.width,a.height);AJS.$("body").append(g);g.hide();g.enable();var h=AJS.$(".aui-blanket"),i=function(a,b){var c=AJS.$(a,b);if(c.length){c.focus();return true}return false},j={changeSize:function(b,d){if(b&&b!=a.width||d&&d!=a.height){c(b,d);if(this.shadow){this.shadow.remove();
this.shadow=null}}this.show()},show:function(){var b=function(){var b=5;AJS.$.browser.msie&&~~AJS.$.browser.version<9&&(b=3);AJS.$(document).keydown(a.keypressListener);AJS.dim();h=AJS.$(".aui-blanket");h.size()!=0&&a.closeOnOutsideClick&&h.click(function(){g.is(":visible")&&j.hide()});g.show();if(!this.shadow){var c=g.offset();this.shadow=Raphael.shadow(c.top,c.left,a.width,a.height,{target:g[0],zindex:g.css("z-index")-1});this.shadow.css({position:"fixed",top:"50%",left:"50%",marginLeft:-(a.width/
2-b)+"px",marginTop:-(a.height/2-b)+"px"})}AJS.popup.current=this;b=g;AJS.$(".dialog-page-body",b).find(":focus").length===0&&(a.focusSelector?i(a.focusSelector,b):i(":input:visible:enabled:first",AJS.$(".dialog-page-body",b))||i(":input:visible:enabled:first",AJS.$(".dialog-button-panel",b))||i(":input:visible:enabled:first",AJS.$(".dialog-page-menu",b)));AJS.$(document).trigger("showLayer",["popup",this])};b.call(this);this.show=b},hide:function(){AJS.$(document).unbind("keydown",a.keypressListener);
h.unbind();this.element.hide();if(this.shadow){this.shadow.remove();this.shadow=null}AJS.$(".aui-dialog:visible").size()==0&&AJS.undim();var b=document.activeElement;this.element.has(b).length&&b.blur();AJS.$(document).trigger("hideLayer",["popup",this]);AJS.popup.current=null;this.enable()},element:g,remove:function(){if(this.shadow){this.shadow.remove();this.shadow=null}g.remove();this.element=null},disable:function(){if(!this.disabled){this.popupBlanket=AJS.$("<div class='dialog-blanket'> </div>").css({height:g.height(),
width:g.width()});g.append(this.popupBlanket);this.disabled=true}},enable:function(){if(this.disabled){this.disabled=false;this.popupBlanket.remove();this.popupBlanket=null}}};return j};
(function(){function a(a,b,d,f){a.buttonpanel||a.addButtonPanel();this.page=a;this.onclick=d;this._onclick=function(){return!0===d.call(this,a.dialog,a)};this.item=AJS("button",b).addClass("button-panel-button");f&&this.item.addClass(f);"function"==typeof d&&this.item.click(this._onclick);a.buttonpanel.append(this.item);this.id=a.button.length;a.button[this.id]=this}function b(a,b,d,f,e){a.buttonpanel||a.addButtonPanel();e||(e="#");this.page=a;this.onclick=d;this._onclick=function(){return!0===d.call(this,
a.dialog,a)};this.item=AJS("a",b).attr("href",e).addClass("button-panel-link");f&&this.item.addClass(f);"function"==typeof d&&this.item.click(this._onclick);a.buttonpanel.append(this.item);this.id=a.button.length;a.button[this.id]=this}function e(a,b){var d="left"==a?-1:1;return function(a){var c=this.page[b];if(this.id!=(1==d?c.length-1:0)){d*=a||1;c[this.id+d].item[0>d?"before":"after"](this.item);c.splice(this.id,1);c.splice(this.id+d,0,this);for(var a=0,f=c.length;a<f;a++)"panel"==b&&this.page.curtab==
c[a].id&&(this.page.curtab=a),c[a].id=a}return this}}function d(a){return function(){this.page[a].splice(this.id,1);for(var b=0,d=this.page[a].length;b<d;b++)this.page[a][b].id=b;this.item.remove()}}a.prototype.moveUp=a.prototype.moveLeft=e("left","button");a.prototype.moveDown=a.prototype.moveRight=e("right","button");a.prototype.remove=d("button");a.prototype.html=function(a){return this.item.html(a)};a.prototype.onclick=function(a){if("undefined"==typeof a)return this.onclick;this.item.unbind("click",
this._onclick);this._onclick=function(){return!0===a.call(this,page.dialog,page)};"function"==typeof a&&this.item.click(this._onclick)};var g=function(a,b,d,f,e){d instanceof AJS.$||(d=AJS.$(d));this.dialog=a.dialog;this.page=a;this.id=a.panel.length;this.button=AJS("button").html(b).addClass("item-button");e&&(this.button[0].id=e);this.item=AJS("li").append(this.button).addClass("page-menu-item");this.body=AJS("div").append(d).addClass("dialog-panel-body");"auto"!==this.dialog.height?this.body.css("height",
a.dialog.height+"px"):this.body.css("max-height",a.dialog.maxHeight+"px");this.padding=20;f&&this.body.addClass(f);var b=a.panel.length,g=this;a.menu.append(this.item);a.body.append(this.body);a.panel[b]=this;d=function(){var b;if(a.curtab+1){b=a.panel[a.curtab];b.body.hide();b.item.removeClass("selected");typeof b.onblur=="function"&&b.onblur()}a.curtab=g.id;g.body.show();g.item.addClass("selected");typeof g.onselect=="function"&&g.onselect();typeof a.ontabchange=="function"&&a.ontabchange(g,b)};
this.button.click?this.button.click(d):(AJS.log("atlassian-dialog:Panel:constructor - this.button.click false"),this.button.onclick=d);d();0==b?a.menu.css("display","none"):a.menu.show()};g.prototype.select=function(){this.button.click()};g.prototype.moveUp=g.prototype.moveLeft=e("left","panel");g.prototype.moveDown=g.prototype.moveRight=e("right","panel");g.prototype.remove=d("panel");g.prototype.html=function(a){return a?(this.body.html(a),this):this.body.html()};g.prototype.setPadding=function(a){isNaN(+a)||
(this.body.css("padding",+a),this.padding=+a,this.page.recalcSize());return this};var f=function(a,b){this.dialog=a;this.id=a.page.length;this.element=AJS("div").addClass("dialog-components");this.body=AJS("div").addClass("dialog-page-body");this.menu=AJS("ul").addClass("dialog-page-menu");"auto"!==a.height?this.menu.css("height",a.height+"px"):this.menu.css("max-height",a.maxHeight+"px");this.body.append(this.menu);this.curtab;this.panel=[];this.button=[];b&&this.body.addClass(b);a.popup.element.append(this.element.append(this.menu).append(this.body));
a.page[a.page.length]=this};f.prototype.recalcSize=function(){for(var a=this.header?56:0,b=this.buttonpanel?51:0,d=this.menu.innerHeight()-this.menu.height(),f=this.panel.length;f--;)if("auto"!==this.dialog.height){var e=this.dialog.height-a-b;this.panel[f].body.css("height",e);this.menu.css("height",e)}else{var e=this.panel[f].body.innerHeight()-this.panel[f].body.height(),g=this.dialog.maxHeight-a-b;this.panel[f].body.css("max-height",g-e);this.menu.css("max-height",g-d)}};f.prototype.addButtonPanel=
function(){this.buttonpanel=AJS("div").addClass("dialog-button-panel");this.element.append(this.buttonpanel)};f.prototype.addPanel=function(a,b,d,f){new g(this,a,b,d,f);this.recalcSize();return this};f.prototype.addHeader=function(a,b){this.header&&this.header.remove();this.header=AJS("h2").text(a||"").addClass("dialog-title");b&&this.header.addClass(b);this.element.prepend(this.header);this.recalcSize();return this};f.prototype.addButton=function(b,d,f){new a(this,b,d,f);this.recalcSize();return this};
f.prototype.addLink=function(a,d,f,e){new b(this,a,d,f,e);this.recalcSize();return this};f.prototype.gotoPanel=function(a){this.panel[a.id||a].select()};f.prototype.getCurrentPanel=function(){return this.panel[this.curtab]};f.prototype.hide=function(){this.element.hide()};f.prototype.show=function(){this.element.show()};f.prototype.remove=function(){this.element.remove()};AJS.Dialog=function(a,b,d){var e={};+a||(e=Object(a),a=e.width,b=e.height,d=e.id);this.height=b||480;"auto"===this.height&&(this.maxHeight=
$(window).height()-200);this.width=a||640;this.id=d;e=AJS.$.extend({},e,{width:this.width,height:this.height,id:this.id,maxHeight:this.maxHeight});this.popup=AJS.popup(e);this.popup.element.addClass("aui-dialog");this.page=[];this.curpage=0;new f(this)};AJS.Dialog.prototype.addHeader=function(a,b){this.page[this.curpage].addHeader(a,b);return this};AJS.Dialog.prototype.addButton=function(a,b,d){this.page[this.curpage].addButton(a,b,d);return this};AJS.Dialog.prototype.addLink=function(a,b,d,f){this.page[this.curpage].addLink(a,
b,d,f);return this};AJS.Dialog.prototype.addSubmit=function(a,b){this.page[this.curpage].addButton(a,b,"button-panel-submit-button");return this};AJS.Dialog.prototype.addCancel=function(a,b){this.page[this.curpage].addLink(a,b,"button-panel-cancel-link");return this};AJS.Dialog.prototype.addButtonPanel=function(){this.page[this.curpage].addButtonPanel();return this};AJS.Dialog.prototype.addPanel=function(a,b,d,f){this.page[this.curpage].addPanel(a,b,d,f);return this};AJS.Dialog.prototype.addPage=
function(a){new f(this,a);this.page[this.curpage].hide();this.curpage=this.page.length-1;return this};AJS.Dialog.prototype.nextPage=function(){this.page[this.curpage++].hide();this.curpage>=this.page.length&&(this.curpage=0);this.page[this.curpage].show();return this};AJS.Dialog.prototype.prevPage=function(){this.page[this.curpage--].hide();0>this.curpage&&(this.curpage=this.page.length-1);this.page[this.curpage].show();return this};AJS.Dialog.prototype.gotoPage=function(a){this.page[this.curpage].hide();
this.curpage=a;0>this.curpage?this.curpage=this.page.length-1:this.curpage>=this.page.length&&(this.curpage=0);this.page[this.curpage].show();return this};AJS.Dialog.prototype.getPanel=function(a,b){var d=null==b?this.curpage:a;null==b&&(b=a);return this.page[d].panel[b]};AJS.Dialog.prototype.getPage=function(a){return this.page[a]};AJS.Dialog.prototype.getCurrentPanel=function(){return this.page[this.curpage].getCurrentPanel()};AJS.Dialog.prototype.gotoPanel=function(a,b){null!=b&&this.gotoPage(a.id||
a);this.page[this.curpage].gotoPanel("undefined"==typeof b?a:b)};AJS.Dialog.prototype.show=function(){this.popup.show();AJS.trigger("show.dialog",{dialog:this});return this};AJS.Dialog.prototype.hide=function(){this.popup.hide();AJS.trigger("hide.dialog",{dialog:this});return this};AJS.Dialog.prototype.remove=function(){this.popup.hide();this.popup.remove();AJS.trigger("remove.dialog",{dialog:this})};AJS.Dialog.prototype.disable=function(){this.popup.disable();return this};AJS.Dialog.prototype.enable=
function(){this.popup.enable();return this};AJS.Dialog.prototype.get=function(a){var b=[],d=this;(a+"").replace(RegExp('(?:^|,)\\s*(?:(page|panel|button|header)(?:#([^"][^ ]*|"[^"]*")|:(\\d+))?|#([^"][^ ]*|"[^"]*"))(?:\\s+(?:(page|panel|button|header)(?:#([^"][^ ]*|"[^"]*")|:(\\d+))?|#([^"][^ ]*|"[^"]*")))?\\s*(?=,|$)',"ig"),function(a,c,f,e,g,j,l,t,s){c=c&&c.toLowerCase();a=[];"page"==c&&d.page[e]?(a.push(d.page[e]),c=(c=j)&&c.toLowerCase(),f=l,e=t,g=s):a=d.page;f=f&&(f+"").replace(/"/g,"");l&&(l+
"").replace(/"/g,"");g=g&&(g+"").replace(/"/g,"");s&&(s+"").replace(/"/g,"");if(c||g)for(j=a.length;j--;){if(g||"panel"==c&&(f||!f&&null==e))for(l=a[j].panel.length;l--;)(a[j].panel[l].button.html()==g||a[j].panel[l].button.html()==f||"panel"==c&&!f&&null==e)&&b.push(a[j].panel[l]);if(g||"button"==c&&(f||!f&&null==e))for(l=a[j].button.length;l--;)(a[j].button[l].item.html()==g||a[j].button[l].item.html()==f||"button"==c&&!f&&null==e)&&b.push(a[j].button[l]);a[j][c]&&a[j][c][e]&&b.push(a[j][c][e]);
"header"==c&&a[j].header&&b.push(a[j].header)}else b=b.concat(a)});for(var f={length:b.length},a=b.length;a--;){f[a]=b[a];for(var e in b[a])e in f||function(a){f[a]=function(){for(var b=this.length;b--;)"function"==typeof this[b][a]&&this[b][a].apply(this[b],arguments)}}(e)}return f};AJS.Dialog.prototype.updateHeight=function(){for(var a=0,b=AJS.$(window).height()-56-51-100,d=0;this.getPanel(d);d++)this.getPanel(d).body.css({height:"auto",display:"block"}).outerHeight()>a&&(a=Math.min(b,this.getPanel(d).body.outerHeight())),
d!==this.page[this.curpage].curtab&&this.getPanel(d).body.css({display:"none"});for(d=0;this.getPanel(d);d++)this.getPanel(d).body.css({height:a||this.height});this.page[0].menu.height(a);this.height=a+56+51+1;this.popup.changeSize(void 0,this.height)};AJS.Dialog.prototype.isMaximised=function(){return this.popup.element.outerHeight()>=AJS.$(window).height()-100};AJS.Dialog.prototype.getCurPanel=function(){return this.getPanel(this.page[this.curpage].curtab)};AJS.Dialog.prototype.getCurPanelButton=
function(){return this.getCurPanel().button}})();
window.Raphael&&(Raphael.shadow=function(a,b,e,d,g){var g=g||{},f=jQuery(g.target),c=jQuery("<div/>",{"class":"aui-shadow"}),h=g.shadow||g.color||"#000",i=10*g.size||0,j=g.offsetSize||3,l=g.zindex||0,m=g.radius||0,n="0.4",g=g.blur||3,e=e+(i+2*g),d=d+(i+2*g);if(Raphael.shadow.BOX_SHADOW_SUPPORT)return f.addClass("aui-box-shadow"),c.addClass("hidden");0===a&&(0===b&&0<f.length)&&(b=f.offset(),a=j-g+b.left,b=j-g+b.top);jQuery.browser.msie&&"9">jQuery.browser.version&&(h="#f0f0f0",n="0.2");c.css({position:"absolute",
left:a,top:b,width:e,height:d,zIndex:l});0<f.length?(c.appendTo(document.body),a=Raphael(c[0],e,d,m)):a=Raphael(a,b,e,d,m);a.canvas.style.position="absolute";a.rect(g,g,e-2*g,d-2*g).attr({fill:h,stroke:h,blur:""+g,opacity:n});return c},Raphael.shadow.BOX_SHADOW_SUPPORT=function(){for(var a=document.documentElement.style,b=["boxShadow","MozBoxShadow","WebkitBoxShadow","msBoxShadow"],e=0;e<b.length;e++)if(b[e]in a)return!0;return!1}());jQuery.os={};var jQueryOSplatform=navigator.platform.toLowerCase();
jQuery.os.windows=-1!=jQueryOSplatform.indexOf("win");jQuery.os.mac=-1!=jQueryOSplatform.indexOf("mac");jQuery.os.linux=-1!=jQueryOSplatform.indexOf("linux");jQuery.ui.draggable.prototype._mouseCapture=function(a){return function(b){var e=a.call(this,b);e&&jQuery.browser.msie&&b.stopPropagation();return e}}(jQuery.ui.draggable.prototype._mouseCapture);jQuery.ui.draggable.prototype._mouseCapture=function(a){return function(b){var e=a.call(this,b);e&&jQuery.browser.msie&&b.stopPropagation();return e}}(jQuery.ui.draggable.prototype._mouseCapture);
(function(a){function b(a){this.num=0;this.timer=a>0?a:false}function e(e){if(a.isPlainObject(e.data)||a.isArray(e.data)||typeof e.data==="string"){var f=e.handler,c={timer:700},h=e.data;typeof h==="string"?c.combo=[h]:a.isArray(h)?c.combo=h:a.extend(c,h);c.combo=a.map(c.combo,function(a){return a.toLowerCase()});e.index=new b(c.timer);e.handler=function(b){if(!(this!==b.target&&/textarea|select|input/i.test(b.target.nodeName))){var h=b.type!=="keypress"?a.hotkeys.specialKeys[b.which]:null,l=String.fromCharCode(b.which).toLowerCase(),
m="",n={};b.altKey&&h!=="alt"&&(m=m+"alt+");b.ctrlKey&&h!=="ctrl"&&(m=m+"ctrl+");b.metaKey&&(!b.ctrlKey&&h!=="meta")&&(m=m+"meta+");b.shiftKey&&h!=="shift"&&(m=m+"shift+");h&&(n[m+h]=true);l&&(n[m+l]=true);/shift+/.test(m)&&(n[m.replace("shift+","")+a.hotkeys.shiftNums[h||l]]=true);h=e.index;l=c.combo;if(d(l[h.val()],n)){if(h.val()===l.length-1){h.reset();return f.apply(this,arguments)}h.inc()}else{h.reset();d(l[0],n)&&h.inc()}}}}}function d(a,b){for(var c=a.split(" "),d=0,e=c.length;d<e;d++)if(b[c[d]])return true;
return false}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"meta",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",
144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta",219:"[",221:"]"},keypressKeys:["<",">","?"],shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(a.hotkeys.keypressKeys,function(b,d){a.hotkeys.shiftNums[d]=d});b.prototype.val=function(){return this.num};b.prototype.inc=function(){if(this.timer){clearTimeout(this.timeout);this.timeout=setTimeout(a.proxy(b.prototype.reset,this),this.timer)}this.num++};
b.prototype.reset=function(){this.timer&&clearTimeout(this.timeout);this.num=0};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:e}})})(jQuery);
jQuery.fn.moveTo=function(a){var a=jQuery.extend({transition:false,scrollOffset:35},a),b=this,e=b.offset().top,d=jQuery("#stalker"),g=d.outerHeight()+a.scrollOffset;if(d.length===0||!d.hasClass("detached")&&e<=d.offset().top)g=0;if((jQuery(window).scrollTop()+jQuery(window).height()-this.outerHeight()<e||jQuery(window).scrollTop()+g>e)&&jQuery(window).height()>g){e=jQuery(window).scrollTop()+g>e?e-(jQuery(window).height()-this.outerHeight())+a.scrollOffset:e-g;if(!jQuery.fn.moveTo.animating&&a.transition){jQuery(document).trigger("moveToStarted",
this);jQuery.fn.moveTo.animating=true;jQuery("html,body").animate({scrollTop:e},1E3,function(){d.trigger("positionChanged");jQuery(document).trigger("moveToFinished",b);delete jQuery.fn.moveTo.animating});return this}if(jQuery("html, body").is(":animated")){jQuery("html, body").stop();delete jQuery.fn.moveTo.animating}jQuery(document).trigger("moveToStarted");jQuery(window).scrollTop(e);d.trigger("positionChanged");setTimeout(function(){jQuery(document).trigger("moveToFinished",b)},100);return this}jQuery(document).trigger("moveToFinished",
this);return this};
AJS.dropDown=function(a,b){var e=null,d=[],g=false,f=AJS.$(document),c={item:"li:has(a)",activeClass:"active",alignment:"right",displayHandler:function(a){return a.name},escapeHandler:function(){this.hide("escape");return false},hideHandler:function(){},moveHandler:function(){},useDisabled:false};AJS.$.extend(c,b);c.alignment={left:"left",right:"right"}[c.alignment.toLowerCase()]||"left";if(a&&a.jquery)e=a;else if(typeof a=="string")e=AJS.$(a);else if(a&&a.constructor==Array){for(var e=AJS("div").addClass("aui-dropdown").toggleClass("hidden",
!!c.isHiddenByDefault),h=0,i=a.length;h<i;h++){for(var j=AJS("ol"),l=0,m=a[h].length;l<m;l++){var n=AJS("li"),q=a[h][l];if(q.href){n.append(AJS("a").html("<span>"+c.displayHandler(q)+"</span>").attr({href:q.href}).addClass(q.className));AJS.$.data(AJS.$("a > span",n)[0],"properties",q)}else n.html(q.html).addClass(q.className);q.icon&&n.prepend(AJS("img").attr("src",q.icon));q.insideSpanIcon&&n.children("a").prepend(AJS("span").attr("class","icon"));AJS.$.data(n[0],"properties",q);j.append(n)}h==
i-1&&j.addClass("last");e.append(j)}AJS.$("body").append(e)}else throw Error("AJS.dropDown function was called with illegal parameter. Should be AJS.$ object, AJS.$ selector or array.");var p=function(){r(1)},w=function(){r(-1)},r=function(a){var b=!g,d=AJS.dropDown.current.$[0],f=AJS.dropDown.current.links,e=d.focused;g=true;if(f.length!==0){d.focused=typeof e==="number"?e:-1;if(!AJS.dropDown.current){AJS.log("move - not current, aborting");return true}d.focused=d.focused+a;if(d.focused<0)d.focused=
f.length-1;else if(d.focused>=f.length)d.focused=0;c.moveHandler(AJS.$(f[d.focused]),a<0?"up":"down");if(b&&f.length){AJS.$(f[d.focused]).addClass(c.activeClass);g=false}else f.length||(g=false)}},x=function(a){if(!AJS.dropDown.current)return true;var b=a.which,d=AJS.dropDown.current.$[0],f=AJS.dropDown.current.links;AJS.dropDown.current.cleanActive();switch(b){case 40:p();break;case 38:w();break;case 27:return c.escapeHandler.call(AJS.dropDown.current,a);case 13:return d.focused>=0?c.selectionHandler?
c.selectionHandler.call(AJS.dropDown.current,a,AJS.$(f[d.focused])):AJS.$(f[d.focused]).attr("nodeName")!="a"?AJS.$("a",f[d.focused]).trigger("focus"):AJS.$(f[d.focused]).trigger("focus"):true;default:f.length&&AJS.$(f[d.focused]).addClass(c.activeClass);return true}a.stopPropagation();a.preventDefault();return false},t=function(a){a&&a.which&&a.which==3||a&&a.button&&a.button==2||AJS.dropDown.current&&AJS.dropDown.current.hide("click")},s=function(a){return function(){if(AJS.dropDown.current){AJS.dropDown.current.cleanFocus();
this.originalClass=this.className;AJS.$(this).addClass(c.activeClass);AJS.dropDown.current.$[0].focused=a}}},v=function(a){if(a.button||a.metaKey||a.ctrlKey||a.shiftKey)return true;AJS.dropDown.current&&c.selectionHandler&&c.selectionHandler.call(AJS.dropDown.current,a,AJS.$(this))};e.each(function(){var a=this,b=AJS.$(this),e={},g={reset:function(){e=AJS.$.extend(e,{$:b,links:AJS.$(c.item||"li:has(a)",a),cleanActive:function(){a.focused+1&&e.links.length&&AJS.$(e.links[a.focused]).removeClass(c.activeClass)},
cleanFocus:function(){e.cleanActive();a.focused=-1},moveDown:p,moveUp:w,moveFocus:x,getFocusIndex:function(){return typeof a.focused=="number"?a.focused:-1}});e.links.each(function(a){var b=AJS.$(this),c=false;b.data("events")&&AJS.$.each(b.data("events"),function(a,b){AJS.$.each(b,function(a,b){if(v===b){c=true;return false}})});if(!c){b.hover(s(a),e.cleanFocus);b.click(v)}})},appear:function(a){if(a){b.removeClass("hidden");b.addClass("aui-dropdown-"+c.alignment)}else b.addClass("hidden")},fade:function(a){a?
b.fadeIn("fast"):b.fadeOut("fast")},scroll:function(a){a?b.slideDown("fast"):b.slideUp("fast")}};e.reset=g.reset;e.reset();e.addControlProcess=function(a,b){AJS.$.aop.around({target:this,method:a},b)};e.addCallback=function(a,b){return AJS.$.aop.after({target:this,method:a},b)};e.show=function(b){if(!c.useDisabled||!this.$.closest(".aui-dd-parent").hasClass("disabled")){this.alignment=c.alignment;t();AJS.dropDown.current=this;this.method=b||this.method||"appear";this.timer=setTimeout(function(){f.click(t)},
0);f.keydown(x);c.firstSelected&&this.links[0]&&s(0).call(this.links[0]);AJS.$(a.offsetParent).css({zIndex:2E3});g[this.method](true);AJS.$(document).trigger("showLayer",["dropdown",AJS.dropDown.current])}};e.hide=function(a){this.method=this.method||"appear";AJS.$(b.get(0).offsetParent).css({zIndex:""});this.cleanFocus();g[this.method](false);f.unbind("click",t).unbind("keydown",x);AJS.$(document).trigger("hideLayer",["dropdown",AJS.dropDown.current]);AJS.dropDown.current=null;return a};e.addCallback("reset",
function(){c.firstSelected&&this.links[0]&&s(0).call(this.links[0])});if(!AJS.dropDown.iframes)AJS.dropDown.iframes=[];AJS.dropDown.createShims=function(){AJS.$("iframe").each(function(){if(!this.shim){this.shim=AJS.$("<div />").addClass("shim hidden").appendTo("body");AJS.dropDown.iframes.push(this)}});return arguments.callee}();e.addCallback("show",function(){AJS.$(AJS.dropDown.iframes).each(function(){var a=AJS.$(this);if(a.is(":visible")){var b=a.offset();b.height=a.height();b.width=a.width();
this.shim.css({left:b.left+"px",top:b.top+"px",height:b.height+"px",width:b.width+"px"}).removeClass("hidden")}})});e.addCallback("hide",function(){AJS.$(AJS.dropDown.iframes).each(function(){this.shim.addClass("hidden")});c.hideHandler()});var h=function(){this.$.offset();this.shadow&&this.shadow.remove();if(this.$.is(":visible"))this.shadow=Raphael.shadow(0,0,this.$.outerWidth(true),this.$.outerHeight(true),{target:this.$[0]})};e.addCallback("reset",h);e.addCallback("show",h);e.addCallback("hide",
function(){this.shadow&&this.shadow.remove()});if(AJS.$.browser.msie&&~~AJS.$.browser.version<9){h=function(){if(this.$.is(":visible")){if(!this.iframeShim)this.iframeShim=AJS.$('<iframe class="dropdown-shim" src="javascript:false;" frameBorder="0" />').insertBefore(this.$);this.iframeShim.css({display:"block",top:this.$.css("top"),width:this.$.outerWidth()+"px",height:this.$.outerHeight()+"px"});c.alignment=="left"?this.iframeShim.css({left:"0px"}):this.iframeShim.css({right:"0px"})}};e.addCallback("reset",
h);e.addCallback("show",h);e.addCallback("hide",function(){this.iframeShim&&this.iframeShim.css({display:"none"})})}d.push(e)});return d};AJS.dropDown.getAdditionalPropertyValue=function(a,b){var e=a[0];(!e||typeof e.tagName!="string"||e.tagName.toLowerCase()!="li")&&AJS.log("AJS.dropDown.getAdditionalPropertyValue : item passed in should be an LI element wrapped by jQuery");return(e=AJS.$.data(e,"properties"))?e[b]:null};AJS.dropDown.removeAllAdditionalProperties=function(){};
AJS.dropDown.Standard=function(a){var b=[],e={selector:".aui-dd-parent",dropDown:".aui-dropdown",trigger:".aui-dd-trigger"};AJS.$.extend(e,a);var d=function(a,b,c,d){AJS.$.extend(d,{trigger:a});b.addClass("dd-allocated");c.addClass("hidden");e.isHiddenByDefault==false&&d.show();d.addCallback("show",function(){b.addClass("active")});d.addCallback("hide",function(){b.removeClass("active")})},g=function(a,b,c,d){if(d!=AJS.dropDown.current){c.css({top:b.outerHeight()});d.show();a.stopImmediatePropagation()}a.preventDefault()};
if(e.useLiveEvents){var f=[],c=[];AJS.$(e.trigger).live("click",function(a){var b=AJS.$(this),j,l,m;if((j=AJS.$.inArray(this,f))>=0){var n=c[j];l=n.dropdown;m=n.ddcontrol}else{j=b.closest(e.selector);l=j.find(e.dropDown);if(l.length===0)return;m=AJS.dropDown(l,e)[0];if(!m)return;f.push(this);n={parent:j,dropdown:l,ddcontrol:m};d(b,j,l,m);c.push(n)}g(a,b,l,m)})}else{a=this instanceof AJS.$?this:AJS.$(e.selector);a=a.not(".dd-allocated").filter(":has("+e.dropDown+")").filter(":has("+e.trigger+")");
a.each(function(){var a=AJS.$(this),c=AJS.$(e.dropDown,this),f=AJS.$(e.trigger,this),l=AJS.dropDown(c,e)[0];AJS.$.extend(l,{trigger:f});d(f,a,c,l);f.click(function(a){g(a,f,c,l)});b.push(l)})}return b};
AJS.dropDown.Ajax=function(a){var b={cache:true};AJS.$.extend(b,a||{});a=AJS.dropDown.Standard.call(this,b);AJS.$(a).each(function(){var a=this;AJS.$.extend(a,{getAjaxOptions:function(d){var g=function(d){b.formatResults&&(d=b.formatResults(d));b.cache&&a.cache.set(a.getAjaxOptions(),d);a.refreshSuccess(d)};return b.ajaxOptions?AJS.$.isFunction(b.ajaxOptions)?AJS.$.extend(b.ajaxOptions.call(a),{success:g}):AJS.$.extend(b.ajaxOptions,{success:g}):AJS.$.extend(d,{success:g})},refreshSuccess:function(a){this.$.html(a)},
cache:function(){var a={};return{get:function(b){return a[(b.url+(b.data||"")).replace(/[\?\&]/gi,"")]},set:function(b,f){a[(b.url+(b.data||"")).replace(/[\?\&]/gi,"")]=f},reset:function(){a={}}}}(),show:function(d){return function(){if(b.cache&&a.cache.get(a.getAjaxOptions())){a.refreshSuccess(a.cache.get(a.getAjaxOptions()));d.call(a)}else{AJS.$(AJS.$.ajax(a.getAjaxOptions())).throbber({target:a.$,end:function(){a.reset()}});d.call(a);a.shadow.hide();a.iframeShim&&a.iframeShim.hide()}}}(a.show),
resetCache:function(){a.cache.reset()}});a.addCallback("refreshSuccess",function(){a.reset()})});return a};AJS.$.fn.dropDown=function(a,b){a=(a||"Standard").replace(/^([a-z])/,function(a){return a.toUpperCase()});return AJS.dropDown[a].call(this,b)};
(function(a){function b(a){if(a.click)a.click();else{var b=document.createEvent("MouseEvents");b.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);a.dispatchEvent(b)}}function e(b){b instanceof jQuery||(b=a(b));var c=b.attr("aria-owns"),b=b.attr("aria-haspopup"),d=document.getElementById(c);if(d)return a(d);if(!c)throw Error("Dropdown 2 trigger required attribute not set: aria-owns");if(!b)throw Error("Dropdown 2 trigger required attribute not set: aria-haspopup");
if(!d)throw Error("Dropdown 2 trigger aria-owns attr set to nonexistent id: "+c);throw Error("Dropdown 2 trigger unknown error. I don't know what you did, but there's smoke everywhere. Consult the documentation.");}var d=a(document),g=jQuery.browser.msie&&parseInt(jQuery.browser.version,10)==8,f=null,c;var h=function(b){if(!l&&b.which===1){l=true;d.bind("mouseup mouseleave",i);a(this).trigger("aui-button-invoke")}},i=function(){d.unbind("mouseup mouseleave",i);setTimeout(function(){l=false},0)};c=
function(){l||a(this).trigger("aui-button-invoke")};var j=function(a){a.preventDefault()},l=false;c=typeof document.addEventListener==="undefined"?{click:c,"click selectstart":j,mousedown:function(a){function b(a){switch(a.toElement){case null:case c:case document.body:case document.documentElement:a.returnValue=false}}h.call(this,a);var c=this,d=document.activeElement;if(d!==null){d.attachEvent("onbeforedeactivate",b);setTimeout(function(){d.detachEvent("onbeforedeactivate",b)},0)}}}:{click:c,"click mousedown":j,
mousedown:h};var m={mouseleave:function(){d.bind(n)},"mouseup mouseleave":function(){a(this).unbind(m)}},n={mouseup:function(c){var d=a(c.target).closest(".aui-dropdown2 a, .aui-dropdown2-trigger")[0];d&&setTimeout(function(){b(d)},0)},"mouseup mouseleave":function(){a(this).unbind(n)}};d.delegate(".aui-dropdown2-trigger",c);d.delegate(".aui-dropdown2-trigger:not(.active):not([aria-disabled=true]),.aui-dropdown2-sub-trigger:not([aria-disabled=true])",{"aui-button-invoke":function(c,h){function i(b,
c){b.each(function(){var b=a(this);b.attr("role",c);if(b.hasClass("checked")){b.attr("aria-checked","true");c=="radio"&&b.closest("ul").attr("role","radiogroup")}else b.attr("aria-checked","false")})}function m(){if(f===N){d.unbind(N);f=null}V("off");setTimeout(function(){F.css("display","none").css("min-width","").insertAfter(L).attr("aria-hidden","true");C||L.removeClass("active");y().removeClass("active");F.removeClass("aui-dropdown2-in-toolbar");F.removeClass("aui-dropdown2-in-buttons");T?F.insertBefore(T):
F.appendTo(W);F.trigger("aui-dropdown2-hide")},0)}function j(){m();C&&U.trigger("aui-dropdown2-hide-all")}function l(a){C&&a.target===U[0]&&m()}function n(a){return!a.is(".disabled, [aria-disabled=true]")}function v(a){return a.hasClass("aui-dropdown2-sub-trigger")}function o(b,c){if(v(b)){var c=a.extend({},c,{$menu:H}),d=e(b);d.is(":visible")?d.trigger("aui-dropdown2-select-first"):b.trigger("aui-button-invoke",c)}}function y(){return F.find("a.active")}function A(a){if(ra&&ra[0]===a[0])return false;
ra=a;y().removeClass("active");n(a)&&a.addClass("active");F.trigger("aui-dropdown2-item-selected");Q();return true}function B(){A(F.find("a:not(.disabled)").first())}function u(a){var b=F.find("> ul > li > a, > .aui-dropdown2-section > ul > li > a").not(".disabled");A(E(b,a,true))}function D(a){if(a.length>0){j();a.trigger("aui-button-invoke")}}function k(a){D(E(H.find(".aui-dropdown2-trigger").not(".disabled, [aria-disabled=true], .aui-dropdown2-sub-trigger"),a,false))}function E(a,b,c){var d=a.index(a.filter(".active")),
d=d+(d<0&&b<0?1:0)+b;if(c)d=d%a.length;else if(d<0)d=a.length;return a.eq(d)}function z(){D(a(this))}function Q(){if(f!==N){d.unbind(f);d.bind(N);f=N}}function V(a){var b="bind",c="delegate";if(a!=="on"){b="unbind";c="undelegate"}if(C)U[b]("aui-dropdown2-hide aui-dropdown2-item-selected aui-dropdown2-step-out",l);else{H[c](".aui-dropdown2-trigger:not(.active)","mousemove",z);L[b]("aui-button-invoke",m)}F[b]("aui-dropdown2-hide-all",j);F[c]("a",la);F[b]("aui-dropdown2-hide",Q);F[b]("aui-dropdown2-select-first",
B)}var h=a.extend({selectFirst:true},h),F=e(this),L=a(this).addClass("active"),C=L.hasClass("aui-dropdown2-sub-trigger"),W=F.parent()[0],T=F.next()[0],K=a(this).attr("data-dropdown2-hide-location");if(K)if(K=document.getElementById(K)){W=a(K);T=void 0}else throw Error("The specified data-dropdown2-hide-location id doesn't exist");var H=h.$menu||L.closest(".aui-dropdown2-trigger-group");if(C){var U=L.closest(".aui-dropdown2");F.addClass(U.attr("class")).addClass("aui-dropdown2-sub-menu")}var la={click:function(b){var c=
a(this);if(n(c)){c.hasClass("interactive")||j();if(v(c)){o(c,{selectFirst:false});b.preventDefault()}}},mousemove:function(){var b=a(this);A(b)&&o(b,{selectFirst:false})}},N={"click focusin mousedown":function(b){b=b.target;!(b===F[0]||a.contains(F[0],b))&&!(b===L[0]||a.contains(L[0],b))&&j()},keydown:function(a){if(a.shiftKey&&a.keyCode==9)u(-1);else switch(a.keyCode){case 13:var c=y();v(c)?o(c):b(c[0]);break;case 27:m();break;case 37:c=y();if(v(c)&&e(c).is(":visible")){F.trigger("aui-dropdown2-step-out");
return}C?m():k(-1);break;case 38:u(-1);break;case 39:c=y();v(c)?o(c):k(1);break;case 40:u(1);break;case 9:u(1);break;default:return}a.preventDefault()}};L.attr("aria-controls",L.attr("aria-owns"));g&&F.removeClass("aui-dropdown2-tailed");F.find(".disabled").attr("aria-disabled","true");F.find("li.hidden > a").addClass("disabled").attr("aria-disabled","true");i(F.find(".aui-dropdown2-checkbox"),"checkbox");i(F.find(".aui-dropdown2-radio"),"radio");var M=L.offset(),ma=L.outerWidth(),K=F.outerWidth(),
fa=a("body").outerWidth(true),S=Math.max(parseInt(F.css("min-width"),10),ma),ha=L.data("container")||false,qa="left";if(g)var za=parseInt(F.css("border-left-width"),10)+parseInt(F.css("border-right-width"),10),K=K-za,S=S-za;C||F.css("min-width",S+"px");var na=M.left,xa=M.top+L.outerHeight();if(C){na=M.left+U.outerWidth()-3;xa=M.top}if(fa<na+K&&K<=na+ma){na=M.left+ma-K;C&&(na=M.left-K);qa="right"}if(ha){L.closest(ha);M=L.offset().left+L.outerWidth();ma=M+K;S>=K&&(K=S);if(ma>M){na=M-K;qa="right"}g&&
(na=na-za)}F.attr({"data-dropdown2-alignment":qa,"aria-hidden":"false"}).css({display:"block",left:na+"px",top:xa+"px"});F.appendTo(document.body);L.hasClass("toolbar-trigger")&&F.addClass("aui-dropdown2-in-toolbar");L.parent().hasClass("aui-buttons")&&F.addClass("aui-dropdown2-in-buttons");L.parents().hasClass("aui-header")&&F.addClass("aui-dropdown2-in-header");F.trigger("aui-dropdown2-show",h);h.selectFirst&&B();V("on");var ra=null},mousedown:function(b){b.which===1&&a(this).bind(m)}});d.delegate(".aui-dropdown2-checkbox:not(.disabled)",
"click",function(){var b=a(this);if(b.hasClass("checked")){b.removeClass("checked").attr("aria-checked","false");b.trigger("aui-dropdown2-item-uncheck")}else{b.addClass("checked").attr("aria-checked","true");b.trigger("aui-dropdown2-item-check")}});d.delegate(".aui-dropdown2-radio:not(.checked):not(.disabled)","click",function(){var b=a(this);b.closest("ul").find(".checked").removeClass("checked").attr("aria-checked","false").trigger("aui-dropdown2-item-uncheck");b.addClass("checked").attr("aria-checked",
"true").trigger("aui-dropdown2-item-check")});d.delegate(".aui-dropdown2 a.disabled","click",function(a){a.preventDefault()})})(jQuery);AJS.bind=function(a,b,e){try{return typeof e==="function"?jQuery(window).bind(a,b,e):jQuery(window).bind(a,b)}catch(d){AJS.log("error while binding: "+d.message)}};AJS.unbind=function(a,b){try{return jQuery(window).unbind(a,b)}catch(e){AJS.log("error while unbinding: "+e.message)}};
AJS.trigger=function(a,b){try{return jQuery(window).trigger(a,b)}catch(e){AJS.log("error while triggering: "+e.message)}};
AJS.warnAboutFirebug=function(a){if(!AJS.Cookie.read("COOKIE_FB_WARNING")&&window.console&&window.console.firebug){a||(a="Firebug is known to cause performance problems with Atlassian products. Try disabling it, if you notice any issues.");var b=AJS.$("<div id='firebug-warning'><p>"+a+"</p><a class='close'>Close</a></div>");AJS.$(".close",b).click(function(){b.slideUp("fast");AJS.Cookie.save("COOKIE_FB_WARNING","true")});b.prependTo(AJS.$("body"))}};
AJS.inlineHelp=function(){AJS.$(".icon-inline-help").click(function(){var a=AJS.$(this).siblings(".field-help");a.hasClass("hidden")?a.removeClass("hidden"):a.addClass("hidden")})};
(function(){AJS.icons=AJS.icons||{};AJS.icons.addIcon=function(a,b){AJS.icons[a]=function(a,d){var g;g=d||24;Raphael([a,g+1,g+1].concat(b)).scale(g/24,g/24,0,0)}};AJS.icons.addIcon.init=function(){for(var a=this.className.split(" "),b=a.length,e=this.className.match(/(^|\s)size-(\d+)(\s|$)/),e=e&&+e[2];b--;)if(a[b]!="addIcon"&&a[b]in AJS.icons)AJS.icons[a[b]](this,e)}})();AJS.$(function(){AJS.$(".svg-icon").each(AJS.icons.addIcon.init)});
AJS.icons.addIcon("generic",[{stroke:"none",fill:"#999",type:"path",path:"M22.465,8.464c1.944,1.944,1.944,5.126,0,7.07l-6.93,6.93c-1.944,1.945-5.126,1.945-7.07,0l-6.929-6.93c-1.945-1.943-1.945-5.125,0-7.07l6.929-6.93c1.944-1.944,5.126-1.944,7.07,0L22.465,8.464z"},{type:"path",stroke:"none",fill:"90-#999996-#a1a19f:20-#b8b8b7:70-#ccc",path:"M9.172,2.242L9.172,2.242l-6.929,6.93C1.491,9.923,1.077,10.927,1.077,12c0,1.072,0.414,2.076,1.166,2.828l6.929,6.93c0.751,0.752,1.756,1.166,2.828,1.166s2.076-0.414,2.828-1.166l6.93-6.93c0.751-0.752,1.165-1.756,1.165-2.828c0-1.072-0.414-2.076-1.165-2.828l-6.93-6.93C13.269,0.682,10.731,0.682,9.172,2.242z"},
{type:"path",stroke:"none",fill:"270-#999996-#a1a19f:20-#b8b8b7:70-#ccc",path:"M7.181,5.869 7.181,17.95 16.974,17.95 16.974,9.205 13.638,5.869"},{type:"path",stroke:"none",fill:"#fff",path:"M12.724,9.619v-2.75H8.181V16.95h7.793v-6.832h-2.75C12.946,10.119,12.724,9.894,12.724,9.619zM13.724,7.369c0,0.521,0,1.32,0,1.75c0.428,0,1.229,0,1.75,0L13.724,7.369z"}]);
AJS.icons.addIcon("error",[{type:"path",stroke:"none",fill:"#c00",path:"M7.857,22L2,16.143 2,7.857 7.857,1.999 16.143,1.999 22,7.857 22,16.143 16.143,22z"},{type:"path",stroke:"none",fill:"90-#c00-#d50909-#ed2121-#f33",path:"M8.271,2.999C7.771,3.5,3.501,7.77,3,8.271c0,0.708,0,6.748,0,7.457c0.501,0.5,4.771,4.77,5.271,5.271c0.708,0,6.749,0,7.457,0c0.501-0.502,4.771-4.771,5.271-5.271c0-0.709,0-6.749,0-7.457c-0.501-0.501-4.771-4.771-5.271-5.272C15.021,2.999,8.979,2.999,8.271,2.999z"},{type:"rect",x:5.318,
y:9.321,fill:"270-#c00-#d50909-#ed2121-#f33",stroke:"none",width:13.363,height:5.356},{type:"rect",x:6.318,y:10.321,fill:"#fff",stroke:"none",width:11.363,height:3.356}]);
AJS.icons.addIcon("success",[{type:"path",stroke:"none",path:"M22,18.801C22,20.559,20.561,22,18.799,22H5.201C3.439,22,2,20.559,2,18.801V5.199C2,3.44,3.439,2,5.201,2h13.598C20.561,2,22,3.44,22,5.199V18.801z",fill:"#393"},{type:"path",path:"M5.201,3C3.987,3,3,3.986,3,5.199v13.602C3,20.014,3.987,21,5.201,21h13.598C20.013,21,21,20.014,21,18.801V5.199C21,3.986,20.013,3,18.799,3H5.201z",stroke:"none",fill:"90-#393-#33a23c-#3c6"},{type:"path",path:"M10.675,12.158c-0.503-0.57-1.644-1.862-1.644-1.862l-3.494,2.833l3.663,5.313l4.503,1.205L17.73,4.624l-4.361-0.056C13.369,4.568,11.424,10.047,10.675,12.158z",
stroke:"none",fill:"270-#393-#33a23c-#3c6"},{type:"path",path:"M14.072,5.577 11.05,14.092 8.917,11.677 6.886,13.324 9.815,17.57 12.997,18.422 16.432,5.607",stroke:"none",fill:"#fff"}]);
AJS.icons.addIcon("hint",[{type:"path",path:"M22.465,8.464c1.944,1.944,1.944,5.126,0,7.07l-6.93,6.93c-1.944,1.945-5.126,1.945-7.07,0l-6.929-6.93c-1.945-1.943-1.945-5.125,0-7.07l6.929-6.93c1.944-1.944,5.126-1.944,7.07,0L22.465,8.464z",stroke:"none",fill:"#009898"},{type:"path",path:"M9.172,2.242L9.172,2.242l-6.929,6.93C1.491,9.923,1.077,10.927,1.077,12c0,1.072,0.414,2.076,1.166,2.828l6.929,6.93c0.751,0.752,1.756,1.166,2.828,1.166s2.076-0.414,2.828-1.166l6.93-6.93c0.751-0.752,1.165-1.756,1.165-2.828c0-1.072-0.414-2.076-1.165-2.828l-6.93-6.93C13.269,0.682,10.731,0.682,9.172,2.242z",stroke:"none",
fill:"270-#099-#00a2a2-#00baba-#0cc"},{type:"path",path:"M12,5.077c-2.679,0-4.857,2.179-4.857,4.857c0,1.897,0.741,2.864,1.337,3.639c0.385,0.502,0.662,0.863,0.761,1.443l0.045,0.264v2.25c0,0.854,0.693,1.547,1.546,1.547h2.338c0.852,0,1.545-0.693,1.545-1.547v-2.254l0.044-0.258c0.1-0.582,0.377-0.943,0.762-1.443c0.596-0.777,1.338-1.743,1.338-3.641C16.857,7.255,14.679,5.077,12,5.077z",stroke:"none",fill:"270-#099-#00a2a2-#00baba-#0cc"},{type:"path",path:"M10.227,14.849c-0.331-1.936-2.084-2.197-2.084-4.915c0-2.131,1.727-3.857,3.857-3.857c2.13,0,3.857,1.727,3.857,3.857c0,2.717-1.754,2.979-2.085,4.915H10.227z M10.285,15.849v1.682c0,0.301,0.246,0.547,0.546,0.547h2.338c0.3,0,0.545-0.246,0.545-0.547v-1.682H10.285z",
stroke:"none",fill:"#fff"}]);
AJS.icons.addIcon("info",[{type:"circle",cx:12,cy:12,r:10,stroke:"none",fill:"#06c"},{type:"path",path:"M3,12c0,4.962,4.037,9,9,9s9-4.038,9-9s-4.037-9-9-9S3,7.037,3,12z",stroke:"none",fill:"90-#06c-#006FD5-#0087ED-#0099FF"},{type:"path",path:"M9.409,7.472c0,0.694,0.282,1.319,0.729,1.785c-0.288,0-0.729,0-0.729,0v9.425h5.182V9.257c0,0-0.44,0-0.729,0c0.446-0.466,0.729-1.09,0.729-1.785c0-1.429-1.162-2.591-2.591-2.591S9.409,6.043,9.409,7.472z",stroke:"none",fill:"270-#06c-#006FD5-#0087ED-#0099FF"},{type:"path",
path:"M13.591,10.257v7.425h-3.182v-7.425H13.591z M12,9.063c0.879,0,1.591-0.712,1.591-1.591S12.879,5.881,12,5.881s-1.591,0.712-1.591,1.591S11.121,9.063,12,9.063z",stroke:"none",fill:"#fff"}]);
AJS.icons.addIcon("warning",[{type:"path",path:"M8.595,4.368c1.873-3.245,4.938-3.245,6.811,0c1.873,3.245,4.938,8.554,6.812,11.798c1.874,3.244,0.342,5.898-3.405,5.898c-3.746,0-9.876,0-13.624,0c-3.746,0-5.278-2.654-3.405-5.898C3.656,12.922,6.721,7.613,8.595,4.368z",stroke:"none",fill:"#f90"},{type:"path",path:"M9.461,4.868L2.649,16.666c-0.72,1.246-0.863,2.371-0.404,3.166s1.504,1.232,2.943,1.232h13.624c1.439,0,2.485-0.438,2.944-1.232s0.315-1.92-0.405-3.166L14.539,4.868C13.82,3.622,12.918,2.935,12,2.935S10.181,3.621,9.461,4.868z",stroke:"none",
fill:"90-#f90-#ffa209-#ffba21-#fc3"},{type:"path",path:"M9.274,6.187c0,0,0.968,9.68,0.986,9.862c-0.532,0.476-0.881,1.148-0.881,1.916c0,1.433,1.165,2.598,2.597,2.598c1.433,0,2.598-1.165,2.598-2.598c0-0.77-0.351-1.441-0.883-1.918c0.018-0.184,0.988-9.86,0.988-9.86H9.274z",stroke:"none",fill:"270-#f90-#ffa209-#ffba21-#fc3"},{type:"path",path:"M11.177,15.171l-0.798-7.984h3.194l-0.8,7.984H11.177z M11.976,16.368c-0.882,0-1.597,0.716-1.597,1.597c0,0.883,0.715,1.598,1.597,1.598c0.881,0,1.598-0.715,1.598-1.598C13.573,17.084,12.856,16.368,11.976,16.368z",
stroke:"none",fill:"#fff"}]);
AJS.icons.addIcon("close",[{type:"path",path:"M15.535,12l4.95-4.95c0.977-0.977,0.977-2.559,0-3.536s-2.56-0.977-3.536,0L12,8.464l-4.95-4.95c-0.977-0.977-2.559-0.977-3.536,0s-0.977,2.559,0,3.536L8.464,12l-4.95,4.95c-0.977,0.977-0.977,2.559,0,3.535s2.559,0.977,3.536,0L12,15.535l4.949,4.949c0.977,0.977,2.56,0.977,3.536,0s0.977-2.559,0-3.535L15.535,12z",stroke:"none",fill:"#999"},{type:"path",path:"M18.718,20.217c-0.401,0-0.777-0.156-1.062-0.439L12,14.121l-5.657,5.656c-0.284,0.283-0.66,0.439-1.061,0.439c-0.4,0-0.777-0.156-1.061-0.439c-0.283-0.283-0.439-0.66-0.439-1.061s0.156-0.777,0.439-1.061L9.878,12L4.222,6.343c-0.283-0.284-0.439-0.66-0.439-1.061c0-0.4,0.156-0.777,0.439-1.061c0.284-0.283,0.66-0.439,1.061-0.439c0.401,0,0.777,0.156,1.061,0.439L12,9.878l5.656-5.657c0.284-0.283,0.66-0.439,1.062-0.439c0.4,0,0.776,0.156,1.061,0.439c0.283,0.284,0.439,0.66,0.439,1.061c0,0.401-0.156,0.777-0.439,1.061L14.121,12l5.657,5.657c0.283,0.283,0.439,0.66,0.439,1.061s-0.156,0.777-0.439,1.061C19.494,20.061,19.118,20.217,18.718,20.217L18.718,20.217z",stroke:"none",
fill:"90-#999996-#a1a19f-#b8b8b7-#ccc"}]);
(function(a){AJS.InlineDialog=function(b,e,d,g){if(typeof e==="undefined"){e=String(Math.random()).replace(".","");if(a("#inline-dialog-"+e+", #arrow-"+e+", #inline-dialog-shim-"+e).length)throw"GENERATED_IDENTIFIER_NOT_UNIQUE";}var f=a.extend(false,AJS.InlineDialog.opts,g),c,h,i,j=false,l=false,m=false,n,q,p=a('<div id="inline-dialog-'+e+'" class="aui-inline-dialog"><div class="contents"></div><div id="arrow-'+e+'" class="arrow"></div></div>'),w=a("#arrow-"+e,p),r=p.find(".contents");r.css("width",
f.width+"px");r.mouseover(function(){clearTimeout(h);p.unbind("mouseover")}).mouseout(function(){s()});var x=function(){c||(c={popup:p,hide:function(){s(0)},id:e,show:function(){t()},reset:function(){var b=f.calculatePositions(p,q,n,f);p.css(b.popupCss);if(window.Raphael){if(!p.arrowCanvas)p.arrowCanvas=Raphael("arrow-"+e,16,16);var c=f.getArrowPath,c=a.isFunction(c)?c(b):c;p.arrowCanvas.path(c).attr(f.getArrowAttributes())}w.css(b.arrowCss);p.fadeIn(f.fadeTime,function(){});if(f.displayShadow){p.shadow&&
p.shadow.remove();p.shadow=Raphael.shadow(0,0,r.width(),r.height(),{target:r}).hide().fadeIn(f.fadeTime)}if(AJS.$.browser.msie&&~~AJS.$.browser.version<10){a("#inline-dialog-shim-"+e).length==0&&a(p).prepend(a('<iframe class = "inline-dialog-shim" id="inline-dialog-shim-'+e+'" frameBorder="0" src="javascript:false;"></iframe>'));a("#inline-dialog-shim-"+e).css({width:r.outerWidth(),height:r.outerHeight()})}}});return c},t=function(){p.is(":visible")||(i=setTimeout(function(){if(m&&l){f.addActiveClass&&
a(b).addClass("active");j=true;if(!B){a("body").bind("click."+u,function(b){a(b.target).closest("#inline-dialog-"+e+" .contents").length===0&&s(0)});B=true}AJS.InlineDialog.current=x();AJS.$(document).trigger("showLayer",["inlineDialog",x()]);x().reset()}},f.showDelay))},s=function(c){l=false;if(j&&f.preHideCallback.call(p[0].popup)){c=c==null?f.hideDelay:c;clearTimeout(h);clearTimeout(i);c!=null&&(h=setTimeout(function(){B&&a("body").unbind("click."+u);B=false;f.addActiveClass&&a(b).removeClass("active");
p.fadeOut(f.fadeTime,function(){f.hideCallback.call(p[0].popup)});if(f.displayShadow){p.shadow.remove();p.shadow=null}p.arrowCanvas.remove();p.arrowCanvas=null;l=j=false;AJS.$(document).trigger("hideLayer",["inlineDialog",x()]);AJS.InlineDialog.current=null;if(!f.cacheContent)o=m=false},c))}},v=function(b,c){var g=a(c);f.upfrontCallback.call({popup:p,hide:function(){s(0)},id:e,show:function(){t()}});p.each(function(){typeof this.popup!="undefined"&&this.popup.hide()});f.closeOthers&&AJS.$(".aui-inline-dialog").each(function(){this.popup.hide()});
q={target:g};n=b?{x:b.pageX,y:b.pageY}:{x:g.offset().left,y:g.offset().top};j||clearTimeout(i);l=true;g=function(){o=false;m=true;f.initCallback.call({popup:p,hide:function(){s(0)},id:e,show:function(){t()}});t()};if(!o){o=true;a.isFunction(d)?d(r,c,g):AJS.$.get(d,function(a,b,c){r.html(f.responseHandler(a,b,c));m=true;f.initCallback.call({popup:p,hide:function(){s(0)},id:e,show:function(){t()}});t()})}clearTimeout(h);j||t();return false};p[0].popup=x();var o=false,y=false,A=function(){if(!y){a(f.container).append(p);
y=true}};f.onHover?f.useLiveEvents?a(b).live("mousemove",function(a){A();v(a,this)}).live("mouseout",function(){s()}):a(b).mousemove(function(a){A();v(a,this)}).mouseout(function(){s()}):f.noBind||(f.useLiveEvents?a(b).live("click",function(a){A();v(a,this);return false}).live("mouseout",function(){s()}):a(b).click(function(a){A();v(a,this);return false}).mouseout(function(){s()}));var B=false,u=e+".inline-dialog-check";p.show=function(a){a&&a.stopPropagation();A();v(null,b)};p.hide=function(){s(0)};
p.refresh=function(){j&&x().reset()};p.getOptions=function(){return f};return p};AJS.InlineDialog.opts={onTop:false,responseHandler:function(a){return a},closeOthers:true,isRelativeToMouse:false,addActiveClass:true,onHover:false,useLiveEvents:false,noBind:false,fadeTime:100,hideDelay:1E4,showDelay:0,width:300,offsetX:0,offsetY:10,arrowOffsetX:0,container:"body",cacheContent:true,displayShadow:true,preHideCallback:function(){return true},hideCallback:function(){},initCallback:function(){},upfrontCallback:function(){},
calculatePositions:function(b,e,d,g){var f,c,h=-7,i,j=e.target.offset(),l=e.target.outerWidth(),m=j.left+l/2;i=(window.pageYOffset||document.documentElement.scrollTop)+a(window).height();c=j.top+e.target.outerHeight()+g.offsetY;var e=j.left+g.offsetX,n=j.top>b.height();i=!(c+b.height()<i)&&n||g.onTop&&n;n=a(window).width()-(e+g.width+10);if(i){c=j.top-b.height()-8;h=g.displayShadow?AJS.$.browser.msie?10:9:0;h=b.height()-h}b=m-e+g.arrowOffsetX;if(g.isRelativeToMouse)if(n<0){f=10;e="auto";b=d.x-(a(window).width()-
g.width)}else{e=d.x-20;f="auto";b=d.x-e}else if(n<0){f=10;e="auto";b=m-(a(window).width()-g.width)}else if(g.width<=l/2){b=g.width/2;e=m-g.width/2}return{displayAbove:i,popupCss:{left:e,right:f,top:c},arrowCss:{position:"absolute",left:b,right:"auto",top:h}}},getArrowPath:function(a){return a.displayAbove?"M0,8L8,16,16,8":"M0,8L8,0,16,8"},getArrowAttributes:function(){return{fill:"#fff",stroke:"#ccc"}}}})(jQuery);
(function(){AJS.messages={setup:function(){AJS.messages.createMessage("generic");AJS.messages.createMessage("error");AJS.messages.createMessage("warning");AJS.messages.createMessage("info");AJS.messages.createMessage("success");AJS.messages.createMessage("hint");AJS.messages.makeCloseable()},makeCloseable:function(a){AJS.$(a||"div.aui-message.closeable").each(function(){var a=AJS.$(this),e=AJS.$('<span class="aui-icon icon-close" role="button" tabindex="0"></span>').click(function(){a.closeMessage()}).keypress(function(d){if(d.which===
AJS.$.ui.keyCode.ENTER||d.which===AJS.$.ui.keyCode.SPACE){a.closeMessage();d.preventDefault()}});a.append(e);e.each(AJS.icons.addIcon.init)})},template:'<div class="aui-message {type} {closeable} {shadowed}"><p class="title"><span class="aui-icon icon-{type}"></span><strong>{title}</strong></p>{body}</div><\!-- .aui-message --\>',createMessage:function(a){AJS.messages[a]=function(b,e){var d=this.template;if(!e){e=b;b="#aui-message-bar"}e.closeable=e.closeable==false?false:true;e.shadowed=e.shadowed==
false?false:true;d=AJS.$(AJS.template(d).fill({type:a,closeable:e.closeable?"closeable":"",shadowed:e.shadowed?"shadowed":"",title:e.title||"","body:html":e.body||""}).toString());e.id&&(/[#\'\"\.\s]/g.test(e.id)?AJS.log("AJS.Messages error: ID rejected, must not include spaces, hashes, dots or quotes."):d.attr("id",e.id));(e.insert||"append")==="prepend"?d.prependTo(b):d.appendTo(b);e.closeable&&AJS.messages.makeCloseable(d)}}};AJS.$.fn.closeMessage=function(){var a=AJS.$(this);a.hasClass("aui-message",
"closeable")&&a.trigger("messageClose",[this]).remove()};AJS.$(function(){AJS.messages.setup()})})();(function(){AJS.tables=AJS.tables||{};AJS.tables.rowStriping=function(){for(var a=AJS.$("table.aui-zebra > tbody"),b=0,e=a.length;b<e;b++)AJS.$(a[b]).find("> tr").filter(":odd").addClass("aui-zebra")};AJS.$(AJS.tables.rowStriping)})();
(function(){var a,b,e,d,g=/#.*/;AJS.tabs={setup:function(){var f;a=AJS.$(".aui-tabs:not(.aui-tabs-disabled)");for(var c=0,g=a.length;c<g;c++){f=AJS.$(a[c]);if(!f.data("aui-tab-events-bound")){b=AJS.$("ul.tabs-menu",a[c]);b.delegate("a","click",function(a){AJS.tabs.change(AJS.$(this),a);a&&a.preventDefault()});f.data("aui-tab-events-bound",true)}}AJS.$(".aui-tabs.vertical-tabs").find("a").each(function(){e=AJS.$(this);if(!e.attr("title")){d=e.children("strong:first");AJS.isClipped(d)&&e.attr("title",
e.text())}})},change:function(a){var b=AJS.$(a.attr("href").match(g)[0]);b.addClass("active-pane").siblings().removeClass("active-pane");a.parent("li.menu-item").addClass("active-tab").siblings().removeClass("active-tab");a.trigger("tabSelect",{tab:a,pane:b})}};AJS.$(AJS.tabs.setup)})();
AJS.template=function(a){var b=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,d=/([^\\])'/g,g=function(a,b,c,d){var f=c;b.replace(e,function(a,b,c,e,g){b=b||e;if(f){if(b+":html"in f){f=f[b+":html"];d=true}else b in f&&(f=f[b]);g&&typeof f=="function"&&(f=f())}});if(f==null||f==c)f=a;f=String(f);d||(f=i.escape(f));return f},f=function(a){this.template=this.template.replace(b,function(b,c){return g(b,c,a,true)});return this},c=function(a){this.template=this.template.replace(b,
function(b,c){return g(b,c,a)});return this},h=function(){return this.template},i=function(a){function b(){return b.template}b.template=String(a);b.toString=b.valueOf=h;b.fill=c;b.fillHtml=f;return b},j={},l=[];i.load=function(b){b=String(b);if(!j.hasOwnProperty(b)){l.length>=1E3&&delete j[l.shift()];l.push(b);j[b]=a("script[title='"+b.replace(d,"$1\\'")+"']")[0].text}return this(j[b])};i.escape=AJS.escapeHtml;return i}(window.jQuery);
AJS.setUpToolbars=function(){if(jQuery.browser.msie){var a=jQuery(".aui-toolbar .toolbar-group");a.each(function(a,b){jQuery(b).children(":first").addClass("first");jQuery(b).children(":last").addClass("last")});if(parseInt(jQuery.browser.version,10)==7){var b=function(){jQuery(".aui-toolbar .toolbar-split-right").each(function(a,b){var f=jQuery(b).closest(".aui-toolbar"),c=f.find(".toolbar-split-left"),e=f.data("leftWidth"),i=f.data("rightWidth");if(!e){e=c.outerWidth();f.data("leftWidth",e)}if(!i){i=
0;jQuery(".toolbar-item",b).each(function(a,b){i=i+jQuery(b).outerWidth()});f.data("rightWidth",i)}f=f.width();f>i&&i>f-e?c.addClass("force-split"):c.removeClass("force-split")})};a.each(function(a,b){var f=0;jQuery(b).children(".toolbar-item").each(function(){f=f+jQuery(this).outerWidth()});jQuery(this).width(f)});jQuery(".aui-toolbar button").closest(".toolbar-item").addClass("contains-button");var e=false;jQuery(window).resize(function(){e!==false&&clearTimeout(e);e=setTimeout(b,200)})}}};AJS.toInit(function(){AJS.setUpToolbars()});
(function(a,b){var e=navigator.platform.indexOf("Mac")!==-1,d=/^(backspace|tab|r(ight|eturn)|s(hift|pace|croll)|c(trl|apslock)|alt|pa(use|ge(up|down))|e(sc|nd)|home|left|up|d(el|own)|insert|f\d\d?|numlock|meta)/i;a.whenIType=function(g){function f(a){!AJS.popup.current&&l&&l.fire(a)}function c(a){a.preventDefault()}function h(a){a=a&&a.split?b.trim(a).split(" "):[a];b.each(a,function(){var a;if(this instanceof Array)a=this;else{a=this.toString();for(var e=[],g="",h;a.length;)if(h=a.match(/^(ctrl|meta|shift|alt)\+/i)){g=
g+h[0];a=a.substring(h[0].length)}else{if(h=a.match(d)){e.push(g+h[0]);a=a.substring(h[0].length)}else{e.push(g+a[0]);a=a.substring(1)}g=""}a=e}a:{for(e=a.length;e--;)if(a[e].length>1&&a[e]!=="space"){e=true;break a}e=false}e=e?"keydown":"keypress";j.push(a);b(document).bind(e,a,f);b(document).bind(e+" keyup",a,c)})}function i(a,c,d){if(d)c=c+(" ("+AJS.I18n.getText("aui.keyboard.shortcut.type.x",a.shift()));else{c=c.replace(/\)$/,"");c=c+AJS.I18n.getText("aui.keyboard.shortcut.or.x",a.shift())}b.each(a,
function(){c=c+(" "+AJS.I18n.getText("aui.keyboard.shortcut.then.x",this))});return c=c+")"}var j=[],l=b.Callbacks();h(g);return a.whenIType.makeShortcut({executor:l,bindKeys:h,addShortcutsToTitle:function(a){for(var a=b(a),c=a.attr("title")||"",d=j.slice(),f=a.data("kbShortcutAppended")||"",g=!f,c=g?c:c.substring(0,c.length-f.length);d.length;){f=i(d.shift().slice(),f,g);g=false}e&&(f=f.replace(/Meta/ig,"\u2318").replace(/Shift/ig,"\u21e7"));a.attr("title",c+f);a.data("kbShortcutAppended",f)},removeShortcutsFromTitle:function(a){var a=
b(a),c=a.data("kbShortcutAppended");if(c){var d=a.attr("title");a.attr("title",d.replace(c,""));a.removeData("kbShortcutAppended")}},keypressHandler:f,defaultPreventionHandler:c})};a.whenIType.makeShortcut=function(a){function d(a){return function(d,f){var f=f||{},e=f.focusedClass||"focused",g=f.hasOwnProperty("wrapAround")?f.wrapAround:true,h=f.hasOwnProperty("escToCancel")?f.escToCancel:true;c.add(function(){var c=b(d),f=c.filter("."+e),i=f.length===0?void 0:{transition:true};if(h)b(document).one("keydown",
function(a){a.keyCode===b.ui.keyCode.ESCAPE&&f&&f.removeClass(e)});f.length&&f.removeClass(e);if((f=a(f,c,g))&&f.length>0){f.addClass(e);f.moveTo(i);f.is("a")?f.focus():f.find("a:first").focus()}});return this}}var c=a.executor,e=a.bindKeys,i=a.addShortcutsToTitle,j=a.removeShortcutsFromTitle,l=a.keypressHandler,m=a.defaultPreventionHandler,n=[];return{moveToNextItem:d(function(a,c,d){var f;if(d&&a.length===0)return c.eq(0);f=b.inArray(a.get(0),c);return f<c.length-1?c.eq(f+1):d?c.eq(0):a}),moveToPrevItem:d(function(a,
c,d){var f;if(d&&a.length===0)return c.filter(":last");f=b.inArray(a.get(0),c);return f>0?c.eq(f-1):d?c.filter(":last"):a}),click:function(a){n.push(a);i(a);c.add(function(){var c=b(a);c.length>0&&c.click()});return this},goTo:function(a){c.add(function(){window.location.href=a});return this},followLink:function(a){n.push(a);i(a);c.add(function(){var c=b(a)[0];if(c&&{a:true,link:true}[c.nodeName.toLowerCase()])window.location.href=c.href});return this},execute:function(a){var b=this;c.add(function(){a.apply(b,
arguments)});return this},evaluate:function(a){a.call(this)},moveToAndClick:function(a){n.push(a);i(a);c.add(function(){var c=b(a);if(c.length>0){c.click();c.moveTo()}});return this},moveToAndFocus:function(a){n.push(a);i(a);c.add(function(b){var c=jQuery(a);if(c.length>0){c.focus();c.moveTo&&c.moveTo();c.is(":input")&&b.preventDefault()}});return this},or:function(a){e(a);return this},unbind:function(){b(document).unbind("keydown keypress",l).unbind("keydown keypress keyup",m);for(var a=0,c=n.length;a<
c;a++)j(n[a]);n=[]}}};a.whenIType.fromJSON=function(a,d){var c=[];a&&b.each(a,function(a,g){var j=g.op,l=g.param,m;if(j==="execute"||j==="evaluate")m=[new Function(l)];else if(/^\[[^\]\[]*,[^\]\[]*\]$/.test(l)){try{m=JSON.parse(l)}catch(n){var q="When using a parameter array, array must be in strict JSON format: "+l;console&&console.error?console.error(q):AJS.log(q)}if(!b.isArray(m)){l="Badly formatted shortcut parameter. String or JSON Array of parameters required: "+l;console&&console.error?console.error(l):
AJS.log(l)}}else m=[l];b.each(g.keys,function(){var a=this;d&&e&&(a=b.map(this,function(a){return a.replace(/ctrl/i,"meta")}));a=AJS.whenIType(a);a[j].apply(a,m);c.push(a)})});return c};b(document).bind("iframeAppended",function(a,d){b(d).load(function(){b(d).contents().bind("keyup keydown keypress",function(a){b.browser.safari&&a.type==="keypress"||b(a.target).is(":input")||b.event.trigger(a,arguments,document,true)})})})})(AJS,AJS.$);
(function(a){a.fn.tooltip=function(b){if(typeof b!="object")return this.tipsy(b);var b=a.extend({},a.fn.tooltip.defaults,b),e=this.tipsy(b);if(b.hideOnClick&&(b.trigger=="hover"||!b.trigger&&this.tipsy.defaults.trigger=="hover")){var d=function(){a(this).tipsy("hide")};if(b.live)a(this.context).on("click.tipsy",this.selector,d);else this.bind("click.tipsy",d)}return e};a.fn.tooltip.defaults={opacity:1,offset:1,delayIn:500,hoverable:true,hideOnClick:true}})(jQuery);
(function(){var a=this,b=a._,e={},d=Array.prototype,g=Object.prototype,f=d.push,c=d.slice,h=d.concat,i=g.toString,j=g.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,q=d.reduceRight,p=d.filter,w=d.every,r=d.some,x=d.indexOf,t=d.lastIndexOf,g=Array.isArray,s=Object.keys,v=Function.prototype.bind,o=function(a){if(a instanceof o)return a;if(!(this instanceof o))return new o(a);this._wrapped=a};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=o;exports._=
o}else a._=o;o.VERSION="1.4.4";var y=o.each=o.forEach=function(a,b,c){if(a!=null)if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,f=a.length;d<f;d++){if(b.call(c,a[d],d,a)===e)break}else for(d in a)if(o.has(a,d)&&b.call(c,a[d],d,a)===e)break};o.map=o.collect=function(a,b,c){var d=[];if(a==null)return d;if(m&&a.map===m)return a.map(b,c);y(a,function(a,f,e){d[d.length]=b.call(c,a,f,e)});return d};o.reduce=o.foldl=o.inject=function(a,b,c,d){var f=arguments.length>2;a==null&&
(a=[]);if(n&&a.reduce===n){d&&(b=o.bind(b,d));return f?a.reduce(b,c):a.reduce(b)}y(a,function(a,e,g){if(f)c=b.call(d,c,a,e,g);else{c=a;f=true}});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};o.reduceRight=o.foldr=function(a,b,c,d){var f=arguments.length>2;a==null&&(a=[]);if(q&&a.reduceRight===q){d&&(b=o.bind(b,d));return f?a.reduceRight(b,c):a.reduceRight(b)}var e=a.length;if(e!==+e)var g=o.keys(a),e=g.length;y(a,function(h,i,m){i=g?g[--e]:--e;if(f)c=b.call(d,
c,a[i],i,m);else{c=a[i];f=true}});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};o.find=o.detect=function(a,b,c){var d;A(a,function(a,f,e){if(b.call(c,a,f,e)){d=a;return true}});return d};o.filter=o.select=function(a,b,c){var d=[];if(a==null)return d;if(p&&a.filter===p)return a.filter(b,c);y(a,function(a,f,e){b.call(c,a,f,e)&&(d[d.length]=a)});return d};o.reject=function(a,b,c){return o.filter(a,function(a,d,f){return!b.call(c,a,d,f)},c)};o.every=o.all=function(a,
b,c){b||(b=o.identity);var d=true;if(a==null)return d;if(w&&a.every===w)return a.every(b,c);y(a,function(a,f,g){if(!(d=d&&b.call(c,a,f,g)))return e});return!!d};var A=o.some=o.any=function(a,b,c){b||(b=o.identity);var d=false;if(a==null)return d;if(r&&a.some===r)return a.some(b,c);y(a,function(a,f,g){if(d||(d=b.call(c,a,f,g)))return e});return!!d};o.contains=o.include=function(a,b){return a==null?false:x&&a.indexOf===x?a.indexOf(b)!=-1:A(a,function(a){return a===b})};o.invoke=function(a,b){var d=
c.call(arguments,2),f=o.isFunction(b);return o.map(a,function(a){return(f?b:a[b]).apply(a,d)})};o.pluck=function(a,b){return o.map(a,function(a){return a[b]})};o.where=function(a,b,c){return o.isEmpty(b)?c?null:[]:o[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return false;return true})};o.findWhere=function(a,b){return o.where(a,b,true)};o.max=function(a,b,c){if(!b&&o.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&o.isEmpty(a))return-Infinity;var d=
{computed:-Infinity,value:-Infinity};y(a,function(a,f,e){f=b?b.call(c,a,f,e):a;f>=d.computed&&(d={value:a,computed:f})});return d.value};o.min=function(a,b,c){if(!b&&o.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&o.isEmpty(a))return Infinity;var d={computed:Infinity,value:Infinity};y(a,function(a,f,e){f=b?b.call(c,a,f,e):a;f<d.computed&&(d={value:a,computed:f})});return d.value};o.shuffle=function(a){var b,c=0,d=[];y(a,function(a){b=o.random(c++);d[c-1]=d[b];d[b]=
a});return d};var B=function(a){return o.isFunction(a)?a:function(b){return b[a]}};o.sortBy=function(a,b,c){var d=B(b);return o.pluck(o.map(a,function(a,b,f){return{value:a,index:b,criteria:d.call(c,a,b,f)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||c===void 0)return 1;if(c<d||d===void 0)return-1}return a.index<b.index?-1:1}),"value")};var u=function(a,b,c,d){var f={},e=B(b||o.identity);y(a,function(b,g){var h=e.call(c,b,g,a);d(f,h,b)});return f};o.groupBy=function(a,b,c){return u(a,
b,c,function(a,b,c){(o.has(a,b)?a[b]:a[b]=[]).push(c)})};o.countBy=function(a,b,c){return u(a,b,c,function(a,b){o.has(a,b)||(a[b]=0);a[b]++})};o.sortedIndex=function(a,b,c,d){for(var c=c==null?o.identity:B(c),b=c.call(d,b),f=0,e=a.length;f<e;){var g=f+e>>>1;c.call(d,a[g])<b?f=g+1:e=g}return f};o.toArray=function(a){return!a?[]:o.isArray(a)?c.call(a):a.length===+a.length?o.map(a,o.identity):o.values(a)};o.size=function(a){return a==null?0:a.length===+a.length?a.length:o.keys(a).length};o.first=o.head=
o.take=function(a,b,d){return a==null?void 0:b!=null&&!d?c.call(a,0,b):a[0]};o.initial=function(a,b,d){return c.call(a,0,a.length-(b==null||d?1:b))};o.last=function(a,b,d){return a==null?void 0:b!=null&&!d?c.call(a,Math.max(a.length-b,0)):a[a.length-1]};o.rest=o.tail=o.drop=function(a,b,d){return c.call(a,b==null||d?1:b)};o.compact=function(a){return o.filter(a,o.identity)};var D=function(a,b,c){y(a,function(a){o.isArray(a)?b?f.apply(c,a):D(a,b,c):c.push(a)});return c};o.flatten=function(a,b){return D(a,
b,[])};o.without=function(a){return o.difference(a,c.call(arguments,1))};o.uniq=o.unique=function(a,b,c,d){if(o.isFunction(b)){d=c;c=b;b=false}var c=c?o.map(a,c,d):a,f=[],e=[];y(c,function(c,d){if(b?!d||e[e.length-1]!==c:!o.contains(e,c)){e.push(c);f.push(a[d])}});return f};o.union=function(){return o.uniq(h.apply(d,arguments))};o.intersection=function(a){var b=c.call(arguments,1);return o.filter(o.uniq(a),function(a){return o.every(b,function(b){return o.indexOf(b,a)>=0})})};o.difference=function(a){var b=
h.apply(d,c.call(arguments,1));return o.filter(a,function(a){return!o.contains(b,a)})};o.zip=function(){for(var a=c.call(arguments),b=o.max(o.pluck(a,"length")),d=Array(b),f=0;f<b;f++)d[f]=o.pluck(a,""+f);return d};o.object=function(a,b){if(a==null)return{};for(var c={},d=0,f=a.length;d<f;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};o.indexOf=function(a,b,c){if(a==null)return-1;var d=0,f=a.length;if(c)if(typeof c=="number")d=c<0?Math.max(0,f+c):c;else{d=o.sortedIndex(a,b);return a[d]===b?d:-1}if(x&&
a.indexOf===x)return a.indexOf(b,c);for(;d<f;d++)if(a[d]===b)return d;return-1};o.lastIndexOf=function(a,b,c){if(a==null)return-1;var d=c!=null;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=d?c:a.length;c--;)if(a[c]===b)return c;return-1};o.range=function(a,b,c){if(arguments.length<=1){b=a||0;a=0}for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-a)/c),0),f=0,e=Array(d);f<d;){e[f++]=a;a=a+c}return e};o.bind=function(a,b){if(a.bind===v&&v)return v.apply(a,c.call(arguments,
1));var d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}};o.partial=function(a){var b=c.call(arguments,1);return function(){return a.apply(this,b.concat(c.call(arguments)))}};o.bindAll=function(a){var b=c.call(arguments,1);b.length===0&&(b=o.functions(a));y(b,function(b){a[b]=o.bind(a[b],a)});return a};o.memoize=function(a,b){var c={};b||(b=o.identity);return function(){var d=b.apply(this,arguments);return o.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};o.delay=
function(a,b){var d=c.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};o.defer=function(a){return o.delay.apply(o,[a,1].concat(c.call(arguments,1)))};o.throttle=function(a,b){var c,d,f,e,g=0,h=function(){g=new Date;f=null;e=a.apply(c,d)};return function(){var i=new Date,m=b-(i-g);c=this;d=arguments;if(m<=0){clearTimeout(f);f=null;g=i;e=a.apply(c,d)}else f||(f=setTimeout(h,m));return e}};o.debounce=function(a,b,c){var d,f;return function(){var e=this,g=arguments,h=c&&!d;clearTimeout(d);
d=setTimeout(function(){d=null;c||(f=a.apply(e,g))},b);h&&(f=a.apply(e,g));return f}};o.once=function(a){var b=false,c;return function(){if(b)return c;b=true;c=a.apply(this,arguments);a=null;return c}};o.wrap=function(a,b){return function(){var c=[a];f.apply(c,arguments);return b.apply(this,c)}};o.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}};o.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,
arguments)}};o.keys=s||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)o.has(a,c)&&(b[b.length]=c);return b};o.values=function(a){var b=[],c;for(c in a)o.has(a,c)&&b.push(a[c]);return b};o.pairs=function(a){var b=[],c;for(c in a)o.has(a,c)&&b.push([c,a[c]]);return b};o.invert=function(a){var b={},c;for(c in a)o.has(a,c)&&(b[a[c]]=c);return b};o.functions=o.methods=function(a){var b=[],c;for(c in a)o.isFunction(a[c])&&b.push(c);return b.sort()};o.extend=function(a){y(c.call(arguments,
1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};o.pick=function(a){var b={},f=h.apply(d,c.call(arguments,1));y(f,function(c){c in a&&(b[c]=a[c])});return b};o.omit=function(a){var b={},f=h.apply(d,c.call(arguments,1)),e;for(e in a)o.contains(f,e)||(b[e]=a[e]);return b};o.defaults=function(a){y(c.call(arguments,1),function(b){if(b)for(var c in b)a[c]==null&&(a[c]=b[c])});return a};o.clone=function(a){return!o.isObject(a)?a:o.isArray(a)?a.slice():o.extend({},a)};o.tap=function(a,b){b(a);return a};
var k=function(a,b,c,d){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof o)a=a._wrapped;if(b instanceof o)b=b._wrapped;var f=i.call(a);if(f!=i.call(b))return false;switch(f){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!=
"object"||typeof b!="object")return false;for(var e=c.length;e--;)if(c[e]==a)return d[e]==b;c.push(a);d.push(b);var e=0,g=true;if(f=="[object Array]"){e=a.length;if(g=e==b.length)for(;e--;)if(!(g=k(a[e],b[e],c,d)))break}else{var f=a.constructor,h=b.constructor;if(f!==h&&(!o.isFunction(f)||!(f instanceof f&&o.isFunction(h)&&h instanceof h)))return false;for(var m in a)if(o.has(a,m)){e++;if(!(g=o.has(b,m)&&k(a[m],b[m],c,d)))break}if(g){for(m in b)if(o.has(b,m)&&!e--)break;g=!e}}c.pop();d.pop();return g};
o.isEqual=function(a,b){return k(a,b,[],[])};o.isEmpty=function(a){if(a==null)return true;if(o.isArray(a)||o.isString(a))return a.length===0;for(var b in a)if(o.has(a,b))return false;return true};o.isElement=function(a){return!!(a&&a.nodeType===1)};o.isArray=g||function(a){return i.call(a)=="[object Array]"};o.isObject=function(a){return a===Object(a)};y(["Arguments","Function","String","Number","Date","RegExp"],function(a){o["is"+a]=function(b){return i.call(b)=="[object "+a+"]"}});if(!o.isArguments(arguments))o.isArguments=
function(a){return!(!a||!o.has(a,"callee"))};if(typeof/./!=="function")o.isFunction=function(a){return typeof a==="function"};o.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};o.isNaN=function(a){return o.isNumber(a)&&a!=+a};o.isBoolean=function(a){return a===true||a===false||i.call(a)=="[object Boolean]"};o.isNull=function(a){return a===null};o.isUndefined=function(a){return a===void 0};o.has=function(a,b){return j.call(a,b)};o.noConflict=function(){a._=b;return this};o.identity=
function(a){return a};o.times=function(a,b,c){for(var d=Array(a),f=0;f<a;f++)d[f]=b.call(c,f);return d};o.random=function(a,b){if(b==null){b=a;a=0}return a+Math.floor(Math.random()*(b-a+1))};var E={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};E.unescape=o.invert(E.escape);var z={escape:RegExp("["+o.keys(E.escape).join("")+"]","g"),unescape:RegExp("("+o.keys(E.unescape).join("|")+")","g")};o.each(["escape","unescape"],function(a){o[a]=function(b){return b==null?
"":(""+b).replace(z[a],function(b){return E[a][b]})}});o.result=function(a,b){if(a==null)return null;var c=a[b];return o.isFunction(c)?c.call(a):c};o.mixin=function(a){y(o.functions(a),function(b){var c=o[b]=a[b];o.prototype[b]=function(){var a=[this._wrapped];f.apply(a,arguments);a=c.apply(o,a);return this._chain?o(a).chain():a}})};var Q=0;o.uniqueId=function(a){var b=++Q+"";return a?a+b:b};o.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=
/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;o.template=function(a,b,c){var d,c=o.defaults({},c,o.templateSettings),f=RegExp([(c.escape||V).source,(c.interpolate||V).source,(c.evaluate||V).source].join("|")+"|$","g"),e=0,g="__p+='";a.replace(f,function(b,c,d,f,h){g=g+a.slice(e,h).replace(L,function(a){return"\\"+F[a]});c&&(g=g+("'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"));d&&(g=g+("'+\n((__t=("+d+"))==null?'':__t)+\n'"));
f&&(g=g+("';\n"+f+"\n__p+='"));e=h+b.length;return b});g=g+"';\n";c.variable||(g="with(obj||{}){\n"+g+"}\n");g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){h.source=g;throw h;}if(b)return d(b,o);b=function(a){return d.call(this,a,o)};b.source="function("+(c.variable||"obj")+"){\n"+g+"}";return b};o.chain=function(a){return o(a).chain()};o.mixin(o);y(["pop","push","reverse","shift",
"sort","splice","unshift"],function(a){var b=d[a];o.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);(a=="shift"||a=="splice")&&c.length===0&&delete c[0];return this._chain?o(c).chain():c}});y(["concat","join","slice"],function(a){var b=d[a];o.prototype[a]=function(){var a=b.apply(this._wrapped,arguments);return this._chain?o(a).chain():a}});o.extend(o.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);
(function(){var a=this,b=a.Backbone,e=[],d=e.push,g=e.slice,f=e.splice,c;c=typeof exports!=="undefined"?exports:a.Backbone={};c.VERSION="0.9.10";var h=a._;!h&&typeof require!=="undefined"&&(h=require("underscore"));c.$=a.jQuery||a.Zepto||a.ender;c.noConflict=function(){a.Backbone=b;return this};c.emulateHTTP=false;c.emulateJSON=false;var i=/\s+/,j=function(a,b,c,d){if(!c)return true;if(typeof c==="object")for(var f in c)a[b].apply(a,[f,c[f]].concat(d));else if(i.test(c)){c=c.split(i);f=0;for(var e=
c.length;f<e;f++)a[b].apply(a,[c[f]].concat(d))}else return true},l=function(a,b){var c,d=-1,f=a.length;switch(b.length){case 0:for(;++d<f;)(c=a[d]).callback.call(c.ctx);break;case 1:for(;++d<f;)(c=a[d]).callback.call(c.ctx,b[0]);break;case 2:for(;++d<f;)(c=a[d]).callback.call(c.ctx,b[0],b[1]);break;case 3:for(;++d<f;)(c=a[d]).callback.call(c.ctx,b[0],b[1],b[2]);break;default:for(;++d<f;)(c=a[d]).callback.apply(c.ctx,b)}},e=c.Events={on:function(a,b,c){if(!j(this,"on",a,[b,c])||!b)return this;this._events||
(this._events={});(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this});return this},once:function(a,b,c){if(!j(this,"once",a,[b,c])||!b)return this;var d=this,f=h.once(function(){d.off(a,f);b.apply(this,arguments)});f._callback=b;this.on(a,f,c);return this},off:function(a,b,c){var d,f,e,g,i,m,l,k;if(!this._events||!j(this,"off",a,[b,c]))return this;if(!a&&!b&&!c){this._events={};return this}g=a?[a]:h.keys(this._events);i=0;for(m=g.length;i<m;i++){a=g[i];if(d=this._events[a]){e=
[];if(b||c){l=0;for(k=d.length;l<k;l++){f=d[l];(b&&b!==f.callback&&b!==f.callback._callback||c&&c!==f.context)&&e.push(f)}}this._events[a]=e}}return this},trigger:function(a){if(!this._events)return this;var b=g.call(arguments,1);if(!j(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;c&&l(c,b);d&&l(d,arguments);return this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),f=a._listenerId||(a._listenerId=h.uniqueId("l"));d[f]=a;a.on(b,typeof b==="object"?
this:c,this);return this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a){a.off(b,typeof b==="object"?this:c,this);!b&&!c&&delete d[a._listenerId]}else{typeof b==="object"&&(c=this);for(var f in d)d[f].off(b,c,this);this._listeners={}}return this}}};e.bind=e.on;e.unbind=e.off;h.extend(c,e);var m=c.Model=function(a,b){var c,d=a||{};this.cid=h.uniqueId("c");this.attributes={};if(b&&b.collection)this.collection=b.collection;b&&b.parse&&(d=this.parse(d,b)||{});if(c=h.result(this,"defaults"))d=
h.defaults({},d,c);this.set(d,b);this.changed={};this.initialize.apply(this,arguments)};h.extend(m.prototype,e,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},sync:function(){return c.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return h.escape(this.get(a))},has:function(a){return this.get(a)!=null},set:function(a,b,c){var d,f,e,g,i,m,j;if(a==null)return this;if(typeof a==="object"){f=a;c=b}else(f=
{})[a]=b;c||(c={});if(!this._validate(f,c))return false;e=c.unset;g=c.silent;a=[];i=this._changing;this._changing=true;if(!i){this._previousAttributes=h.clone(this.attributes);this.changed={}}j=this.attributes;m=this._previousAttributes;if(this.idAttribute in f)this.id=f[this.idAttribute];for(d in f){b=f[d];h.isEqual(j[d],b)||a.push(d);h.isEqual(m[d],b)?delete this.changed[d]:this.changed[d]=b;e?delete j[d]:j[d]=b}if(!g){if(a.length)this._pending=true;b=0;for(d=a.length;b<d;b++)this.trigger("change:"+
a[b],this,j[a[b]],c)}if(i)return this;if(!g)for(;this._pending;){this._pending=false;this.trigger("change",this,c)}this._changing=this._pending=false;return this},unset:function(a,b){return this.set(a,void 0,h.extend({},b,{unset:true}))},clear:function(a){var b={},c;for(c in this.attributes)b[c]=void 0;return this.set(b,h.extend({},a,{unset:true}))},hasChanged:function(a){return a==null?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this.changed):
false;var b,c=false,d=this._changing?this._previousAttributes:this.attributes,f;for(f in a)if(!h.isEqual(d[f],b=a[f]))(c||(c={}))[f]=b;return c},previous:function(a){return a==null||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(a){a=a?h.clone(a):{};if(a.parse===void 0)a.parse=true;var b=a.success;a.success=function(a,c,d){if(!a.set(a.parse(c,d),d))return false;b&&b(a,c,d)};return this.sync("read",
this,a)},save:function(a,b,c){var d,f,e=this.attributes;if(a==null||typeof a==="object"){d=a;c=b}else(d={})[a]=b;if(d&&(!c||!c.wait)&&!this.set(d,c))return false;c=h.extend({validate:true},c);if(!this._validate(d,c))return false;if(d&&c.wait)this.attributes=h.extend({},e,d);if(c.parse===void 0)c.parse=true;f=c.success;c.success=function(a,b,c){a.attributes=e;var g=a.parse(b,c);c.wait&&(g=h.extend(d||{},g));if(h.isObject(g)&&!a.set(g,c))return false;f&&f(a,b,c)};a=this.isNew()?"create":c.patch?"patch":
"update";if(a==="patch")c.attrs=d;a=this.sync(a,this,c);if(d&&c.wait)this.attributes=e;return a},destroy:function(a){var a=a?h.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(a,b,f){(f.wait||a.isNew())&&d();c&&c(a,b,f)};if(this.isNew()){a.success(this,null,a);return false}var f=this.sync("delete",this,a);a.wait||d();return f},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||k();return this.isNew()?a:a+(a.charAt(a.length-
1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(a){return!this.validate||!this.validate(this.attributes,a)},_validate:function(a,b){if(!b.validate||!this.validate)return true;var a=h.extend({},this.attributes,a),c=this.validationError=this.validate(a,b)||null;if(!c)return true;this.trigger("invalid",this,c,b||{});return false}});var n=c.Collection=function(a,
b){b||(b={});if(b.model)this.model=b.model;if(b.comparator!==void 0)this.comparator=b.comparator;this.models=[];this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,h.extend({silent:true},b))};h.extend(n.prototype,e,{model:m,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return c.sync.apply(this,arguments)},add:function(a,b){a=h.isArray(a)?a.slice():[a];b||(b={});var c,e,g,i,m,j,l,k,n,p;l=[];k=b.at;n=this.comparator&&k==
null&&b.sort!=false;p=h.isString(this.comparator)?this.comparator:null;c=0;for(e=a.length;c<e;c++)if(g=this._prepareModel(i=a[c],b))if(m=this.get(g)){if(b.merge){m.set(i===g?g.attributes:i,b);n&&(!j&&m.hasChanged(p))&&(j=true)}}else{l.push(g);g.on("all",this._onModelEvent,this);this._byId[g.cid]=g;g.id!=null&&(this._byId[g.id]=g)}else this.trigger("invalid",this,i,b);if(l.length){n&&(j=true);this.length=this.length+l.length;k!=null?f.apply(this.models,[k,0].concat(l)):d.apply(this.models,l)}j&&this.sort({silent:true});
if(b.silent)return this;c=0;for(e=l.length;c<e;c++)(g=l[c]).trigger("add",g,this,b);j&&this.trigger("sort",this,b);return this},remove:function(a,b){a=h.isArray(a)?a.slice():[a];b||(b={});var c,d,f,e;c=0;for(d=a.length;c<d;c++)if(e=this.get(a[c])){delete this._byId[e.id];delete this._byId[e.cid];f=this.indexOf(e);this.models.splice(f,1);this.length--;if(!b.silent){b.index=f;e.trigger("remove",e,this,b)}this._removeReference(e)}return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,h.extend({at:this.length},
b));return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,h.extend({at:0},b));return a},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){if(a!=null){this._idAttr||(this._idAttr=this.model.prototype.idAttribute);return this._byId[a.id||a.cid||a[this._idAttr]||a]}},at:function(a){return this.models[a]},where:function(a){return h.isEmpty(a)?
[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return false;return true})},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");a||(a={});h.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return h.invoke(this.models,"get",a)},update:function(a,b){b=h.extend({add:true,merge:true,remove:true},
b);b.parse&&(a=this.parse(a,b));var c,d,f,e,g=[],i=[],m={};h.isArray(a)||(a=a?[a]:[]);if(b.add&&!b.remove)return this.add(a,b);d=0;for(f=a.length;d<f;d++){c=a[d];e=this.get(c);b.remove&&e&&(m[e.cid]=true);(b.add&&!e||b.merge&&e)&&g.push(c)}if(b.remove){d=0;for(f=this.models.length;d<f;d++){c=this.models[d];m[c.cid]||i.push(c)}}i.length&&this.remove(i,b);g.length&&this.add(g,b);return this},reset:function(a,b){b||(b={});b.parse&&(a=this.parse(a,b));for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);
b.previousModels=this.models.slice();this._reset();a&&this.add(a,h.extend({silent:true},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?h.clone(a):{};if(a.parse===void 0)a.parse=true;var b=a.success;a.success=function(a,c,d){a[d.update?"update":"reset"](c,d);b&&b(a,c,d)};return this.sync("read",this,a)},create:function(a,b){b=b?h.clone(b):{};if(!(a=this._prepareModel(a,b)))return false;b.wait||this.add(a,b);var c=this,d=b.success;b.success=function(a,b,f){f.wait&&c.add(a,
f);d&&d(a,b,f)};a.save(null,b);return a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models.length=0;this._byId={}},_prepareModel:function(a,b){if(a instanceof m){if(!a.collection)a.collection=this;return a}b||(b={});b.collection=this;var c=new this.model(a,b);return!c._validate(a,b)?false:c},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,
b,c,d){if(!((a==="add"||a==="remove")&&c!==this)){a==="destroy"&&this.remove(b,d);if(b&&a==="change:"+b.idAttribute){delete this._byId[b.previous(b.idAttribute)];b.id!=null&&(this._byId[b.id]=b)}this.trigger.apply(this,arguments)}},sortedIndex:function(a,b,c){b||(b=this.comparator);var d=h.isFunction(b)?b:function(a){return a.get(b)};return h.sortedIndex(this.models,a,d,c)}});h.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select",
"reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"],function(a){n.prototype[a]=function(){var b=g.call(arguments);b.unshift(this.models);return h[a].apply(h,b)}});h.each(["groupBy","countBy","sortBy"],function(a){n.prototype[a]=function(b,c){var d=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,d,c)}});var q=c.Router=
function(a){a||(a={});if(a.routes)this.routes=a.routes;this._bindRoutes();this.initialize.apply(this,arguments)},p=/\((.*?)\)/g,w=/(\(\?)?:\w+/g,r=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(q.prototype,e,{initialize:function(){},route:function(a,b,d){h.isRegExp(a)||(a=this._routeToRegExp(a));d||(d=this[b]);c.history.route(a,h.bind(function(f){f=this._extractParameters(a,f);d&&d.apply(this,f);this.trigger.apply(this,["route:"+b].concat(f));this.trigger("route",b,f);c.history.trigger("route",this,
b,f)},this));return this},navigate:function(a,b){c.history.navigate(a,b);return this},_bindRoutes:function(){if(this.routes)for(var a,b=h.keys(this.routes);(a=b.pop())!=null;)this.route(a,this.routes[a])},_routeToRegExp:function(a){a=a.replace(x,"\\$&").replace(p,"(?:$1)?").replace(w,function(a,b){return b?a:"([^/]+)"}).replace(r,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var t=c.History=function(){this.handlers=[];h.bindAll(this,"checkUrl");if(typeof window!==
"undefined"){this.location=window.location;this.history=window.history}},s=/^[#\/]|\s+$/g,v=/^\/+|\/+$/g,o=/msie [\w.]+/,y=/\/$/;t.started=false;h.extend(t.prototype,e,{interval:50,getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(a==null)if(this._hasPushState||!this._wantsHashChange||b){var a=this.location.pathname,c=this.root.replace(y,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return a.replace(s,"")},start:function(a){if(t.started)throw Error("Backbone.history has already been started");
t.started=true;this.options=h.extend({},{root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState);var a=this.getFragment(),b=document.documentMode,b=o.exec(navigator.userAgent.toLowerCase())&&(!b||b<=7);this.root=("/"+this.root+"/").replace(v,"/");if(b&&this._wantsHashChange){this.iframe=c.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;
this.navigate(a)}if(this._hasPushState)c.$(window).on("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!b)c.$(window).on("hashchange",this.checkUrl);else if(this._wantsHashChange)this._checkUrlInterval=setInterval(this.checkUrl,this.interval);this.fragment=a;a=this.location;b=a.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b){this.fragment=this.getFragment(null,true);this.location.replace(this.root+
this.location.search+"#"+this.fragment);return true}if(this._wantsPushState&&this._hasPushState&&b&&a.hash){this.fragment=this.getHash().replace(s,"");this.history.replaceState({},document.title,this.root+this.fragment+a.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){c.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);t.started=false},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=
this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return false;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return h.any(this.handlers,function(a){if(a.route.test(b)){a.callback(b);return true}})},navigate:function(a,b){if(!t.started)return false;if(!b||b===true)b={trigger:b};a=this.getFragment(a||"");if(this.fragment!==a){this.fragment=a;
var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else if(this._wantsHashChange){this._updateHash(this.location,a,b.replace);if(this.iframe&&a!==this.getFragment(this.getHash(this.iframe))){b.replace||this.iframe.document.open().close();this._updateHash(this.iframe.location,a,b.replace)}}else return this.location.assign(c);b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){if(c){c=a.href.replace(/(javascript:|#).*$/,"");a.replace(c+
"#"+b)}else a.hash="#"+b}});c.history=new t;var A=c.View=function(a){this.cid=h.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},B=/^(\S+)\s*(.*)$/,u=["model","collection","el","id","attributes","className","tagName","events"];h.extend(A.prototype,e,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},
setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof c.$?a:c.$(a);this.el=this.$el[0];b!==false&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=h.result(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];h.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var d=b.match(B),f=d[1],d=d[2],c=h.bind(c,this),f=f+(".delegateEvents"+this.cid);if(d==="")this.$el.on(f,c);else this.$el.on(f,d,c)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+
this.cid)},_configure:function(a){this.options&&(a=h.extend({},h.result(this,"options"),a));h.extend(this,h.pick(a,u));this.options=a},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),false);else{var a=h.extend({},h.result(this,"attributes"));if(this.id)a.id=h.result(this,"id");this.className&&(a["class"]=h.result(this,"className"));a=c.$("<"+h.result(this,"tagName")+">").attr(a);this.setElement(a,false)}}});var D={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",
read:"GET"};c.sync=function(a,b,d){var f=D[a];h.defaults(d||(d={}),{emulateHTTP:c.emulateHTTP,emulateJSON:c.emulateJSON});var e={type:f,dataType:"json"};if(!d.url)e.url=h.result(b,"url")||k();if(d.data==null&&b&&(a==="create"||a==="update"||a==="patch")){e.contentType="application/json";e.data=JSON.stringify(d.attrs||b.toJSON(d))}if(d.emulateJSON){e.contentType="application/x-www-form-urlencoded";e.data=e.data?{model:e.data}:{}}if(d.emulateHTTP&&(f==="PUT"||f==="DELETE"||f==="PATCH")){e.type="POST";
if(d.emulateJSON)e.data._method=f;var g=d.beforeSend;d.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",f);if(g)return g.apply(this,arguments)}}if(e.type!=="GET"&&!d.emulateJSON)e.processData=false;var i=d.success;d.success=function(a){i&&i(b,a,d);b.trigger("sync",b,a,d)};var m=d.error;d.error=function(a){m&&m(b,a,d);b.trigger("error",b,a,d)};a=d.xhr=c.ajax(h.extend(e,d));b.trigger("request",b,a,d);return a};c.ajax=function(){return c.$.ajax.apply(c.$,arguments)};m.extend=n.extend=
q.extend=A.extend=t.extend=function(a,b){var c=this,d;d=a&&h.has(a,"constructor")?a.constructor:function(){return c.apply(this,arguments)};h.extend(d,c,b);var f=function(){this.constructor=d};f.prototype=c.prototype;d.prototype=new f;a&&h.extend(d.prototype,a);d.__super__=c.prototype;return d};var k=function(){throw Error('A "url" property or function must be specified');}}).call(this);var Mustache="undefined"!==typeof module&&module.exports||{};
(function(a){function b(a){return!RegExp.prototype.test.call(w,a)}function e(a){return'"'+a.replace(v,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'}function d(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function g(a){return String(a).replace(/[&<>"'\/]/g,function(a){return o[a]})}function f(a){this.tail=this.string=a;this.pos=0}function c(a,b){this.view=a;this.parent=b;this.clearCache()}function h(){this.clearCache()}function i(a,b){typeof a==="string"&&
(a=l(a));for(var c=['""'],d,f,g=0,h=a.length;g<h;++g){d=a[g];switch(d.type){case "#":case "^":f=d.type==="#"?"_section":"_inverted";c.push("r."+f+"("+e(d.value)+", c, function (c, r) {\n  "+i(d.tokens,true)+"\n})");break;case "{":case "&":case "name":f=d.type==="name"?"true":"false";c.push("r._name("+e(d.value)+", c, "+f+")");break;case ">":c.push("r._partial("+e(d.value)+", c)");break;case "text":c.push(e(d.value))}}c="return "+c.join(" + ")+";";return b?c:new Function("c, r",c)}function j(a){if(a.length===
2)return[RegExp(d(a[0])+"\\s*"),RegExp("\\s*"+d(a[1]))];throw Error("Invalid tags: "+a.join(" "));}function l(c,e){e=e||a.tags;tagRes=j(e);for(var g=new f(c),h=[],i=[],m=false,l=false,n,s;!g.eos();){if(s=g.scanUntil(tagRes[0]))for(var w=0,o=s.length;w<o;++w){n=s[w];b(n)?i.push(h.length):l=true;h.push({type:"text",value:n});if(n==="\n"){if(m&&!l)for(;i.length;)h.splice(i.pop(),1);else i=[];l=m=false}}if(!g.scan(tagRes[0]))break;m=true;n=g.scan(t)||"name";g.scan(q);if(n==="="){s=g.scanUntil(r);g.scan(r);
g.scanUntil(tagRes[1])}else if(n==="{"){s=RegExp("\\s*"+d("}"+e[1]));s=g.scanUntil(s);g.scan(x);g.scanUntil(tagRes[1])}else s=g.scanUntil(tagRes[1]);if(!g.scan(tagRes[1]))throw Error("Unclosed tag at "+g.pos);h.push({type:n,value:s});if(n==="name"||n==="{"||n==="&")l=true;if(n==="="){e=s.split(p);tagRes=j(e)}}for(var v,g=0;g<h.length;++g){token=h[g];if(v&&v.type==="text"&&token.type==="text"){v.value=v.value+token.value;h.splice(g--,1)}else v=token}l=v=[];g=[];for(m=0;m<h.length;++m){i=h[m];switch(i.type){case "#":case "^":i.tokens=
[];g.push(i);l.push(i);l=i.tokens;break;case "/":if(g.length===0)throw Error("Unopened section: "+i.value);l=g.pop();if(l.value!==i.value)throw Error("Unclosed section: "+l.value);l=g.length>0?g[g.length-1].tokens:v;break;default:l.push(i)}}if(l=g.pop())throw Error("Unclosed section: "+l.value);return v}function m(a,b,c){return y.compilePartial(a,b,c)}function n(a,b,c){if(c)for(var d in c)m(d,c[d]);return y.render(a,b)}a.name="mustache.js";a.version="0.5.1-dev";a.tags=["{{","}}"];a.parse=l;a.clearCache=
function(){y.clearCache()};a.compile=function(a,b){return y.compile(a,b)};a.compilePartial=m;a.render=n;a.Scanner=f;a.Context=c;a.Renderer=h;a.to_html=function(a,b,c,d){a=n(a,b,c);if(typeof d==="function")d(a);else return a};var q=/\s*/,p=/\s+/,w=/\S/,r=/\s*=/,x=/\s*\}/,t=/#|\^|\/|>|\{|&|=|!/,s=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},v=/[\x00-\x2F\x3A-\x40\x5B-\x60\x7B-\xFF\u2028\u2029]/gm,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;",
"/":"&#x2F;"};a.isWhitespace=b;a.isArray=s;a.quote=e;a.escapeRe=d;a.escapeHtml=g;f.prototype.eos=function(){return this.tail===""};f.prototype.scan=function(a){if((a=this.tail.match(a))&&a.index===0){this.tail=this.tail.substring(a[0].length);this.pos=this.pos+a[0].length;return a[0]}return null};f.prototype.scanUntil=function(a){var b=this.tail.search(a);switch(b){case -1:a=this.tail;this.pos=this.pos+this.tail.length;this.tail="";break;case 0:a=null;break;default:a=this.tail.substring(0,b);this.tail=
this.tail.substring(b);this.pos=this.pos+b}return a};c.make=function(a){return a instanceof c?a:new c(a)};c.prototype.clearCache=function(){this._cache={}};c.prototype.push=function(a){return new c(a,this)};c.prototype.lookup=function(a){var b=this._cache[a];if(!b){if(a===".")b=this.view;else for(var c=this;c;){if(a.indexOf(".")>0)for(var d=a.split("."),f=0,b=c.view;b&&f<d.length;)b=b[d[f++]];else b=c.view[a];if(b!=null)break;c=c.parent}this._cache[a]=b}typeof b==="function"&&(b=b.call(this.view));
return b};h.prototype.clearCache=function(){this._cache={};this._partialCache={}};h.prototype.compile=function(a){var b=i(a),d=this;return function(a){return b(c.make(a),d)}};h.prototype.compilePartial=function(a,b,c){this._partialCache[a]=this.compile(b,c);return this._partialCache[a]};h.prototype.render=function(a,b){var c=this._cache[a];if(!c){c=this.compile(a);this._cache[a]=c}return c(b)};h.prototype._section=function(a,b,c){a=b.lookup(a);switch(typeof a){case "object":if(s(a)){for(var d="",
f=0,e=a.length;f<e;++f)d=d+c(b.push(a[f]),this);return d}return c(b.push(a),this);case "function":var c=c(b,this),g=this;return a.call(b.view,c,function(a){return g.render(a,b)})||"";default:if(a)return c(b,this)}return""};h.prototype._inverted=function(a,b,c){a=b.lookup(a);return a==null||a===false||s(a)&&a.length===0?c(b,this):""};h.prototype._partial=function(a,b){var c=this._partialCache[a];return c?c(b,this):""};h.prototype._name=function(a,b,c){a=b.lookup(a);typeof a==="function"&&(a=a.call(b.view));
b=a==null?"":String(a);return c?g(b):b};var y=new h})(Mustache);
(function(a){function b(b,c,d){var f=this;return this.on("click.pjax",b,function(b){var g=a.extend({},m(c,d));if(!g.container)g.container=a(this).attr("data-pjax")||f;e(b,g)})}function e(b,c,d){d=m(c,d);c=b.currentTarget;if(c.tagName.toUpperCase()!=="A")throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(b.which>1||b.metaKey||b.ctrlKey||b.shiftKey||b.altKey))if(!(location.protocol!==c.protocol||location.host!==c.host)&&!(c.hash&&c.href.replace(c.hash,"")===location.href.replace(location.hash,
""))&&c.href!==location.href+"#"){c={url:c.href,container:a(c).attr("data-pjax"),target:c,fragment:null};g(a.extend({},c,d));b.preventDefault()}}function d(b,c,d){d=m(c,d);c=b.currentTarget;if(c.tagName.toUpperCase()!=="FORM")throw"$.pjax.submit requires a form element";c={type:c.method,url:c.action,data:a(c).serializeArray(),container:a(c).attr("data-pjax"),target:c,fragment:null};g(a.extend({},c,d));b.preventDefault()}function g(b){function d(b,c){var e=a.Event(b,{relatedTarget:f});h.trigger(e,
c);return!e.isDefaultPrevented()}b=a.extend(true,{},a.ajaxSettings,g.defaults,b);if(a.isFunction(b.url))b.url=b.url();var f=b.target,e=l(b.url).hash,h=b.context=n(b.container);if(!b.data)b.data={};b.data._pjax=h.selector;var i;b.beforeSend=function(a,c){if(c.type!=="GET")c.timeout=0;a.setRequestHeader("X-PJAX","true");a.setRequestHeader("X-PJAX-Container",h.selector);if(!d("pjax:beforeSend",[a,c]))return false;if(c.timeout>0){i=setTimeout(function(){d("pjax:timeout",[a,b])&&a.abort("timeout")},c.timeout);
c.timeout=0}b.requestUrl=l(c.url).href};b.complete=function(a,c){i&&clearTimeout(i);d("pjax:complete",[a,c,b]);d("pjax:end",[a,b])};b.error=function(a,f,e){var g=q("",a,b),a=d("pjax:error",[a,f,e,b]);b.type=="GET"&&(f!=="abort"&&a)&&c(g.url)};b.success=function(f,i,m){var j=q(f,m,b);if(j.contents){g.state={id:b.id||(new Date).getTime(),url:j.url,title:j.title,container:h.selector,fragment:b.fragment,timeout:b.timeout,state:b.state};(b.push||b.replace)&&window.history.replaceState(g.state,j.title,
j.url);if(j.title)document.title=j.title;h.html(j.contents);typeof b.scrollTo==="number"&&a(window).scrollTop(b.scrollTo);(b.replace||b.push)&&window._gaq&&_gaq.push(["_trackPageview"]);if(e!==""){var k=l(j.url);k.hash=e;g.state.url=k.href;window.history.replaceState(g.state,j.title,k.href);j=a(k.hash);j.length&&a(window).scrollTop(j.offset().top)}d("pjax:success",[f,i,m,b])}else c(j.url)};if(!g.state){g.state={id:(new Date).getTime(),url:window.location.href,title:document.title,container:h.selector,
fragment:b.fragment,timeout:b.timeout,state:b.state};window.history.replaceState(g.state,document.title)}var m=g.xhr;if(m&&m.readyState<4){m.onreadystatechange=a.noop;m.abort()}g.options=b;m=g.xhr=a.ajax(b);if(m.readyState>0){if(b.push&&!b.replace){var p=g.state.id,k=h.clone().contents();r[p]=k;for(t.push(p);x.length;)delete r[x.shift()];for(;t.length>g.defaults.maxCacheLength;)delete r[t.shift()];window.history.pushState(null,"",j(b.requestUrl))}d("pjax:start",[m,b]);d("pjax:send",[m,b])}return g.xhr}
function f(b,c){return g(a.extend({url:window.location.href,push:false,replace:true,scrollTo:false},m(b,c)))}function c(a){window.history.replaceState(null,"","#");window.location.replace(a)}function h(b){if((b=b.state)&&b.container){var d=a(b.container);if(d.length){var f=r[b.id];if(g.state){var e=g.state.id<b.id?"forward":"back",h=g.state.id,i=d.clone().contents(),m;r[h]=i;if(e==="forward"){i=t;m=x}else{i=x;m=t}i.push(h);(h=m.pop())&&delete r[h];e=a.Event("pjax:popstate",{state:b,direction:e});
d.trigger(e);e={id:b.id,url:b.url,container:d,push:false,fragment:b.fragment,timeout:b.timeout,state:b.state,scrollTo:false};if(f){d.trigger("pjax:start",[null,e]);if(b.title)document.title=b.title;d.html(f);g.state=b;d.trigger("pjax:end",[null,e])}else g(e);d[0].offsetHeight}else g.state=b}else c(location.href)}}function i(b){var c=a.isFunction(b.url)?b.url():b.url,d=b.type?b.type.toUpperCase():"GET",f=a("<form>",{method:d==="GET"?"GET":"POST",action:c,style:"display:none"});d!=="GET"&&d!=="POST"&&
f.append(a("<input>",{type:"hidden",name:"_method",value:d.toLowerCase()}));b=b.data;if(typeof b==="string")a.each(b.split("&"),function(b,c){var d=c.split("=");f.append(a("<input>",{type:"hidden",name:d[0],value:d[1]}))});else if(typeof b==="object")for(key in b)f.append(a("<input>",{type:"hidden",name:key,value:b[key]}));a(document.body).append(f);f.submit()}function j(a){return a.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function l(a){var b=document.createElement("a");
b.href=a;return b}function m(b,c){b&&c?c.container=b:c=a.isPlainObject(b)?b:{container:b};if(c.container)c.container=n(c.container);return c}function n(b){b=a(b);if(b.length){if(b.selector!==""&&b.context===document)return b;if(b.attr("id"))return a("#"+b.attr("id"));throw"cant get selector for pjax container!";}throw"no pjax container for "+b.selector;}function q(b,c,d){var f={};f.url=j(c.getResponseHeader("X-PJAX-URL")||d.requestUrl);if(/<html/i.test(b))var c=a(b.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]),
e=a(b.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]);else c=e=a(b);if(e.length===0)return f;f.title=c.filter("title").add(c.find("title")).last().text();if(d.fragment){b=d.fragment==="body"?e:e.filter(d.fragment).add(e.find(d.fragment)).first();if(b.length){f.contents=b.contents();if(!f.title)f.title=b.attr("title")||b.data("title")}}else if(!/<html/i.test(b))f.contents=e;if(f.contents){f.contents=f.contents.not("title");f.contents.find("title").remove()}if(f.title)f.title=a.trim(f.title);return f}function p(){a.fn.pjax=
b;a.pjax=g;a.pjax.enable=a.noop;a.pjax.disable=w;a.pjax.click=e;a.pjax.submit=d;a.pjax.reload=f;a.pjax.defaults={timeout:650,push:true,replace:false,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20};a(window).bind("popstate.pjax",h)}function w(){a.fn.pjax=function(){return this};a.pjax=i;a.pjax.enable=p;a.pjax.disable=a.noop;a.pjax.click=a.noop;a.pjax.submit=a.noop;a.pjax.reload=function(){window.location.reload()};a(window).unbind("popstate.pjax",h)}var r={},x=[],t=[];a.inArray("state",a.event.props)<
0&&a.event.props.push("state");a.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/);a.support.pjax?p():w()})(jQuery);(function(a){if(a.support.pjax){var b=a.fn.pjax;a.fn.pjax=function(){b.apply(this,arguments);this.data("bb-pjax-enabled",true);var e=this.selector;a(document).bind("pjax:success",function(){a(e).data("bb-pjax-enabled",true)})}}})(jQuery);
(function(a,b,e){function d(a){return a}function g(a){return decodeURIComponent(a.replace(f," "))}var f=/\+/g,c=a.cookie=function(f,i,j){if(i!==e){j=a.extend({},c.defaults,j);if(i===null)j.expires=-1;if(typeof j.expires==="number"){var l=j.expires,m=j.expires=new Date;m.setDate(m.getDate()+l)}i=c.json?JSON.stringify(i):String(i);return b.cookie=[encodeURIComponent(f),"=",c.raw?i:encodeURIComponent(i),j.expires?"; expires="+j.expires.toUTCString():"",j.path?"; path="+j.path:"",j.domain?"; domain="+
j.domain:"",j.secure?"; secure":""].join("")}i=c.raw?d:g;j=b.cookie.split("; ");for(l=0;m=j[l]&&j[l].split("=");l++)if(i(m.shift())===f){f=i(m.join("="));return c.json?JSON.parse(f):f}return null};c.defaults={};a.removeCookie=function(b,c){if(a.cookie(b)!==null){a.cookie(b,null,c);return true}return false}})(jQuery,document);
(function(){var a,b,e,d,g,f,c;f=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(?:[.](\d+))?)?(?:([-+]\d\d):(\d\d)|Z)$/;e=function(a,b,d){b==null&&(b=0);d==null&&(d=0);a.setHours(c.H(a)-b,c.M(a)+(+b>0?-d:+d));return a};b=function(b){return d[b]||a[b]};g=function(a,b){b==null&&(b=2);return(a+1E3+"").substr(4-b)};c={yy:function(a){return g(c.yyyy(a)%100)},yyyy:function(a){return a.getFullYear()},m:function(a){return a.getMonth()+1},mm:function(a){return g(c.m(a))},mmm:function(a){return b("abbrMonths")[c.m(a)-
1]},mmmm:function(a){return b("fullMonths")[c.m(a)-1]},d:function(a){return a.getDate()},dd:function(a){return g(c.d(a))},ddd:function(a){return b("abbrDays")[a.getDay()]},dddd:function(a){return b("fullDays")[a.getDay()]},o:function(a){return b("ordinals")(c.d(a))},h:function(a){return c.H(a)%12||12},hh:function(a){return g(c.h(a))},H:function(a){return a.getHours()},HH:function(a){return g(c.H(a))},M:function(a){return a.getMinutes()},MM:function(a){return g(c.M(a))},s:function(a){return a.getSeconds()},
ss:function(a){return g(c.s(a))},S:function(a){return""+c.s(a)+"."+g(a%1E3,3)},SS:function(a){return""+c.ss(a)+"."+g(a%1E3,3)},a:function(a){return b("periods")[+(c.H(a)>11)]},Z:function(a){var b,a=Math.abs(b=-a.getTimezoneOffset());return""+(b<0?"-":"+")+g(a/60>>0)+":"+g(a%60)}};a=function(b,d){var f,e,g,n,q,p,w;if(!(b instanceof Date)){d=b;b=new Date}d||(d=a.format);if(typeof d==="function")return d(b);n=null;e=g="";w=(""+d.replace(/~/g,"~T").replace(/%%/g,"~P")+"%").split("");q=0;for(p=w.length;q<
p;q++){f=w[q];if(e)if(f===n||e==="%")e=e+f;else{e=e.substr(1);g=g+(c.hasOwnProperty(e)?a.escaped?jQuery("<b>").text(c[e](b)).html():c[e](b):e)}/%/.test(e)||(e=/%/.test(d)?f==="%"?"%":(g=g+f,""):"%"+f);n=f}return g.replace(/~P/g,"%").replace(/~T/g,"~")};a.abbrDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];a.abbrMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];a.fullDays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];a.fullMonths=["January",
"February","March","April","May","June","July","August","September","October","November","December"];a.format="d mmmm yyyy";a.periods=["AM","PM"];a.ordinals=function(a){return a+["th","st","nd","rd"][10<a&&a<14||(a=a%10)>3?0:a]};a.version="0.8.0";jQuery.localize=a;d={};jQuery.fn.localize=function(b){var c;if(typeof b==="object"){jQuery.extend(d,b);b=d.format}b||(b=a.format);c=d.escaped?"html":"text";this.each(function(){var d,g,m;d=jQuery(this);this.nodeName.toLowerCase()==="time"&&(m=f.exec(d.attr("datetime")||
a("yyyy-mm-ddTHH:MM:ssZ")));if(m){g=e(new Date(Date.UTC(+m[1],m[2]-1,+m[3],+m[4],+m[5],+m[6]||0,+(""+(m[7]||0)+"00").substr(0,3))),m[8],m[9]);d.attr("datetime",a(g,"yyyy-mm-ddTHH:MM"+(m[7]?":SS":m[6]?":ss":"")+"Z"));return d[c](typeof b==="function"?b.call(d,g):a(g,b))}});d={};return this}}).call(this);
(function(a){function b(a){var b=null;if(document.cookie&&document.cookie!=="")for(var g=document.cookie.split(";"),f=0;f<g.length;f++){var c=jQuery.trim(g[f]);if(c.substring(0,a.length+1)==a+"="){b=decodeURIComponent(c.substring(a.length+1));break}}return b}a.ajaxSetup({beforeSend:function(a,d){/^(?!https?:)/.test(d.url)&&a.setRequestHeader("X-CSRFToken",b("csrftoken"))}})})(jQuery);
(function(a,b,e,d){var g=e(a),f=e(b),c=e.fancybox=function(){c.open.apply(this,arguments)},h=false,i=b.createTouch!==d,j=function(a){return e.type(a)==="string"},l=function(a,b){b&&(j(a)&&a.indexOf("%")>0)&&(a=c.getViewport()[b]/100*parseInt(a,10));return Math.round(a)+"px"};e.extend(c,{version:"2.0.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,autoSize:true,autoResize:!i,autoCenter:!i,fitToView:true,aspectRatio:false,topRatio:0.5,fixed:false,
scrolling:"auto",wrapCSS:"",arrows:true,closeBtn:true,closeClick:false,nextClick:false,mouseWheel:true,autoPlay:false,playSpeed:3E3,preload:3,modal:false,loop:true,ajax:{dataType:"html",headers:{"X-fancyBox":true}},keys:{next:[13,32,34,39,40],prev:[8,33,37,38],close:[27]},index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',
iframe:'<iframe class="fancybox-iframe" name="fancybox-frame{rnd}" frameborder="0" hspace="0"'+(e.browser.msie?' allowtransparency="true"':"")+"></iframe>",swf:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="wmode" value="transparent" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{href}" /><embed src="{href}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="100%" height="100%" wmode="transparent"></embed></object>',
error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<div title="Close" class="fancybox-item fancybox-close"></div>',next:'<a title="Next" class="fancybox-nav fancybox-next"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev"><span></span></a>'},openEffect:"fade",openSpeed:300,openEasing:"swing",openOpacity:true,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:300,closeEasing:"swing",closeOpacity:true,closeMethod:"zoomOut",
nextEffect:"elastic",nextSpeed:300,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:300,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:{speedIn:0,speedOut:300,opacity:0.8,css:{cursor:"pointer"},closeClick:true},title:{type:"float"}},onCancel:e.noop,beforeLoad:e.noop,afterLoad:e.noop,beforeShow:e.noop,afterShow:e.noop,beforeClose:e.noop,afterClose:e.noop},group:{},opts:{},coming:null,current:null,isOpen:false,isOpened:false,wrap:null,skin:null,outer:null,inner:null,
player:{timer:null,isActive:false},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,b){c.close(true);a&&!e.isArray(a)&&(a=a instanceof e?e(a).get():[a]);c.isActive=true;c.opts=e.extend(true,{},c.defaults,b);if(e.isPlainObject(b)&&b.keys!==d)c.opts.keys=b.keys?e.extend({},c.defaults.keys,b.keys):false;c.group=a;c._start(c.opts.index||0)},cancel:function(){if(!(c.coming&&false===c.trigger("onCancel"))){c.coming=null;c.hideLoading();c.ajaxLoad&&c.ajaxLoad.abort();c.ajaxLoad=null;
if(c.imgPreload)c.imgPreload.onload=c.imgPreload.onabort=c.imgPreload.onerror=null}},close:function(a){c.cancel();if(c.current&&false!==c.trigger("beforeClose")){c.unbindEvents();if(!c.isOpen||a&&a[0]===true){e(".fancybox-wrap").stop().trigger("onReset").remove();c._afterZoomOut()}else{c.isOpen=c.isOpened=false;e(".fancybox-item, .fancybox-nav").remove();c.wrap.stop(true).removeClass("fancybox-opened");c.inner.css("overflow","hidden");c.transitions[c.current.closeMethod]()}}},play:function(a){var b=
function(){clearTimeout(c.player.timer)},d=function(){b();if(c.current&&c.player.isActive)c.player.timer=setTimeout(c.next,c.current.playSpeed)},f=function(){b();e("body").unbind(".player");c.player.isActive=false;c.trigger("onPlayEnd")};if(c.player.isActive||a&&a[0]===false)f();else if(c.current&&(c.current.loop||c.current.index<c.group.length-1)){c.player.isActive=true;e("body").bind({"afterShow.player onUpdate.player":d,"onCancel.player beforeClose.player":f,"beforeLoad.player":b});d();c.trigger("onPlayStart")}},
next:function(){c.current&&c.jumpto(c.current.index+1)},prev:function(){c.current&&c.jumpto(c.current.index-1)},jumpto:function(a){if(c.current){a=parseInt(a,10);c.group.length>1&&c.current.loop&&(a>=c.group.length?a=0:a<0&&(a=c.group.length-1));if(c.group[a]!==d){c.cancel();c._start(a)}}},reposition:function(a,b){var d;if(c.isOpen){d=c._getPosition(b);if(a&&a.type==="scroll"){delete d.position;c.wrap.stop(true,true).animate(d,200)}else c.wrap.css(d)}},update:function(a){if(c.isOpen){h||setTimeout(function(){var b=
c.current,d=!a||a&&a.type==="orientationchange";if(h){h=false;if(b){if(!a||a.type!=="scroll"||d){if(b.autoSize&&b.type!=="iframe"){c.inner.height("auto");b.height=c.inner.height()}(b.autoResize||d)&&c._setDimension();b.canGrow&&b.type!=="iframe"&&c.inner.height("auto")}(b.autoCenter||d)&&c.reposition(a);c.trigger("onUpdate")}}},200);h=true}},toggle:function(){if(c.isOpen){c.current.fitToView=!c.current.fitToView;c.update()}},hideLoading:function(){f.unbind("keypress.fb");e("#fancybox-loading").remove()},
showLoading:function(){c.hideLoading();f.bind("keypress.fb",function(a){if(a.keyCode===27){a.preventDefault();c.cancel()}});e('<div id="fancybox-loading"><div></div></div>').click(c.cancel).appendTo("body")},getViewport:function(){return{x:g.scrollLeft(),y:g.scrollTop(),w:i&&a.innerWidth?a.innerWidth:g.width(),h:i&&a.innerHeight?a.innerHeight:g.height()}},unbindEvents:function(){c.wrap&&c.wrap.unbind(".fb");f.unbind(".fb");g.unbind(".fb")},bindEvents:function(){var a=c.current,b=a.keys;if(a){g.bind("resize.fb orientationchange.fb"+
(a.autoCenter&&!a.fixed?" scroll.fb":""),c.update);b&&f.bind("keydown.fb",function(a){var d;d=a.target||a.srcElement;if(!a.ctrlKey&&!a.altKey&&!a.shiftKey&&!a.metaKey&&(!d||!d.type&&!e(d).is("[contenteditable]"))){d=a.keyCode;if(e.inArray(d,b.close)>-1){c.close();a.preventDefault()}else if(e.inArray(d,b.next)>-1){c.next();a.preventDefault()}else if(e.inArray(d,b.prev)>-1){c.prev();a.preventDefault()}}});e.fn.mousewheel&&(a.mouseWheel&&c.group.length>1)&&c.wrap.bind("mousewheel.fb",function(a,b){var d=
a.target||null;if(b!==0&&(!d||d.clientHeight===0||d.scrollHeight===d.clientHeight&&d.scrollWidth===d.clientWidth)){a.preventDefault();c[b>0?"prev":"next"]()}})}},trigger:function(a,b){var d,f=b||c[e.inArray(a,["onCancel","beforeLoad","afterLoad"])>-1?"coming":"current"];if(f){e.isFunction(f[a])&&(d=f[a].apply(f,Array.prototype.slice.call(arguments,1)));if(d===false)return false;f.helpers&&e.each(f.helpers,function(b,d){if(d&&e.isPlainObject(c.helpers[b])&&e.isFunction(c.helpers[b][a]))c.helpers[b][a](d,
f)});e.event.trigger(a+".fb")}},isImage:function(a){return j(a)&&a.match(/\.(jpe?g|gif|png|bmp)((\?|#).*)?$/i)},isSWF:function(a){return j(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(a){var b={},d=c.group[a]||null,f,g,h;if(d&&(d.nodeType||d instanceof e)){f=true;e.metadata&&(b=e(d).metadata())}b=e.extend(true,{},c.opts,{index:a,element:d},e.isPlainObject(d)?d:b);e.each(["href","title","content","type"],function(a,g){b[g]=c.opts[g]||f&&e(d).attr(g)||b[g]||null});if(typeof b.margin==="number")b.margin=
[b.margin,b.margin,b.margin,b.margin];b.modal&&e.extend(true,b,{closeBtn:false,closeClick:false,nextClick:false,arrows:false,mouseWheel:false,keys:null,helpers:{overlay:{css:{cursor:"auto"},closeClick:false}}});c.coming=b;if(false===c.trigger("beforeLoad"))c.coming=null;else{g=b.type;a=b.href||d;if(!g){if(f){g=e(d).data("fancybox-type");if(!g)g=(g=d.className.match(/fancybox\.(\w+)/))?g[1]:null}!g&&j(a)&&(c.isImage(a)?g="image":c.isSWF(a)?g="swf":a.match(/^#/)&&(g="inline"));g||(g=f?"inline":"html");
b.type=g}if(g==="inline"||g==="html"){if(!b.content)b.content=g==="inline"?e(j(a)?a.replace(/.*(?=#[^\s]+$)/,""):a):d;if(!b.content||!b.content.length)g=null}else a||(g=null);if(g==="ajax"&&j(a)){h=a.split(/\s+/,2);a=h.shift();b.selector=h.shift()}b.href=a;b.group=c.group;b.isDom=f;switch(g){case "image":c._loadImage();break;case "ajax":c._loadAjax();break;case "inline":case "iframe":case "swf":case "html":c._afterLoad();break;default:c._error("type")}}},_error:function(a){c.hideLoading();e.extend(c.coming,
{type:"html",autoSize:true,minWidth:0,minHeight:0,padding:15,hasError:a,content:c.coming.tpl.error});c._afterLoad()},_loadImage:function(){var a=c.imgPreload=new Image;a.onload=function(){this.onload=this.onerror=null;c.coming.width=this.width;c.coming.height=this.height;c._afterLoad()};a.onerror=function(){this.onload=this.onerror=null;c._error("image")};a.src=c.coming.href;(a.complete===d||!a.complete)&&c.showLoading()},_loadAjax:function(){c.showLoading();c.ajaxLoad=e.ajax(e.extend({},c.coming.ajax,
{url:c.coming.href,error:function(a,b){c.coming&&b!=="abort"?c._error("ajax",a):c.hideLoading()},success:function(a,b){if(b==="success"){c.coming.content=a;c._afterLoad()}}}))},_preloadImages:function(){var a=c.group,b=c.current,d=a.length,f,g,h,i=Math.min(b.preload,d-1);if(b.preload&&!(a.length<2))for(h=1;h<=i;h=h+1){f=a[(b.index+h)%d];g=f.href||e(f).attr("href")||f;if(f.type==="image"||c.isImage(g))(new Image).src=g}},_afterLoad:function(){c.hideLoading();if(!c.coming||false===c.trigger("afterLoad",
c.current))c.coming=false;else{if(c.isOpened){e(".fancybox-item, .fancybox-nav").remove();c.wrap.stop(true).removeClass("fancybox-opened");c.inner.css("overflow","hidden");c.transitions[c.current.prevMethod]()}else{e(".fancybox-wrap").stop().trigger("onReset").remove();c.trigger("afterClose")}c.unbindEvents();c.isOpen=false;c.current=c.coming;c.wrap=e(c.current.tpl.wrap).addClass("fancybox-"+(i?"mobile":"desktop")+" fancybox-type-"+c.current.type+" fancybox-tmp "+c.current.wrapCSS).appendTo("body");
c.skin=e(".fancybox-skin",c.wrap).css("padding",l(c.current.padding));c.outer=e(".fancybox-outer",c.wrap);c.inner=e(".fancybox-inner",c.wrap);c._setContent()}},_setContent:function(){var a=c.current,b=a.content,d=a.type,f=a.minWidth,g=a.minHeight,h=a.maxWidth,j=a.maxHeight;switch(d){case "inline":case "ajax":case "html":if(a.selector)b=e("<div>").html(b).find(a.selector);else if(b instanceof e){b.parent().hasClass("fancybox-inner")&&b.parents(".fancybox-wrap").unbind("onReset");b=b.show().detach();
e(c.wrap).bind("onReset",function(){b.appendTo("body").hide()})}if(a.autoSize){f=e('<div class="fancybox-wrap '+c.current.wrapCSS+' fancybox-tmp"></div>').appendTo("body").css({minWidth:l(f,"w"),minHeight:l(g,"h"),maxWidth:l(h,"w"),maxHeight:l(j,"h")}).append(b);a.width=f.width();a.height=f.height();f.width(c.current.width);if(f.height()>a.height){f.width(a.width+1);a.width=f.width();a.height=f.height()}b=f.contents().detach();f.remove()}break;case "image":b=a.tpl.image.replace("{href}",a.href);a.aspectRatio=
true;break;case "swf":b=a.tpl.swf.replace(/\{width\}/g,a.width).replace(/\{height\}/g,a.height).replace(/\{href\}/g,a.href);break;case "iframe":b=e(a.tpl.iframe.replace("{rnd}",(new Date).getTime())).attr("scrolling",a.scrolling).attr("src",a.href);a.scrolling=i?"scroll":"auto"}if(d==="image"||d==="swf"){a.autoSize=false;a.scrolling="visible"}if(d==="iframe"&&a.autoSize){c.showLoading();c._setDimension();c.inner.css("overflow",a.scrolling);b.bind({onCancel:function(){e(this).unbind();c._afterZoomOut()},
load:function(){c.hideLoading();try{if(this.contentWindow.document.location)c.current.height=e(this).contents().find("body").height()}catch(a){c.current.autoSize=false}c[c.isOpen?"_afterZoomIn":"_beforeShow"]()}}).appendTo(c.inner)}else{c.inner.append(b);c._beforeShow()}},_beforeShow:function(){c.coming=null;c.trigger("beforeShow");c._setDimension();c.wrap.hide().removeClass("fancybox-tmp");c.bindEvents();c._preloadImages();c.transitions[c.isOpened?c.current.nextMethod:c.current.openMethod]()},_setDimension:function(){var a=
c.wrap,b=c.inner,d=c.current,f=c.getViewport(),g=d.margin,h=d.padding*2,i=d.width,t=d.height,s=d.maxWidth+h,v=d.maxHeight+h,o=d.minWidth+h,y=d.minHeight+h,A;f.w=f.w-(g[1]+g[3]);f.h=f.h-(g[0]+g[2]);j(i)&&i.indexOf("%")>0&&(i=(f.w-h)*parseFloat(i)/100);j(t)&&t.indexOf("%")>0&&(t=(f.h-h)*parseFloat(t)/100);g=i/t;i=i+h;t=t+h;if(d.fitToView){s=Math.min(f.w,s);v=Math.min(f.h,v)}if(d.aspectRatio){if(i>s){i=s;t=(i-h)/g+h}if(t>v){t=v;i=(t-h)*g+h}if(i<o){i=o;t=(i-h)/g+h}if(t<y){t=y;i=(t-h)*g+h}}else{i=Math.max(o,
Math.min(i,s));t=Math.max(y,Math.min(t,v))}i=Math.round(i);t=Math.round(t);e(a.add(b)).width("auto").height("auto");b.width(i-h).height(t-h);a.width(i);A=a.height();if(i>s||A>v)for(;(i>s||A>v)&&i>o&&A>y;){t=t-10;if(d.aspectRatio){i=Math.round((t-h)*g+h);if(i<o){i=o;t=(i-h)/g+h}}else i=i-10;b.width(i-h).height(t-h);a.width(i);A=a.height()}d.dim={width:l(i),height:l(A)};d.canGrow=d.autoSize&&t>y&&t<v;d.canShrink=false;d.canExpand=false;if(i-h<d.width||t-h<d.height)d.canExpand=true;else if((i>f.w||A>
f.h)&&i>o&&t>y)d.canShrink=true;c.innerSpace=A-h-b.height()},_getPosition:function(a){var b=c.current,d=c.getViewport(),f=b.margin,e=c.wrap.width()+f[1]+f[3],g=c.wrap.height()+f[0]+f[2],h={position:"absolute",top:f[0]+d.y,left:f[3]+d.x};b.autoCenter&&(b.fixed&&!a&&g<=d.h&&e<=d.w)&&(h={position:"fixed",top:f[0],left:f[3]});h.top=l(Math.max(h.top,h.top+(d.h-g)*b.topRatio));h.left=l(Math.max(h.left,h.left+(d.w-e)*0.5));return h},_afterZoomIn:function(){var a=c.current,b=a?a.scrolling:"no";if(a){c.isOpen=
c.isOpened=true;c.wrap.addClass("fancybox-opened");c.inner.css("overflow",b==="yes"?"scroll":b==="no"?"hidden":b);c.trigger("afterShow");c.update();(a.closeClick||a.nextClick)&&c.inner.css("cursor","pointer").bind("click.fb",function(b){if(!e(b.target).is("a")&&!e(b.target).parent().is("a"))c[a.closeClick?"close":"next"]()});a.closeBtn&&e(a.tpl.closeBtn).appendTo(c.skin).bind("click.fb",c.close);if(a.arrows&&c.group.length>1){(a.loop||a.index>0)&&e(a.tpl.prev).appendTo(c.outer).bind("click.fb",c.prev);
(a.loop||a.index<c.group.length-1)&&e(a.tpl.next).appendTo(c.outer).bind("click.fb",c.next)}if(c.opts.autoPlay&&!c.player.isActive){c.opts.autoPlay=false;c.play()}}},_afterZoomOut:function(){var a=c.current;c.wrap.trigger("onReset").remove();e.extend(c,{group:{},opts:{},current:null,isActive:false,isOpened:false,isOpen:false,wrap:null,skin:null,outer:null,inner:null});c.trigger("afterClose",a)}});c.transitions={getOrigPosition:function(){var a=c.current,b=a.element,d=a.padding,f=e(a.orig),g={},h=
50,i=50;if(!f.length&&a.isDom&&e(b).is(":visible")){f=e(b).find("img:first");f.length||(f=e(b))}if(f.length){g=f.offset();if(f.is("img")){h=f.outerWidth();i=f.outerHeight()}}else{a=c.getViewport();g.top=a.y+(a.h-i)*0.5;g.left=a.x+(a.w-h)*0.5}return g={top:l(g.top-d),left:l(g.left-d),width:l(h+d*2),height:l(i+d*2)}},step:function(a,b){var d=b.prop,f,e;if(d==="width"||d==="height"){f=Math.ceil(a-c.current.padding*2);if(d==="height"){e=(a-b.start)/(b.end-b.start);b.start>b.end&&(e=1-e);f=f-c.innerSpace*
e}c.inner[d](f)}},zoomIn:function(){var a=c.wrap,b=c.current,d=b.openEffect,f=d==="elastic",g=e.extend({},b.dim,c._getPosition(f)),h=e.extend({opacity:1},g);delete h.position;if(f){g=this.getOrigPosition();if(b.openOpacity)g.opacity=0;c.outer.add(c.inner).width("auto").height("auto")}else if(d==="fade")g.opacity=0;a.css(g).show().animate(h,{duration:d==="none"?0:b.openSpeed,easing:b.openEasing,step:f?this.step:null,complete:c._afterZoomIn})},zoomOut:function(){var a=c.wrap,b=c.current,d=b.openEffect,
f=d==="elastic",e={opacity:0};if(f){a.css("position")==="fixed"&&a.css(c._getPosition(true));e=this.getOrigPosition();if(b.closeOpacity)e.opacity=0}a.animate(e,{duration:d==="none"?0:b.closeSpeed,easing:b.closeEasing,step:f?this.step:null,complete:c._afterZoomOut})},changeIn:function(){var a=c.wrap,b=c.current,d=b.nextEffect,f=d==="elastic",e=c._getPosition(f),g={opacity:1};e.opacity=0;if(f){e.top=l(parseInt(e.top,10)-200);g.top="+=200px"}a.css(e).show().animate(g,{duration:d==="none"?0:b.nextSpeed,
easing:b.nextEasing,complete:c._afterZoomIn})},changeOut:function(){var a=c.wrap,b=c.current,d=b.prevEffect,f={opacity:0};a.removeClass("fancybox-opened");if(d==="elastic")f.top="+=200px";a.animate(f,{duration:d==="none"?0:b.prevSpeed,easing:b.prevEasing,complete:function(){e(this).trigger("onReset").remove()}})}};c.helpers.overlay={overlay:null,update:function(){var a,c;this.overlay.width("100%").height("100%");if(e.browser.msie||i){a=Math.max(b.documentElement.scrollWidth,b.body.scrollWidth);c=
Math.max(b.documentElement.offsetWidth,b.body.offsetWidth);a=a<c?g.width():a}else a=f.width();this.overlay.width(a).height(f.height())},beforeShow:function(a){if(!this.overlay){a=e.extend(true,{},c.defaults.helpers.overlay,a);this.overlay=e('<div id="fancybox-overlay"></div>').css(a.css).appendTo("body");a.closeClick&&this.overlay.bind("click.fb",c.close);if(c.current.fixed&&!i)this.overlay.addClass("overlay-fixed");else{this.update();this.onUpdate=function(){this.update()}}this.overlay.fadeTo(a.speedIn,
a.opacity)}},afterClose:function(a){this.overlay&&this.overlay.fadeOut(a.speedOut||0,function(){e(this).remove()});this.overlay=null}};c.helpers.title={beforeShow:function(a){var b;if(b=c.current.title){b=e('<div class="fancybox-title fancybox-title-'+a.type+'-wrap">'+b+"</div>").appendTo("body");if(a.type==="float"){b.width(b.width());b.wrapInner('<span class="child"></span>');c.current.margin[2]=c.current.margin[2]+Math.abs(parseInt(b.css("margin-bottom"),10))}b.appendTo(a.type==="over"?c.inner:
a.type==="outside"?c.wrap:c.skin)}}};e.fn.fancybox=function(a){var b=e(this),d=this.selector||"",g,h=function(f){var h=this,i=g,j;if(!f.ctrlKey&&(!f.altKey&&!f.shiftKey&&!f.metaKey)&&!e(h).is(".fancybox-wrap")){f.preventDefault();f=a.groupAttr||"data-fancybox-group";j=e(h).attr(f);if(!j){f="rel";j=h[f]}if(j&&j!==""&&j!=="nofollow"){h=d.length?e(d):b;h=h.filter("["+f+'="'+j+'"]');i=h.index(this)}a.index=i;c.open(h,a)}},a=a||{};g=a.index||0;d?f.undelegate(d,"click.fb-start").delegate(d,"click.fb-start",
h):b.unbind("click.fb-start").bind("click.fb-start",h);return this};e(b).ready(function(){c.defaults.fixed=e.support.fixedPosition||!(e.browser.msie&&e.browser.version<=6)&&!i})})(window,document,jQuery);
(function(a){var b=0;a.getScrollbarWidth=function(){if(!b)if(a.browser.msie){var e=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:-1E3}).appendTo("body"),d=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:-1E3}).appendTo("body");b=e.width()-d.width();e.add(d).remove()}else{e=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:-1E3}).prependTo("body").append("<div />").find("div").css({width:"100%",
height:200});b=100-e.width();e.parent().remove()}return b}})(jQuery);
(function(a){a.ui=a.ui||{};var b=/left|center|right/,e=/top|center|bottom/,d=a.fn.position,g=a.fn.offset;a.fn.position=function(f){if(!f||!f.of)return d.apply(this,arguments);var f=a.extend({},f),c=a(f.of),g=c[0],i=(f.collision||"flip").split(" "),j=f.offset?f.offset.split(" "):[0,0],l,m,n;if(g.nodeType===9){l=c.width();m=c.height();n={top:0,left:0}}else if(g.setTimeout){l=c.width();m=c.height();n={top:c.scrollTop(),left:c.scrollLeft()}}else if(g.preventDefault){f.at="left top";l=m=0;n={top:f.of.pageY,
left:f.of.pageX}}else{l=c.outerWidth();m=c.outerHeight();n=c.offset()}a.each(["my","at"],function(){var a=(f[this]||"").split(" ");a.length===1&&(a=b.test(a[0])?a.concat(["center"]):e.test(a[0])?["center"].concat(a):["center","center"]);a[0]=b.test(a[0])?a[0]:"center";a[1]=e.test(a[1])?a[1]:"center";f[this]=a});i.length===1&&(i[1]=i[0]);j[0]=parseInt(j[0],10)||0;j.length===1&&(j[1]=j[0]);j[1]=parseInt(j[1],10)||0;if(f.at[0]==="right")n.left=n.left+l;else if(f.at[0]==="center")n.left=n.left+l/2;if(f.at[1]===
"bottom")n.top=n.top+m;else if(f.at[1]==="center")n.top=n.top+m/2;n.left=n.left+j[0];n.top=n.top+j[1];return this.each(function(){var b=a(this),c=b.outerWidth(),d=b.outerHeight(),e=parseInt(a.curCSS(this,"marginLeft",true))||0,g=parseInt(a.curCSS(this,"marginTop",true))||0,h=c+e+parseInt(a.curCSS(this,"marginRight",true))||0,s=d+g+parseInt(a.curCSS(this,"marginBottom",true))||0,v=a.extend({},n),o;if(f.my[0]==="right")v.left=v.left-c;else if(f.my[0]==="center")v.left=v.left-c/2;if(f.my[1]==="bottom")v.top=
v.top-d;else if(f.my[1]==="center")v.top=v.top-d/2;v.left=Math.round(v.left);v.top=Math.round(v.top);o={left:v.left-e,top:v.top-g};a.each(["left","top"],function(b,e){if(a.ui.position[i[b]])a.ui.position[i[b]][e](v,{targetWidth:l,targetHeight:m,elemWidth:c,elemHeight:d,collisionPosition:o,collisionWidth:h,collisionHeight:s,offset:j,my:f.my,at:f.at})});a.fn.bgiframe&&b.bgiframe();b.offset(a.extend(v,{using:f.using}))})};a.ui.position={fit:{left:function(b,c){var d=a(window),d=c.collisionPosition.left+
c.collisionWidth-d.width()-d.scrollLeft();b.left=d>0?b.left-d:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=d>0?b.top-d:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]!=="center"){var d=a(window),d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),e=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,g=c.at[0]==="left"?c.targetWidth:
-c.targetWidth,l=-2*c.offset[0];b.left=b.left+(c.collisionPosition.left<0?e+g+l:d>0?e+g+l:0)}},top:function(b,c){if(c.at[1]!=="center"){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),e=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,g=c.at[1]==="top"?c.targetHeight:-c.targetHeight,l=-2*c.offset[1];b.top=b.top+(c.collisionPosition.top<0?e+g+l:d>0?e+g+l:0)}}}};if(!a.offset.setOffset){a.offset.setOffset=function(b,c){if(/static/.test(a.curCSS(b,"position")))b.style.position=
"relative";var d=a(b),e=d.offset(),g=parseInt(a.curCSS(b,"top",true),10)||0,l=parseInt(a.curCSS(b,"left",true),10)||0,e={top:c.top-e.top+g,left:c.left-e.left+l};"using"in c?c.using.call(b,e):d.css(e)};a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?this.each(function(){a.offset.setOffset(this,b)}):g.call(this)}}})(jQuery);
(function(a){a.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,extractTerms:null},_create:function(){var b=this,e=this.element[0].ownerDocument,d;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(e){if(!b.options.disabled&&!b.element.attr("readonly")){d=false;var f=a.ui.keyCode;
switch(e.keyCode){case f.PAGE_UP:b._move("previousPage",e);break;case f.PAGE_DOWN:b._move("nextPage",e);break;case f.UP:if(b.menu.element.is(":visible")){b._move("previous",e);e.preventDefault()}break;case f.DOWN:if(b.menu.element.is(":visible")){b._move("next",e);e.preventDefault()}break;case f.ENTER:case f.NUMPAD_ENTER:if(b.menu.active){d=true;e.preventDefault()}case f.TAB:if(!b.menu.active)break;b.menu.select(e);break;case f.ESCAPE:b.element.val(b.term);b.close(e);break;default:clearTimeout(b.searching);
b.searching=setTimeout(function(){if(b.term!=b.element.val()){b.selectedItem=null;b.search(null,e)}},b.options.delay)}}}).bind("keypress.autocomplete",function(a){if(d){d=false;a.preventDefault()}}).bind("focus.autocomplete",function(){if(!b.options.disabled){b.selectedItem=null;b.previous=b.element.val()}}).bind("blur.autocomplete",function(a){if(!b.options.disabled){clearTimeout(b.searching);b.closing=setTimeout(function(){b.close(a);b._change(a)},150)}});this._initSource();this.response=function(){return b._response.apply(b,
arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",e)[0]).mousedown(function(d){var f=b.menu.element[0];a(d.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==b.element[0]&&(c.target!==f&&!a.ui.contains(f,c.target))&&b.close()})},1);setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,d){var c=d.item.data("item.autocomplete");false!==b._trigger("focus",a,{item:c})&&
/^key/.test(a.originalEvent.type)&&b.element.val(c.value)},selected:function(a,d){var c=d.item.data("item.autocomplete"),h=b.previous;if(b.element[0]!==e.activeElement){b.element.focus();b.previous=h;setTimeout(function(){b.previous=h;b.selectedItem=c},1)}false!==b._trigger("select",a,{item:c})&&b.element.val(c.value);b.term=b.element.val();b.close(a);b.selectedItem=c},blur:function(){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,
left:0}).hide().data("menu");a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(b,e){a.Widget.prototype._setOption.apply(this,arguments);b==="source"&&this._initSource();b==="appendTo"&&this.menu.element.appendTo(a(e||"body",this.element[0].ownerDocument)[0])},
_initSource:function(){var b=this,e,d;this.cache=this.cache||{};if(a.isArray(this.options.source)){e=this.options.source;this.source=function(b,d){d(a.ui.autocomplete.filter(e,b.term))}}else if(typeof this.options.source==="string"){d=this.options.source;this.source=function(e,f){b.xhr&&b.xhr.abort();var c=e.term;c in b.cache?f(b.cache[c]):b.xhr=a.ajax({url:d,data:e,dataType:"json",success:function(a,d,e){b.cache[c]=a;e===b.xhr&&f(a);b.xhr=null},error:function(a){a===b.xhr&&f([]);b.xhr=null}})}}else this.source=
this.options.source},search:function(a,e){a=a!=null?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(e);clearTimeout(this.closing);if(this._trigger("search",e)!==false)return this._search(a)},_search:function(a){this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){if(a&&a.length){a=this._normalize(a);this._suggest(a);this._trigger("open")}else this.close();this.element.removeClass("ui-autocomplete-loading")},
close:function(a){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",a)}},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b==="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var e=this.menu.element.empty().zIndex(this.element.zIndex()+
1);this._renderMenu(e,b);this.menu.deactivate();this.menu.refresh();e.show();this._resizeMenu();e.position(a.extend({of:this.element},this.options.position))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(b,e){var d=this;a.each(e,function(a,f){d._renderItem(b,f)})},_escape:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},_renderItem:function(b,e){var d=(this.options.extractTerms||
function(a){return[a]})(a(this.element).val()),d=_.filter(d,function(a){return a}),d=_.sortBy(d,function(a){return-a.length}),d=RegExp("(?![^&;]+;)(?!<[^<>]*)("+_.map(d,function(a){return a.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")}).join("|")+")(?![^<>]*>)(?![^&;]+;)","gi"),g=a("<a>");g.html(this._escape(e.label).replace(d,"<strong>$1</strong>"));e.avatar&&g.prepend(a("<img />").attr("src",e.avatar));return a("<li></li>").data("item.autocomplete",e).append(g).appendTo(b)},_move:function(a,
e){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term);this.menu.deactivate()}else this.menu[a](e);else this.search(null,e)},widget:function(){return this.menu.element}});a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(b,e){var d=RegExp(a.ui.autocomplete.escapeRegex(e),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}})})(jQuery);
(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(e){if(a(e.target).closest(".ui-menu-item a").length){e.preventDefault();b.select(e)}});this.refresh()},refresh:function(){var b=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(e){b.activate(e,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,e){this.deactivate();if(this.hasScroll()){var d=e.offset().top-this.element.offset().top,g=this.element.attr("scrollTop"),f=this.element.height();d<0?this.element.attr("scrollTop",g+d):d>=f&&this.element.attr("scrollTop",g+d-f+e.height())}this.active=e.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",a,{item:e})},deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");
this._trigger("blur");this.active=null}},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,e,d){if(this.active){a=this.active[a+"All"](".ui-menu-item").eq(0);a.length?this.activate(d,a):this.activate(d,this.element.children(e))}else this.activate(d,
this.element.children(e))},nextPage:function(b){if(this.hasScroll())if(!this.active||this.last())this.activate(b,this.element.children(".ui-menu-item:first"));else{var e=this.active.offset().top,d=this.element.height(),g=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-e-d+a(this).height();return b<10&&b>-10});g.length||(g=this.element.children(".ui-menu-item:last"));this.activate(b,g)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||
this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll())if(!this.active||this.first())this.activate(b,this.element.children(".ui-menu-item:last"));else{var e=this.active.offset().top,d=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-e+d-a(this).height();return b<10&&b>-10});result.length||(result=this.element.children(".ui-menu-item:first"));this.activate(b,result)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||
this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})})(jQuery);
(function(a,b){var e={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},d={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};a.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(b){var d=a(this).css(b).offset().top;d<0&&
a(this).css("top",b.top-d)}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string")this.originalTitle="";this.options.title=this.options.title||this.originalTitle;var b=this,d=b.options,c=d.title||"&#160;",e=a.ui.dialog.getTitleId(b.element),i=(b.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+d.dialogClass).css({zIndex:d.zIndex}).attr("tabIndex",
-1).css("outline",0).keydown(function(c){if(d.closeOnEscape&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE){b.close(c);c.preventDefault()}}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(a){b.moveToTop(false,a)});b.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(i);var j=(b.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(i),l=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role",
"button").hover(function(){l.addClass("ui-state-hover")},function(){l.removeClass("ui-state-hover")}).focus(function(){l.addClass("ui-state-focus")}).blur(function(){l.removeClass("ui-state-focus")}).click(function(a){b.close(a);return false}).appendTo(j);(b.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(d.closeText).appendTo(l);a("<span></span>").addClass("ui-dialog-title").attr("id",e).html(c).prependTo(j);if(a.isFunction(d.beforeclose)&&!a.isFunction(d.beforeClose))d.beforeClose=
d.beforeclose;j.find("*").add(j).disableSelection();d.draggable&&a.fn.draggable&&b._makeDraggable();d.resizable&&a.fn.resizable&&b._makeResizable();b._createButtons(d.buttons);b._isOpen=false;a.fn.bgiframe&&i.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();
this.originalTitle&&this.element.attr("title",this.originalTitle);return this},widget:function(){return this.uiDialog},close:function(b){var d=this,c,e;if(false!==d._trigger("beforeClose",b)){d.overlay&&d.overlay.destroy();d.uiDialog.unbind("keypress.ui-dialog");d._isOpen=false;if(d.options.hide)d.uiDialog.hide(d.options.hide,function(){d._trigger("close",b)});else{d.uiDialog.hide();d._trigger("close",b)}a.ui.dialog.overlay.resize();if(d.options.modal){c=0;a(".ui-dialog").each(function(){if(this!==
d.uiDialog[0]){e=a(this).css("z-index");isNaN(e)||(c=Math.max(c,e))}});a.ui.dialog.maxZ=c}return d}},isOpen:function(){return this._isOpen},moveToTop:function(b,d){var c=this.options;if(c.modal&&!b||!c.stack&&!c.modal)return this._trigger("focus",d);if(c.zIndex>a.ui.dialog.maxZ)a.ui.dialog.maxZ=c.zIndex;if(this.overlay){a.ui.dialog.maxZ=a.ui.dialog.maxZ+1;this.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)}c={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};
a.ui.dialog.maxZ=a.ui.dialog.maxZ+1;this.uiDialog.css("z-index",a.ui.dialog.maxZ);this.element.attr(c);this._trigger("focus",d);return this},open:function(){if(!this._isOpen){var b=this.options,d=this.uiDialog;this.overlay=b.modal?new a.ui.dialog.overlay(this):null;this._size();this._position(b.position);d.show(b.show);this.moveToTop(true);b.modal&&d.bind("keypress.ui-dialog",function(b){if(b.keyCode===a.ui.keyCode.TAB){var d=a(":tabbable",this),f=d.filter(":first"),d=d.filter(":last");if(b.target===
d[0]&&!b.shiftKey){f.focus(1);return false}if(b.target===f[0]&&b.shiftKey){d.focus(1);return false}}});a(this.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus();this._isOpen=true;this._trigger("open");return this}},_createButtons:function(b){var d=this,c=false,e=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),i=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);d.uiDialog.find(".ui-dialog-buttonpane").remove();
typeof b==="object"&&b!==null&&a.each(b,function(){return!(c=true)});if(c){a.each(b,function(b,c){var c=a.isFunction(c)?{click:c,text:b}:c,e=a('<button type="button"></button>').attr(c,true).unbind("click").click(function(){c.click.apply(d.element[0],arguments)}).appendTo(i);a.fn.button&&e.button()});e.appendTo(d.uiDialog)}},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var d=this,c=d.options,e=a(document),i;d.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",
handle:".ui-dialog-titlebar",containment:"document",start:function(e,h){i=c.height==="auto"?"auto":a(this).height();a(this).height(a(this).height()).addClass("ui-dialog-dragging");d._trigger("dragStart",e,b(h))},drag:function(a,c){d._trigger("drag",a,b(c))},stop:function(j,l){c.position=[l.position.left-e.scrollLeft(),l.position.top-e.scrollTop()];a(this).removeClass("ui-dialog-dragging").height(i);d._trigger("dragStop",j,b(l));a.ui.dialog.overlay.resize()}})},_makeResizable:function(d){function f(a){return{originalPosition:a.originalPosition,
originalSize:a.originalSize,position:a.position,size:a.size}}var d=d===b?this.options.resizable:d,c=this,e=c.options,i=c.uiDialog.css("position"),d=typeof d==="string"?d:"n,e,s,w,se,sw,ne,nw";c.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:c.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:c._minHeight(),handles:d,start:function(b,d){a(this).addClass("ui-dialog-resizing");c._trigger("resizeStart",b,f(d))},resize:function(a,b){c._trigger("resize",
a,f(b))},stop:function(b,d){a(this).removeClass("ui-dialog-resizing");e.height=a(this).height();e.width=a(this).width();c._trigger("resizeStop",b,f(d));a.ui.dialog.overlay.resize()}}).css("position",i).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var d=[],c=[0,0],e;if(b){if(typeof b==="string"||typeof b==="object"&&"0"in b){d=b.split?b.split(" "):
[b[0],b[1]];d.length===1&&(d[1]=d[0]);a.each(["left","top"],function(a,b){if(+d[a]===d[a]){c[a]=d[a];d[a]=b}});b={my:d.join(" "),at:d.join(" "),offset:c.join(" ")}}b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b));e||this.uiDialog.hide()},_setOptions:function(b){var f=this,c={},h=false;a.each(b,function(a,b){f._setOption(a,b);
a in e&&(h=true);a in d&&(c[a]=b)});h&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",c)},_setOption:function(b,d){var c=this.uiDialog;switch(b){case "beforeclose":b="beforeClose";break;case "buttons":this._createButtons(d);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+d);break;case "dialogClass":c.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+d);break;case "disabled":d?c.addClass("ui-dialog-disabled"):
c.removeClass("ui-dialog-disabled");break;case "draggable":var e=c.is(":data(draggable)");e&&!d&&c.draggable("destroy");!e&&d&&this._makeDraggable();break;case "position":this._position(d);break;case "resizable":(e=c.is(":data(resizable)"))&&!d&&c.resizable("destroy");e&&typeof d==="string"&&c.resizable("option","handles",d);!e&&d!==false&&this._makeResizable(d);break;case "title":a(".ui-dialog-title",this.uiDialogTitlebar).html(""+(d||"&#160;"))}a.Widget.prototype._setOption.apply(this,arguments)},
_size:function(){var b=this.options,d,c,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(b.minWidth>b.width)b.width=b.minWidth;d=this.uiDialog.css({height:"auto",width:b.width}).height();c=Math.max(0,b.minHeight-d);if(b.height==="auto")if(a.support.minHeight)this.element.css({minHeight:c,height:"auto"});else{this.uiDialog.show();b=this.element.css("height","auto").height();e||this.uiDialog.hide();this.element.height(Math.max(b,c))}else this.element.height(Math.max(b.height-
d,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});a.extend(a.ui.dialog,{version:"1.8.7",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");if(!a)a=this.uuid=this.uuid+1;return"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}});a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map(["focus","mousedown","mouseup","keydown","keypress","click"],function(a){return a+".dialog-overlay"}).join(" "),
create:function(b){if(this.instances.length===0){setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return false})},1);a(document).bind("keydown.dialog-overlay",function(c){if(b.options.closeOnEscape&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE){b.close(c);c.preventDefault()}});a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize)}var d=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});a.fn.bgiframe&&d.bgiframe();this.instances.push(d);return d},destroy:function(b){var d=a.inArray(b,this.instances);d!=-1&&this.oldInstances.push(this.instances.splice(d,1)[0]);this.instances.length===0&&a([document,window]).unbind(".dialog-overlay");b.remove();var c=0;a.each(this.instances,function(){c=Math.max(c,this.css("z-index"))});this.maxZ=c},height:function(){var b,d;if(a.browser.msie&&a.browser.version<7){b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);
d=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return b<d?a(window).height()+"px":b+"px"}return a(document).height()+"px"},width:function(){var b,d;if(a.browser.msie&&a.browser.version<7){b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);d=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return b<d?a(window).width()+"px":b+"px"}return a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,
function(){b=b.add(this)});b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}});a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
(function(){var a=function(){this.options_index=0;this.parsed=[]};a.prototype.add_node=function(a){return a.nodeName.toUpperCase()==="OPTGROUP"?this.add_group(a):this.add_option(a)};a.prototype.add_group=function(a){var e,d,g,f,c,h;e=this.parsed.length;this.parsed.push({array_index:e,group:true,label:a.label,children:0,disabled:a.disabled});c=a.childNodes;h=[];g=0;for(f=c.length;g<f;g++){d=c[g];h.push(this.add_option(d,e,a.disabled))}return h};a.prototype.add_option=function(a,e,d){if(a.nodeName.toUpperCase()===
"OPTION"){if(a.text!==""){if(e!=null)this.parsed[e].children=this.parsed[e].children+1;this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,data:a.dataset,attributes:a.attributes,html:a.innerHTML,selected:a.selected,disabled:d===true?d:a.disabled,group_array_index:e,classes:a.className,style:a.style.cssText})}else this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true});return this.options_index=this.options_index+
1}};a.select_to_array=function(b){var e,d,g,f;e=new a;f=b.childNodes;d=0;for(g=f.length;d<g;d++){b=f[d];e.add_node(b)}return e.parsed};this.SelectParser=a}).call(this);
(function(){var a=function(a,e){this.form_field=a;this.options=e!=null?e:{};this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers();this.finish_setup()};a.prototype.set_default_values=function(){var a=this;this.click_test_action=function(e){return a.test_active_click(e)};this.activate_action=function(e){return a.activate_field(e)};this.results_showing=this.mouse_on_container=this.active_field=false;this.result_single_selected=
this.result_highlighted=null;this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||false;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;this.search_contains=this.options.search_contains||
false;this.choices=0;this.single_backstroke_delete=this.options.single_backstroke_delete||false;this.max_selected_options=this.options.max_selected_options||Infinity;this.result_formatter=this.options.result_formatter||function(a){return"<span>"+a.html+"</span>"};return this.inherit_select_classes=this.options.inherit_select_classes||false};a.prototype.set_default_text=function(){this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?
this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option";return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"};a.prototype.mouse_enter=function(){return this.mouse_on_container=true};a.prototype.mouse_leave=function(){return this.mouse_on_container=false};a.prototype.input_focus=function(){var a=
this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return a.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()};a.prototype.input_blur=function(){var a=this;if(!this.mouse_on_container){this.active_field=false;return setTimeout(function(){return a.blur_test()},100)}};a.prototype.result_add_option=function(a){var e,d;if(a.disabled)return"";a.dom_id=this.container_id+"_o_"+a.array_index;e=a.selected&&this.is_multiple?[]:["active-result"];a.selected&&
e.push("result-selected");a.group_array_index!=null&&e.push("group-option");a.classes!==""&&e.push(a.classes);d=a.style.cssText!==""?' style="'+a.style+'"':"";return'<li id="'+a.dom_id+'" class="'+e.join(" ")+'"'+d+' data-value="'+a.value+'">'+a.html+"</li>"};a.prototype.results_update_field=function(){this.is_multiple||this.results_reset_cleanup();this.result_clear_highlight();this.result_single_selected=null;return this.results_build()};a.prototype.results_toggle=function(){return this.results_showing?
this.results_hide():this.results_show()};a.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()};a.prototype.keyup_checker=function(a){var e,d;e=(d=a.which)!=null?d:a.keyCode;this.search_field_scale();switch(e){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}break;case 13:a.preventDefault();if(this.results_showing)return this.result_select(a);
break;case 27:this.results_showing&&this.results_hide();return true;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};a.prototype.generate_field_id=function(){var a;a=this.generate_random_id();return this.form_field.id=a};a.prototype.generate_random_char=function(){var a;a=Math.floor(Math.random()*36);return"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(a,a+1)};this.AbstractChosen=a}).call(this);
(function(){var a,b,e,d,g={}.hasOwnProperty;d=this;a=jQuery;a.fn.extend({chosen:function(c){var d,f;d=navigator.userAgent.toLowerCase();f=/(msie) ([\w.]+)/.exec(d)||[];d=f[1]||"";f=f[2]||"0";return d==="msie"&&(f==="6.0"||f==="7.0"&&document.documentMode===7)?this:this.each(function(){var d;d=a(this);if(!d.hasClass("chzn-done"))return d.data("chosen",new b(this,c))})}});var f=function(){return f.__super__.constructor.apply(this,arguments)},c=f,h=AbstractChosen,i=function(){this.constructor=c},j;for(j in h)g.call(h,
j)&&(c[j]=h[j]);i.prototype=h.prototype;c.prototype=new i;c.__super__=h.prototype;f.prototype.setup=function(){this.form_field_jq=a(this.form_field);this.current_value=this.form_field_jq.val();return this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")};f.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")};f.prototype.set_up_html=function(){var b,c;this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id();this.container_id=
this.container_id+"_chzn";b=["chzn-container"];b.push("chzn-container-"+(this.is_multiple?"multi":"single"));this.inherit_select_classes&&this.form_field.className&&b.push(this.form_field.className);this.is_rtl&&b.push("chzn-rtl");this.f_width=this.form_field_jq.outerWidth();b={id:this.container_id,"class":b.join(" "),style:"width: "+this.f_width+"px;",title:this.form_field.title};b=a("<div />",b);this.is_multiple?b.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+
this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):b.html('<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>');this.form_field_jq.hide().after(b);
this.container=a("#"+this.container_id);this.dropdown=this.container.find("div.chzn-drop").first();b=this.container.height();c=this.f_width-e(this.dropdown);this.dropdown.css({width:c+"px",top:b+"px"});this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chzn-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chzn-choices").first();
this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chzn-search").first();this.selected_item=this.container.find(".chzn-single").first();b=c-e(this.search_container)-e(this.search_field);this.search_field.css({width:b+"px"})}this.results_build();this.set_tab_index();return this.form_field_jq.trigger("liszt:ready",{chosen:this})};f.prototype.register_observers=function(){var a=this;this.container.mousedown(function(b){return a.container_mousedown(b)});
this.container.mouseup(function(b){return a.container_mouseup(b)});this.container.mouseenter(function(b){return a.mouse_enter(b)});this.container.mouseleave(function(b){return a.mouse_leave(b)});this.search_results.mouseup(function(b){return a.search_results_mouseup(b)});this.search_results.mouseover(function(b){return a.search_results_mouseover(b)});this.search_results.mouseout(function(b){return a.search_results_mouseout(b)});this.form_field_jq.bind("liszt:updated",function(b){return a.results_update_field(b)});
this.form_field_jq.bind("liszt:activate",function(b){return a.activate_field(b)});this.form_field_jq.bind("liszt:open",function(b){return a.container_mousedown(b)});this.search_field.blur(function(b){return a.input_blur(b)});this.search_field.keyup(function(b){return a.keyup_checker(b)});this.search_field.keydown(function(b){return a.keydown_checker(b)});this.search_field.focus(function(b){return a.input_focus(b)});return this.is_multiple?this.search_choices.click(function(b){return a.choices_click(b)}):
this.container.click(function(a){return a.preventDefault()})};f.prototype.search_field_disabled=function(){if(this.is_disabled=this.form_field_jq[0].disabled){this.container.addClass("chzn-disabled");this.search_field[0].disabled=true;this.is_multiple||this.selected_item.unbind("focus",this.activate_action);return this.close_field()}this.container.removeClass("chzn-disabled");this.search_field[0].disabled=false;if(!this.is_multiple)return this.selected_item.bind("focus",this.activate_action)};f.prototype.container_mousedown=
function(b){var c;if(!this.is_disabled){c=b!=null?a(b.target).hasClass("search-choice-close"):false;b&&(b.type==="mousedown"&&!this.results_showing)&&b.preventDefault();if(!this.pending_destroy_click&&!c){if(this.active_field){if(!this.is_multiple&&b&&(a(b.target)[0]===this.selected_item[0]||a(b.target).parents("a.chzn-single").length)){b.preventDefault();this.results_toggle()}}else{this.is_multiple&&this.search_field.val("");a(document).click(this.click_test_action);this.results_show()}return this.activate_field()}return this.pending_destroy_click=
false}};f.prototype.container_mouseup=function(a){if(a.target.nodeName==="ABBR"&&!this.is_disabled)return this.results_reset(a)};f.prototype.blur_test=function(){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()};f.prototype.close_field=function(){a(document).unbind("click",this.click_test_action);this.active_field=false;this.results_hide();this.container.removeClass("chzn-container-active");this.winnow_results_clear();this.clear_backstroke();this.show_search_field_default();
return this.search_field_scale()};f.prototype.activate_field=function(){this.container.addClass("chzn-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus()};f.prototype.test_active_click=function(b){return a(b.target).parents("#"+this.container_id).length?this.active_field=true:this.close_field()};f.prototype.results_build=function(){var a,b,c,f,e;this.parsing=true;this.results_data=d.SelectParser.select_to_array(this.form_field);
if(this.is_multiple&&this.choices>0){this.search_choices.find("li.search-choice").remove();this.choices=0}else if(!this.is_multiple){this.selected_item.addClass("chzn-default").find("span").text(this.default_text);this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")}a="";e=this.results_data;c=0;for(f=e.length;c<f;c++){b=e[c];if(b.group)a=a+this.result_add_group(b);
else if(!b.empty){a=a+this.result_add_option(b);if(b.selected&&this.is_multiple)this.choice_build(b);else if(b.selected&&!this.is_multiple){this.selected_item.removeClass("chzn-default").find("span").attr("data-value",b.value).text(b.text);this.allow_single_deselect&&this.single_deselect_control_build()}}}this.search_field_disabled();this.show_search_field_default();this.search_field_scale();this.search_results.html(a);return this.parsing=false};f.prototype.result_add_group=function(b){if(b.disabled)return"";
b.dom_id=this.container_id+"_g_"+b.array_index;return'<li id="'+b.dom_id+'" class="group-result">'+a("<div />").text(b.label).html()+"</li>"};f.prototype.result_do_highlight=function(a){var b,c,d,f;if(a.length){this.result_clear_highlight();this.result_highlight=a;this.result_highlight.addClass("highlighted");c=parseInt(this.search_results.css("maxHeight"),10);f=this.search_results.scrollTop();d=c+f;b=this.result_highlight.position().top+this.search_results.scrollTop();a=b+this.result_highlight.outerHeight();
if(a>=d)return this.search_results.scrollTop(a-c>0?a-c:0);if(b<f)return this.search_results.scrollTop(b)}};f.prototype.result_clear_highlight=function(){this.result_highlight&&this.result_highlight.removeClass("highlighted");return this.result_highlight=null};f.prototype.results_show=function(){var a;if(this.is_multiple){if(this.max_selected_options<=this.choices){this.form_field_jq.trigger("liszt:maxselected",{chosen:this});return false}}else{this.selected_item.addClass("chzn-single-with-drop");
this.result_single_selected&&this.result_do_highlight(this.result_single_selected)}a=this.is_multiple?this.container.height():this.container.height()-1;this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this});this.dropdown.css({top:a+"px",left:0});this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};f.prototype.results_hide=function(){this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop");this.result_clear_highlight();
this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this});this.dropdown.css({left:"-9000px"});return this.results_showing=false};f.prototype.set_tab_index=function(){var a;if(this.form_field_jq.attr("tabindex")){a=this.form_field_jq.attr("tabindex");this.form_field_jq.attr("tabindex",-1);return this.search_field.attr("tabindex",a)}};f.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}this.search_field.val("");
return this.search_field.removeClass("default")};f.prototype.search_results_mouseup=function(b){var c;c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first();if(c.length){this.result_highlight=c;this.result_select(b);return this.search_field.focus()}};f.prototype.search_results_mouseover=function(b){if(b=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first())return this.result_do_highlight(b)};f.prototype.search_results_mouseout=
function(b){if(a(b.target).hasClass("active-result"))return this.result_clear_highlight()};f.prototype.choices_click=function(b){b.preventDefault();if(this.active_field&&!a(b.target).hasClass("search-choice")&&!this.results_showing)return this.results_show()};f.prototype.choice_build=function(b){var c,d=this;if(this.is_multiple&&this.max_selected_options<=this.choices){this.form_field_jq.trigger("liszt:maxselected",{chosen:this});return false}c=this.container_id+"_c_"+b.array_index;this.choices=this.choices+
1;b=b.disabled?'<li class="search-choice search-choice-disabled" id="'+c+'">'+this.result_formatter(b)+"</li>":'<li class="search-choice" id="'+c+'">'+this.result_formatter(b)+'<a href="javascript:void(0)" class="search-choice-close" rel="'+b.array_index+'"></a></li>';this.search_container.before(b);return a("#"+c).find("a").first().click(function(a){return d.choice_destroy_link_click(a)})};f.prototype.choice_destroy_link_click=function(b){b.preventDefault();if(this.is_disabled)return b.stopPropagation;
this.pending_destroy_click=true;return this.choice_destroy(a(b.target))};f.prototype.choice_destroy=function(a){if(this.result_deselect(a.attr("rel"))){this.choices=this.choices-1;this.show_search_field_default();this.is_multiple&&(this.choices>0&&this.search_field.val().length<1)&&this.results_hide();a.parents("li").first().remove();return this.search_field_scale()}};f.prototype.results_reset=function(){this.form_field.options[0].selected=true;this.selected_item.find("span").text(this.default_text);
this.selected_item.find("span").removeAttr("data-value");this.is_multiple||this.selected_item.addClass("chzn-default");this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field)return this.results_hide()};f.prototype.results_reset_cleanup=function(){this.current_value=this.form_field_jq.val();return this.selected_item.find("abbr").remove()};f.prototype.result_select=function(a){var b,c;if(this.result_highlight){b=this.result_highlight;
c=b.attr("id");this.result_clear_highlight();if(this.is_multiple)this.result_deactivate(b);else{this.search_results.find(".result-selected").removeClass("result-selected");this.result_single_selected=b;this.selected_item.removeClass("chzn-default")}b.addClass("result-selected");b=c.substr(c.lastIndexOf("_")+1);b=this.results_data[b];b.selected=true;this.form_field.options[b.options_index].selected=true;if(this.is_multiple)this.choice_build(b);else{this.selected_item.find("span").first().attr("data-value",
b.value).text(b.text);this.allow_single_deselect&&this.single_deselect_control_build()}(!a.metaKey&&!a.ctrlKey||!this.is_multiple)&&this.results_hide();this.search_field.val("");(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[b.options_index].value});this.current_value=this.form_field_jq.val();return this.search_field_scale()}};f.prototype.result_activate=function(a){return a.addClass("active-result")};f.prototype.result_deactivate=
function(a){return a.removeClass("active-result")};f.prototype.result_deselect=function(b){var c;c=this.results_data[b];if(this.form_field.options[c.options_index].disabled)return false;c.selected=false;this.form_field.options[c.options_index].selected=false;a("#"+this.container_id+"_o_"+b).removeClass("result-selected").addClass("active-result").show();this.result_clear_highlight();this.winnow_results();this.form_field_jq.trigger("change",{deselected:this.form_field.options[c.options_index].value});
this.search_field_scale();return true};f.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect&&this.selected_item.find("abbr").length<1)return this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')};f.prototype.winnow_results=function(){var b,c,d,f,e,g,h,i,j,s,v,o,y,A,B;this.no_results_clear();i=0;j=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html();e=RegExp((this.search_contains?"":
"^")+j.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");s=RegExp(j.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");B=this.results_data;v=0;for(y=B.length;v<y;v++){c=B[v];if(!c.disabled&&!c.empty)if(c.group)a("#"+c.dom_id).css("display","none");else if(!this.is_multiple||!c.selected){b=false;h=c.dom_id;g=a("#"+h);if(e.test(c.html)){b=true;i=i+1}else if(this.enable_split_word_search&&(c.html.indexOf(" ")>=0||c.html.indexOf("[")===0)){f=c.html.replace(/\[|\]/g,"").split(" ");if(f.length){o=0;for(A=f.length;o<
A;o++){d=f[o];if(e.test(d)){b=true;i=i+1}}}}if(b){if(j.length){b=c.html.search(s);d=c.html.substr(0,b+j.length)+"</em>"+c.html.substr(b+j.length);d=d.substr(0,b)+"<em>"+d.substr(b)}else d=c.html;g.html(d);this.result_activate(g);c.group_array_index!=null&&a("#"+this.results_data[c.group_array_index].dom_id).css("display","list-item")}else{this.result_highlight&&h===this.result_highlight.attr("id")&&this.result_clear_highlight();this.result_deactivate(g)}}}return i<1&&j.length?this.no_results(j):this.winnow_results_set_highlight()};
f.prototype.winnow_results_clear=function(){var b,c,d,f,e;this.search_field.val("");c=this.search_results.find("li");e=[];d=0;for(f=c.length;d<f;d++){b=c[d];b=a(b);b.hasClass("group-result")?e.push(b.css("display","auto")):!this.is_multiple||!b.hasClass("result-selected")?e.push(this.result_activate(b)):e.push(void 0)}return e};f.prototype.winnow_results_set_highlight=function(){var a;if(!this.result_highlight){a=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];a=a.length?
a.first():this.search_results.find(".active-result").first();if(a!=null)return this.result_do_highlight(a)}};f.prototype.no_results=function(b){var c;c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');c.find("span").first().html(b);return this.search_results.append(c)};f.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};f.prototype.keydown_arrow=function(){var b;if(this.result_highlight){if(this.results_showing)(b=this.result_highlight.nextAll("li.active-result").first())&&
this.result_do_highlight(b)}else(b=this.search_results.find("li.active-result").first())&&this.result_do_highlight(a(b));if(!this.results_showing)return this.results_show()};f.prototype.keyup_arrow=function(){var a;if(!this.results_showing&&!this.is_multiple)return this.results_show();if(this.result_highlight){a=this.result_highlight.prevAll("li.active-result");if(a.length)return this.result_do_highlight(a.first());this.choices>0&&this.results_hide();return this.result_clear_highlight()}};f.prototype.keydown_backstroke=
function(){var a;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}a=this.search_container.siblings("li.search-choice").last();if(a.length&&!a.hasClass("search-choice-disabled")){this.pending_backstroke=a;return this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")}};f.prototype.clear_backstroke=function(){this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus");
return this.pending_backstroke=null};f.prototype.keydown_checker=function(a){var b,c;b=(c=a.which)!=null?c:a.keyCode;this.search_field_scale();b!==8&&this.pending_backstroke&&this.clear_backstroke();switch(b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a);this.mouse_on_container=false;break;case 13:a.preventDefault();break;case 38:a.preventDefault();this.keyup_arrow();break;case 40:this.keydown_arrow()}};f.prototype.search_field_scale=
function(){var b,c,d,f,e;if(this.is_multiple){c="position:absolute; left: -1000px; top: -1000px; display:none;";d=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];f=0;for(e=d.length;f<e;f++){b=d[f];c=c+(b+":"+this.search_field.css(b)+";")}b=a("<div />",{style:c});b.text(this.search_field.val());a("body").append(b);c=b.width()+25;b.remove();c>this.f_width-10&&(c=this.f_width-10);this.search_field.css({width:c+"px"});b=this.container.height();return this.dropdown.css({top:b+
"px"})}};f.prototype.generate_random_id=function(){var b;for(b="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();a("#"+b).length>0;)b=b+this.generate_random_char();return b};b=f;d.Chosen=b;e=function(a){return a.outerWidth()-a.width()};d.get_side_border_padding=e}).call(this);
var store=function(){var a={},b=window,e=b.document,d;a.disabled=false;a.set=function(){};a.get=function(){};a.remove=function(){};a.clear=function(){};a.transact=function(b,c){var d=a.get(b);typeof d=="undefined"&&(d={});c(d);a.set(b,d)};a.serialize=function(a){return JSON.stringify(a)};a.deserialize=function(a){return typeof a!="string"?void 0:JSON.parse(a)};var g;try{g="localStorage"in b&&b.localStorage}catch(f){g=false}if(g){d=b.localStorage;a.set=function(b,c){d.setItem(b,a.serialize(c))};a.get=
function(b){return a.deserialize(d.getItem(b))};a.remove=function(a){d.removeItem(a)};a.clear=function(){d.clear()}}else{var c;try{c="globalStorage"in b&&b.globalStorage&&b.globalStorage[b.location.hostname]}catch(h){c=false}if(c){d=b.globalStorage[b.location.hostname];a.set=function(b,c){d[b]=a.serialize(c)};a.get=function(b){return a.deserialize(d[b]&&d[b].value)};a.remove=function(a){delete d[a]};a.clear=function(){for(var a in d)delete d[a]}}else if(e.documentElement.addBehavior){d=e.createElement("div");
b=function(b){return function(){var c=Array.prototype.slice.call(arguments,0);c.unshift(d);e.body.appendChild(d);d.addBehavior("#default#userData");d.load("localStorage");c=b.apply(a,c);e.body.removeChild(d);return c}};a.set=b(function(b,c,d){b.setAttribute(c,a.serialize(d));b.save("localStorage")});a.get=b(function(b,c){return a.deserialize(b.getAttribute(c))});a.remove=b(function(a,b){a.removeAttribute(b);a.save("localStorage")});a.clear=b(function(a){var b=a.XMLDocument.documentElement.attributes;
a.load("localStorage");for(var c=0,d;d=b[c];c++)a.removeAttribute(d.name);a.save("localStorage")})}}try{a.set("__storejs__","__storejs__");if(a.get("__storejs__")!="__storejs__")a.disabled=true;a.remove("__storejs__")}catch(i){a.disabled=true}return a}();"undefined"!=typeof module&&(module.exports=store);
(function(a){function b(a,b){this.name={now:a,then:b};this.lines=[]}function e(a){this.number={};var b=this;_.each(a,function(a,c){b[c]=a})}function d(a,b){b.indexOf(a)>-1&&(b=b.substr(a.length,b.length));return b.replace(/^[ab]\//,"")}function g(a){var f=a.html().replace(/\r?\n$/,""),g,j,l=[],m=a.hasClass("conflicts"),n;_.each(f.split("\n"),function(a,c,f){switch(a.charAt(0)){case "-":if(/^--- /.test(a)){j&&l.push(j);j=new b(d("+++ ",f[c+1]),d("--- ",a))}else j.append(new e({text:a.replace(/^\-/,
""),type:"del",file:j,number:{then:++g[0]}}));break;case "@":if(/^@@ /.test(a)){j.append(new e({text:a,type:"context",file:j}));a=a.match(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@(.*)/);g=[--a[1],+a[2]+a[1],--a[3],+a[4]+a[3]]}break;case "+":if(!/^\+\+\+ /.test(a)){c="ins";if(m)if(a.match(/^\+(?:&lt;){7} /)){n="conflict-a";c="marker"}else if(a.match(/^\+(?:\|\|\|\|\|\|\||=======)/)){n="conflict-b";c="marker"}else if(a.match(/^\+(?:&gt;){7} /)){n=null;c="marker"}n&&c!="marker"&&(c=n);j.append(new e({text:a.replace(/^\+/,
""),type:c,file:j,number:{now:++g[2]}}))}break;default:j&&j.append(new e({text:a.replace(/^ /,""),type:n,file:j,number:{now:++g[2],then:++g[0]}}))}});l.push(j);return l}var f;b.prototype.append=function(a){this.lines.push(a);return this};f=e.prototype;f.charAt=function(){return String.prototype.charAt.apply(this.text,_.toArray(arguments))};f.diff=function(a){for(var b=this.text.length,d=a.text.length,f=Math.min(b,d),e=0,g=-1;e<f&&this.charAt(e)===a.charAt(e);++e);for(;-g<=f-e&&this.charAt(b+g)===
a.charAt(d+g);--g);this.render(e,g+1);a.render(e,g+1)};f.$number=function(b,d){var f=a("<td>").addClass("number"),e=this.number[b];e&&f.text(e);typeof d==="function"&&d.call(f,this,b);return f};f.render=function(a,b){var d=b+this.text.length;this.$el.html([this.substr(0,a),"<",this.type,">",this.substr(a,d-a),"</",this.type,">",this.substr(d)].join(""));return this};f.substr=function(){return String.prototype.substr.apply(this.text,_.toArray(arguments))};a.fn.udiff=function(b){var d=this,f=function(){var e=
window.setTimeout,l=d.first();if(l.length){d=d.not(l);_.each(g(l),function(d){var f={},e=a("<table>");if(d){_.each(d.lines,function(d,f,g){var h=a("<td>").addClass("code").html(d.text);a("<tr>").addClass(d.type).append(d.$number("now",b)).append(d.$number("then",b)).append(h).appendTo(e);d.$el=h;var h=g[f-2],i=g[f-1],f=g[f+1];typeof i!=="undefined"&&(i.type=="del"&&d.type=="ins"&&(typeof h==="undefined"||h.type!="ins"&&h.type!="del")&&(typeof f==="undefined"||f.type!="ins"&&f.type!="del"))&&i.diff(d)});
if(d=l.attr("class"))f["class"]=d;if(d=l.attr("id"))f.id=d;l.replaceWith(e.attr(f))}});e(f,0)}};if(b==="version")return"0.2.3mod";f();return this}})(jQuery);
(function(a){function b(a,b){var c=typeof a[b];return c==="function"||!!(c=="object"&&a[b])||c=="unknown"}function e(a,b,c){b<0&&(b=b+a.value.length);typeof c==g&&(c=b);c<0&&(c=c+a.value.length);return{start:b,end:c}}function d(){return typeof document.body=="object"&&document.body?document.body:document.getElementsByTagName("body")[0]}var g="undefined",f,c,h,i,j,l,m,n,q;a(document).ready(function(){function p(a,b){return function(){var c=this.jquery?this[0]:this,d=c.nodeName.toLowerCase();if(c.nodeType==
1&&(d=="textarea"||d=="input"&&c.type=="text")){c=[c].concat(Array.prototype.slice.call(arguments));c=a.apply(this,c);if(!b)return c}if(b)return this}}var w=document.createElement("textarea");d().appendChild(w);if(typeof w.selectionStart!=g&&typeof w.selectionEnd!=g){f=function(a){var b=a.selectionStart,c=a.selectionEnd;return{start:b,end:c,length:c-b,text:a.value.slice(b,c)}};c=function(a,b,c){b=e(a,b,c);a.selectionStart=b.start;a.selectionEnd=b.end};q=function(a,b){b?a.selectionEnd=a.selectionStart:
a.selectionStart=a.selectionEnd}}else if(b(w,"createTextRange")&&typeof document.selection=="object"&&document.selection&&b(document.selection,"createRange")){f=function(a){var b=0,c=0,d,f,e;if((e=document.selection.createRange())&&e.parentElement()==a){f=a.value.length;d=a.value.replace(/\r\n/g,"\n");c=a.createTextRange();c.moveToBookmark(e.getBookmark());e=a.createTextRange();e.collapse(false);if(c.compareEndPoints("StartToEnd",e)>-1)b=c=f;else{b=-c.moveStart("character",-f);b=b+(d.slice(0,b).split("\n").length-
1);if(c.compareEndPoints("EndToEnd",e)>-1)c=f;else{c=-c.moveEnd("character",-f);c=c+(d.slice(0,c).split("\n").length-1)}}}return{start:b,end:c,length:c-b,text:a.value.slice(b,c)}};c=function(a,b,c){var b=e(a,b,c),c=a.createTextRange(),d=b.start-(a.value.slice(0,b.start).split("\r\n").length-1);c.collapse(true);if(b.start==b.end)c.move("character",d);else{c.moveEnd("character",b.end-(a.value.slice(0,b.end).split("\r\n").length-1));c.moveStart("character",d)}c.select()};q=function(a,b){var c=document.selection.createRange();
c.collapse(b);c.select()}}else{d().removeChild(w);window.console&&window.console.log&&window.console.log("TextInputs module for Rangy not supported in your browser. Reason: No means of finding text input caret position");return}d().removeChild(w);i=function(a,b,d,f){var e;if(b!=d){e=a.value;a.value=e.slice(0,b)+e.slice(d)}f&&c(a,b,b)};h=function(a){var b=f(a);i(a,b.start,b.end,true)};n=function(a){var b=f(a),d;if(b.start!=b.end){d=a.value;a.value=d.slice(0,b.start)+d.slice(b.end)}c(a,b.start,b.start);
return b.text};j=function(a,b,d,f){var e=a.value;a.value=e.slice(0,d)+b+e.slice(d);if(f){b=d+b.length;c(a,b,b)}};l=function(a,b){var d=f(a),e=a.value;a.value=e.slice(0,d.start)+b+e.slice(d.end);d=d.start+b.length;c(a,d,d)};m=function(a,b,d){var e=f(a),g=a.value;a.value=g.slice(0,e.start)+b+e.text+d+g.slice(e.end);b=e.start+b.length;c(a,b,b+e.length)};a.fn.extend({getSelection:p(f,false),setSelection:p(c,true),collapseSelection:p(q,true),deleteSelectedText:p(h,true),deleteText:p(i,true),extractSelectedText:p(n,
false),insertText:p(j,true),replaceSelectedText:p(l,true),surroundSelectedText:p(m,true)})})})(jQuery);
(function(a){a.fn.editable=function(b,e){if("disable"==b)a(this).data("disabled.editable",true);else if("enable"==b)a(this).data("disabled.editable",false);else if("destroy"==b)a(this).unbind(a(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");else{var d=a.extend({},a.fn.editable.defaults,{target:b},e),g=a.editable.types[d.type].plugin||function(){},f=a.editable.types[d.type].submit||function(){},c=a.editable.types[d.type].buttons||a.editable.types.defaults.buttons,
h=a.editable.types[d.type].content||a.editable.types.defaults.content,i=a.editable.types[d.type].element||a.editable.types.defaults.element,j=a.editable.types[d.type].reset||a.editable.types.defaults.reset,l=d.callback||function(){},m=d.onedit||function(){},n=d.onsubmit||function(){},q=d.onreset||function(){},p=d.onerror||j;d.tooltip&&a(this).attr("title",d.tooltip);d.autowidth="auto"==d.width;d.autoheight="auto"==d.height;return this.each(function(){var b=this,e=a(b).width(),x=a(b).height();a(this).data("event.editable",
d.event);a.trim(a(this).html())||a(this).html(d.placeholder);a(this).bind(d.event,function(q){if(true!==a(this).data("disabled.editable")&&!b.editing&&false!==m.apply(this,[d,b])){q.preventDefault();q.stopPropagation();d.tooltip&&a(b).removeAttr("title");if(0==a(b).width()){d.width=e;d.height=x}else{if(d.width!="none")d.width=d.autowidth?a(b).width():d.width;if(d.height!="none")d.height=d.autoheight?a(b).height():d.height}a(this).html().toLowerCase().replace(/(;|"|\/)/g,"")==d.placeholder.toLowerCase().replace(/(;|"|\/)/g,
"")&&a(this).html("");b.editing=true;b.revert=a(b).text();a(b).html("");var s=a("<form />");d.cssclass&&("inherit"==d.cssclass?s.attr("class",a(b).attr("class")):s.attr("class",d.cssclass));if(d.style)if("inherit"==d.style){s.attr("style",a(b).attr("style"));s.css("display",a(b).css("display"))}else s.attr("style",d.style);var v=i.apply(s,[d,b]),o;if(d.loadurl){var y=setTimeout(function(){v.disabled=true;h.apply(s,[d.loadtext,d,b])},100),q={};q[d.id]=b.id;a.isFunction(d.loaddata)?a.extend(q,d.loaddata.apply(b,
[b.revert,d])):a.extend(q,d.loaddata);a.ajax({type:d.loadtype,url:d.loadurl,data:q,async:false,success:function(a){window.clearTimeout(y);o=a;v.disabled=false}})}else if(d.data){o=d.data;a.isFunction(d.data)&&(o=d.data.apply(b,[b.revert,d]))}else o=b.revert;h.apply(s,[o,d,b]);v.attr("name",d.name);c.apply(s,[d,b]);a(b).append(s);g.apply(s,[d,b]);a(":input:visible:enabled:first",s).focus();d.select&&v.select();v.keydown(function(a){if(a.keyCode==27){a.preventDefault();j.apply(s,[d,b])}});"cancel"==
d.onblur?v.blur(function(){y=setTimeout(function(){j.apply(s,[d,b])},500)}):"submit"==d.onblur?v.blur(function(){y=setTimeout(function(){s.submit()},200)}):a.isFunction(d.onblur)?v.blur(function(){d.onblur.apply(b,[v.val(),d])}):v.blur(function(){});s.submit(function(c){y&&clearTimeout(y);c.preventDefault();if(false!==n.apply(s,[d,b])&&false!==f.apply(s,[d,b]))if(a.isFunction(d.target)){c=d.target.apply(b,[v.val(),d]);a(b).text(c);b.editing=false;l.apply(b,[b.innerHTML,d]);a.trim(a(b).html())||a(b).html(d.placeholder)}else{c=
{};c[d.name]=v.val();c[d.id]=b.id;a.isFunction(d.submitdata)?a.extend(c,d.submitdata.apply(b,[b.revert,d])):a.extend(c,d.submitdata);"PUT"==d.method&&(c._method="put");a(b).html(d.indicator);var e={type:"POST",data:c,dataType:"html",url:d.target,success:function(c){e.dataType=="html"&&a(b).html(c);b.editing=false;l.apply(b,[c,d]);a.trim(a(b).html())||a(b).html(d.placeholder)},error:function(a){p.apply(s,[d,b,a])}};a.extend(e,d.ajaxoptions);a.ajax(e)}a(b).attr("title",d.tooltip);return false})}});
this.reset=function(c){if(this.editing&&false!==q.apply(c,[d,b])){a(b).text(b.revert);b.editing=false;a.trim(a(b).html())||a(b).html(d.placeholder);d.tooltip&&a(b).attr("title",d.tooltip)}}})}};a.editable={types:{defaults:{element:function(){var b=a('<input type="hidden"></input>');a(this).append(b);return b},content:function(b){a(":input:first",this).val(b)},reset:function(a,e){e.reset(this)},buttons:function(b,e){var d=this;if(b.submit){if(b.submit.match(/>$/))var g=a(b.submit).click(function(){g.attr("type")!=
"submit"&&d.submit()});else{g=a('<button type="submit" />');g.html(b.submit)}a(this).append(g)}if(b.cancel){if(b.cancel.match(/>$/))var f=a(b.cancel);else{f=a('<button type="cancel" />');f.html(b.cancel)}a(this).append(f);a(f).click(function(c){(a.isFunction(a.editable.types[b.type].reset)?a.editable.types[b.type].reset:a.editable.types.defaults.reset).apply(d,[b,e]);c.preventDefault()})}}},text:{element:function(b){var e=a("<input />");b.width!="none"&&e.attr("width",b.width);b.height!="none"&&e.attr("height",
b.height);e.attr("autocomplete","off");a(this).append(e);return e}},textarea:{element:function(b){var e=a("<textarea />");b.rows?e.attr("rows",b.rows):b.height!="none"&&e.height(b.height);b.cols?e.attr("cols",b.cols):b.width!="none"&&e.width(b.width);a(this).append(e);return e}},select:{element:function(){var b=a("<select />");a(this).append(b);return b},content:function(b,e,d){if(String==b.constructor)eval("var json = "+b);else var g=b;for(var f in g)if(g.hasOwnProperty(f)&&"selected"!=f){b=a("<option />").val(f).append(g[f]);
a("select",this).append(b)}a("select",this).children().each(function(){(a(this).val()==g.selected||a(this).text()==a.trim(d.revert))&&a(this).attr("selected","selected")});if(!e.submit){var c=this;a("select",this).change(function(){c.submit()})}}}},addInputType:function(b,e){a.editable.types[b]=e}};a.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},
ajaxoptions:{}}})(jQuery);
(function(a){function b(a){return typeof a=="object"?a:{top:a,left:a}}var e=a.scrollTo=function(b,e,f){a(window).scrollTo(b,e,f)};e.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,limit:true};e.window=function(){return a(window)._scrollable()};a.fn._scrollable=function(){return this.map(function(){if(this.nodeName&&a.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"])==-1)return this;var b=(this.contentWindow||this).document||this.ownerDocument||this;return/webkit/i.test(navigator.userAgent)||
b.compatMode=="BackCompat"?b.body:b.documentElement})};a.fn.scrollTo=function(d,g,f){if(typeof g=="object"){f=g;g=0}typeof f=="function"&&(f={onAfter:f});d=="max"&&(d=9E9);f=a.extend({},e.defaults,f);g=g||f.duration;f.queue=f.queue&&f.axis.length>1;f.queue&&(g=g/2);f.offset=b(f.offset);f.over=b(f.over);return this._scrollable().each(function(){function c(a){i.animate(m,g,f.easing,a&&function(){a.call(this,d,f)})}if(d!=null){var h=this,i=a(h),j=d,l,m={},n=i.is("html,body");switch(typeof j){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(j)){j=
b(j);break}j=a(j,this);if(!j.length)return;case "object":if(j.is||j.style)l=(j=a(j)).offset()}a.each(f.axis.split(""),function(a,b){var d=b=="x"?"Left":"Top",g=d.toLowerCase(),x="scroll"+d,t=h[x],s=e.max(h,b);if(l){m[x]=l[g]+(n?0:t-i.offset()[g]);if(f.margin){m[x]=m[x]-(parseInt(j.css("margin"+d))||0);m[x]=m[x]-(parseInt(j.css("border"+d+"Width"))||0)}m[x]=m[x]+(f.offset[g]||0);f.over[g]&&(m[x]=m[x]+j[b=="x"?"width":"height"]()*f.over[g])}else{d=j[g];m[x]=d.slice&&d.slice(-1)=="%"?parseFloat(d)/100*
s:d}f.limit&&/^\d+$/.test(m[x])&&(m[x]=m[x]<=0?0:Math.min(m[x],s));if(!a&&f.queue){t!=m[x]&&c(f.onAfterFirst);delete m[x]}});c(f.onAfter)}}).end()};e.max=function(b,e){var f=e=="x"?"Width":"Height",c="scroll"+f;if(!a(b).is("html,body"))return b[c]-a(b)[f.toLowerCase()]();var f="client"+f,h=b.ownerDocument.documentElement,i=b.ownerDocument.body;return Math.max(h[c],i[c])-Math.min(h[f],i[f])}})(jQuery);
(function(a){a.fn.hoverIntent=function(b,e){var d={sensitivity:7,interval:100,timeout:0},d=a.extend(d,e?{over:b,out:e}:b),g,f,c,h,i=function(a){g=a.pageX;f=a.pageY},j=function(b,e){e.hoverIntent_t=clearTimeout(e.hoverIntent_t);if(Math.abs(c-g)+Math.abs(h-f)<d.sensitivity){a(e).unbind("mousemove",i);e.hoverIntent_s=1;return d.over.apply(e,[b])}c=g;h=f;e.hoverIntent_t=setTimeout(function(){j(b,e)},d.interval)},l=function(b){var f=jQuery.extend({},b),e=this;if(e.hoverIntent_t)e.hoverIntent_t=clearTimeout(e.hoverIntent_t);
if(b.type=="mouseenter"){c=f.pageX;h=f.pageY;a(e).bind("mousemove",i);if(e.hoverIntent_s!=1)e.hoverIntent_t=setTimeout(function(){j(f,e)},d.interval)}else{a(e).unbind("mousemove",i);if(e.hoverIntent_s==1)e.hoverIntent_t=setTimeout(function(){e.hoverIntent_t=clearTimeout(e.hoverIntent_t);e.hoverIntent_s=0;d.out.apply(e,[f])},d.timeout)}};return this.bind("mouseenter",l).bind("mouseleave",l)}})(jQuery);
(function(a,b){function e(a,b,c){var d=j[b.type]||{};if(a==null)return c||!b.def?null:b.def;a=d.floor?~~a:parseFloat(a);return isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a}function d(b){var d=h(),f=d._rgba=[],b=b.toLowerCase();q(c,function(a,c){var e,g=c.re.exec(b);e=g&&c.parse(g);g=c.space||"rgba";if(e){e=d[g](e);d[i[g].cache]=e[i[g].cache];f=d._rgba=e._rgba;return false}});if(f.length){f.join()==="0,0,0,0"&&a.extend(f,n.transparent);return d}return n[b]}function g(a,b,c){c=(c+1)%1;
return c*6<1?a+(b-a)*c*6:c*2<1?b:c*3<2?a+(b-a)*(2/3-c)*6:a}var f=/^([\-+])=\s*(\d+\.?\d*)/,c=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1]*2.55,a[2]*2.55,a[3]*2.55,a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],
16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],h=a.Color=function(b,c,d,f){return new a.Color.fn.parse(b,c,d,f)},i={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},
hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},j={"byte":{floor:true,max:255},percent:{max:1},degrees:{mod:360,floor:true}},l=h.support={},m=a("<p>")[0],n,q=a.each;m.style.cssText="background-color:rgba(1,1,1,.5)";l.rgba=m.style.backgroundColor.indexOf("rgba")>-1;q(i,function(a,b){b.cache="_"+a;b.props.alpha={idx:3,type:"percent",def:1}});h.fn=a.extend(h.prototype,{parse:function(c,f,g,j){if(c===b){this._rgba=[null,null,null,null];return this}if(c.jquery||
c.nodeType){c=a(c).css(f);f=b}var m=this,l=a.type(c),v=this._rgba=[];if(f!==b){c=[c,f,g,j];l="array"}if(l==="string")return this.parse(d(c)||n._default);if(l==="array"){q(i.rgba.props,function(a,b){v[b.idx]=e(c[b.idx],b)});return this}if(l==="object"){c instanceof h?q(i,function(a,b){c[b.cache]&&(m[b.cache]=c[b.cache].slice())}):q(i,function(b,d){var f=d.cache;q(d.props,function(a,b){if(!m[f]&&d.to){if(a==="alpha"||c[a]==null)return;m[f]=d.to(m._rgba)}m[f][b.idx]=e(c[a],b,true)});if(m[f]&&a.inArray(null,
m[f].slice(0,3))<0){m[f][3]=1;if(d.from)m._rgba=d.from(m[f])}});return this}},is:function(a){var b=h(a),c=true,d=this;q(i,function(a,f){var e,g=b[f.cache];if(g){e=d[f.cache]||f.to&&f.to(d._rgba)||[];q(f.props,function(a,b){if(g[b.idx]!=null)return c=g[b.idx]===e[b.idx]})}return c});return c},_space:function(){var a=[],b=this;q(i,function(c,d){b[d.cache]&&a.push(c)});return a.pop()},transition:function(a,b){var c=h(a),d=c._space(),f=i[d],g=this.alpha()===0?h("transparent"):this,m=g[f.cache]||f.to(g._rgba),
l=m.slice(),c=c[f.cache];q(f.props,function(a,d){var f=d.idx,g=m[f],h=c[f],i=j[d.type]||{};if(h!==null)if(g===null)l[f]=h;else{i.mod&&(h-g>i.mod/2?g=g+i.mod:g-h>i.mod/2&&(g=g-i.mod));l[f]=e((h-g)*b+g,d)}});return this[d](l)},blend:function(b){if(this._rgba[3]===1)return this;var c=this._rgba.slice(),d=c.pop(),f=h(b)._rgba;return h(a.map(c,function(a,b){return(1-d)*f[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return a==null?b>2?1:0:a});if(c[3]===1){c.pop();b=
"rgb("}return b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){a==null&&(a=b>2?1:0);b&&b<3&&(a=Math.round(a*100)+"%");return a});if(c[3]===1){c.pop();b="hsl("}return b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();b&&c.push(~~(d*255));return"#"+a.map(c,function(a){a=(a||0).toString(16);return a.length===1?"0"+a:a}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});h.fn.parse.prototype=h.fn;
i.hsla.to=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,d=a[2]/255,a=a[3],f=Math.max(b,c,d),e=Math.min(b,c,d),g=f-e,h=f+e,i=h*0.5;return[Math.round(e===f?0:b===f?60*(c-d)/g+360:c===f?60*(d-b)/g+120:60*(b-c)/g+240)%360,i===0||i===1?i:i<=0.5?g/h:g/(2-h),i,a==null?1:a]};i.hsla.from=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],a=a[3],c=d<=0.5?d*(1+c):d+c-d*c,d=2*d-c;return[Math.round(g(d,
c,b+1/3)*255),Math.round(g(d,c,b)*255),Math.round(g(d,c,b-1/3)*255),a]};q(i,function(c,d){var g=d.props,i=d.cache,j=d.to,m=d.from;h.fn[c]=function(c){j&&!this[i]&&(this[i]=j(this._rgba));if(c===b)return this[i].slice();var d,f=a.type(c),l=f==="array"||f==="object"?c:arguments,n=this[i].slice();q(g,function(a,b){var c=l[f==="object"?a:b.idx];c==null&&(c=n[b.idx]);n[b.idx]=e(c,b)});if(m){d=h(m(n));d[i]=n;return d}return h(n)};q(g,function(b,d){h.fn[b]||(h.fn[b]=function(e){var g=a.type(e),h=b==="alpha"?
this._hsla?"hsla":"rgba":c,i=this[h](),j=i[d.idx];if(g==="undefined")return j;if(g==="function"){e=e.call(this,j);g=a.type(e)}if(e==null&&d.empty)return this;if(g==="string")(g=f.exec(e))&&(e=j+parseFloat(g[2])*(g[1]==="+"?1:-1));i[d.idx]=e;return this[h](i)})})});h.hook=function(b){b=b.split(" ");q(b,function(b,c){a.cssHooks[c]={set:function(b,f){var e,g="";if(a.type(f)!=="string"||(e=d(f))){f=h(e||f);if(!l.rgba&&f._rgba[3]!==1){for(e=c==="backgroundColor"?b.parentNode:b;(g===""||g==="transparent")&&
e&&e.style;)try{g=a.css(e,"backgroundColor");e=e.parentNode}catch(i){}f=f.blend(g&&g!=="transparent"?g:"_default")}f=f.toRgbaString()}try{b.style[c]=f}catch(j){}}};a.fx.step[c]=function(b){if(!b.colorInit){b.start=h(b.elem,c);b.end=h(b.end);b.colorInit=true}a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})};h.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor");a.cssHooks.borderColor=
{expand:function(a){var b={};q(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a});return b}};n=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);
(function(a,b){var e="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";a.fn.imagesLoaded=function(d){function g(){var b=a(m),f=a(n);h&&(n.length?h.reject(j,b,f):h.resolve(j));a.isFunction(d)&&d.call(c,j,b,f)}function f(b,c){if(!(b.src===e||a.inArray(b,l)!==-1)){l.push(b);c?n.push(b):m.push(b);a.data(b,"imagesLoaded",{isBroken:c,src:b.src});i&&h.notifyWith(a(b),[c,j,a(m),a(n)]);if(j.length===l.length){setTimeout(g);j.unbind(".imagesLoaded")}}}var c=this,h=a.isFunction(a.Deferred)?
a.Deferred():0,i=a.isFunction(h.notify),j=c.find("img").add(c.filter("img")),l=[],m=[],n=[];j.length?j.bind("load.imagesLoaded error.imagesLoaded",function(a){f(a.target,a.type==="error")}).each(function(c,d){var g=d.src,h=a.data(d,"imagesLoaded");if(h&&h.src===g)f(d,h.isBroken);else if(d.complete&&d.naturalWidth!==b)f(d,d.naturalWidth===0||d.naturalHeight===0);else if(d.readyState||d.complete){d.src=e;d.src=g}}):g();return h?h.promise(c):c}})(jQuery);
(function(a){function b(b){if(b.data("natural-size"))return a.Deferred().resolve(b.data("natural-size"));if(b[0].naturalWidth){var d={width:b[0].naturalWidth,height:b[0].naturalHeight};b.data("natural-size",d);return a.Deferred().resolve(d)}var c=new Image,e=a.Deferred(),i=false,d=function(){if(!i){var a={width:c.width,height:c.height};b.data("natural-size",a);e.resolve(a);i=true}};c.onload=d;c.src=b[0].src;c.complete&&d();return e}function e(a,b){this._$container=a;this._$toggle=b}function d(a,b){var c=
a.data("margin_border_padding");if(c==null){c=a.outerWidth(true)-a.width();a.data("margin_border_padding",c)}return b-c}e.prototype.init=function(){var d=this,f,c;this._$toggle.on("click",function(a){a.preventDefault()});var e=this._$imgs=this._$container.find("img");this._$sinceImg=e.eq(0);this._$untilImg=e.eq(1);this._$untilRevision=this._$untilImg.parent();this._$sinceRevision=this._$sinceImg.parent();this._$revisions=this._$untilRevision.add(this._$sinceRevision);this._$untilRevisionLabel=d._$untilRevision.find("h5");
this._$sinceRevisionLabel=d._$sinceRevision.find("h5");e.imagesLoaded().always(function(){var e=b(d._$sinceImg).done(function(a){f=a}),h=b(d._$untilImg).done(function(a){c=a});a.when(e,h).done(function(){d._initToolbar(f.width===c.width&&f.height===c.height&&f.width>0)})})};e.prototype._initToolbar=function(b){var d=this,c=this._$toggle.find(".image-diff-two-up"),e=this._$toggle.find(".image-diff-blend"),i=this._$toggle.find(".image-diff-split");i.attr("aria-disabled",!b);b&&i.attr("title",i.data("title"));
e.attr("aria-disabled",!b);b&&e.attr("title",e.data("title"));var j=this._$toggle.find(".aui-button"),l="two-up",b=function(b){return function(c){var e=a(this);e.parent();if(e.attr("aria-disabled")!=="true"&&e.attr("aria-pressed")!=="true"){j.attr("aria-pressed","false");e.attr("aria-pressed","true");d._onDiffModeChanged(b,l);l=b}c.preventDefault()}};c.click(b("two-up"));e.click(b("blend"));i.click(b("split"))};e.prototype._onDiffModeChanged=function(a,b){this._$container.removeClass("two-up blend split").addClass(a);
switch(b){case "two-up":this._cleanTwoUpDiff();break;case "blend":this._cleanBlendDiff();break;case "split":this._cleanSplitDiff()}switch(a){case "two-up":this._setupTwoUpDiff();break;case "blend":this._setupBlendDiff();break;case "split":this._setupSplitDiff()}eve("stash.feature.fileContent.diffView.imageDiffModeChanged",this,a,b)};e.prototype._cleanTwoUpDiff=a.noop;e.prototype._setupTwoUpDiff=a.noop;e.prototype._cleanBlendDiff=function(){var a=this._$container.children(".opacity-slider-container"),
b=a.find("input");a.remove();this._$untilImg.css("opacity","");b[0].onchange=null};e.prototype._setupBlendDiff=function(){var b=this,d=a('<input type="range" min="0" max="1" step="0.01" value="1" />');this._$container.children(".binary:first").before(a('<div class="opacity-slider-container" />').append(d));fdSlider.onDomReady();d[0].onchange=function(){b._$untilImg.css("opacity",parseFloat(a(this).val()))}};e.prototype._cleanSplitDiff=function(){this._$imgs.css("width","").css("height","");this._$revisions.css("width",
"");this._$untilRevision.css("margin-left","");this._$untilRevisionLabel.add(this._$sinceRevisionLabel).css("margin-left","").css("margin-right","");this._$untilImg.unwrap();this._$untilRevisionImageContainer.remove();delete this._$untilRevisionImageContainer;this._$revisions.unwrap();this._$splitContainer.remove();delete this._$splitContainer;if(this._onResize){eve.off("window.resize.debounced",this._onResize);delete this._onResize}};e.prototype._setSplitDiffElementProperties=function(a,b,c){var e=
d(this._$container,this._$container.parent().width()),b=d(b,e),b=d(this._$sinceRevision,b),e=d(this._$sinceImg,b),i=Math.min(c.width,e);this._$imgs.width(i);this._$imgs.height(Math.floor(i/c.width*c.height));a.height(this._$imgs.outerHeight(true));a=i+(b-e);this._$revisions.width(a);this._$untilRevision.css("margin-left",-a)};e.prototype._setupSplitDiff=function(){var a=this;return b(this._$imgs).done(function(b){a._$untilImg.wrap('<div class="image-container" />');a._$revisions.wrapAll('<div class="split-container" />');
a._$untilRevisionImageContainer=a._$untilImg.parent();a._$splitContainer=a._$container.find(".split-container");var c;a._onResize=function(){a._setSplitDiffElementProperties(a._$untilRevisionImageContainer,a._$splitContainer,b);c=a._$sinceImg.outerWidth(true)};a._onResize();eve.on("window.resize.debounced",a._onResize);if(b.width<50){a._$untilRevisionLabel.css("margin-left","-50px");a._$sinceRevisionLabel.css("margin-right","-50px")}else if(b.width<100){a._$untilRevisionLabel.css("margin-left",-b.width);
a._$sinceRevisionLabel.css("margin-right",-b.width)}var d;a._$splitContainer.on("mouseenter",function(){d=a._$untilRevision.offset();a._$revisions.on("mousemove",e)});a._$splitContainer.on("mouseleave",function(){a._$revisions.off("mousemove",e)});var e=function(b){a._$untilRevisionImageContainer.css("width",Math.min(b.pageX-d.left,c))}})};AJS.ImageDiffer=AJS.ImageDiffer||e})(jQuery);
jQuery(function(a){function b(a,b,c){var d=Array(a+1).join(b.header);return{name:"Heading "+a,className:[b.classname,"heading-"+a,c].join(" "),openWith:d+" ",closeWith:" "+d,placeHolder:"Your title here..."}}function e(a,b,c){return{name:"Heading "+a,className:[b.classname,"heading-"+a,c].join(" "),openWith:"h"+a+". ",placeHolder:"Your title here..."}}function d(a){return{name:"Bold",className:[a.classname,"bold first separator"].join(" "),openWith:a.bold,closeWith:a.bold}}function g(a){return{name:"Italic",
className:[a.classname,"italic last"].join(" "),openWith:a.italic,closeWith:a.italic}}function f(a){return{name:"Bulleted list",className:[a.classname,"bulleted-list first separator"].join(" "),openWith:a.ul,multiline:true}}function c(a){return{name:"Numeric list",className:[a.classname,"numeric-list last"].join(" "),openWith:a.ol,multiline:true}}function h(a){return{name:"Code",className:[a.classname,"code first last separator"].join(" "),openBlockWith:a.codeOpenBlock,closeBlockWith:a.codeCloseBlock,
openWith:a.codeOpen,closeWith:a.codeClose,multiline:true}}function i(a,b,c,d){d.unshift(a.classname);return{name:b,className:d.join(" "),replaceWith:c}}function j(a,b){return{name:"Help",className:[a.classname,"help first last right"].join(" "),call:function(){var a="https://confluence.atlassian.com/display/BITBUCKET/Marking+up+Comments";b&&(a="https://confluence.atlassian.com/x/FA4zDQ");window.open(a,"_blank")}}}var l=BB.repo.pygmentsLanguage||"python",m={classname:"markdown",header:"#",bold:"**",
italic:"*",ul:"(!(* |!|*)!)",ol:"(!(1. |!|1.)!)",codeOpenBlock:"(!(\n```\n#![![Language:!:"+l+"]!]\n\n|!|<pre>)!)",codeCloseBlock:"\n```",link:"[[![Link Text]!]]([![Link URL]!])",image:"![[![Image Alt Text]!]]([![Image URL]!])"},n={classname:"creole",header:"=",bold:"**",italic:"//",ul:"(!(* |!|*)!)",ol:"(!(# |!|#)!)",codeOpenBlock:"(!({{{\n#![![Language:!:"+l+"]!]\n\n|!|<pre>)!)",codeCloseBlock:"(!(\n}}}|!|</pre>)!)",link:"[[[![Link URL]!]|[![Link Text]!]]]",image:"{{[![Image URL]!]|[![Image Title]!]}}"},
q={classname:"rest",header:"=",bold:"**",italic:"*",ul:"(!(* |!|*)!)",ol:"(!(#. |!|#.)!)",codeOpenBlock:"\n.. sourcecode:: [![Language:!:"+l+"]!]\n\n",codeOpen:"    ",codeCloseBlock:"\n",link:"`[![Link Text]!] <[![Link URL]!]>`_",image:".. image:: [![Image URL]!]\n   :alt: [![Image Alt Text]!]"},p={classname:"textile",bold:"*",italic:"_",ul:"(!(* |!|*)!)",ol:"(!(# |!|#)!)",codeOpenBlock:"\npre. \n",codeCloseBlock:"\n",link:'"[![Link Text]!]":[![Link URL]!]',image:"![![Image URL]!]([![Image Title:!: ]!])!"};
BB.markItUpSettings=function(l,r){var x=r&&r.wikiHelp,l=l||"markdown",t=b(1,n,"first"),s=b(2,n),v=b(3,n,"last"),o=d(n),y=g(n),A=f(n),B=c(n),u=h(n),D=i(n,"Link",n.link,["first","link"]),k=i(n,"Image",n.image,["last","image"]),E=b(1,m,"first"),z=b(2,m),Q=b(3,m,"last"),V=d(m),F=g(m),L=f(m),C=c(m),W=h(m),T=i(m,"Link",m.link,["first","link"]),K=i(m,"Image",m.image,["last","image"]),H;H={name:"Section",className:[q.classname,"heading-single first last"].join(" "),placeHolder:"Section",closeWith:function(a){var b=
7;if(a.selection&&a.selection.length)b=a.selection.length;return"\n"+Array(b+1).join(q.header)+"\n"}};t=[t,s,v,o,y,A,B,u,D,k,E,z,Q,V,F,L,C,W,T,K,H,d(q),g(q),f(q),c(q),h(q),i(q,"Link",q.link,["first","link"]),i(q,"Image",q.image,["last","image"]),e(1,p,"first"),e(2,p),e(3,p,"last"),d(p),g(p),f(p),c(p),h(p),i(p,"Link",p.link,["first","link"]),i(p,"Image",p.image,["last","image"]),{name:"Preview",className:"preview first last right no-icon",beforeInsert:function(b){var b=a(b.textarea).closest(".textarea-preview"),
c=b.find(".markItUpHeader .markItUpButton.preview a");c.attr("aria-pressed")?c.text("Preview"):c.text("Edit");BB.utils.previewContent(c,b)}},{name:"Language",className:"language first last right no-icon hidden",call:function(){a("#dropdown-wiki-lang ul").show()}},j(m,x)];if(x){t.push(j(n,true));t.push(j(q,true));t.push(j(p,true))}return{nameSpace:"markup-type-"+l,previewParserPath:"",resizeHandle:false,onShiftEnter:{keepDefault:false,replaceWith:"\n\n"},markupSet:t}};a.fn.editable.defaults.placeholder=
""});
(function(a){a.fn.markItUp=function(b,e){var d,g,f,c,h,i;c=h=i=false;if(typeof b=="string"){d=b;g=e}f={id:"",nameSpace:"",root:"",previewHandler:false,previewInWindow:"",previewInElement:"",previewAutoRefresh:true,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParser:false,previewParserPath:"",previewParserVar:"data",resizeHandle:true,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},markupSet:[{}]};a.extend(f,b,e);f.root||a("script").each(function(b,c){miuScript=
a(c).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/);if(miuScript!==null)f.root=miuScript[1]});return this.each(function(){function b(a,c){return c?a.replace(/("|')~\//g,"$1"+f.root):a.replace(/^~\//,f.root)}function e(b){var c=a("<ul></ul>"),d=0;a("li:hover > ul",c).css("display","block");a.each(b,function(){var b=this,f,g;f=b.key?(b.name||"")+" [Ctrl+"+b.key+"]":b.name||"";key=b.key?'accesskey="'+b.key+'"':"";if(b.separator)f=a('<li class="markItUpSeparator">'+(b.separator||"")+"</li>").appendTo(c);
else{d++;for(g=A.length-1;g>=0;g--);f=a('<li class="markItUpButton '+(b.className||"")+'"><a href="" '+key+' title="'+f+'" tabindex="-1">'+(b.name||"")+"</a></li>").bind("contextmenu.markItUp",function(){return false}).bind("mouseup.markItUp",function(a){a.preventDefault()}).bind("focusin.markItUp",function(){o.focus()}).bind("click.markItUp",function(a){a.preventDefault();b.call?eval(b.call)():setTimeout(function(){q(b)},1)}).bind("mouseenter.markItUp",function(){a("> ul",this).show();a(document).one("click",
function(){a("ul ul",z).hide()})}).bind("mouseleave.markItUp",function(){a("> ul",this).hide()}).appendTo(c);if(b.dropMenu){A.push(d);a(f).addClass("markItUpDropMenu").append(e(b.dropMenu))}}});A.pop();return c}function m(b){a.isFunction(b)&&(b=b(E));if(b)var b=b.toString(),b=b.replace(/\(\!\(([\s\S]*?)\)\!\)/g,function(a,b){var c=b.split("|!|");return i===true?c[1]!==void 0?c[1]:c[0]:c[1]===void 0?"":c[0]}),c={},b=b.replace(/\[\!\[([\s\S]*?)\]\!\]/g,function(a,b){var d=b.split(":!:"),e=d[0];if(Object.prototype.hasOwnProperty.call(c,
e))return c[e];if(L===true)return false;value=prompt(d[0],d[1]?d[1]:"");value===null&&(L=true);return c[e]=value});else b="";return b}function n(a){var b=m(k.openWith),c=m(k.placeHolder),d=m(k.replaceWith),e=m(k.closeWith),f=m(k.openBlockWith),g=m(k.closeBlockWith),h=k.multiline;if(d!=="")block=b+d+e;else if(selection===""&&c!=="")block=b+c+e;else{var a=a||selection,i=[a],j=[];h===true&&(i=a.split(/\r?\n/));for(a=0;a<i.length;a++){line=i[a];var l;(l=line.match(/ *$/))?j.push(b+line.replace(/ *$/g,
"")+e+l):j.push(b+line+e)}block=j.join("\n")}block=f+block+g;return{block:block,openBlockWith:f,openWith:b,replaceWith:d,placeHolder:c,closeWith:e,closeBlockWith:g}}function q(b){var d,e,g;E=k=b;x();a.extend(E,{line:"",root:f.root,textarea:y,selection:selection||"",caretPosition:u,ctrlKey:c,shiftKey:h,altKey:i});m(f.beforeInsert);m(k.beforeInsert);(c===true&&h===true||b.multiline===true)&&m(k.beforeMultiInsert);a.extend(E,{line:1});if(c===true&&h===true){lines=selection.split(/\r?\n/);e=0;d=lines.length;
for(g=0;g<d;g++)if(a.trim(lines[g])!==""){a.extend(E,{line:++e,selection:lines[g]});lines[g]=n(lines[g]).block}else lines[g]="";string={block:lines.join("\n")};e=u;d=string.block.length+(a.browser.opera?d-1:0)}else if(c===true){string=n(selection);e=u+string.openWith.length;d=string.block.length-string.openWith.length-string.closeWith.length;d=d-(string.block.match(/ $/)?1:0);d=d-w(string.block)}else if(h===true){string=n(selection);e=u;d=string.block.length;d=d-w(string.block)}else{string=n(selection);
e=u+string.block.length;d=0;e=e-w(string.block)}if(selection===""&&string.replaceWith===""){D=D+p(string.block);e=u+string.openBlockWith.length+string.openWith.length;d=string.block.length-string.openWith.length-string.closeWith.length-string.closeBlockWith.length-string.openBlockWith.length;D=o.val().substring(u,o.val().length).length;D=D-p(o.val().substring(0,u))}a.extend(E,{caretPosition:u,scrollPosition:B});if(string.block!==selection&&L===false){g=string.block;document.selection?document.selection.createRange().text=
g:y.value=y.value.substring(0,u)+g+y.value.substring(u+selection.length,y.value.length);r(e,d)}else D=-1;x();a.extend(E,{line:"",selection:selection});(c===true&&h===true||b.multiline===true)&&m(k.afterMultiInsert);m(k.afterInsert);m(f.afterInsert);V&&f.previewAutoRefresh&&t();h=i=c=L=false}function p(b){return a.browser.opera?b.length-b.replace(/\n*/g,"").length:0}function w(b){return a.browser.msie?b.length-b.replace(/\r*/g,"").length:0}function r(b,c){if(y.createTextRange){if(a.browser.opera&&
a.browser.version>=9.5&&c==0)return false;range=y.createTextRange();range.collapse(true);range.moveStart("character",b);range.moveEnd("character",c);range.select()}else y.setSelectionRange&&y.setSelectionRange(b,b+c);y.scrollTop=B;y.focus()}function x(){y.focus();B=y.scrollTop;if(document.selection){selection=document.selection.createRange().text;if(a.browser.msie){var b=document.selection.createRange(),c=b.duplicate();c.moveToElementText(y);for(u=-1;c.inRange(b);){c.moveStart("character");u++}}else u=
y.selectionStart}else{u=y.selectionStart;selection=y.value.substring(u,y.selectionEnd)}return selection}function t(){if(f.previewHandler&&typeof f.previewHandler==="function")f.previewHandler(o.val());else if(f.previewParser&&typeof f.previewParser==="function"){var c=f.previewParser(o.val());s(b(c,1))}else f.previewParserPath!==""?a.ajax({type:"POST",dataType:"text",global:false,url:f.previewParserPath,data:f.previewParserVar+"="+encodeURIComponent(o.val()),success:function(a){s(b(a,1))}}):F||a.ajax({url:f.previewTemplatePath,
dataType:"text",global:false,success:function(a){s(b(a,1).replace(/<\!-- content --\>/g,o.val()))}});return false}function s(b){if(f.previewInElement)a(f.previewInElement).html(b);else if(V&&V.document){try{sp=V.document.documentElement.scrollTop}catch(c){sp=0}V.document.open();V.document.write(b);V.document.close();V.document.documentElement.scrollTop=sp}}function v(b){h=b.shiftKey;i=b.altKey;c=!b.altKey||!b.ctrlKey?b.ctrlKey||b.metaKey:false;if(b.type==="keydown"){if(c===true){li=a('a[accesskey="'+
(b.keyCode==13?"\\n":String.fromCharCode(b.keyCode))+'"]',z).parent("li");if(li.length!==0){c=false;setTimeout(function(){li.triggerHandler("mouseup")},1);return false}}if(b.keyCode===13||b.keyCode===10){if(c===true){c=false;q(f.onCtrlEnter);return f.onCtrlEnter.keepDefault}if(h===true){h=false;q(f.onShiftEnter);return f.onShiftEnter.keepDefault}q(f.onEnter);return f.onEnter.keepDefault}if(b.keyCode===9){if(h==true||c==true||i==true)return false;if(D!==-1){x();D=o.val().length-D;console.log("caret offset");
r(D,0);D=-1;return false}q(f.onTab);return f.onTab.keepDefault}}}var o,y,A,B,u,D,k,E,z,Q,V,F,L;o=a(this);y=this;A=[];L=false;B=u=0;D=-1;f.previewParserPath=b(f.previewParserPath);f.previewTemplatePath=b(f.previewTemplatePath);if(d)switch(d){case "remove":o.unbind(".markItUp").removeClass("markItUpEditor");o.parent("div").parent("div.markItUp").parent("div").replaceWith(o);o.data("markItUp",null);break;case "insert":q(g);break;default:a.error("Method "+d+" does not exist on jQuery.markItUp")}else{nameSpace=
id="";f.id?id='id="'+f.id+'"':o.attr("id")&&(id='id="markItUp'+o.attr("id").substr(0,1).toUpperCase()+o.attr("id").substr(1)+'"');f.nameSpace&&(nameSpace='class="'+f.nameSpace+'"');o.wrap("<div "+nameSpace+"></div>");o.wrap("<div "+id+' class="markItUp"></div>');o.wrap('<div class="markItUpContainer"></div>');o.addClass("markItUpEditor");z=a('<div class="markItUpHeader"></div>').insertBefore(o);a(e(f.markupSet)).appendTo(z);Q=a('<div class="markItUpFooter"></div>').insertAfter(o);if(f.resizeHandle===
true&&a.browser.safari!==true){resizeHandle=a('<div class="markItUpResizeHandle"></div>').insertAfter(o).bind("mousedown.markItUp",function(b){var c=o.height(),d=b.clientY,e,f;e=function(a){o.css("height",Math.max(20,a.clientY+c-d)+"px");return false};f=function(){a("html").unbind("mousemove.markItUp",e).unbind("mouseup.markItUp",f);return false};a("html").bind("mousemove.markItUp",e).bind("mouseup.markItUp",f)});Q.append(resizeHandle)}o.bind("keydown.markItUp",v).bind("keyup",v);o.bind("insertion.markItUp",
function(b,c){c.target!==false&&x();y===a.markItUp.focused&&q(c)});o.bind("focus.markItUp",function(){a.markItUp.focused=this});f.previewInElement&&t()}})};a.fn.markItUpRemove=function(){return this.each(function(){a(this).markItUp("remove")})};a.markItUp=function(b){var e={target:false};a.extend(e,b);if(e.target)return a(e.target).each(function(){a(this).focus();a(this).trigger("insertion",[e])});a("textarea").trigger("insertion",[e])}})(jQuery);
var fdSlider=function(){function a(a){function b(a){a=!!a;if(a!=da){da=a;ra(za())}}function e(a){if(!Na||a){try{Ya(O,-1);p(O,"focus",n);p(O,"blur",o);if(j)p(O,"keypress",v);else{p(O,"keydown",v);p(O,"keypress",s)}p(aa,"mouseover",D);p(aa,"mouseout",y);p(aa,"mousedown",A);p(aa,"touchstart",A);if(d)if(window.addEventListener&&!window.devicePixelRatio)window.removeEventListener("DOMMouseScroll",u,false);else{p(document,"mousewheel",u);p(window,"mousewheel",u)}}catch(b){}t(Y,"fd-slider-focused");t(Y,
"fd-slider-active");x(Y,"fd-slider-disabled");aa.setAttribute("aria-disabled",true);J.disabled=Na=true;clearTimeout(ta);a||l("disable")}}function i(a){if(Na||a){Ya(O,0);q(O,"focus",n);q(O,"blur",o);if(j)q(O,"keypress",v);else{q(O,"keydown",v);q(O,"keypress",s)}q(aa,"touchstart",A);q(aa,"mousedown",A);q(aa,"mouseover",D);q(aa,"mouseout",y);t(Y,"fd-slider-disabled");aa.setAttribute("aria-disabled",false);J.disabled=Na=va=false;a||l("enable")}}function m(){S();try{var a=aa.offsetWidth,b=aa.offsetHeight,
c=O.offsetWidth,d=O.offsetHeight;R=(I?b-d:a-c)/$a;Ta=Math.max(ja?db(nb(ea)):Math.abs((ea-X)/Z)*R,0);Sa=Math.min(ja?db(nb(ia)):Math.abs((ia-X)/Z)*R,Math.floor(I?b-d:a-c));oa=a;ob=b;ra(ab?za():ca=="select"?J.selectedIndex:parseFloat(J.value),false)}catch(e){}l("redraw")}function l(a){if(Ga){if(a.match(/^(blur|focus|change)$/i)){var b;if(typeof document.createEventObject!="undefined")try{b=document.createEventObject();J.fireEvent("on"+a.toLowerCase(),b)}catch(c){}else if(typeof document.createEvent!=
"undefined"){b=document.createEvent("HTMLEvents");b.initEvent(a,true,true);J.dispatchEvent(b)}}}else if(ya.hasOwnProperty(a)){b={userSet:da,disabled:Na,elem:J,value:ca=="select"?J.options[J.selectedIndex].value:J.value};for(var d=0,e;e=ya[a][d];d++)e.call(J,b)}}function n(){x(Y,"fd-slider-focused");if(c.onfocus){da=true;ra(za())}if(d){q(window,"DOMMouseScroll",u);q(document,"mousewheel",u);j||q(window,"mousewheel",u)}l("focus");return true}function o(){t(Y,"fd-slider-focused");if(d){p(document,"mousewheel",
u);p(window,"DOMMouseScroll",u);j||p(window,"mousewheel",u)}ka=true;l("blur")}function u(a){if(ka){var a=a||window.event,b=0,c;if(a.wheelDelta){b=a.wheelDelta/120;j&&window.opera.version()<9.2&&(b=-b)}else a.detail&&(b=-a.detail/3);I&&(b=-b);if(b){c=za();c=c+(b<0?-Z:Z);da=true;ra(na(c))}r(a)}}function s(a){a=a||window.event;return a.keyCode>=33&&a.keyCode<=40||!ka||a.keyCode==45||a.keyCode==46?w(a):true}function v(a){if(!ka)return true;var a=a||window.event,b=a.keyCode!==null?a.keyCode:a.charCode,
c;if(b<33||b>40&&b!=45&&b!=46)return true;c=za();b==37||b==40||b==46||b==34?c=c-(a.ctrlKey||b==34?+Ea:+Z):b==39||b==38||b==45||b==33?c=c+(a.ctrlKey||b==33?+Ea:+Z):b==35?c=ia:b==36&&(c=ea);da=true;ra(na(c));l("update");r(a)}function D(){x(Y,"fd-slider-hover")}function y(){t(Y,"fd-slider-hover")}function A(a){a=a||window.event;r(a);var b;if(a.target)b=a.target;else if(a.srcElement)b=a.srcElement;if(b&&b.nodeType==3)b=b.parentNode;if(a.touches){if(a.targetTouches&&a.targetTouches.length!=1)return false;
a=a.touches[0];va=true}clearTimeout(ta);ta=null;ka=false;da=true;if(b.className.search("fd-slider-handle")!=-1){cb=I?a.clientY:a.clientX;Ha=parseInt(I?O.offsetTop:O.offsetLeft)||0;ma(a);if(va){q(document,"touchmove",ma);q(document,"touchend",M);p(aa,"mousedown",A)}else{q(document,"mousemove",ma);q(document,"mouseup",M)}x(Y,"fd-slider-active");x(document.body,"fd-slider-drag-"+(I?"vertical":"horizontal"));l("dragstart")}else{S();b=0;if(a.pageX||a.pageY)b=I?a.pageY:a.pageX;else if(a.clientX||a.clientY)b=
I?a.clientY+document.body.scrollTop+document.documentElement.scrollTop:a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;b=b-(I?qb+Math.round(O.offsetHeight/2):zb+Math.round(O.offsetWidth/2));b=La(b);if(ua=="tween"){x(Y,"fd-slider-active");ka=false;Ra=parseInt(b,10);gb=parseInt(I?O.offsetTop:O.offsetLeft,10);hb=Ra-gb;pb=0;ta||(ta=setTimeout(G,20))}else if(ua=="timed"){x(Y,"fd-slider-active");q(document,va?"touchend":"mouseup",B);Pa=b;ha()}else xa(b)}return false}function B(a){a=
a||window.event;r(a);p(document,va?"touchend":"mouseup",B);t(Y,"fd-slider-active");clearTimeout(ta);ta=null;ka=true;return false}function M(a){a=a||window.event;r(a);if(va){p(document,"touchmove",ma);p(document,"touchend",M)}else{p(document,"mousemove",ma);p(document,"mouseup",M)}ka=true;t(document.body,"fd-slider-drag-"+(I?"vertical":"horizontal"));t(Y,"fd-slider-active");l("dragend");return false}function ma(a){a=a||window.event;r(a);if(a.touches){if(a.targetTouches&&a.targetTouches.length!=1)return false;
a=a.touches[0]}xa(La(Ha+(I?a.clientY-cb:a.clientX-cb)));return false}function fa(a){var b=za();da=true;b=b+a*Z;ra(na(b))}function S(){var a=0,b=0,c=aa;try{for(;c.offsetParent;){a=a+c.offsetLeft;b=b+c.offsetTop;c=c.offsetParent}}catch(d){}zb=a;qb=b}function ha(){var a=parseInt(I?O.offsetTop:O.offsetLeft,10),a=Math.round(Pa<a?Math.max(Pa,Math.floor(a-R)):Math.min(Pa,Math.ceil(a+R)));xa(La(a));if(a!=Pa)ta=setTimeout(ha,$a>20?50:100);else{ka=true;t(Y,"fd-slider-active");l("finalise")}}function qa(a){if(isNaN(a)||
a===""||typeof a=="undefined"){da=false;return Fa}if(a<Math.min(ea,ia)){da=false;return Math.min(ea,ia)}if(a>Math.max(ea,ia)){da=false;return Math.max(ea,ia)}da=true;return a}function za(){return na(ca=="input"?parseFloat(J.value):J.selectedIndex)}function na(a){return isNaN(a)||a===""||typeof a=="undefined"?Fa:Math.min(Math.max(a,Math.min(ea,ia)),Math.max(ea,ia))}function xa(a){var b;if(ja){b=a/((aa[I?"offsetHeight":"offsetWidth"]-aa[O?"offsetHeight":"offsetWidth"])/100);var c=0,d=X,e,f;for(f in ja)if(ja.hasOwnProperty(f)){b>=
c&&b<=+f&&(e=d+(b-c)*(+ja[f]-d)/(+f-c));c=+f;d=+ja[f]}b=e}else b=I?sa-Math.round(a/R)*Z:X+Math.round(a/R)*Z;b=na(b);O.style[I?"top":"left"]=(a||0)+"px";Da();eb(ca=="select"||Z==1?Math.round(b):b)}function ra(a,b){var c=false,d;if((typeof a==="undefined"||isNaN(a)||a==="")&&ca=="input"&&!ab){d=Fa;c=true;da=false}else d=qa(a);O.style[I?"top":"left"]=(ja?db(nb(d)):I?Math.round((sa-d)/Z*R):Math.round((d-X)/Z*R))+"px";Da();typeof b!==false&&eb(c?"":d)}function La(a){if(ja)return Math.max(Math.min(Sa,a),
Ta);var b=a%R,a=b&&b>=R/2?a+(R-b):a-b;a<Math.min(Math.abs(Ta),Math.abs(Sa))?a=Math.min(Math.abs(Ta),Math.abs(Sa)):a>Math.max(Math.abs(Ta),Math.abs(Sa))&&(a=Math.max(Math.abs(Ta),Math.abs(Sa)));return Math.min(Math.max(a,0),Sa)}function nb(a){var b=0,c=X,d=0,e;for(e in ja)if(ja.hasOwnProperty(e)){a>=c&&a<=+ja[e]&&(d=b+(a-c)*(+e-b)/(+ja[e]-c));b=+e;c=+ja[e]}return d}function db(a){return(aa[I?"offsetHeight":"offsetWidth"]-O[I?"offsetHeight":"offsetWidth"])/100*a}function eb(a){l("update");da?t(Y,"fd-slider-no-value"):
x(Y,"fd-slider-no-value");if(ca=="select")try{a=parseInt(a,10);if(J.selectedIndex===a){Ma();return}J.options[a].selected=true}catch(b){}else{a!==""&&!kb&&(a=(X+Math.round((a-X)/Z)*Z).toFixed(Za));if(J.value===a){Ma();return}J.value=a}Ma();l("change")}function Da(){h||(I?Qa.style.height=Math.max(1,ga.offsetHeight-O.offsetTop)+"px":Qa.style.width=Math.max(1,O.offsetLeft)+"px")}function Ma(){var a=ca=="select"?J.options[J.selectedIndex].value:J.value,b=bb?bb(a):ca=="select"?J.options[J.selectedIndex].text?
J.options[J.selectedIndex].text:a:a;O.setAttribute("aria-valuenow",a);O.setAttribute("aria-valuetext",b)}function xb(){da=true;kb=jb;ra(ca=="input"?parseFloat(J.value):J.selectedIndex);Ma();kb=false}function yb(){ca=="input"?J.value=J.defaultValue:J.selectedIndex=fb;qa(ca=="select"?J.options[J.selectedIndex].value:J.value);m();Ma()}function b(a){da=!!a}function Ya(a,b){a.setAttribute("tabIndex",b);a.tabIndex=b}var J=a.inp,Na=false,ca=J.tagName.toLowerCase(),X=+a.min,sa=+a.max,ea=+a.min,ia=+a.max,
Aa=Math.abs(sa-X),Z=ca=="select"?1:+a.step,Ea=a.maxStep?+a.maxStep:Z*2,Za=a.precision||0,$a=Math.ceil(Aa/Z),ja=a.scale||false,Aa=!!a.hideInput,ua=a.animation||"",I=!!a.vertical,ya=a.callbacks||{},ib=a.classNames||"",Ga=!!a.html5Shim,Fa=sa<X?X:X+(sa-X)/2,fb=ca=="select"?J.selectedIndex:J.defaultValue||Fa,ab=Ga||!!a.forceValue,Oa=Ga&&I&&"inpHeight"in a?a.inpHeight:false,bb=!Ga&&a.ariaFormat?a.ariaFormat:false,jb=!Ga&&ca!="select"&&"userSnap"in a?!!a.userSnap:false,kb=false,ta=null,ka=true,ob=0,oa=0,
Ra=0,gb=0,hb=0,pb=0,zb=0,qb=0,Sa=0,Ta=0,Ha=0,Pa=0,cb=0,R=0,da=false,va=false,aa,Y,Ua,O,Qa,ga;if(ca=="input"&&ab&&!J.defaultValue)J.defaultValue=za();if(sa<X){Z=-Math.abs(Z);Ea=-Math.abs(Ea)}ja&&(ja[100]=sa);var G=function(){pb++;var a=hb,b=pb,c=gb,a=Math.ceil(b==20?c+a:a*(-Math.pow(2,-10*b/20)+1)+c);xa(b==20?Ra:a);if(b!=20){l("move");ta=setTimeout(G,20)}else{clearTimeout(ta);ta=null;ka=true;t(Y,"fd-slider-focused");t(Y,"fd-slider-active");l("finalise")}};Ga||Aa?x(J,"fd-form-element-hidden"):q(J,"change",
xb);if(Ga){J.stepUp=function(a){fa(a||1)};J.stepDown=function(a){fa(a||-1)}}aa=document.createElement("span");aa.className="fd-slider"+(I?"-vertical ":" ")+ib;aa.id="fd-slider-"+J.id;if(I&&Oa)aa.style.height=Oa+"px";Y=document.createElement("span");Y.className="fd-slider-wrapper"+(!Ga?" fd-slider-no-value":"");Ua=document.createElement("span");Ua.className="fd-slider-inner";ga=document.createElement("span");ga.className="fd-slider-bar";if(g)O=document.createElement("span");else{O=document.createElement("a");
O.setAttribute("href","#");q(O,"click",w)}Ya(O,0);O.className="fd-slider-handle";O.appendChild(document.createTextNode(String.fromCharCode(160)));Y.appendChild(Ua);if(!h){Qa=document.createElement("span");Qa.className="fd-slider-range";Y.appendChild(Qa)}Y.appendChild(ga);Y.appendChild(O);aa.appendChild(Y);J.parentNode.insertBefore(aa,J);if(j){O.unselectable="on";ga.unselectable="on";Ua.unselectable="on";aa.unselectable="on";Y.unselectable="on";if(!h)Qa.unselectable="on"}aa.setAttribute("role","application");
O.setAttribute("role","slider");O.setAttribute("aria-valuemin",ca=="select"?J.options[0].value:X);O.setAttribute("aria-valuemax",ca=="select"?J.options[J.options.length-1].value:sa);a=false;Aa=document.getElementsByTagName("label");for(ib=0;Oa=Aa[ib];ib++)if(Oa.htmlFor&&Oa.htmlFor==J.id||Oa.getAttribute("for")==J.id){a=Oa;break}if(a&&!a.id)a.id=J.id+"_label";if(a){O.setAttribute("aria-labelledby",a.id);O.id="fd-slider-handle-"+J.id;a.setAttribute("for",O.id)}document.getElementById(f)&&O.setAttribute("aria-describedby",
f);J.getAttribute("disabled")==true?e(true):i(true);if(c.onvalue){da=true;qa(ca=="input"?parseFloat(J.value):J.selectedIndex)}J.form&&q(J.form,"reset",yb);Ma();l("create");m();return{onResize:function(){(aa.offsetHeight!=ob||aa.offsetWidth!=oa)&&m()},destroy:function(){clearTimeout(ta);Ua=ga=O=aa=Y=ta=null;l("destroy");ya=null},reset:function(){ra(ca=="input"?parseFloat(J.value):J.selectedIndex)},stepUp:function(a){fa(Math.abs(a)||1)},stepDown:function(a){fa(-Math.abs(a)||-1)},increment:function(a){fa(a)},
disable:function(){e()},enable:function(){i()},setRange:function(a,b){var c=a,d=b;if(ea>ia){c=Math.min(X,Math.max(c,d));d=Math.max(sa,Math.min(c,d));ea=Math.max(c,d);ia=Math.min(c,d)}else{c=Math.max(X,Math.min(c,d));d=Math.min(sa,Math.max(c,d));ea=Math.min(c,d);ia=Math.max(c,d)}Fa<Math.min(ea,ia)?Fa=Math.min(ea,ia):Fa>Math.max(ea,ia)&&(Fa=Math.max(ea,ia));O.setAttribute("aria-valuemin",ea);O.setAttribute("aria-valuemax",ia);qa(ca=="input"?parseFloat(J.value):J.selectedIndex);m()},getValueSet:function(){return!!da},
setValueSet:function(a){b(a)},checkValue:function(){if(c.onvalue){da=true;qa(ca=="input"?parseFloat(J.value):J.selectedIndex)}Ma();m()}}}var b={},e=0,d=true,g=true,f="fd-slider-describedby",c={onfocus:true,onvalue:true},h=false,i="jump",j=Object.prototype.toString.call(window.opera)==="[object Opera]",l=/^([\-]{0,1}[0-9]+(\.[0-9]+){0,1})$/,m=/^([0-9]+(\.[0-9]+){0,1})$/,n=function(a){if(typeof a==="object")for(var b in a){value=a[b];switch(b.toLowerCase()){case "mousewheelenabled":d=!!value;break;
case "fullaria":g=!!value;break;case "describedby":f=String(value);break;case "norangebar":h=!!value;break;case "html5animation":i=String(value).search(/^(jump|tween|timed)$/i)!=-1?String(value).toLowerCase():"jump";break;case "varsetrules":if("onfocus"in value)c.onfocus=!!value.onfocus;if("onvalue"in value)c.onvalue=!!value.onvalue}}},q=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,true)},p=function(a,b,c){try{a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,
c,true)}catch(d){}},w=function(a){a=a||window.event;if(a.stopPropagation){a.stopPropagation();a.preventDefault()}return false},r=function(a){a=a||window.event;a.preventDefault?a.preventDefault():a.returnValue=false},x=function(a,b){if(!RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className))a.className=a.className+((a.className?" ":"")+b)},t=function(a,b){a.className=!b?"":a.className.replace(RegExp("(^|\\s)"+b+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},s=function(a){return!!(a in b&&b.hasOwnProperty(a))},
v=function(c){if(!c||!c.inp||!c.inp.tagName||c.inp.tagName.search(/^input|select/i)==-1)return false;c.html5Shim=false;if(c.inp.tagName.toLowerCase()=="select"){if(c.inp.options.length<2)return false;c.min=0;c.max=c.inp.options.length-1;c.step=1;c.precision=0;c.scale=false;c.forceValue=true}else{if(String(c.inp.type).search(/^(text|range)$/i)==-1)return false;c.min=c.min&&String(c.min).search(l)!=-1?+c.min:0;c.max=c.max&&String(c.max).search(l)!=-1?+c.max:100;c.step=c.step&&String(c.step).search(m)!=
-1?c.step:1;c.precision=c.precision&&String(c.precision).search(/^[0-9]+$/)!=-1?c.precision:String(c.step).search(/\.([0-9]+)$/)!=-1?String(c.step).match(/\.([0-9]+)$/)[1].length:0;c.scale=c.scale||false;c.forceValue="forceValue"in c?!!c.forceValue:false;c.userSnap="userSnap"in c?!!c.userSnap:false}c.ariaFormat="ariaFormat"in c&&typeof c.ariaFormat=="function"?c.ariaFormat:false;c.maxStep=c.maxStep&&String(c.maxStep).search(m)!=-1?+c.maxStep:+c.step*2;c.classNames=c.classNames||"";c.callbacks=c.callbacks||
false;A(c.inp.id);b[c.inp.id]=new a(c);return true},o=function(a,b){return a.getAttribute(b)||""},y=function(){for(var c=document.getElementsByTagName("input"),d,f=0,g;g=c[f];f++)if(g.tagName.toLowerCase()=="input"&&(g.type.toLowerCase()=="text"&&(o(g,"min")&&o(g,"min").search(l)!=-1||o(g,"max")&&o(g,"max").search(l)!=-1||o(g,"step")&&o(g,"step").search(/^(any|([0-9]+(\.[0-9]+){0,1}))$/i)!=-1))&&(!g.id||!document.getElementById("fd-slider-"+g.id))){g.id&&!document.getElementById("fd-slider-"+g.id)&&
A(g.id);if(!g.id)g.id="fd-slider-form-elem-"+e++;d={inp:g,callbacks:[],animation:i,vertical:o(g,"data-fd-slider-vertical")?true:g.offsetHeight>g.offsetWidth,classNames:o(g,"data-fd-slider-vertical"),html5Shim:true};if(d.vertical&&!o(g,"data-fd-slider-vertical"))d.inpHeight=g.offsetHeight;d.min=o(g,"min")||0;d.max=o(g,"max")||100;d.step=o(g,"step").search(/^any$/i)!=-1?d.max-d.min:o(g,"step").search(m)!=-1?g.getAttribute("step"):1;d.precision=String(d.step).search(/\.([0-9]+)$/)!=-1?String(d.step).match(/\.([0-9]+)$/)[1].length:
0;d.maxStep=d.step*2;A(d.inp.id);b[d.inp.id]=new a(d)}return true},A=function(a){if(a in b&&b.hasOwnProperty(a)){b[a].destroy();delete b[a];return true}return false},B=function(){for(var a in b)b.hasOwnProperty(a)&&b[a].destroy();b=[]},u=function(){for(var a in b)if(b.hasOwnProperty(a))b[a].onResize()};q(window,"load",y);q(window,"load",function(){setTimeout(function(){for(var a in b)b[a].checkValue()},0)});q(window,"resize",u);q(window,"unload",function(){B();b=null});var D=document.getElementsByTagName("script"),
D=function(a){if(typeof a!=="string"||a==="")return{};try{if(typeof JSON==="object"&&typeof JSON.parse==="function")return JSON.parse(a);if(/mousewheelenabled|fullaria|describedby|norangebar|html5animation|varsetrules/.test(a.toLowerCase()))return Function(["var document,top,self,window,parent,Number,Date,Object,Function,Array,String,Math,RegExp,Image,ActiveXObject;return (",a.replace(/<\!--.+--\>/gim,"").replace(/\bfunction\b/g,"function-"),");"].join(""))()}catch(b){}return{err:"Could not parse the JSON object"}}(String(D[D.length-
1].innerHTML).replace(/[\n\r\s\t]+/g," ").replace(/^\s+/,"").replace(/\s+$/,""));typeof D==="object"&&!("err"in D)&&n(D);return{rescanDocument:y,createSlider:function(a){return v(a)},onDomReady:function(){p(window,"load",y);y()},destroyAll:function(){B()},destroySlider:function(a){return A(a)},redrawAll:function(){u()},addEvent:q,removeEvent:p,stopEvent:w,increment:function(a,c){if(!s(a))return false;b[a].increment(c)},stepUp:function(a,c){if(!s(a))return false;b[a].stepUp(Math.abs(c)||1)},stepDown:function(a,
c){if(!s(a))return false;b[a].stepDown(-Math.abs(c)||-1)},setRange:function(a,c,d){if(!s(a))return false;b[a].setRange(c,d)},updateSlider:function(a){if(!s(a))return false;b[a].onResize();b[a].reset()},disable:function(a){if(!s(a))return false;b[a].disable()},enable:function(a){if(!s(a))return false;b[a].enable()},getValueSet:function(){var a={},c;for(c in b)a[c]=b[c].getValueSet();return a},setValueSet:function(a,c){if(!s(id))return false;b[a].setValueSet(!!c)},setGlobalVariables:function(a){n(a)},
removeOnload:function(){p(window,"load",y)}}}();
(function(){var a,b,e,d,g,f,c,h,i,j,l,m,n,q,p,w,r,x,t,s,v,o,y,A,B,u,D,k,E,z,Q=[].slice,V={}.hasOwnProperty;d={};e=function(a,b){return function(){var c;c=1<=arguments.length?Q.call(arguments,0):[];return b.apply(a,c)}};t=function(a,b){a==null&&(a={});typeof a==="function"&&(a={success:a});if(b!==void 0)a.data=b;return a};c=function(a,b){var c,a=t(a);if(c=a.success)a.success=function(a,d,e){return c(b(a),d,e)};return a};B=function(a,b,c){var d,e,f;if(e=/^(.+?)[.](.+)$/.exec(b))B(a[e[1]],e[2],c);else if(e=
/^\[(.+)\]$/.exec(b)){b=e[1];d=0;for(f=a.length;d<f;d++){e=a[d];c(e,b)}}else if(e=/^\{(.+)\}$/.exec(b)){b=e[1];for(d in a)if(V.call(a,d)){e=a[d];c(e,b)}}else c(a,b);return a};s=function(a,b){var c,d,a=t(a);for(d in b)if(V.call(b,d)){c=b[d];c(d,a)}return a};j=function(a){return function(b,d){return c(d,function(c){return B(c,b,a)})}};f={utc_created_on:"date_created",utc_last_updated:"date_updated",utc_sent_on:"date_created",utc_updated_on:"date_updated"};a=j(function(a,b){var c,d,e,g,h,i;i=b.split(",");
g=0;for(h=i.length;g<h;g++){d=i[g];c=d.split(":");d=c[0];e=c[1];if(c=a[d]){e||(e=f[d]||"date");delete a[d];delete a[d.replace(/^utc_?/,"")];a[e]=new Date(c.replace(" ","T"))}}return a});x=j(function(a){if(a.size===-1)return delete a.size});b=function(a,b){var c,d;if(a===b)return 0;c=a.toLowerCase();d=b.toLowerCase();return(c===d?a<b:c<d)?-1:1};l=j(function(a,c){var d,e,f;e=c.split(":");f=e[0];e=e[1];if(f in a){d=(d=a[f].replace(/^\s+|\s+$/g,""))?d.split(/\s*[\n\r]\s*/).sort(b):[];delete a[f];a[e||
f]=d}return a});w=j(function(a,b){var c,d,e;c=b.split(":");d=c[0];c=c[1];if(d in a){e=a[d];delete a[d];a[c]=e}return a});u=j(function(a,b){var c,d,e,f;c=b.split(":");b=c[0];f=c[1].split(",");d=0;for(e=f.length;d<e;d++){c=f[d];a[c]=a[b][c]}delete a[b];return a});r=function(a,b){return c(b,function(b){return b[a]})};j=function(a){return function(){var b,c,e;c=arguments[0];e=3<=arguments.length?Q.call(arguments,1,b=arguments.length-1):(b=1,[]);b=arguments[b++];b=t(b,e[0]);b.type=a;b.url=c;if(a==="GET"&&
!d.proxy_url)b.dataType="jsonp";return $.ajax(b)}};m=j("POST");i=j("GET");q=j("PUT");h=j("DELETE");D=function(){var a;a=1<=arguments.length?Q.call(arguments,0):[];return(d.proxy_url||"https://bitbucket.org/!api/1.0/")+a.join("/")};p=function(a){var b,c,d,e,f,g,h,i,j;a==null&&(a={});b=[];for(c in a)V.call(a,c)&&b.push(c);d=b.sort();if(d.length===0)return"";b=[];g=0;for(i=d.length;g<i;g++){c=d[g];f=a[c];f instanceof Array||(f=[f]);h=0;for(j=f.length;h<j;h++){e=f[h];b.push(encodeURIComponent(c)+"="+
encodeURIComponent(e))}}return"?"+b.join("&")};var F=function(a){if(!(this instanceof F))return new F(a);this.name="bitbucket.error";this.message=a},L=F;j=Error;E=function(){this.constructor=L};for(k in j)V.call(j,k)&&(L[k]=j[k]);E.prototype=j.prototype;L.prototype=new E;L.__super__=j.prototype;d.error=F;o=function(b,c,d){var e;d==null&&(d="%");if(typeof c==="string"){d=c;c={}}e={};e[d.replace(/%/,"utc_created_on,utc_last_updated")]=a;e[d.replace(/%/,"metadata:component,kind,milestone,version")]=
u;return s(t(b,c),e)};y=function(b,c,d){var e;d==null&&(d="%");if(typeof c==="string"){d=c;c={}}e={};e[d.replace(/%/,"utc_created_on,utc_updated_on")]=a;e[d.replace(/%/,"author_info:author")]=w;return s(t(b,c),e)};A=function(b,c,d){var e;d==null&&(d="%");if(typeof c==="string"){d=c;c={}}if((c!=null?c.mailing_lists:void 0)!=null){c.email_mailinglist=c.mailing_lists.join("\n");delete c.mailing_lists}e={};e[d.replace(/%/,"utc_created_on,utc_last_updated")]=a;e[d.replace(/%/,"email_mailinglist:mailing_lists")]=
l;return s(t(b,c),e)};v=function(b,c){var d;c==null&&(c="%");d={};d[c.replace(/%/,"utctimestamp")]=a;d[c.replace(/%/,"size")]=x;return s(t(b),d)};d.flags={access:{direct:1,via_groups:2},output:{include_groups:4}};var C,W,T,K,H,U,la;U=["read","write","admin"];la={};k=j=0;for(E=U.length;j<E;k=++j){K=U[k];la[K]=k}H=function(){var a;a=1<=arguments.length?Q.call(arguments,0):[];return U[Math.max.apply(Math,function(){var b,c,d;d=[];b=0;for(c=a.length;b<c;b++){K=a[b];d.push(la[K]||0)}return d}())]};C=d.flags.access.direct;
W=d.flags.access.via_groups;T=d.flags.output.include_groups;n=function(a){return{direct:C,expand:W,flags:a,groups:T,max:H,privileges:{}}};d.repositories=function(){var a,b;b=2<=arguments.length?Q.call(arguments,0,a=arguments.length-1):(a=0,[]);a=arguments[a++];b=b[0];return i(D("repositories")+p(b),A(a,"repositories.[%]"))};var N=function(a,b){var c;if(b==null){c=a.split("/");a=c[0];b=c[1]}if(!(this instanceof N))return new N(a,b);this.username=a;this.slug=b};N.create=function(a,b){var c,e;e=a.username;
c=a.slug;if(!e||!c)throw d.error('"username" and "slug" are required attributes');if(/^[.]{1,2}$/.test(c))throw d.error('"'+c+'" is an invalid slug');if(/[^a-z0-9.-]/.test(c))throw d.error('"'+c+'" does not match /^[a-z0-9.-]+$/');delete a.username;delete a.slug;a.name=c;m(D("repositories"),A(b,a));return N(e,c)};N.prototype.toString=function(){return this.username+"/"+this.slug};N.prototype.url=function(){var a;a=1<=arguments.length?Q.call(arguments,0):[];return D.apply(null,["repositories",this.username,
this.slug].concat(Q.call(a)))};N.prototype.details=function(a){return i(this.url(),A(a))};N.prototype.update=function(a,b){return q(this.url(),A(b,a))};N.prototype.destroy=function(a){return h(this.url(),a)};N.prototype.branches=function(b){return i(this.url("branches"),s(b,{"{utctimestamp}":a,"{size}":x}))};N.prototype.changeset=function(a,b){return i(this.url("changesets",a),v(b))};N.prototype.changesets=function(){var a,b;b=2<=arguments.length?Q.call(arguments,0,a=arguments.length-1):(a=0,[]);
a=arguments[a++];b=b[0];return i(this.url("changesets")+p(b),v(a,"changesets.[%]"))};N.prototype.diffstat=function(a,b){return i(this.url("changesets",a,"diffstat"),b)};N.prototype.directory=function(){var b,c,d;d=arguments[0];c=3<=arguments.length?Q.call(arguments,1,b=arguments.length-1):(b=1,[]);b=arguments[b++];return i(this.url("src",d,c),s(b,{"files.[utctimestamp]":a}))};N.prototype.file=function(a,b,c){return i(this.url("src",a,b),r("data",c))};N.prototype.followers=function(a){return i(this.url("followers"),
r("followers",a))};N.prototype.create_issue=function(a,b){return m(this.url("issues"),o(b,a))};N.prototype.update_issue=function(a,b,c){return q(this.url("issues",a),o(c,b))};N.prototype.delete_issue=function(a,b){return h(this.url("issues",a),b)};N.prototype.issue=function(a,b){return i(this.url("issues",a),o(b))};N.prototype.create_issue_comment=function(a,b,c){return m(this.url("issues",a,"comments"),y(c,b))};N.prototype.update_issue_comment=function(a,b,c,d){return q(this.url("issues",a,"comments",
b),y(d,c))};N.prototype.delete_issue_comment=function(a,b,c){return h(this.url("issues",a,"comments",b),c)};N.prototype.issue_comment=function(a,b,c){return i(this.url("issues",a,"comments",b),y(c))};N.prototype.issue_comments=function(a,b){return i(this.url("issues",a,"comments"),y(b,"[%]"))};N.prototype.issue_followers=function(a,b){return i(this.url("issues",a,"followers"),r("followers",b))};N.prototype.issues=function(){var a,b;b=2<=arguments.length?Q.call(arguments,0,a=arguments.length-1):(a=
0,[]);a=arguments[a++];b=b[0];return i(this.url("issues")+p(b),o(a,"issues.[%]"))};N.prototype.create_linkifier=function(a,b){return m(this.url("links"),a,b)};N.prototype.update_linkifier=function(a,b,c){return q(this.url("links",a),b,c)};N.prototype.delete_linkifier=function(a,b){return h(this.url("links",a),b)};N.prototype.linkifier=function(a,b){return i(this.url("links",a),b)};N.prototype.linkifiers=function(){};N.prototype.deploy_key=function(a,b,c){return i(this.url("deploy-keys",a),b,c)};N.prototype.deploy_keys=
function(a,b){return i(this.url("deploy-keys"),a,b)};N.prototype.create_deploy_key=function(a,b){return m(this.url("deploy-keys"),a,b)};N.prototype.update_deploy_key=function(a,b,c){return q(this.url("deploy-keys",a),b,c)};N.prototype.delete_deploy_key=function(a,b){return h(this.url("deploy-keys",a),b)};N.prototype.privileges=function(a,b){var c,d,f,g,h,j;if(b==null){b=a;a=3}b=t(b);h=b.success||function(){};f=b.error||function(){};d=n(a);c=2;j=function(){return--c>0};g=false;b.error=function(a,b,
c){if(!g){f(a,b,c);return g=true}};b.success=e(d,function(a,b,c){var d,e,f,g;if(this.flags&this.direct){f=0;for(g=a.length;f<g;f++){e=a[f];d=e.privilege;e=e.user;e=e.username;this.privileges[e]=this.max(this.privileges[e],d)}}if(!j())return h(this.privileges,b,c)});i(D("privileges",this),b);b.success=e(d,function(a,b,c){var d,e,f,g,i,m,l;if(this.flags&(this.groups|this.expand)){f=0;for(i=a.length;f<i;f++){d=a[f];e=d.privilege;d=d.group;this.flags&this.groups&&(this.privileges[d.owner.username+"/"+
d.slug]=e);if(this.flags&this.expand){l=d.members;g=0;for(m=l.length;g<m;g++){d=l[g].username;this.privileges[d]=this.max(this.privileges[d],e)}}}}if(!j())return h(this.privileges,b,c)});return i(D("group-privileges",this),b)};N.prototype.tags=function(b){return i(this.url("tags"),s(b,{"{utctimestamp}":a,"{size}":x}))};N.prototype.wiki_page=function(){var a,b;b=2<=arguments.length?Q.call(arguments,0,a=arguments.length-1):(a=0,[]);a=arguments[a++];return i(this.url("wiki",b[0]),a)};d.repository=N;
z=["component","milestone","version"];k=function(){var a,b,c;b=g;a=g+"s";c=d.repository.prototype;c["create_"+b]=function(b,c){return m(this.url("issues",a),{name:b},c)};c["update_"+b]=function(b,c,d){return q(this.url("issues",a,b),{name:c},d)};c["delete_"+b]=function(b,c){return h(this.url("issues",a,b),c)};c[b]=function(b,c){return i(this.url("issues",a,b),c)};return c[a]=function(b){return i(this.url("issues",a),b)}};j=0;for(E=z.length;j<E;j++){g=z[j];k()}d.send_invitation=function(b,c,d,e){d=
d.toString().split("/");b=D("invitations",d[0],d[1],b);return m(b,{permission:c},a("utc_sent_on",A(e,"repository.%")))};d.send_general_invitation=function(a,b){return m(D("invitations",a),b)};d.users=function(a,b){var d;if(((d=a.user)!=null?d.length:void 0)===0){b=t(b);typeof b.complete==="function"&&b.complete();b.success([])}else return i(D("users")+p(a),c(b,function(a){var b,c,d,e;c={};d=0;for(e=a.length;d<e;d++){b=a[d];c[b.username]=b}return c}))};var M=function(a){if(!(this instanceof M))return new M(a);
this.username=a};M.create=function(a,b){var c;c=a.username;if(!c)throw d.error('"username" is a required attribute');m(D("newuser"),a,b);return M(c)};M.prototype.url=function(){var a;a=1<=arguments.length?Q.call(arguments,0):[];return D.apply(null,["users",this.username].concat(Q.call(a)))};M.prototype.details=function(a){return i(this.url(),r("user",a))};M.prototype.events=function(){var b,c;c=2<=arguments.length?Q.call(arguments,0,b=arguments.length-1):(b=0,[]);b=arguments[b++];c=c[0];return i(this.url("events")+
p(c),s(b,{"events.[utc_created_on:date]":a}))};M.prototype.followers=function(a){return i(this.url("followers"),r("followers",a))};M.prototype.delete_invitation=function(a,b){return h(this.url("invitations",a),b)};M.prototype.invitation=function(b,c){return i(this.url("invitations",b),s(c,{utc_sent_on:a}))};M.prototype.invitations=function(b){return i(this.url("invitations"),s(b,{"[utc_sent_on]":a}))};M.prototype.invite=function(a,b,c){return q(this.url("invitations",a,b),c)};M.prototype.uninvite=
function(a,b,c){return h(this.url("invitations",a,b),c)};M.prototype.plan=function(a){return i(this.url("plan"),a)};M.prototype.privileges=function(a,b){var c,d,f,g,h,j;if(b==null){b=a;a=3}b=t(b);h=b.success||function(){};f=b.error||function(){};d=n(a);c=2;j=function(){return--c>0};g=false;b.error=function(a,b,c){if(!g){f(a,b,c);return g=true}};b.success=e(d,function(a,b,c){var d,e,f,g,i,m;if(this.flags&this.direct){i=0;for(m=a.length;i<m;i++){f=a[i];d=f.privilege;e=f.repo;f=f.user;e=(g=this.privileges)[e]||
(g[e]={});e[f.username]=this.max(e[f.username],d)}}if(!j())return h(this.privileges,b,c)});i(D("privileges",this.username),b);b.success=e(d,function(a,b,c){var d,e,f,g,i,m,l,k,n;if(this.flags&(this.groups|this.expand)){i=0;for(l=a.length;i<l;i++){d=a[i];e=d.privilege;f=d.repo;d=d.group;f=(g=this.privileges)[f]||(g[f]={});this.flags&this.groups&&(f[d.owner.username+"/"+d.slug]=e);if(this.flags&this.expand){n=d.members;m=0;for(k=n.length;m<k;m++){d=n[m].username;f[d]=this.max(f[d],e)}}}}if(!j())return h(this.privileges,
b,c)});return i(D("group-privileges",this.username),b)};M.prototype.repositories=function(a){return i(this.url(),r("repositories",A(a,"[%]")))};M.prototype.add_email_address=function(a,b){return m(this.url("emails",a),b)};M.prototype.set_primary_email_address=function(a,b){return q(this.url("emails",a),{primary:true},b)};M.prototype.remove_email_address=function(a,b){return h(this.url("emails",a),b)};M.prototype.email_address=function(a,b){return i(this.url("emails",a),b)};M.prototype.email_addresses=
function(a){return i(this.url("emails"),a)};M.prototype.remove_ad=function(a,b){return h(this.url("ad",a),b)};M.prototype.feature_viewed=function(a,b){return h(this.url("feature",a),b)};M.prototype.add_ssh_key=function(a,b){return m(this.url("ssh-keys"),a,w("pk:id",b))};M.prototype.update_ssh_key=function(a,b,c){return q(this.url("ssh-keys",a),b,w("pk:id",c))};M.prototype.remove_ssh_key=function(a,b){return h(this.url("ssh-keys",a),b)};M.prototype.ssh_key=function(a,b){return i(this.url("ssh-keys",
a),w("pk:id",b))};M.prototype.ssh_keys=function(a){return i(this.url("ssh-keys"),w("[pk:id]",a))};M.prototype.create_consumer=function(a,b){return m(this.url("consumers"),a,b)};M.prototype.update_consumer=function(a,b,c){return q(this.url("consumers",a),b,c)};M.prototype.delete_consumer=function(a,b){return h(this.url("consumers",a),b)};M.prototype.consumer=function(a,b){return i(this.url("consumers",a),b)};M.prototype.consumers=function(a){return i(this.url("consumers"),a)};M.prototype.add_member=
function(a,b,c){return m(this.url("privileges",a),{privilege:b},c)};M.prototype.update_member=function(a,b,c){return q(this.url("privileges",a),{privilege:b},c)};M.prototype.remove_member=function(a,b){return h(this.url("privileges",a),b)};M.prototype.members=function(a){return i(this.url("privileges"),a)};d.user=M;d.groups=function(a,b){return i(D("groups")+p(a),b)};var ma=function(a,b){if(!(this instanceof ma))return new ma(a,b);this.username=a;this.slug=b};ma.prototype.url=function(){var a;a=1<=
arguments.length?Q.call(arguments,0):[];return D.apply(null,["groups",this.username,this.slug].concat(Q.call(a)))};ma.prototype.details=function(a){return i(this.url(),a)};d.group=ma;d.utils={alphabetical:b};window.bitbucket=d}).call(this);bitbucket.proxy_url="/!api/1.0/";window.__=_.escape;(function(a,b){$=b})(this,$||AJS.$);
(function(a,b){var e=Array.prototype.concat,d={concat:function(){return _.extend(e.apply(this,_.toArray(arguments)),d)},toString:function(){var a="",b=_.toArray(arguments);if(Object.prototype.toString.call(_.last(b))==="[object Object]"){var c=b.pop();_.each(_.keys(c).sort(),function(b,d){a=a+"{sep}{key}={val}".format({sep:d?"&":"?",key:encodeURIComponent(b),val:encodeURIComponent(c[b])})})}return"/{}/{}".format(_.map(e.apply(this,b),encodeURIComponent).join("/"),a)}};BB.CANON_URL=BB.CANON_URL||b("#bb-canon-url").attr("content");
BB.debug=BB.debug||b("#bb-debug").attr("content")==="true";BB.api=_.extend(["!api","1.0"],d);BB.decorators={loginRequired:function(a){return function(){BB.user.id!=null&&a.apply(null,[].slice.apply(arguments))}}};BB.delay=function(b,c){if(typeof b==="function"){c=b;b=0}return a.setTimeout(c,b)};BB.doctest=function(){doctest.apply(null,arguments.length?_.toArray(arguments):b("script[data-doctests]").map(function(){return b(this).data("doctests")||this.src}))};var g=void 0;BB.gaqPush=function(){if(g)if(BB.debug)console.log(["_gaq.push(",
_.map(arguments,function(a){return'  ["'+a.join('", "')+'"]'}).join(",\n"),");"].join("\n"));else{a._gaq||(a._gaq=[]);_gaq.push.apply(_gaq,_.toArray(arguments))}else{g=true;BB.gaqPush(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"],["_setAccount","UA-2456069-3"],["atl._setAccount","UA-6032469-33"]);BB.gaqPush.apply(null,arguments)}};var f=BB,c=[],h=false,i=function(){for(var a=c.length;a--;)c[a]();h=true};i.register=function(){c.push.apply(c,_.toArray(arguments));
if(h)for(var a=arguments.length;a--;)arguments[a]()};f.initialize=i;BB.localize=function(a){a=a&&a.length?a:b("time");a.each(function(){var a=b(this),c=a.data();a.closest(".site-message").length?a.localize({format:"h:MMa, d mmmm yyyy (UTCZ)",periods:["am","pm"]}):c.format?a.localize({format:c.format,periods:c.associatedPressPeriods?["a.m.","p.m."]:void 0}):c.relative!==false&&a.localize();if(c.title){c=new Date(a.attr("datetime"));a.attr({title:b.localize(c,"d mmmm yyyy HH:MM")})}})};BB.log=function(){BB.debug&&
console.log.apply(console,_.toArray(arguments))};BB.valid={email:function(a){return/^[^@\s]+@[^.@\s]+(\.[^.@\s]+)+$/.test(a)},url:function(a){return/^[^.@\s]+(\.[^.@\s]+)+$/.test(a)}};var j=[];b(document).keydown(function(a){j.push(a.keyCode);if(j.toString().indexOf("38,38,40,40,37,39,37,39,66,65")>-1){b.getScript("http://www.cornify.com/js/cornify.js",function(){cornify_add();b(document).keydown(cornify_add)});b(this).unbind("keydown",arguments.callee)}})})(this,jQuery);
(function(a){if(a.support.pjax){var b=a("body").data("replaceUrl");b&&window.history.replaceState({},"",b);a(document).bind("pjax:end",function(e,d){if(d)(b=a("<div></div>").html(d.responseText).find("meta").attr("content"))&&window.history.replaceState({},"",b)})}})(jQuery);
(function(){var a={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var e=0;e<a.length;e++){var d=a[e].string,g=a[e].prop;this.versionSearchString=a[e].versionSearch||a[e].identity;if(d){if(d.indexOf(a[e].subString)!=-1)return a[e].identity}else if(g)return a[e].identity}},
searchVersion:function(a){var e=a.indexOf(this.versionSearchString);if(e!=-1)return parseFloat(a.substring(e+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,
subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],
dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};a.init();window.$.client={os:a.OS,browser:a.browser}})();BB=window.BB||{};BB.utils=BB.utils||{};BB.utils.ajaxOptions=function(a,b){a=$(a);b||(b={});b.url=a.attr("action");b.type=a.attr("method");b.data=a.serialize();return b};
BB.utils.canonicalPathname=function(a){return(a||window.location.pathname).rstrip("/")};BB.utils.chosen=function(a,b){a.find("select").each(function(){var a=$(this);a.data("placeholder",a.attr("placeholder"));a=a.find("option").first();!a.val()&&a.text()==="---------"&&a.text("")}).chosen(b)};BB.utils.csvToArray=function(a){return a?a.split(","):[]};BB.utils.decorate=function(a,b){return function(e){return function(){var d=_.toArray(arguments);b=b||null;a.apply(b,d);e.apply(b,d)}}};
BB.utils.delegate=function(a,b,e){$(function(d){d(document.body).on(b,a,e)});return function(){$(document.body).off(b,a,e)}};
BB.utils.enableFollowingLinks=function(a){a.preventDefault();var a=$(this),b=a.closest(".info-button"),e=a.closest(".followers");if(!b.hasClass("info-button-requesting")&&!b.hasClass("info-button-readonly")){b.addClass("info-button-requesting");$.ajax({url:a.attr("href"),dataType:"json",complete:function(){b.removeClass("info-button-requesting")},success:function(a){e.removeClass("followers-following followers-not-following").addClass(a.following?"followers-following":"followers-not-following")}})}};
BB.utils.exists=function(a,b){var e=$(a);e.length===1&&b(e)};BB.utils.guard=function(a,b){$(function(){BB.utils.exists(a,b)})};BB.utils.linkifyTweet=function(a){return linkify(a).replace(/(^|\s+)(@(\w{1,15})|#\S+)(?!\S)/gm,function(a,e,d,g){a={spaces:e,token:d};a.href=g?"https://twitter.com/"+g:"https://twitter.com/search/"+escape(d);return'{spaces}<a href="{href}">{token}</a>'.format(a)})};
BB.utils.placeholder=function(a){var a=$(a||document.body),b;if(!("placeholder"in document.createElement("input"))){b=a.find("input[placeholder]").focus(function(){var a=$(this);a.val()===a.attr("placeholder")&&a.removeClass("placeholder").val("")}).blur(function(){var a=$(this);a.val()===""&&a.addClass("placeholder").val(a.attr("placeholder"))}).trigger("blur");b.closest("form").submit(function(){b.trigger("focus")});$(window).unload(function(){b.trigger("focus")});return a}};
BB.utils.processFormErrors=function(a){return _.reduce($(a).children(),function(a,e){var d=$(e).children().remove().text();a[$(e).text().trim()]=d;return a},{})};BB.utils.queryStringMap=function(a){a=(a||location.search).lstrip("?");if(!a)return{};var b={};_.each(a.split("&"),function(a){a=a.split("=");b[decodeURIComponent(a[0])]=decodeURIComponent(a[1])});return b};BB.utils.ready=function(a,b){var e=function(){var d=$(a);d.length&&b(d)};$(document).bind("pjax:end",e);$(e)};
BB.utils.slugify=function(a){return(""+a).replace(/[ ]/g,"-").toLowerCase()};BB.utils.sortedInsert=function(a,b,e){var d=e||b.collection,g=d.sortedIndex(a,d.comparator),e=b.$ol||b.$table.find("tbody");(b=b.$table&&b.$table.find("tbody tr.form"))&&b.length?b.length&&(g===0?b.after(a.view.el):e.children(":nth-child("+(g+1)+")").after(a.view.el)):g===0?e.prepend(a.view.el):e.children(":nth-child("+g+")").after(a.view.el);return{add:function(){d.add(a,{at:g})}}};
BB.utils.toOptions=function(a){return typeof a!=="function"?a:{error:function(){alert("An unexpected error occurred.")},success:a}};BB.utils.toUsername=function(a){return(""+a).replace(/\W/g,"").toLowerCase()};
BB.utils.apiUtcToDate=function(a){a=a.match(/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})\+\d{2}:\d{2}/);return new Date("{} {} {} {}:{}:{} UTC".format(a[3],{"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"}[a[2]],a[1],a[4],a[5],a[6]))};
BB.utils.previewContent=function(a,b){if(a.attr("aria-pressed"))BB.utils.editContent(a,b);else{var e=setTimeout(function(){b.find(".mask").show()},300),d={content:b.find("textarea").val()};if(BB.repo.id)d.repo_id=BB.repo.id;d.markup_type=b.attr("data-markup-type");$.ajax({type:"POST",url:BB.api.toString("content-preview"),data:d,success:function(d){b.addClass("previewing");a.attr("aria-pressed",true);b.find(".preview-container").html(d.markup);clearTimeout(e);b.find(".mask").hide()},error:function(){alert("There was an error rendering your preview.");
clearTimeout(e);b.find(".mask").hide()}})}};BB.utils.editContent=function(a,b){b.removeClass("previewing");a.removeAttr("aria-pressed")};
BB.utils.userPrefs=function(a,b){var e=$.Deferred(),d={url:BB.api.concat("user","preferences",BB.user.username,a)};if(arguments.length==1){d.type="GET";d.success=function(a){e.resolve(a.value)};d.error=function(a){a.status==404&&e.resolve(null);e.reject()}}else{d.complete=function(){e.resolve()};if(b){d.type="PUT";d.data={value:b}}else d.type="DELETE"}$.ajax(d);return e};
BB.utils.checkTask=function(a,b,e){$.ajax({type:"GET",url:a,success:function(d){d.complete?d.url?e?e(d.url):window.location=d.url:b&&b(d.error,d):d.error?b&&b(d.error,d):setTimeout(BB.utils.checkTask.bind(this,a,b,e),1E3)},error:function(){b&&b("An unexpected error occurred")}})};jQuery(function(a){if(a.support.pjax)a.pjax.defaults.timeout=2E3;a(document).bind("pjax:end",BB.initialize);BB.initialize()});
(function(a){BB.utils.guard("#header-language form",function(b){b.on("click","a",function(e){e.preventDefault();b.find("input[name=language]").val(a(e.target).attr("data-value"));b.submit()})});BB.utils.guard("#call-for-translators",function(b){b.slideDown();BB.gaqPush(["atl._trackEvent","i18n","Show call for translators banner"]);b.on("messageClose",function(){var b=BB.api.concat("user","preferences",BB.user.username,"dismiss-call-for-translators");a.post(b,{value:"True"})});b.on("click",".view-language-link",
function(){BB.gaqPush(["atl._trackEvent","i18n","View language preference","banner"])})});BB.utils.guard("#footer .view-language-link",function(a){a.on("click",function(){BB.gaqPush(["atl._trackEvent","i18n","View language preference","footer"])})});BB.utils.guard("#id_language_code_group",function(b){function e(){var a=i.data("languages");return _.indexOf(a,f.val())<0}function d(){if(!j&&b.data("banner-referrer")){BB.gaqPush(["atl._trackEvent","i18n","Language field referrer","banner"]);j=true}}
var g=b.closest("form"),f=a("#id_language_code"),c=a("#translate-progress-content"),h=null,i=a("#help-translate-message");f.on("change",function(){i.is(":visible")?e(f.val())||i.slideUp():e(f.val())&&i.slideDown()});var j=false;f.on("change",function(){d();h=a.get(c.attr("data-stats-url"))});i.on("click",".translate-link",d);var l=f.val();g.on("submit",function(){if(f.val()!==l){var a=l+" -> "+f.val();BB.gaqPush(["atl._trackEvent","i18n","Save language change",a])}});var m=false,n=new AJS.Dialog({width:450,
height:"auto",id:"translate-progress-dialog"});n.addPanel("main").addHeader("This translation is incomplete").addButton("Save settings",function(){m=true;g.submit()},"aui-button aui-button-primary").addCancel("Cancel",function(a){a.hide()});n.getCurrentPanel().body.append(c.show());g.on("submit",function(b){var c=f.val();if(!(c===l||!e(c)||m)){b.preventDefault();var d=g.find("button[type=submit]"),i=setTimeout(function(){d.addClass("loading").attr("aria-disabled",true).attr("disabled",true)},400);
h.done(function(b){clearTimeout(i);d.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled");b=b[c]||0;a("#translate-progress-content").find("span.language").text(f.find(":selected").text()).end().find("span.percent").text(b).end().find(".progress").css("width",b+"%");n.show()})}});b.on("click",".translate-link",function(b){b=a(b.target).attr("data-type");BB.gaqPush(["atl._trackEvent","i18n","Translate",b])})})})(jQuery);
BB.utils.guard("#dashboard-content",function(a){var b=$("#dashboard-tabs"),e=b.find("ul.aui-nav > li");a.on("click","ul.filter-control a",function(a){var e=b.find("li.aui-nav-selected"),e=(e=/(\w+)-tab/.exec(e.attr("id")))?e[1]:"",a=$(a.target).text();BB.gaqPush(["atl._trackEvent","Dashboard","Filter - "+a,e])});a.on("click","ul.filter-control a, ol.paginator a",function(b){b.preventDefault();$("body, html").animate({scrollTop:0},400);$.pjax($.extend({url:$(this).attr("href"),push:true},{container:a,
scrollTo:null,timeout:3E4}))});a.on("pjax:end",function(){var b=a.children(".dashboard-section:first").attr("id"),g=a.find('ul.filter-control > li[aria-pressed="true"]').attr("id");e.removeClass("aui-nav-selected");$("#"+b+"-tab").addClass("aui-nav-selected");a.removeClass("has-mask");$.cookie("dashboard-tab",b?b:"");$.cookie("dashboard-filter",g?g:"")}).on("pjax:error",function(b,e,f){if(e.readyState>0&&f!=="abort"){a.html("<h2>Error</h2><p>We were unable to load this page.</p>");return false}}).on("pjax:beforeSend",
function(){a.addClass("has-mask")});if($.support.pjax)e.on("click","a",function(b){b.preventDefault();var b=$(b.target).closest("li"),g=/(\w+)-tab/.exec(b.attr("id"));BB.gaqPush(["atl._trackEvent","Dashboard","Tab - "+(g?g[1]:"")]);$.pjax($.extend({url:$(this).attr("href"),push:true},{container:a,scrollTo:null,timeout:3E4}));a.empty();e.removeClass("aui-nav-selected");b.addClass("aui-nav-selected")});a.on("click","#import-all-github-repos",function(a){a.preventDefault();var b=$(a.target);b.attr("aria-disabled",
"true").attr("disabled","disabled").addClass("loading");$.post(b.attr("data-api-url"),{type:"github"},function(){window.location=b.attr("href")})})});BB.account={};BB.account.avatar=function(a,b){return a.endsWith(/\/default_(team_)?avatar\/([0-9]+)\/(team_|user_)blue[.]png/)?a.replace(/[0-9]+(?=\/(team_|user_)blue[.]png$)/,b):a.replace(/\bs=\d+$/,"s="+b)};
BB.account.groupPrivileges=function(a,b){var a=BB.utils.toOptions(a),e=a.success;$.ajax(_.extend(a,{url:BB.api.toString("group-privileges",b||BB.targetUser.username),success:function(a,b,f){var c={};_.each(a,function(a){var b="{owner.username}/{slug}".format(a.group);c[b]||(c[b]={read:[],write:[],admin:[]});c[b][a.privilege].push(a.repo)});e(c,b,f)}}))};BB.account.displayName=function(a){return a.is_team?a.first_name:a.first_name&&a.last_name?"{first_name} {last_name}".format(a):a.username};
BB.utils.guard("#registration-form-container",function(){var a=$("#id_email");a.val()===""&&a.val(BB.utils.queryStringMap().prefilled_email||"")});
(function(){var a,b,e;a=Math.abs;b=Math.floor;e=Math.round;$.localize.format=function(d,g){var f,c,h,i,j,l,m;g==null&&(g=new Date);c=(d-g)/1E3;if(-10<c&&c<300)return"just now";h=c<0;c=a(c);j=h?"ago":"from now";d.setHours(g.getHours(),g.getMinutes(),g.getSeconds(),g.getMilliseconds());f=a(e((d-g)/864E5));if(f>30)return $.localize(d,"yyyy-mm-dd");if(f>1)return""+f+" days "+j;if(c>=86400)return h?"yesterday":"tomorrow";m=[["an hour",3600],["a minute",60],["a second",1]];f=0;for(h=m.length;f<h;f++){i=
m[f];l=i[0];i=i[1];if(c>=i)break}c=b(c/i);return c===1?""+l+" "+j:""+c+" "+l.split(" ")[1]+"s "+j};BB.utils.guard("#overview",function(a){return a.children("ol").children("li").find(".commit").each(function(){var a,b,c,d,e,j;c=null;j=$(this).find("time").get().reverse();d=0;for(e=j.length;d<e;d++){a=j[d];a=$(a);b=a.attr("datetime");b===c?a.remove():c=b}})})}).call(this);
(function(a,b){b.Mustache={};var e={};b.Mustache.to_html=function(b,g){var f=e[b];if(!f){f=Mustache.compile(a("#"+b).html());e[b]=f}return f(g)};b.Mustache.clear=function(a){delete e[a]};Mustache.tags=["[[","]]"]})($,BB);
BB.utils.guard("#repo-dropdown-recent",function(a){var b=function(a){a.hasViewed=!!a.viewed.length;a.hasUpdated=!!a.updated.length;return BB.Mustache.to_html("repo-dropdown-template",a)};$.get(BB.api.toString("user","repositories","overview",{max:5}),function(e){(e.viewed.length||e.updated.length)&&a.replaceWith(b(e))})});$("#repo-create-cta").on("click",function(){BB.gaqPush(["atl._trackEvent","Header","Create call to action"])});
BB.utils.guard("#search-query",function(a){var b=a.autocomplete({minLength:3,source:"/xhr/repositories",extractTerms:function(a){var b=a.indexOf("/");return b>=0?[a.substr(0,b),a.substr(b+1)]:[a]},select:function(a,b){window.location="/"+b.item.value},focus:function(a){a.preventDefault()}});a.bind("autocompleteopen",function(){b.autocomplete("widget").find("img").each(function(a,b){$(b).addClass("repo-avatar size16")})})});
(function(){function a(a){a.animate({opacity:0},h,function(){a.remove()})}function b(){if(i){clearTimeout(i);i=null}}function e(d){b(d);i=setTimeout(function(){a($(d.target))},c)}function d(c){i=setTimeout(function(){a(c)},f);c.on("mouseover",b);c.on("mouseout",e)}var g=$("#aui-message-bar .aui-message.closeable"),f=4E3,c=1E3,h=200,i;g.length&&d(g);var j=AJS.messages.makeCloseable;AJS.messages.makeCloseable=function(a){var b=$(a).filter(".aui-message"),c=b.closest("#aui-message-bar, .disappearing-message");
b.length&&c.length&&d(b);j(a)};BB.messages={addMessage:function(a,b){sessionStorage&&sessionStorage.setItem("bb-messages",a+"|"+(b||"success"))},getMessage:function(){var a=null;if(sessionStorage){var b=sessionStorage.getItem("bb-messages");sessionStorage.removeItem("bb-messages");if(b){a=b.split("|");a={body:a[0],type:a[1]}}}return a}};$(function(){var a=BB.messages.getMessage(),b=$("#aui-message-bar").find(".aui-message");if(a){b.remove();AJS.messages[a.type]({body:$("<div>").text(a.body).html()})}else b.removeClass("hidden")})})();
(function(){function a(){setTimeout(function(){e=true},0);return e}function b(a,b,e){return function(c){var h=$(a);AJS.InlineDialog(c,b,function(a,c,d){var e=AJS.InlineDialog.current;h.appendTo(a).removeClass("hidden");d();setTimeout(function(){e&&e.id===b?AJS.InlineDialog.current.hide():h.find("input").trigger("select")},0)},e)}}var e=true;BB.utils.guard("#repo-clone-button",b("#repo-clone-dialog","repo-clone-dialog",{width:360,preHideCallback:a}));BB.utils.guard("#clone-wiki",b("#wiki-clone-dialog",
"clone-wiki-dialog",{preHideCallback:a}));$(function(){$(".clone-url").each(function(a,b){var f=$(b),c=f.find(".aui-dropdown2-trigger"),h=f.find("input"),i=function(a){c.attr("href",a.attr("href"));c.find(".dropdown-text").text(a.text());h.val(a.attr("data-command"));a.hasClass("ssh")?f.addClass("ssh"):f.removeClass("ssh")};f.find("a.item-link").click(function(a){a.preventDefault();i($(this));h.select();e=false});BB.user.isSshEnabled&&i(f.find("a.item-link.ssh"));h.focus(function(){var a=$(this);
a.one("mouseup",function(a){a.preventDefault()});a.select()})})});BB.utils.guard("#repo-content",function(){$(".clone-in-sourcetree").each(function(a,b){var e=$(b),c=e.attr("data-https-url"),h=e.attr("data-ssh-url");e.find("a.hide").click(function(a){a.preventDefault();$.ajax({type:"DELETE",url:BB.api.toString("feature-help","clone-in-sourcetree")});e.hide()});e.find("button").click(function(){window.location.href="sourcetree://cloneRepo/"+(BB.user.isSshEnabled?h:c)})})})})();
BB.utils.guard("#header",function(){if(BB.user.isAuthenticated){var a=$("#account-warning");$.ajax({cache:false,type:"GET",url:"/account/xhr/header_information/",success:function(b){var e=$("#account-admin-links"),d=$("#inbox-unread-count");$("#header-messages");_.each(b.teams,function(a){a=$.extend({baseUrl:BB.baseUrl},a);e.find("ul").append($('<li><a href="{baseUrl}/{username!esc}" class="aui-icon-container"><img src="{avatar!esc}" alt="" width="16" height="16">{display_name!esc}</a> </li>'.format(a)))});
if(b.teams.length!=0){e.show();b.teams.unshift({username:BB.user.username,display_name:BB.user.displayName,avatar:BB.user.avatarUrl,privilege:"admin"});$(document).trigger("teams-loaded",{teams:b.teams})}var g=$("#plan-upgrade").length;if(b.global_too_many_users.length&&!g){var g=b.global_too_many_users[0],f="Congratulations, your team is growing! It's time to upgrade.";g!=BB.user.username&&(f="It's time for {!esc} to upgrade to the next user level.".format(g));f=f+' Committers will have read-only access. <a href="{}/account/user/{!esc}/plan-upgrade/">Upgrade now.</a>'.format(BB.baseUrl,
g);a.addClass("has-message");a.find(".message").html(f)}BB.utils.exists("#repo-warning",function(a){if(b.pending_transfers.hasOwnProperty(BB.repo.id)){var d=BB.Mustache.to_html("repo-warning-template",{username:b.pending_transfers[BB.repo.id]});a.find(".message").html(d);a.slideDown(200)}});if(BB.repo.readonly){g=$("#repo-warning");g.find(".message").html("This repository is in <strong>read-only</strong> mode. You caught us doing some quick maintenance.");g.slideDown(200)}d.text("("+b.unread_notifications+
")")},error:function(){},complete:function(){a.hasClass("has-message")&&a.slideDown(200)}})}});
(function(a,b){function e(a){return function(b,d,e,f){var e=d.target,b=e.offset(),g=parseInt(e.css("padding-left"),10)+parseInt(e.css("padding-right"),10),g=e.width()+g,e=b.left+g/2,d=b.top+d.target.outerHeight()+f.offsetY,f=a(b,g,f);return{displayAbove:false,popupCss:{top:d,left:f,right:"auto"},arrowCss:{position:"absolute",left:e-f-8,right:"auto"}}}}var d=b.BB;d.dialog={};a(document).on("keydown",".aui-dialog .button-panel-button, .aui-dialog .button-panel-link",function(b){b.keyCode===13&&a(this).click()});
var g=d.dialog.FormDialog=function(b,d){d=d||{};typeof d=="function"&&(d={onUpdateContents:d});(this.useLiveEvents=!!d.useLiveEvents)?this.trigger=b:this.$trigger_=a(b);this.onUpdateContents_=d.onUpdateContents;this.template_=d.template;this.templateData_=d.templateData;this.timeout_=this.boundClick_=null;this.success=d.success;this.complete=d.complete;this.error=d.error;this.onSubmit=d.submit;this.isStaticContent=!!d.isStaticContent;var e=d.width||600,f=d.height||"auto",g;g=this.useLiveEvents?d.id:
d.id||this.$trigger_.attr("id");this.$dialog_=new AJS.Dialog({width:e,height:f,id:"bb-"+g+"-dialog"});this.$dialog_.addPanel("main");this.$element_=this.$dialog_.popup.element;this.$errorContainer_=this.$element_.find(".error-container")},f=g.prototype;f.bind=function(){this.boundClick_=this.open.bind(this);if(this.useLiveEvents){var b=a("body");b.off("click.disabled",this.trigger);b.on("click.formdialog",this.trigger,this.boundClick_)}else this.$trigger_.unbind("click.disabled").click(this.boundClick_);
return this};f.unbind=function(){if(this.boundClick_){this.useLiveEvents?a("body").off("click.formdialog",this.trigger,this.boundClick_):this.$trigger_.unbind("click",this.boundClick_);this.boundClick_=null}return this};f.disable=function(){this.unbind();var b=function(a){a.preventDefault()};if(this.useLiveEvents)a("body").on("click.disabled",this.trigger,b());else this.$trigger_.bind("click.disabled",b)};f.open=function(b){b.preventDefault();if(this.useLiveEvents){if(a(this.trigger).attr("aria-disabled"))return}else if(this.$trigger_.attr("aria-disabled"))return;
if(!this.$dialog_.initialized||!this.isStaticContent){var e=this.useLiveEvents?a(b.target):this.$trigger_;e.addClass("loading");if(this.template_){b=typeof this.templateData_==="function"?this.templateData_():this.templateData_;this.open_(d.Mustache.to_html(this.template_,b||{}),e)}else a.get(e.attr("href"),this.open_.bind(this))}else this.$dialog_.show();this.clearErrors()};f.open_=function(a,d){typeof a==="string"&&(a={html:a});this.useLiveEvents?d.removeClass("loading"):this.$trigger_.removeClass("loading");
if(a.redirect)b.location=a.redirect;else{this.updateContents(a.html,d);this.$dialog_.initialized=true;this.$dialog_.show()}};f.updateContents=function(a,b){this.$dialog_.getCurrentPanel().html(a);this.$form_=this.$element_.find("form");this.$form_.find(".submit").hide();this.$originalSubmit_=this.$form_.find("input[type=submit]");this.$form_.find("input").keypress(this.submitOnEnter.bind(this));this.$element_.find(".dialog-button-panel").empty();this.$dialog_.addHeader(this.$form_.attr("title")||
this.$form_.attr("data-title")).addButton(this.$originalSubmit_.attr("value")||"Submit",this.submit.bind(this),"aui-button aui-style").addCancel("Cancel",function(a){a.hide()});var d=this.$originalSubmit_.attr("value");this.$submit_=this.$element_.find(".dialog-button-panel").find('button:contains("'+d+'")');this.$errorContainer_=this.$element_.find(".error-container");if(this.onUpdateContents_)this.onUpdateContents_(this.$dialog_,b)};f.submitOnEnter=function(a){if(a.type==="keypress"&&a.keyCode===
13){a.preventDefault();this.submit()}};f.submit=function(){var b=this.$submit_;this.clearErrors();this.timeout_=setTimeout(function(){b.addClass("loading")},300);b.attr("aria-disabled",true).addClass("disabled");if(this.onSubmit)this.onSubmit(this.$form_);else a.ajax({type:this.$form_.attr("method")||"POST",url:this.$form_.attr("action"),data:this.$form_.serialize(),contentType:"text/json",success:this.submit_.bind(this),error:this.error_.bind(this)})};f.complete_=function(){clearTimeout(this.timeout_);
this.$dialog_.enable();this.$submit_.attr("aria-disabled",false).removeClass("loading disabled")};f.submit_=function(a){typeof a==="string"&&(a={html:a});if(a.success)if(a.redirect)b.location=a.redirect;else{if(this.success){this.success(this.$element,a);this.complete?this.complete():this.complete_()}}else if(a.html){this.updateContents(a.html);this.complete?this.complete():this.complete_()}else if(this.success){this.success(this.$element,a);this.complete?this.complete():this.complete_()}};f.error_=
function(a){this.error&&this.error(this.$element,a);this.complete_()};f.close=function(){this.$dialog_.hide()};f.remove=function(){this.$dialog_.remove()};f.displayError=function(a){this.clearErrors();AJS.messages.error(this.$errorContainer_,a)};f.clearErrors=function(){this.$errorContainer_.empty()};g.prototype=f;d.inlineDialog={};d.inlineDialog.alignRight=function(){return e(function(a,b,d){return a.left+b-d.width})};d.inlineDialog.alignLeft=function(){return e(function(a,b,d){return a.left+d.offsetX})};
d.inlineDialog.alignTo=function(a){return e(a)}})(jQuery,this);
BB.filter=function(a,b,e){var e=$.extend({delay:200},e),d={};return function(g){function f(){a.toggleClass("empty",!d.$items.filter(":visible").length)}function c(){function a(c,d){return $(d).text().match(b)}var b,c=/[-[\]{}()*+?.,\\^$|#\s]/g;if(h.val()==i){if(j.length===1)b=RegExp(j[0].replace(c,"\\$&"),"i");else{c=j[0].replace(c,"\\$&")+".*/.*"+j[1].replace(c,"\\$&");b=RegExp(c,"i")}d.$items.addClass("hidden");d.$items.filter(a).removeClass("hidden");f()}}var h=$(g.target),i=h.val(),j=i.split("/");
j.length===1&&/\s+/.test(i)&&(j=i.split(/\s+/));j=$.map(j,$.trim);d.$items=d.$items||a.find(b);if(d.val===i)f();else{d.val=i;setTimeout(c,e.delay)}}};
BB.utils.ready(".repo-filter-widget",function(a){function b(a){a=a.pageY-f.offset().top-15;a<j&&(a=j);var b=a,b=b&&b>0?Math.round(b):null;localStorage&&localStorage.setItem(h,b);return f.height(a)}function e(a){$(document).unbind(a).unbind("mousemove",b)}function d(a){$(document).bind("mousemove",b).bind("mouseup",e);a.preventDefault()}var g=a.find(".filter-box"),f=a.find(".filter-list"),c=localStorage&&localStorage.getItem("bb-repo-filter-selected-tab"),h="bb-dashboard-repo-filter-height",i=localStorage&&
localStorage.getItem(h),j=55;g.bind("keyup input propertychange",BB.filter(a,".repo"));a.find(".filter-tabs li.menu-item a").click(function(a){var b=$(a.target).closest("a"),c=b.closest("div.filter-tabs"),d=b.attr("href").substring(1);a.preventDefault();c.find("li.active-tab").removeClass("active-tab");b.closest("li").addClass("active-tab");b.closest(".repo-filter-widget").find(".filter-list").removeClass("all following mine teams").addClass(d);localStorage&&localStorage.setItem("bb-repo-filter-selected-tab",
d);g.val()&&g.val()!==g.attr("placeholder")&&g.trigger("input")});c&&a.find(".filter-tabs a."+c).click();BB.utils.exists("#dashboard",function(){a.find("div.handle").on("mousedown",d);i&&f.height(i)});g.val()&&g.trigger("input")});
BB.utils.ready(".ad-banner.ad",function(a){a.find(".view").on("click",function(a){a=$(a.target).parent(".ad-banner").data("analytics");BB.gaqPush(["atl._trackEvent","Advertisement",a+" - view"])});a.find(".close").on("click",function(){var b=a.data("analytics"),e=a.data("ad");bitbucket.user(BB.user.username).remove_ad(e,{});a.addClass("hidden");BB.gaqPush(["atl._trackEvent","Advertisement",b+"- hide"])})});
BB.utils.ready(".ad-banner.feature",function(a){a.find(".view").on("click",function(){BB.gaqPush(["atl._trackEvent","Advertisement","new-feature-banner - view"])});a.find(".tweet").on("click",function(){BB.gaqPush(["atl._trackEvent","Advertisement","new-feature-banner - tweet"])});a.find(".close").on("click",function(){var b=a.data("featureid");bitbucket.user(BB.user.username).feature_viewed(b,{});a.addClass("hidden");BB.gaqPush(["atl._trackEvent","Feature","new-feature-banner- hide"])})});
BB.utils.ready("#signup-banner",function(a){a.find(".signup-button").on("click",function(){BB.gaqPush(["atl._trackEvent","Signup","Logged out banner clicked"])});a.find(".close").on("click",function(){$.cookie("bb.hide-signup-banner",true);a.remove();BB.gaqPush(["atl._trackEvent","Signup","Logged out banner dismissed"])})});
BB.utils.ready(".branch-dialog-trigger",function(a){function b(a,b){return a.mainbranch&&!b.mainbranch?-1:!a.mainbranch&&b.mainbranch||a.name>b.name?1:a.name<b.name?-1:0}AJS.InlineDialog(a,"branch-dialog",function(e,d,g){if(!e.find(".branch-dialog").length){e.addClass("loading");var f=function(a){$.each(a,function(b,d){a[b].safeName=encodeURIComponent(d.name);if(d.heads&&d.heads.length>1)a[b].hasMultipleHeads=true;a[b].hasMultipleHeads&&$.each(d.heads,function(d,e){a[b].heads[d]={changeset:e,shortChangeset:e.slice(0,
7)}})});return a};$.getJSON(a.data("branches-tags-url")).success(function(c){c.branches=f(c.branches);c.branches.sort(b);if(a.data("ignoreTags"))c.ignoreTags=true;else{c.tags=f(c.tags);c.ignoreTags=false}BB.Mustache.clear("branch-dialog-template");e.removeClass("loading").html(BB.Mustache.to_html("branch-dialog-template",c));BB.tabbedFilter(e)}).error(function(){e.removeClass("loading").html("<p>Could not load branches and tags</p>")})}g&&g();setTimeout(function(){e.find("input.filter-box").focus()},
0)},{getArrowAttributes:function(){return{fill:"#f5f5f5",stroke:"#bbb"}}})});
BB.ChangesetSelector=function(a,b,e){function d(){if(!l&&!m){l=true;q.addClass("loading");$.ajax({url:i.toString()+c,data:{page:j},success:function(a){if(a.length){for(var b=0,c=a.length;b<c;b++){var d=a[b],e=d.author;d.selected=h&&(h.startsWith(d.node)||d.node.startsWith(h));if(e.username)e.display_name=e.isTeam&&e.first_name?e.first_name:!e.isTeam&&e.first_name?e.first_name+" "+e.last_name:e.username;d=$("<li></li>").html(BB.Mustache.to_html("source-changeset",d));p.before(d);j++}q.removeClass("loading");
BB.localize()}else{m=true;q.removeClass("loading");q.append($('<li class="end">No more commits</li>'))}},error:function(a,b){var c;c=w[a.status]?w[a.status]:b;n.hide();q.remove();q=null;AJS.messages.error({body:"{!esc}".format(c)})},complete:function(){l=false}})}}function g(a,b,c){if(!q||!q.length){q=$("<ul></ul>").addClass("file-history-widget");p=$("<li></li>").addClass("loading-item");q.append(p);a.append(q);d();q.scroll(function(){q[0].scrollHeight-q.scrollTop()<=q.outerHeight()&&d()});q.on("click",
"a",function(a){if(e.onSelect){var b=$(a.target).closest("a"),c=b.attr("data-hash"),d=h;a.preventDefault();if(b.hasClass("highlight"))return;h=c;if(e.onSelect(b)){a={hash:c.substring(0,7),utctimestamp:b.find("time").attr("datetime"),avatar:b.find("img").attr("src"),display_name:b.find("author").text()};q.find(".highlight").removeClass("highlight");b.addClass("highlight");f.html($(BB.Mustache.to_html("source-changeset-trigger",a)));BB.localize()}else h=d}n.hide()})}c&&c()}var f=$(a),a=f.data("changeset"),
c=f.data("path"),h=f.data("current"),i=BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"filehistory",a),j=0,l=false,m=false,n,q,p,w={500:"An error occurred while processing your request.",404:"Unable to find changesets for this file."},e=e||{};return{init:function(){n=AJS.InlineDialog(f,b,g)},getSelectedChangeset:function(){return h}}};
BB.utils.ready(".user-select",function(a){$('<style type="text/css">').appendTo("head");a.find("select option").each(function(){var a=$(this).val(),e="background-image: url("+$(this).data("avatar")+") !important;",d=document.styleSheets[document.styleSheets.length-1];_.each(['.user-select .chzn-container span[data-value="'+a+'"]:before','.user-select .chzn-container li[data-value="'+a+'"]:before'],function(a){d.insertRule?d.insertRule(a+"{"+e+"}",d.cssRules.length):d.addRule(a,e)})})});
(function(a){var b=[],e={};BB.whenIType=function(d,g,f,c){var h,i,j,l=function(b){var b=a(b),c=b.attr("title")||"",e=d.slice(0);if(b.data("kbShortcutAppended")){var f=c,f=f.replace(/\)$/," OR "),f=f+("'"+e.shift()+"'"),g=a("#keyThen").val()||"then";a.each(e,function(){f=f+(" "+g+" '"+this+"'")});f=f+" )";b.attr({title:f})}else{var h=a("#keyType").val()||"type",i=a("#keyThen").val()||"then",c=c+(c?" ":""),c=c+("( "+h+" '"+e.shift()+"'");a.each(e,function(){c=c+(" "+i+" '"+this+"'")});c=c+" )";b.attr({title:c});
b.data("kbShortcutAppended",true)}},m=function(b){var d;a:{for(d=b.length;d--;)if(b[d].length>1&&b[d]!=="space"){d=true;break a}d=false}a(document).bind(d?"keydown":"keypress",b,function(b){if(h&&(c||!BB.whenIType.disabled&&!a("#keyboard-shortcut-container").is(":visible")))if(!i||a(i).is(":visible")){h(b);b.preventDefault()}})};f||(f="Application");if(!Object.hasOwnProperty.call(e,f)){b.push(f);e[f]=[]}var n={keys:[d],desc:g};e[f].push(n);m(d);return{or:function(a){n.keys.push(a);m(a);return this},
moveToNextItem:function(b,c,d){h=function(){a(".aui-dialog:visible").length>0&&(b=".aui-dialog:visible "+b);var e,f=a(b),g=a(b).filter(".focused");if(!h.blurHandler)a(document).one("keydown",function(b){if(b.keyCode===a.ui.keyCode.ESCAPE&&g){g.removeClass("focused");g.find("a:first").blur()}});if(g.length===0)g=a(b).eq(0);else{g.removeClass("focused");e=a.inArray(g.get(0),f);if(e<f.length-1)g=f.eq(e+1);else if(c&&c())d();else{g.removeClass("focused");g=a(b).eq(0)}}if(g&&g.length>0){g.addClass("focused");
g.moveTo();g.find("a:first").focus()}}},moveToPrevItem:function(b,c,d){h=function(){a(".aui-dialog:visible").length>0&&(b=".aui-dialog:visible "+b);var e,f=a(b),g=a(b).filter(".focused");if(!h.blurHandler)a(document).one("keydown",function(b){if(b.keyCode===a.ui.keyCode.ESCAPE&&g){g.removeClass("focused");g.find("a:first").blur()}});if(g.length===0)g=a(b).last();else{g.removeClass("focused");e=a.inArray(g.get(0),f);if(e>0)g=f.eq(e-1);else if(c&&c())d();else{g.removeClass("focused");g=a(b).last()}}if(g&&
g.length>0){g.addClass("focused");g.moveTo();g.find("a:first").focus()}}},click:function(b){l(b);h=function(){a(b).trigger("click")}},goTo:function(a){h=function(){window.location.href=a}},followLink:function(b){l(b);h=function(){var c=a(b)[0];if(c&&c.nodeName.toLowerCase()==="a")window.location.href=c.href}},execute:function(a){h=a},moveToAndClick:function(b){l(b);h=function(){a(b).click().moveTo()}},moveToAndFocus:function(b){l(b);h=function(){a(b).focus().moveTo()}},focus:function(b){l(b);h=function(){a(b).focus()}},
displayHelp:function(){h=function(){var c=j;if(c){j&&j.hide().remove();j=null}else{c=j=new AJS.Dialog({width:800,height:"auto",id:"bb-keyboard-shortcuts-dialog"});c.addPanel("main").addHeader("Keyboard shortcuts").addCancel("Close",function(){j&&j.hide().remove();j=null});var d=a('<section id="keyboard-shortcuts" class="aui-group"></div>'),f=a('<div class="aui-item"></div>').appendTo(d),g=a('<div class=aui-item"></div>').appendTo(d),h=1;_.each(b,function(b){var c="";_.each(e[b],function(b){if(!b.guard||
a(b.guard).is(":visible")){c=c+("<dt>"+b.desc+"</dt>");c=c+"<dd>";c=c+_.map(b.keys,function(a){return"<kbd>"+a.join("</kbd> then <kbd>")+"</kbd>"}).join(" or ");c=c+"</dd>"}});if(c){h++;var d=a('<div class="keyboard-shortcut-context"></div>');d.append('<h3 class="context-title">'+b+"</h3>");a("<dl></dl>").append(c).appendTo(d);(h%2?g:f).append(d)}});c.getCurrentPanel().html(d);c.show()}}},dismiss:function(){h=function(){a("#keyboard-shortcut-container").remove()}},guard:function(a){i=a;n.guard=a}}};
BB.whenIType.fromJSON=function(a){_.each(a,function(a){var b=a.section;_.each(a.shortcuts,function(a){var d=a.op,e=a.params||[],g=a.guard,l=BB.whenIType(a.keys,a.description,b,a.always);l[d].apply(null,e);g&&l.guard(g);a.aliasKeys&&l.or(a.aliasKeys)})})}})(jQuery);
jQuery(function(a){a(document).bind("keydown",function(a){a.keyCode===27&&/^(input|select|textarea)$/i.test(a.target.nodeName)&&a.target.blur()});a(document).bind("iframeAppended",function(b,e){a(e).load(function(){a(e).contents().bind("keyup keydown keypress",function(b){a.browser.safari&&b.type==="keypress"||/^(input|select|textarea)$/i.test(b.target.nodeName)||a(document).trigger(b)})})})});
jQuery(function(a){if(BB.user.isKbdShortcutsEnabled){var b=function(){return a("a.next-page, a.prev-page").length},e=[{section:"Global navigation",shortcuts:[{keys:["g","d"],description:"Go to dashboard",op:"followLink",params:["#logo-link"]},{keys:["g","a"],description:"Go to account settings",op:"followLink",params:["#account-link"],guard:"#user-dropdown-trigger"},{keys:["g","i"],description:"Go to inbox",op:"followLink",params:["#inbox-link"],guard:"#user-dropdown-trigger"},{keys:["/"],description:"Focus the site search",
op:"focus",params:["#search-query"]}]},{section:"Global actions",shortcuts:[{keys:["c","r"],description:"Create a repository",op:"followLink",params:["#create-repo-link"],guard:"#repositories-dropdown-trigger"},{keys:["i","r"],description:"Import a repository",op:"followLink",params:["#import-repo-link"],guard:"#repositories-dropdown-trigger"}]},{section:"Repository navigation",shortcuts:[{keys:["r","o"],description:"Repository overview",guard:"#repo-overview-link",op:"followLink",params:["#repo-overview-link"]},
{keys:["r","s"],description:"Repository source",guard:"#repo-source-link",op:"followLink",params:["#repo-source-link"]},{keys:["r","c"],description:"Repository commits",guard:"#repo-commits-link",op:"followLink",params:["#repo-commits-link"]},{keys:["r","p"],description:"Repository pull requests",guard:"#repo-pullrequests-link",op:"followLink",params:["#repo-pullrequests-link"]},{keys:["r","w"],description:"Repository wiki",guard:"#repo-wiki-link",op:"followLink",params:["#repo-wiki-link"]},{keys:["r",
"i"],description:"Repository issues",guard:"#repo-issues-link",op:"followLink",params:["#repo-issues-link"]},{keys:["r","d"],description:"Repository downloads",guard:"#repo-downloads-link",op:"followLink",params:["#repo-downloads-link"]},{keys:["r","a"],description:"Repository administration",guard:"#repo-admin-link",op:"followLink",params:["#repo-admin-link"]}]},{section:"Repository actions",shortcuts:[{keys:["x","f"],description:"Fork repository",guard:"#fork-button",op:"followLink",params:["#fork-button"]},
{keys:["x","c"],description:"Compare repository",guard:"#compare-button",op:"followLink",params:["#compare-button"]},{keys:["x","p"],description:"Create pull request",guard:"#pull-request-button",op:"followLink",params:["#pull-request-button"]},{keys:["x","i"],description:"Invite to repository",guard:"#repo-invite-link",op:"click",params:["#repo-invite-link"]},{keys:["x","w"],description:"Follow repository",guard:"#repo-follow",op:"click",params:["#repo-follow"]},{keys:["f"],description:"Search for file",
op:"execute",params:[function(){BB.FileSearchDialog.show()}]}]},{section:"List navigation",shortcuts:[{keys:["j"],description:"Select next item",guard:".iterable-item:visible",op:"moveToNextItem",params:[".iterable-item:visible",b,function(){var b=a("a.next-page");if(b.attr("href")){window.store.set("focusFirst",true);BB.whenIType.disabled=true;a.support.pjax&&b.data("bb-pjax-enabled")?b.click():window.location=b.attr("href")}}]},{keys:["k"],description:"Select previous item",guard:".iterable-item:visible",
op:"moveToPrevItem",params:[".iterable-item:visible",b,function(){var b=a("a.prev-page");if(b.attr("href")){window.store.set("focusLast",true);BB.whenIType.disabled=true;a.support.pjax&&b.data("bb-pjax-enabled")?b.click():window.location=b.attr("href")}}]},{keys:["return"],aliasKeys:["o"],description:"View selected item",guard:".iterable-item:visible",op:"execute",params:[function(){var b=a(".iterable-item.focused  a.execute:visible").first();if(b.length){var d=b.attr("href");if(!b.data("add-to-stack")){var c=
window.store.get("lastFocusedIdArray")||[];c.push({id:d});window.store.set("lastFocusedIdArray",c);window.store.set("leaveFocusedUniqueId",true)}b.hasClass("click")||a.support.pjax&&b.data("bb-pjax-enabled")?b.click():window.location.href=d}}]}]},{section:"Application",shortcuts:[{keys:["?"],description:"Display this help",op:"displayHelp",always:true},{keys:["esc"],description:"Dismiss dialog or remove focus",op:"dismiss",always:true},{keys:["u"],description:"Back up",op:"execute",params:[function(){window.store.set("leaveFocusedUniqueId",
true);window.history.back()}]}]},{section:"Commits / pull requests",shortcuts:[{keys:["t","c"],description:"Toggle display of inline comments",guard:"#changeset-diff",op:"execute",params:[function(){var b=a("#changeset-diff");b.find(".comment-thread-container").addClass("existing-comment");b.toggleClass("hide-comments")}]},{keys:["p","d"],description:"Switch to the pull request diff tab",guard:"#pr-menu-diff",op:"execute",params:[function(){a(window).scrollTo("#pr-menu-diff",500,{axis:"y",offset:-50});
a("#pr-menu-diff").click()}]},{keys:["p","c"],description:"Switch to the pull request commits tab",guard:"#pr-menu-commits",op:"execute",params:[function(){a(window).scrollTo("#pr-menu-commits",500,{axis:"y",offset:-50});a("#pr-menu-commits").click()}]},{keys:["p","a"],description:"Switch to the pull request activity tab",guard:"#pr-menu-activity",op:"execute",params:[function(){a(window).scrollTo("#pr-menu-activity",500,{axis:"y",offset:-50});a("#pr-menu-activity").click()}]}]}];BB.utils.exists("#command-bar",
function(){_.each(e,function(a){a.section==="Global navigation"&&a.shortcuts.push({keys:["."],description:"Open the command bar",op:"execute",params:[function(){BB.commandBar.show()}]})})});BB.whenIType.fromJSON(e);b=function(){var b=null;if(window.store.get("focusLast")){b=a(".iterable-item:visible").last();window.store.remove("focusLast");BB.whenIType.disabled=false}else if(window.store.get("focusFirst")){b=a(".iterable-item:visible").first();window.store.remove("focusFirst");BB.whenIType.disabled=
false}else{var d=window.store.get("lastFocusedIdArray");if(d)for(;d.length;){var c=d.pop(),b=a('.iterable a[href="'+c.id+'"]:visible').closest(".iterable-item");if(b.length){window.store.set("lastFocusedIdArray",d);window.store.remove("leaveFocusedUniqueId");BB.whenIType.disabled=false;break}}}if(b&&b.length){b.addClass("focused");b.find("a").first().focus();a(document).one("keydown",function(c){if(c.keyCode===a.ui.keyCode.ESCAPE){b.removeClass("focused");b.find("a").first().blur()}})}};BB.initialize.register(b);
a(document).bind("bb:compare",b);var d=window.onbeforeunload;window.onbeforeunload=function(a){window.store.get("leaveFocusedUniqueId")||window.store.remove("lastFocusedIdArray");window.store.remove("leaveFocusedUniqueId");if(typeof d==="function")return d(a)}}});BB.quickFilter=function(a,b){var b=$.extend({delay:200},b),e=a.find("input.filter-box");e.bind("keyup input propertychange",BB.filter(a,".filter-item a",b));e.val()&&e.trigger("input")};
BB.tabbedFilter=function(a){a.find(".filter-tabs li.menu-item a").click(function(a){var e=$(a.target).closest("a"),d=e.closest("div.tabbed-filter-widget"),g=e.closest("div.filter-tabs"),f=d.find("input.filter-box"),c=e.attr("href").substring(1),c=d.find("#"+c),h=c.data("filter-placeholder");a.preventDefault();g.find("li.active-tab").removeClass("active-tab");e.closest("li").addClass("active-tab");d.find(".tab-pane.active-pane").removeClass("active-pane");c.addClass("active-pane");f.attr("placeholder",
h);f.val()&&f.val()!==f.attr("placeholder")&&f.trigger("input")});BB.quickFilter(a)};
(function(){function a(a,b,g){this.$src=a;this.$dst=b;this.echo=g;this.handler=function(){this.$dst.val(this.val())}.bind(this);this.onblur=function(){this.$dst.val()!==this.val()&&this.unbindAll()}.bind(this);this.bindAll()}BB.widgets={};a.prototype.bindAll=function(){this.$src.bind("keyup change",this.handler);this.$dst.bind("blur",this.onblur)};a.prototype.unbindAll=function(){this.$src.unbind("keyup change",this.handler);this.$dst.unbind("blur",this.onblur)};a.prototype.val=function(){return this.echo.apply(this,
_.map(this.$src,function(a){return $(a).val()}))};BB.widgets.CalculatedInput=a;var b={initialUsers:[],initialAdmins:[],allowAddSelf:true,allowDeleteSelf:false,allowRevokeSelfAdmin:false,allowInvitations:false};BB.widgets.user=function(a,d){var g,f,c,h;function i(){var b=_.keys(v);p.val(b);w.val(_.filter(b,function(a){return v[a]}));var c=_.keys(s);n.val(c);q.val(_.filter(c,function(a){return s[a]}));b=!(!c.length&&!b.length);c=!(!w.val().length&&!q.val().length);a.toggleClass("non-empty",b).trigger("change:members",
[b,c])}var d=$.extend(b,d),j,l,m,n,q,p,w,r,x,t,s,v,o;j=a.find(".error");l=d.userInput||a.find(".user-input");m=d.userList||a.find("table.widget");n=d.userField||a.find(".user-field");q=d.adminUsersField||a.find(".admin-users-field");w=d.adminInvitationsField||a.find(".admin-invitations-field");d.allowInvitations&&(p=d.invitationField||a.find(".email-field"));r=d.addUserButton||a.find("button.add-user");t=function(a){return j.text(a).show()};o=!(d.initialAdmins&&d.initialAdmins.length);s={};v={};x=
function(b,c,f){var g,f=!!f;if(d.allowInvitations&&typeof b==="string"){g=$(BB.Mustache.to_html("team-member-template",{isRegistered:false,isAdmin:f,email:b}));m.append(g);v[b]=f;a.trigger("bb:userwidget.invite-added",b)}else{var h=b.username;if(!b.display_name)b.display_name=b.first_name&&b.last_name?"{first_name} {last_name}".format(b):h;b.isRegistered=true;b.isAdmin=f;b.isCheckboxDisabled=!d.allowRevokeSelfAdmin&&h===BB.user.username;g=$(BB.Mustache.to_html("team-member-template",b));!d.allowDeleteSelf&&
h===BB.user.username&&g.find('a[href="#delete"]').remove();m.append(g);s[h]=f;a.trigger("bb:userwidget.user-added",b)}if(c){j.hide().text("");l.val("").focus()}i()};l.hasClass("bb-user-typeahead")||l.autocomplete({minLength:3,source:"/xhr/users"});g=BB.utils.csvToArray(n.val());f=[];c=BB.utils.csvToArray(q.val());h=BB.utils.csvToArray(w.val());d.allowInvitations&&(f=BB.utils.csvToArray(p.val()));f.length||g.length?bitbucket.users({user:g},{error:function(){return alert("An unexpected error occurred!")},
success:function(a){_.each(g,function(b){x(a[b],false,_.contains(c,b))});_.each(f,function(a){x(a,false,_.contains(h,a))})}}):d.initialUsers.length?_.each(d.initialUsers,function(a){x(a,false,_.contains(d.initialAdmins,a.username))}):i();l.keypress(function(a){if(a.keyCode===13){r.click();a.preventDefault()}});var y;r.click(function(a){a.preventDefault();l.autocomplete("close");var b=l.val().trim();if(b){var c=$(a.target);if(!c.is(":disabled")){c.prop({disabled:true});y=BB.delay(300,function(){l.addClass("loading")});
return bitbucket.user(b).details({complete:function(){c.prop({disabled:false});clearTimeout(y);l.removeClass("loading")},error:function(a){if(a.status!==404)return t("An unexpected error occurred.");if(!d.allowInvitations||!BB.valid.email(b))return t("No user named \u201c{}\u201d.".format(b));if(Object.prototype.hasOwnProperty.call(v,b))return t("{} is already a member.".format(b));x(b,true,o);o=false},success:function(a){if(Object.prototype.hasOwnProperty.call(s,a.username))return t("{username} is already a member.".format(a));
if(!d.allowAddSelf&&a.username===BB.user.username)return t("You cannot add yourself as a member.");x(a,true,o);o=false}})}}});a.bind("adduser.user-widget",function(a,b){var c=b.user;Object.prototype.hasOwnProperty.call(s,c.username)?b.errorOnDuplicate&&t("{username} is already a member.".format(c)):x(c)});a.on("change","input[name=is-admin]",function(a){var b=$(a.target),a=b.closest("tr"),b=b.prop("checked");a.hasClass("registered-user")?s[a.data("username")]=b:v[a.data("email-address")]=b;i()});
m.delegate('a[href="#delete"]',"click",function(a){a.preventDefault();a=$(this).closest("tr");if(a.hasClass("registered-user")){var b=a.data("username");delete s[b]}else{b=a.data("email-address");delete v[b]}i();o=_.isEmpty(s)&&_.isEmpty(v);return a.remove()})}})();BB.utils.guard("#repo-search-nav",function(a){BB.utils.chosen(a,{allow_single_deselect:true})});
BB.utils.guard("#search-language-trigger",function(a){var b=a.closest("li"),e=b.find("select");a.on("click",function(a){a.preventDefault();e.trigger("liszt:updated");b.addClass("has-value")});e.on("change",function(a){a=$(a.target).val();$("#search-language").val(a);$("#repo-search-form").submit()})});
BB.utils.guard("#repo-search-form",function(a){a.on("submit",function(a){a=$(a.target).find("#search-language");a.val()||a.remove()});a=$("#search-query-input")[0];a.focus();a.setSelectionRange(a.selectionEnd,a.selectionEnd)});
$(function(){var a=function(a,e,d){var g=function(){document.location.reload()},f=function(a){var b=this,a=BB.utils.processFormErrors(a.responseText);$.each(a,function(a,c){var d=b.find('[name="'+a+'"]');if(d.length!==0){var e=$("<div>").text(c).addClass("error");d.after(e)}});b.find("button:submit").attr("aria-disabled",false).removeClass("disabled")},c=function(){var a=e.closest(".aui-popup");a.find(".error").remove();var b={key:a.find("#id_key").val(),label:a.find("#id_label").val()};a.find("button:submit").attr("aria-disabled",
true).addClass("disabled");d(b,{error:f.bind(a),success:g})},h=e.find("button:submit"),i=e.find("h1"),j=new AJS.Dialog({width:800,height:"auto",id:a}),l;j.addPanel("main");l=j.getCurrentPanel().body;l.append(e);j.addHeader(i.text()).addButton(h.text(),c,"aui-button aui-style").addCancel("Cancel",function(a){a.hide()});e.submit(function(a){a.preventDefault();c()});e.removeClass("hidden");i.remove();return{show:function(){l.find(".error").remove();j.show()},hide:function(){j.hide()},updateForm:function(a){if(a){l.find("#ssh_pk").val(a.pk);
l.find("#id_label").val(a.label);l.find("#id_key").val(a.key)}else{l.find("#ssh_pk").val("");l.find("#id_label").val("");l.find("#id_key").val("")}}}};BB.SSHKeys=function(b,e){var d=e.onEdit,g=e.onCreate,f=e.onDelete,c=$("#edit-ssh-key"),h=$("#new-ssh-key"),i=b.find("table.widget"),j=a("bb-edit-ssh-key-dialog",c,d);$(".edit-link").click(function(a){a.preventDefault();a=$(a.target).closest(".ssh-key").data();j.updateForm(a);j.show()});var l=a("bb-new-ssh-key-dialog",h,g);l.updateForm();$("#add-key").click(function(){l.show()});
b.delegate('a[href="#delete"]',"click",function(a){a.preventDefault();var b=$(this).closest("tr"),a=b.data().pk;f(a,{success:function(){b.remove();i.find("tbody tr").length||i.find("tbody").html("<tr><td>There are no keys configured</td><td></td></tr>")},error:function(){alert("There was an error communicating with the server, please try again.")}})});$(".ssh-key-copy-help."+$.client.os.toLowerCase()).show()}});
BB.InviteDialog=function(a,b,e,d){var d=d||{},g=a.find('input[type="email"]'),f,c=new AJS.Dialog({width:480,height:"auto",id:b,closeOnOutsideClick:true}),h=a.find(".error");c.addHeader("Send an invitation");c.addPanel("Invite",a,"panel-body");a.show();c.addButton("Send",function(){a.submit()},"aui-button aui-style");c.addCancel("Cancel",function(a){a.hide()});f=c.getCurrentPanel().page.button[0].item;g.on("keyup input propertychange",function(){$.trim(g.val())?f.prop("disabled",false).attr("aria-disabled",
false):f.prop("disabled",true).attr("aria-disabled",true)});a.submit(function(b){b.preventDefault();var j=$.trim(g.val());if(j&&!f.attr("disabled")){var b={400:"Please enter a valid email address.",409:"{!esc} has already been invited.".format(j),500:"There was a problem processing your request (500 Internal Server Error)."},l=$.extend(b,d.messages||{});f.prop("disabled",true).attr("aria-disabled",true);var m=BB.delay(200,function(){f.addClass("disabled loading")});h.addClass("hidden");e(j,a,{complete:function(){clearTimeout(m);
f.prop("disabled",false).removeClass("disabled loading").attr("aria-disabled",false)},success:function(a,b,d){if(d.status===200){c.hide();AJS.messages.success({body:"Invitation sent to {!esc}".format(j)})}},error:function(a,b){var c;c=b!=="timeout"?l[a.status]||"There was a problem processing your request":"There was a problem connecting to the server.";h.removeClass("hidden").find(".message").text(c)}})}});AJS.bind("show.dialog",function(c,d){if(d.dialog.id==b){a.find(".error").addClass("hidden");
g.val("");f.prop("disabled",true).attr("aria-disabled",true)}});return{show:function(){c.show()},hide:function(){c.hide()}}};
(function(a,b,e){a=a.BB;a.backbone=a.backbone||{};a.backbone.ui={};a.backbone.ui.CollectionView=e.View.extend({view:null,views_:null,initialize:function(a){if(a.view)this.view=a.view;this.init_();this.collection.on("add",this.add_,this);this.collection.on("remove",this.remove_,this);this.collection.on("reset",this.refresh_,this)},init_:function(){var a=this;this.views_={};this.collection.each(function(b){var e=a.views_[b.cid]=new a.view({model:b});b.on("change",e.render,e)})},add_:function(a){a=this.views_[a.cid]=
new this.view({model:a});this.collection.comparator?this.render():this.$el.append(a.render().el)},remove_:function(a){var b=this.views_[a.cid];if(b){b.remove();delete this.views_[a.cid]}},refresh_:function(){this.init_();this.render()},render:function(){var a=this,b=this.$el;b.children().detach();this.collection.each(function(e){b.append(a.views_[e.cid].render().el)});return this}})})(this,jQuery,Backbone);
(function(){var a,b=$('<form class="aui invitation-form" id="general-invite-form" method="post" novalidate><div class="error aui-message hidden"><span class="aui-icon icon-error"></span><div class="message"></div></div><div class="field-group"><label for="id_general_email_address">Email address</label><input type="email" id="id_general_email_address" name="email-address" class="text"></div><p class="field-group free-users" ><strong>Have questions?</strong> For every friend who joins Bitbucket, we\'ll <a id="general-invite-blog-link" href="http://blog.bitbucket.org/2012/09/18/refer-a-friend-to-bitbucket-for-free-users/" target="_blank">add 1 free user to your plan limit</a>. Earn up to 3 additional users.</p></form>'),e=
b.find("p.free-users"),d=BB.InviteDialog(b,"invitation-dialog",function(b,d,c){bitbucket.send_general_invitation(b,{complete:c.complete,success:function(b,d,e){BB.gaqPush(["atl._trackEvent","Share","General invite user",a]);c.success(b,d,e)},error:c.error})});$(".general-invite-link").click(function(b){BB.user.isTeam&&e.hide();b.preventDefault();a=$(b.target).parent(".invite-users-box").length>0?"dashboard":"nav-link";d.show()});$("#dashboard #invite-users .close").click(function(){$("#dashboard #invite-users").hide();
BB.gaqPush(["atl._trackEvent","Share","Dismiss invite panel"]);$.ajax({type:"PUT",url:BB.api.concat("user","preferences",BB.user.username,"dismiss-bonus"),data:{value:"True"},error:function(){alert("There was a problem connecting to the server.")}})})})();
BB.utils.guard(".textarea-preview .preview-footer",function(a){a.find(".preview").click(function(a){a.preventDefault();var a=$(a.target),e=a.closest(".textarea-preview");a.attr("aria-pressed")?a.text("Preview"):a.text("Edit");BB.utils.previewContent(a,e)})});
BB.utils.guard("#file-search-form",function(a){function b(a,b,c,d,e){this.$queryInput=a;this.lastQuery="";this.$resultsContainer=b;this.revision=c;this.branch=d?encodeURIComponent(d):d;this.template=e;this.charLimit=80;this.resultLimit=100;this.nextPageStart=0;this.isLastPage=true;this.loading=false;this.files=[];this.getFiles();this.initialized=true;a.on("keyup",this.keyup.bind(this));a.on("keydown",function(a){a.which===9&&a.preventDefault()})}function e(a){return a!=a.toUpperCase()?"["+d(a.toUpperCase()+
a)+"]":d(a)}function d(a){return a.replace(/[\-\[\]{}()+?.,\\\^$|#\s]/g,"\\$&")}BB=BB||{};BB.FileSearch=BB.FileSearch||{};(BB.FileSearchDialog=new AJS.Dialog({width:680,height:"auto",id:"file-search-dialog",closeOnOutsideClick:true})).addPanel("Search",a,"panel-body");a.show();a.on("submit",function(){return false});var g=$("#file-search-query"),f=$("#filtered-files"),c=a.find(".tip"),h=Math.round(Math.random()*c.length-2);BB.utils.client.os==="Mac"?c.closest(".mod-win").remove():c.closest(".mod-osx").remove();
AJS.bind("show.dialog",function(d,e){if(e.dialog.id==="file-search-dialog"&&!BB.FileSearch.initialized){BB.FileSearch=new b(g,f,a.attr("data-revision"),a.attr("data-branch"),"filtered-files-template");c.addClass("hidden").eq(h).removeClass("hidden")}});$(document).on("click","#inline-dialog-branch-dialog .filter-list a",function(){$(document).one("pjax:end",function(b,c,d){if(b.target&&b.target.id==="source-container"){c=/src\/(.*)\//.exec(d.url)[1];b=$(b.relatedTarget).text().trim();if(BB.FileSearch.initialized){BB.FileSearch.revision=
c;BB.FileSearch.files=[];BB.FileSearch.getFiles();BB.FileSearch.$queryInput.val("")}else{a.attr("data-revision",c);a.attr("data-branch",b)}}})});b.prototype.keyup=function(a){var b=a.which===9,c=a.which===74,d=a.which===75,e=a.which===79,f=BB.utils.client.os==="Mac",f=f&&a.ctrlKey||!f&&a.altKey,c=a.which===40||c&&f||b&&!a.shiftKey,e=a.which===13||e&&f;a.which===38||d&&f||b&&a.shiftKey?this.selectPreviousResult():c?this.selectNextResult():e?this.selectResult():this.executeSearch()};b.prototype.getPositions=
function(a){var b=a.position().top,c=this.$resultsContainer.scrollTop();return{itemStart:b,itemEnd:b+a.height(),containerStart:c,containerEnd:c+this.$resultsContainer.height()}};b.prototype.isVisible=function(a){a=this.getPositions(a);return a.itemStart>=a.containerStart&&a.itemEnd<=a.containerEnd};b.prototype.makeVisible=function(a,b){var c=this.getPositions(a);b?this.$resultsContainer.scrollTop(c.itemStart):this.$resultsContainer.scrollTop(c.itemEnd-(c.containerEnd-c.containerStart))};b.prototype.selectNextResult=
function(){var a=this.$resultsContainer.find(".focused"),b=a.next();if(!a.length){b=this.$resultsContainer.find(".iterable-item:first");b.addClass("focused")}if(b.length){a.removeClass("focused");b.addClass("focused")}this.isVisible(b)||this.makeVisible(b)};b.prototype.selectPreviousResult=function(){var a=this.$resultsContainer.find(".focused"),b=a.prev();if(b.length){a.removeClass("focused");b.addClass("focused")}this.isVisible(b)||this.makeVisible(b,true)};b.prototype.selectResult=function(){if(this.$resultsContainer.find(".focused").length){var a=
this.$resultsContainer.find(".focused a.execute").attr("href");window.location.href=a}};b.prototype.executeSearch=function(){var a=this.$queryInput.val();if(a!==this.lastQuery)if(this.lastQuery=a){a=this.filterFiles(a);a.length<this.resultLimit&&!this.isLastPage&&this.getFiles({start:this.nextPageStart});this.$resultsContainer.html(BB.Mustache.to_html(this.template,{files:a,node:this.revision,branch:this.branch})).show();this.selectNextResult();a.length===0&&this.$resultsContainer.hide()}else this.$resultsContainer.hide()};
b.prototype.getFiles=function(a){var b=BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"directory"),b=this.revision?b.toString(this.revision):b;if(!this.loading){this.$queryInput.addClass("loading");$.ajax({url:b,type:"GET",data:a}).success(function(a){this.isLastPage=a.isLastPage;this.nextPageStart=a.nextPageStart;this.revision=a.revision;_.each(a.values,function(a){this.files.push({name:a})}.bind(this));this.loading=false;this.$queryInput.removeClass("loading");this.executeSearch()}.bind(this))}};
b.prototype.filterFiles=function(a){var b=this.files,c;if(a){var b="",a=a.replace(/(^\s*)|(\s*$)/gi,"").replace(/[ ]{2,}/gi," ").split(/\*|\s|(?=[A-Z0-9]|\/|\.|-|_)/g),a=_.filter(a,function(a){return a.length!==0}),d=a.length;if(d){for(var b=b+("("+_.map(a[0].split(""),e).join("")+")"),f=1;f<d;f++)b=b+(".*?("+_.map(a[f].split(""),e).join("")+")");c=RegExp("("+b+")","g")}else c=void 0}else c=null;b=_.filter(this.files,function(a){c.lastIndex=0;return c.test(a.name)});c.lastIndex=0;_.each(b,function(a){a.isDirectory=
a.name.slice(-1)==="/";var b=a.name;if(a.name.length>this.charLimit){b=Math.floor(this.charLimit/2);b=a.name.slice(0,b)+"&hellip;"+a.name.slice(-b)}a.highlightedName=b.replace(c,"<strong>$1</strong>")}.bind(this));return b.slice(0,this.resultLimit)}});
BB.utils.guard("#social-wizard",function(a){var b=function(a,b,c,d,e,f){var g=new AJS.Dialog({width:c,height:"auto",id:a,closeOnOutsideClick:true});g.addHeader(d);g.addPanel("body",b,"panel-body");g.addButton("Save",e.save,"save-button");g.addCancel("Cancel",e.cancel);b.show();b.on("submit",function(a){a.preventDefault();$(g.popup.element).find(".save-button").trigger("click")});f.on("click",function(){g.show()});return g};AJS.bind("show.dialog",function(a,b){var c=$(b.dialog.popup.element);c.find(".error").addClass("hidden");
c.find("input, textarea").val("")});var e=function(a,b){$(a.popup.element).find(".error").removeClass("hidden").find(".message").text(b)},d=function(a){$(a.popup.element).find(".save-button").prop("disabled",true)},g=function(a){$(a.popup.element).find(".save-button").removeProp("disabled")},f=function(){a.find('[href="/"]').addClass("aui-button").addClass("aui-button-primary").text("Go to dashboard")};a.find('[href="/"]').on("click",function(){$(this).text()==="Do this later"&&BB.gaqPush(["atl._trackEvent",
"Social registration","Wizard","Do this later"])});BB.utils.exists("#add-ssh-key-form",function(a){var c=b("ssh-key-dialog",a,840,"Add an SSH key",{save:function(){if($("#id_key").val()){d(c);bitbucket.user(BB.user.username).add_ssh_key(a.serializeArray()).success(function(){f();c.hide();$("#account-ssh-key").addClass("completed");BB.gaqPush(["atl._trackEvent","Social registration","Wizard","Set key"])}).error(function(){e(c,"The SSH key entered is invalid.")}).complete(function(){g(c)})}else e(c,
"Please enter an SSH key before saving.")},cancel:function(a){a.hide()}},$("#set-ssh-key"))});BB.utils.exists("#account-ssh-key[data-import-url]",function(a){var b=a.data("import-url");$("#import-ssh-keys").on("click",function(){a.addClass("loading");$.ajax({url:b}).success(function(b){a.removeClass("loading");if(b.length>0){f();a.find(".key-count").text(b.length).end().addClass("completed");BB.gaqPush(["atl._trackEvent","Social registration","Wizard","Import keys"])}else AJS.messages.warning({body:"Import failed. Are your SSH keys already associated with another Bitbucket account?"})})})});
var c=$("#choose-password-form"),h=b("password-dialog",c,400,"Choose a password",{save:function(){if(!$("#id_new_password1").val()||!$("#id_new_password2").val())e(h,"Please complete both fields before saving");else if($("#id_new_password1").val()!==$("#id_new_password2").val())e(h,"The values entered do not match");else{d(h);$.ajax({url:c.attr("action"),type:"POST",data:c.serialize()}).success(function(){f();h.hide();$("#account-password").addClass("completed");BB.gaqPush(["atl._trackEvent","Social registration",
"Wizard","Set password"])}).error(function(){e(h,"There was a problem processing your request.")}).complete(function(){g(h)})}},cancel:function(a){a.hide()}},$("#set-password"));$(".ssh-key-copy-help").hide().filter("."+$.client.os.toLowerCase()).show();var i=function(a,b,c){AJS.InlineDialog(a,b,function(a,d,e){BB.gaqPush(["atl._trackEvent","Social registration","Wizard",b]);a.html(c.html());e&&e()})};i($("#ssh-key-help-trigger"),"ssh-key-help",$("#ssh-key-help"));i($("#password-help-trigger"),"password-help",
$("#password-help"))});BB.utils.guard("#social-setup",function(a){a.on("click",".form-link a",function(b){b.preventDefault();b=$(this).attr("href").slice(8);a.attr("data-method",b)})});BB.utils.guard("#support-admin-content",function(){AJS.$("#is-ondemand, .title-tip").tooltip()});
BB.progressDialog=function(a,b){function e(){if(!l){l=new AJS.Dialog({width:i,height:j,id:"bb-"+h+"-dialog"});l.addPanel("main");var a;a=typeof b.templateData==="function"?b.templateData(void 0):b.templateData;d(a||{})}l.show()}function d(a){l.addHeader(a.title||b.title||"Progress").getCurrentPanel().html(BB.Mustache.to_html(b.template,a));l.popup.element.find(".dialog-button-panel").empty();a.closeLink&&l.addCancel("Close",function(a){a.hide()})}function g(a,b,c){d({error:c,closeLink:true})}function f(d){d&&
d.preventDefault();b.taskUrl=b.taskUrl||a.attr("data-url");e();$.ajax({type:"post",url:b.taskUrl,success:function(a,d){if(d==="success"){var f=b.taskUrl;e();c(f)}},error:g})}function c(a){$.ajax({type:"get",url:a,success:function(d,e,f){if(d.status=="ACCEPTED"||d.status=="STARTED"){e=l.popup.element.find("#progress-container");f=b.getStatus(d);e.find(".progress-message").text(f);if(d.pct){e.find(".progress").css({width:d.pct+"%"});e.find(".progress-percent").text(d.pct+"%")}setTimeout(function(){c(a)},
1E3)}else d.status=="SUCCESS"?b.onComplete&&b.onComplete(l,d):d.status=="FAILURE"&&g(f,e,d.message?d.message:"Unexpected error")},error:g})}if(arguments.length==1&&!a.jquery){b=a;a=$()}var h=b.id||"progress",i=b.width||600,j=b.height||"auto",l;if(a&&a.length)a.on("click",f);return{getDialog:function(){return l},getElement:function(){return l.popup.element},bind:function(b,c){if(b&&b.length){a=b;a.on(c,f)}},start:function(a,d){b.taskUrl=a?a:b.taskUrl;if(d==="get"){e();c(a)}else f()},update:d}};
BB.uploadHandler=function(a,b){function e(){var c=a.prop("files")[0];b.fileSelected&&b.fileSelected(c)}function d(a){if(a.lengthComputable){a=Math.round(a.loaded*100/a.total).toString();m.find(".progress-bar .progress").css("width",(a||0)+"%")}}function g(){a.parent().removeClass("hidden");m.find(".upload-progress-container").remove()}function f(b){var c=m.find(".error-container");c.length||(c=$('<div class="error-container"></div>').insertBefore(a.parent()));g();c.empty().text(b)}function c(a){g();
b.complete&&b.complete(a.target)}function h(a){b.error&&b.error(a.target);f("There was an error attempting to upload the file.")}function i(a){b.cancel&&b.cancel(a.target);f("The upload has been canceled by the user or the browser dropped the connection.")}function j(b){var e=new XMLHttpRequest;if(e.upload){b.preventDefault();b=new FormData(m[0]);if(a.val()){var f=a.parent();f.toggleClass("hidden");var g=a.prop("files")[0].name,j=$('<div class="upload-progress-container"></div>');$('<div class="progress-bar"><div class="progress"></div></div>').appendTo(j);
$('<div class="filename"></div>').text(g).appendTo(j);j.insertAfter(f);m.find(".error-container").empty();e.upload.addEventListener("progress",d,false);e.addEventListener("load",c,false);e.addEventListener("error",h,false);e.addEventListener("abort",i,false);e.open("POST",m.attr("action"));e.send(b)}return false}}function l(b){n.removeClass("file-hover");a.prop("files",b.originalEvent.dataTransfer.files);j(b)}var b=b||{},m=a.closest("form"),n=b.$dropTarget||$(),q={ajaxUpload:"upload"in new XMLHttpRequest,
dragAndDrop:"draggable"in document.createElement("span"),fileReader:!!a.prop("files"),formData:!!window.FormData};if(q.fileReader)a.on("change",e);if(q.ajaxUpload)m.on("submit",j);if(n.length&&q.dragAndDrop){n.on("dragover dragenter",function(){n.addClass("file-hover");return false});n.on("dragend dragleave",function(){n.removeClass("file-hover");return false});n.on("drop",l)}return{supports:function(a){return q[a]}}};
BB.utils.guard(".invite-form",function(){$("#logout-button").on("click",function(a){a.preventDefault();var b=$(this);$.get(b.data("logoutUrl")).complete(function(){window.location=b.attr("href")})})});
(function(a){BB.dialog=BB.dialog||{};var b=0,e=function(d,e){var f;if(typeof d==="string")f={};else{f=d;d=f.content}var c=f.id||b++,c=new AJS.Dialog({width:400,height:"auto",id:"bb-"+c+"-confirmation-dialog"}),h=a("<div></div>").html(d),i=f.buttonText||"Okay";f.title&&c.addHeader(f.title);c.addPanel("main",h,"confirmation-dialog-body");c.addButton(i,function(a){a.remove();e&&e(true)});return c};BB.dialog.Confirmation=function(a,b){var f=e(a,b);f.addCancel("Cancel",function(a){a.remove();b&&b(false)});
f.show()};BB.dialog.Alert=function(a,b){e(a,b).show()}})(jQuery);
function CommandBar(a,b){this.$container=a;this.$input=a.find("input");this.options=b||{};this.commands=[];this.commandGroups=[];this.contextStack=[];this.$input.on("keyup",function(a){var b=$(a.target).val();a.keyCode==13&&this.triggerSearch(b);this.refreshContextStack(b)}.bind(this)).on("focusout",function(){this.hide()}.bind(this));var e=BB.typeahead.TypeaheadModel.extend({replacementText:function(){return this.get("isUser")?"@{}".format(this.get(this.idAttribute)):this.get("isPR")?"{} prs #{}".format(this.get("repo"),
this.get("localID")):this.get("isIssue")?"{} issues #{}".format(this.get("repo"),this.get("localID")):this.get(this.idAttribute)}},{splitWordsRegExp:/[\s+|\/]/,matcher:function(a,b){return!b?true:this.startsWith(a.get(a.idAttribute),b)}}),d=BB.typeahead.ui.TypeaheadView.extend({template:_.bind(BB.Mustache.to_html,null,"command-bar-item"),render:function(){this.$el.html(this.template(this.model.toHighlightedJSON(this.query)));return this}}),g=BB.typeahead.ui.TypeaheadSuggestions.extend({viewClass:function(){return d}}),
f=BB.typeahead.ui.TypeaheadCompletion.extend({shouldSuppressSuggestions:function(){return false}});$.get(this.$container.data("allyourthings-api-url")).success(function(b){b=new AJS.ProgressiveDataSet(this.formatDefaultData(b),{model:e,matcher:e.matcher.bind(e)});(new f({results:new g,source:b,el:a[0]})).render()}.bind(this))}CommandBar.prototype.triggerSearch=function(a){var b=this.findCommand(a);if(b){var e=b.matcher.exec(a).slice(1);b.callback(a,e);this.hide()}};
CommandBar.prototype.formatDefaultData=function(a){var b=[];_.each(a.users,function(a){b.push({isUser:true,id:"{}".format(a.username)})});_.each(a.repos,function(a){b.push({isRepo:true,id:"{}/{}".format(a.owner,a.slug)})});_.each(a.prs,function(a){b.push({isPR:true,id:"PR #{}: {}".format(a.local_id,a.title),localID:a.local_id,repo:"{}/{}".format(a.repo.owner,a.repo.slug),repo_slug:a.repo.slug})});_.each(a.issues,function(a){b.push({isIssue:true,id:"Issue #{}: {}".format(a.local_id,a.title),localID:a.local_id,
repo:"{}/{}".format(a.repo.owner,a.repo.slug),repo_slug:a.repo.slug})});return b};CommandBar.prototype.addCommand=function(a,b,e,d,g){this.commands.push({command:a,description:b,matcher:RegExp("^{}$".format(e.source)),callback:d,isGlobal:!g})};
CommandBar.prototype.addCommandGroup=function(a,b,e){this.commandGroups.push({prefix:a,matcher:RegExp("^{}\\s+".format(b.source)),commands:e});_.each(e,function(a){var e=a[0],f=a[1],c;if(typeof a[2]==="object"){c="{}\\s+{}".format(b.source,a[2].source);a=a[3]}else{c="{}\\s+{}".format(b.source,e);a=a[2]}this.addCommand(e,f,RegExp(c),a,true)}.bind(this))};CommandBar.prototype.filterCommandGroups=function(a){return _.filter(this.commandGroups,function(b){return a.match(b.matcher)})};
CommandBar.prototype.findCommand=function(a){return _.find(this.commands,function(b){return a.trimRight().match(b.matcher)})};CommandBar.prototype.refreshContextStack=function(a){var b=false;_.each(this.contextStack,function(d,e,f){if(!a.match(d)){f.splice(e,1);b=true}});var e=_.map(this.filterCommandGroups(a),function(a){return a.matcher});_.each(_.difference(e,this.contextStack),function(a){this.contextStack.push(a);b=true}.bind(this));b&&this.$container.trigger("contextChange.commandBar",this.getContext())};
CommandBar.prototype.getContext=function(){var a=this.contextStack.length;return _.findWhere(this.commandGroups,{matcher:a?this.contextStack[a-1]:null})};CommandBar.prototype.show=function(a){this.$input.val("");a=a||this.options.animationSpeed||100;this.$container.stop().slideDown(a,function(){this.$input.focus()}.bind(this))};CommandBar.prototype.hide=function(a){this.$container.stop().slideUp(a||this.options.animationSpeed||100)};
BB.utils.guard("#command-bar",function(a){BB.commandBar=new CommandBar(a);a=/([\w\-]+)\/([\w\-]+)/;BB.commandBar.addCommand("user/repo","View repository",a,function(a,e){window.location="/{}/{}/".format(e[0],e[1])});BB.commandBar.addCommandGroup("$1/$2",a,[["source","View source",function(a,e){window.location="/{}/{}/source/".format(e[0],e[1])}],["commits","View commits",function(a,e){window.location="/{}/{}/commits/".format(e[0],e[1])}],["prs","View pull requests",function(a,e){window.location="/{}/{}/pull-requests/".format(e[0],
e[1])}],["issues","View issues",function(a,e){window.location="/{}/{}/issues/".format(e[0],e[1])}],["wiki","View wiki",function(a,e){window.location="/{}/{}/wiki/".format(e[0],e[1])}],["dls","View downloads",function(a,e){window.location="/{}/{}/downloads/".format(e[0],e[1])}]]);BB.commandBar.addCommandGroup("$1/$2 issues",/([\w\-]+)\/([\w\-]+) issues/,[["#","View issue",/#(\d+)/,function(a,e){window.location="/{}/{}/issue/{}/".format(e[0],e[1],e[2])}],["new","Create issue",function(a,e){window.location=
"/{}/{}/issues/new/".format(e[0],e[1])}]]);BB.commandBar.addCommandGroup("$1/$2 prs",/([\w\-]+)\/([\w\-]+) prs/,[["#","View pull request",/#(\d+)/,function(a,e){window.location="/{}/{}/pull-request/{}/".format(e[0],e[1],e[2])}],["new","Create pull request",function(a,e){window.location="/{}/{}/pull-request/new/".format(e[0],e[1])}]]);BB.commandBar.addCommand("@user","View user profile",/@([\w\-]+)/,function(a,e){window.location="/{}/".format(e[0])})});BB.utils.guard("#create-form",function(a){BB.utils.chosen(a)});
(function(a,b,e){var d=function(){this.sources_={"source-svn":new f(this),"source-hg":new c(this),"source-goog":new j(this),"source-sourceforge":new l(this),"source-codeplex":new m(this),"source-git":new h(this)};this.ajax_=this.urlTimeout_=this.previousUrl_=this.source_=null;this.$message_=a("<div></div>");this.$scm_=this.$source_=this.$url_=this.$form_=null};d.prototype={bind:function(b){this.$form_=b;this.$sourceScm_=a("#id_source_scm");this.$url_=a("#id_url");this.$source_=a("#id_source");this.$auth_=
a("#id_auth");this.$authFields_=a("#url-auth-fields");this.$username_=a("#id_username");this.$password_=a("#id_password");this.$submitButton_=this.$form_.find("button[type=submit]");this.$scm_=b.find("input[name=scm]");this.$url_.add(this.$username_).add(this.$password_).change(this.verifyUrl.bind(this));this.$source_.change(this.onSourceChange_.bind(this));this.$auth_.change(this.onAuthChange_.bind(this));this.$submitButton_.click(this.disableButtonAndSubmit_.bind(this));a(document).bind("source-scm-change",
this.onSourceScmChange_.bind(this));for(var c in this.sources_)this.sources_[c].bind(b);this.$auth_.is(":checked")&&!this.$authFields_.is(":visible")&&this.$authFields_.show();this.onSourceChange_(null,true);this.$message_.delegate("a.suggestion","click",this.useSuggestedUrl_.bind(this)).hide().appendTo(this.$url_.closest("div"))},renderUrl:function(a){this.$url_.val(a);a!==this.previousUrl_&&this.resetUrlStatus_();this.previousUrl_=a},verifyUrl:function(){var b=this.$url_.val();if(b!==""){this.ajax_&&
this.ajax_.abort();var c=this.$url_;this.urlTimeout_=BB.delay(300,function(){c.removeClass("success warning_ error_").addClass("spinner")});var d={};this.source_.canAuth()&&this.$auth_.is(":checked")&&a.extend(d,{username:a("#id_username").val(),password:a("#id_password").val()});this.ajax_=a.ajax({url:BB.api.toString("_import",this.source_.scm(),b),type:"POST",data:d,timeout:3E4,complete:this.ajaxComplete_.bind(this),success:this.ajaxSuccess_.bind(this)})}},useSuggestedUrl_:function(b){b.preventDefault();
b=a(b.target).attr("href");this.renderUrl(b);this.verifyUrl()},resetUrlStatus_:function(){this.$url_.removeClass("success warning_ error_");this.$message_.hide().removeClass("error")},ajaxComplete_:function(a,b){clearTimeout(this.urlTimeout_);this.$url_.removeClass("spinner");if(b==="timeout"){this.$url_.addClass("error_");this.$message_.addClass("error").text("Connecting to the URL timed out.").slideDown()}else switch(a.status){case 400:this.$url_.addClass("error_");this.$message_.addClass("error").text(a.responseText).slideDown();
break;case 404:this.$url_.addClass("error_");this.$message_.addClass("error").text(a.responseText).slideDown();break;case 401:this.$url_.addClass("error_");this.$message_.addClass("error").text("Authentication failed.").slideDown();break;case 403:this.$url_.addClass("error_");this.$message_.addClass("error").text(a.responseText).slideDown()}},ajaxSuccess_:function(a,b,c){if(c.status===200)if(a.svn)if(a.trunk){this.$url_.removeClass("error_").addClass("success");this.$message_.slideUp()}else{this.$url_.removeClass("error_ success").addClass("warning_");
a=["<div>The URL does not point to trunk.",a.suggestions.length===0?"":' <a class="suggestion" href="'+a.suggestions[0]+'">Use trunk instead?</a>',"</div>"].join("");this.$message_.addClass("warning").html(a).slideDown()}else{this.$message_.slideUp();this.$url_.removeClass("error_ warning_").addClass("success")}},disableButtonAndSubmit_:function(){this.$submitButton_.attr({disabled:"disabled"});this.$sourceScm_.val(this.source_.scm());this.$form_.submit()},onAuthChange_:function(){this.$authFields_.slideToggle();
this.verifyUrl()},onSourceChange_:function(a,b){this.source_&&this.source_.hideSource(b);this.source_=this.sources_[this.$source_.val()];this.source_.showSource(b);this.verifyUrl()},onSourceScmChange_:function(){var a=this.source_.scm();this.$form_.find("#hidden_scm_input").remove();if(a==="git"||a==="hg"){this.$scm_.prop({disabled:true});this.$scm_.prop({checked:false}).filter("[value="+a+"]").prop({checked:true}).change();this.$form_.append('<input id="hidden_scm_input" type="hidden" name="scm" value="'+
a+'"/>')}else this.$scm_.prop({disabled:false})}};var g=function(){};g.prototype={canAuth:function(){return true},bind:function(){},scm:function(){return"not-implemented"},onSourceScmChange_:function(){a(document).trigger("source-scm-change")},showSource:function(){this.onSourceScmChange_()},hideSource:function(){}};var f=function(){this.$help_=null};f.prototype=b.extend(new g,{scm:function(){return"svn"},showSource:function(){this.onSourceScmChange_();this.$help_.show()},hideSource:function(){this.$help_.hide()},
bind:function(){this.$help_=a("#source-fields-subversion")}});var c=function(){};c.prototype=b.extend(new g,{scm:function(){return"hg"}});var h=function(){this.$url_=this.$name_=null};h.prototype=b.extend(new g,{bind:function(){this.$name_=a("#id_name");this.$url_=a("#id_url");this.$url_.change(this.onUrlChange_.bind(this))},scm:function(){return"git"},onUrlChange_:function(){var a=this.$url_.val().trim();(a=/\/([^\/]*?)(\.git)?$/.exec(a))&&this.$name_.val()===""&&this.$name_.val(a[1])}});var i=function(a){this.repositoryImporter=
a;this.$scm_=this.$projectName_=this.$container_=this.$url_=this.$auth_=this.$form_=this.idleVerifyUrlTimeout_=null};i.prototype=b.extend(new g,{template_:{},bind:function(b){this.$form_=b;this.$auth_=a("#id_auth").closest("div.checkbox");this.$name_=a("#id_name");this.$url_=a("#id_url");this.bindSourceFields_(b);b=a(this.inputElements_());b.keydown(this.onKeyDown_.bind(this));b.keyup(this.onKeyUp_.bind(this));b.change(this.onProjectNameChange_.bind(this));b.blur(this.cancelIdleUrlVerification_.bind(this));
this.$scm_.change(this.renderAndVerifyUrl_.bind(this));this.$scm_.change(this.onSourceScmChange_.bind(this))},inputElements_:function(){return this.$projectName_[0]},getProjectName_:function(){return this.$projectName_.val()},bindSourceFields_:function(){},canAuth:function(){return false},onKeyDown_:function(a){if(a.keyCode===8){a=this.$projectName_.val();a.startsWith(this.$name_.val())&&this.$name_.val(a.rstrip(/./))}},cancelIdleUrlVerification_:function(){e.clearTimeout(this.idleVerifyUrlTimeout_)},
onKeyUp_:function(){this.cancelIdleUrlVerification_();this.idleVerifyUrlTimeout_=BB.delay(2E3,this.renderAndVerifyUrl_.bind(this));this.repositoryImporter.renderUrl(this.url());var a=this.$projectName_.val();a.startsWith(this.$name_.val())&&this.$name_.val(a)},onProjectNameChange_:function(){this.repositoryImporter.renderUrl(this.url());this.repositoryImporter.verifyUrl()},renderAndVerifyUrl_:function(){this.repositoryImporter.renderUrl(this.url());this.repositoryImporter.verifyUrl()},url:function(){var a=
this.getProjectName_().trim();return a?this.template_[this.scm()]({projectName:a}):""},scm:function(){return this.$scm_.filter(":checked").val()},showSource:function(a){this.onSourceScmChange_();this.$url_.prop({readonly:true});this.$url_.val("");if(!this.$container_.is(":visible"))if(a){this.$container_.show();this.canAuth()?this.$auth_.show():this.$auth_.hide()}else{this.$container_.slideDown();this.canAuth()?this.$auth_.slideDown():this.$auth_.slideUp()}},hideSource:function(a){if(this.$container_.is(":visible"))if(a){this.$container_.hide();
this.$auth_.show()}else{this.$container_.slideUp();this.$auth_.slideDown()}this.$url_.prop({readonly:false})}});var j=function(a){i.call(this,a)};j.prototype=b.extend(new i,{template_:{hg:b.template("https://<%= projectName %>.googlecode.com/hg/"),svn:b.template("http://<%= projectName %>.googlecode.com/svn/trunk"),git:b.template("https://code.google.com/p/<%= projectName %>/")},bindSourceFields_:function(){this.$container_=a("#source-fields-goog");this.$projectName_=a("#id_goog_project_name");this.$scm_=
a('[name="goog_scm"]')}});var l=function(a){i.call(this,a)};l.prototype=b.extend(new i,{template_:{hg:b.template("http://<%= projectName %>.hg.sourceforge.net:8000/hgroot/<%= projectName %>"),svn:b.template("https://<%= projectName %>.svn.sourceforge.net/svnroot/<%= projectName %>")},bindSourceFields_:function(){this.$container_=a("#source-fields-sourceforge");this.$projectName_=a("#id_sourceforge_project_name");this.$scm_=a('[name="sourceforge_scm"]')}});var m=function(a){i.call(this,a)};m.prototype=
b.extend(new i,{template_:{hg:b.template("https://hg01.codeplex.com/<%= projectName %>/"),svn:b.template("https://<%= projectName %>.svn.codeplex.com/svn/")},bindSourceFields_:function(){this.$container_=a("#source-fields-codeplex");this.$projectName_=a("#id_codeplex_project_name");this.$scm_=a('[name="codeplex_scm"]')}});a(function(a){a=a("#import-form");if(a.length===1){(new d).bind(a);a.find("input[type=submit]").removeAttr("disabled")}BB.utils.chosen(a)});var n=Backbone.Collection.extend({initialize:function(a,
b){this.url=b.url}}),q=Backbone.View.extend({initialize:function(){this.collection.bind("add",this.insert,this);this.collection.bind("reset",this.update,this);this.collection.bind("reset",this.poll,this)},statusTemplate:b.bind(BB.Mustache.to_html,null,"github-import-progress"),buttonTemplate:b.bind(BB.Mustache.to_html,null,"github-import-finished-button"),events:{"click button.github-start-import":"start","click button.github-import-all":"importAll"},pollDelayMs:1E3,spinnerDelayMs:500,poll:function(){var a=
this.collection;a.any(function(a){return a.get("running")})&&setTimeout(function(){a.fetch()},this.pollDelayMs)},start:function(b){var c=this;c.$("button.github-start-import:enabled").length===1&&c.disableImportAll();var d=a(b.target);d.attr("aria-disabled","true").attr("disabled","disabled");var e=setTimeout(function(){d.addClass("loading")},this.spinnerDelayMs);this.collection.create({url:d.data("url"),type:d.data("type")},{wait:true,complete:function(){clearTimeout(e);c.poll()}})},importAll:function(c){var d=
this,c=a(c.target).attr("data-type");d.disableImportAll();var e=d.$("button.github-start-import");e.attr("aria-disabled","true").attr("disabled","disabled");var f=setTimeout(function(){e.addClass("loading")},this.spinnerDelayMs);a.post(d.collection.url,{type:c},function(a){clearTimeout(f);b.each(a,function(a){d.collection.add(a)});d.poll()})},disableImportAll:function(){this.$("button.github-import-all").attr("aria-disabled","true").attr("disabled","disabled")},$buttonForModel:function(b){var c=b.get("url");
return this.$("button.github-start-import").filter(function(){return a(this).attr("data-url")===c})},insert:function(b){var c=this.$buttonForModel(b).closest("article").find("h1"),d=c.find(".name").text(),e=b.get("succeeded")?"repository_html_url":"html_url",e=a("<a>").attr("href",b.get(e));c.find(".name").html(e.text(d));c.append(this.statusTemplate(b.toJSON()))},update:function(){var c=this,d=b.map(c.$(".github-import-status"),function(b){return a(b).data("id")}),d=b.difference(d,c.collection.map(function(a){return a.get("id")}));
b.each(d,function(a){var b=c.$("#github-import-status-"+a),d=b.closest("article").find(".github-start-import"),e=c.failedJSON(a,b.attr("href"));b.replaceWith(c.statusTemplate(e));d.removeClass("loading").fadeOut(300,function(){d.replaceWith(c.buttonTemplate(e))})});c.collection.each(function(b){var d=c.$("#github-import-status-"+b.get("id")),e=d.closest("article").find("h1"),f=d.closest("article").find(".github-start-import"),g=e.find(".name").text(),h=b.get("succeeded")?"repository_html_url":"html_url",
h=a("<a>").attr("href",b.get(h));e.find(".name").html(h.text(g));d.data("queued")&&!b.get("queued")?setTimeout(function(){d.replaceWith(c.statusTemplate(b.toJSON()))},c.pollDelayMs/2):d.replaceWith(c.statusTemplate(b.toJSON()));d.data("running")&&!b.get("running")&&f.removeClass("loading").fadeOut(300,function(){f.replaceWith(c.buttonTemplate(b.toJSON()))})})},failedJSON:function(a,b){return{id:a,html_url:b,queued:false,running:false,succeeded:false,failed:true}}});a(function(a){var b=a("#github-repositories");
if(b.length){var c=b.find(".mask");a.get(b.attr("data-html-url"),function(d){d=a(d);BB.localize(d.find("time"));c.replaceWith(d);d=new n(d.children(".github-import-data").data("imports"),{url:b.data("api-url")});(new q({el:b,collection:d})).render();d.fetch()})}var d=a("#repo-import .sidebar a.import-github"),e=d.find("form.connect-button");if(e.length)d.on("click",function(a){a.preventDefault();e.submit()})})})(jQuery,_,this);
BB.utils.guard("#fork-form",function(a){BB.utils.chosen(a);a.find("#fp_sel").change(function(){if(this.value==="specific"){$("#fp_specific").show();$("#fp_specific_input").focus()}else{$("#fp_specific").hide();$("#fp_specific_input").val(this.value)}})});
BB.utils.guard("#repo-overview",function(){function a(a){var b=a.attr("id"),b=b.substring(0,b.length-8),e=$("#repo-stats .stats");AJS.InlineDialog(a,"overview-"+b,function(a,d,e){if(!a.find(".repo-stats-dialog").length){$("#"+b).appendTo(a).removeClass("hidden");BB.quickFilter(a)}e&&e();setTimeout(function(){a.find("input.filter-box").focus()},0)},{offsetY:5,width:292,calculatePositions:BB.inlineDialog.alignTo(function(){return e.offset().left+13}),getArrowAttributes:function(){return{fill:b==="followers-dialog"?
"#fff":"#f5f5f5",stroke:"#ccc"}}})}BB.utils.exists("#branches-dialog-trigger",a);BB.utils.exists("#forks-dialog-trigger",a);BB.utils.exists("#tags-dialog-trigger",a);BB.utils.exists("#followers-dialog-trigger",a);BB.utils.exists("#sync-repo-box",function(a){var b=a.find('a[href="#sync-repo"]'),e=a.find("a.close"),c=b.attr("data-conflict-url"),h=b.attr("data-source-repo"),i=b.attr("data-dest-repo");BB.mergeDialog(b,{getData:function(){var a=b.attr("data-source-branch"),c=b.attr("data-dest-branch"),
d;d=a==c?h:"{}/{}".format(h,a);return{action:b.attr("data-compare-url"),source:"{}::{}".format(h,a),sourceBranch:a,sourceRepo:h,sourceAvatar:b.attr("data-source-avatar"),sourceAvatarAltText:b.attr("data-source-repo-name"),dest:"{}::{}".format(i,c),destBranch:c,destRepo:i,destAvatar:b.attr("data-dest-avatar"),destAvatarAltText:b.attr("data-dest-repo-name"),sameRepo:false,canCloseBranch:false,hasConflicts:false,mergeCommands:"",commitMessageSlug:d,syncRepo:true}},success:function(){BB.messages.addMessage("{} successfully synced with {}.".format(i,
h));window.location.reload(true)},conflictUrl:c});e.on("click",function(b){b.preventDefault();var b=e.attr("data-pref"),c=e.attr("data-pref-value");BB.utils.userPrefs(b,c).done(function(){a.animate({opacity:0},200,function(){a.animate({height:0},200,function(){a.remove()})});BB.gaqPush(["atl._trackEvent","Sync","Dismiss sync repo box"])})})});BB.utils.exists("#invite-repo-box",function(a){var b=a.find('a[href="#invite-repo"]'),e=a.find("a.close");b.on("click",function(){BB.gaqPush(["atl._trackEvent",
"Share","Repo overview invite user button"])});e.on("click",function(a){a.preventDefault();a="dismiss-invite-box-"+e.data("repo-id");BB.utils.userPrefs(a,"True").done(function(){$("#invite-repo-box").animate({opacity:0},200,function(){$(this).animate({height:0},200,function(){$("#invite-repo-box").remove()})});BB.gaqPush(["atl._trackEvent","Share","Dismiss repo overview invite panel"])})})});var b=window.location.hash;if(b&&b.length>1){b=b.substring(1);$("#"+b+"-dialog-trigger").click()}var e=$("a.follow").hasClass("following");
$("a.follow").on("follow:repo",function(a,b){if(e!==b){e=b;$("#followers-list li.current-user").toggleClass("hidden",!b);var f=$("#followers-dialog-trigger .value"),c=+f.text();b?c++:c--;$("#followers-list ol").toggleClass("empty",c===0);f.text(c);var f=$("#followers-dialog-trigger"),h=f.html();c===1?f.html(h.replace(/Followers/,"Follower")):f.html(h.replace(/Follower\b/,"Followers"))}})});
(function(a,b,e,d){var b=e.Model.extend({save:function(){var b;if(this.get("email"))if(this.get("permission"))b=bitbucket.send_invitation(this.get("email"),this.get("permission"),d.repo.toString());else{if(this.get("group")){b=bitbucket.user(d.repo.owner.username);var c=b.username+"/"+this.get("group");b=b.invite(this.get("email"),c)}}else this.get("username")&&(this.get("permission")?b=a.ajax({url:d.api.concat("privileges",d.repo.owner.username,d.repo.slug,this.get("username")),type:"PUT",data:this.get("permission")}):
this.get("group")&&(b=a.ajax({url:d.api.concat("groups",d.repo.owner.username,this.get("group"),"members",this.get("username")),type:"PUT",data:JSON.stringify(this.get("bbUserObject"))})));b.error(function(a){a.status!==409&&this.set({error:a.responseText})}.bind(this)).complete(function(){this.trigger("save",this)}.bind(this))}}),g=e.Collection.extend({model:b,add:function(a){if(this.any(function(b){if(a.get("username"))return a.get("username")===b.get("username");if(a.get("email"))return a.get("email")===
b.get("email")}))return false;e.Collection.prototype.add.call(this,a)}});d.share=d.share||{};d.share.Share=b;d.share.ShareCollection=g})(window.jQuery,window._,window.Backbone,window.BB);
(function(a,b,e,d){var g=e.View.extend({tagName:"tr",template:"share-detail-template",events:{"click .delete":"destroyModel"},initialize:function(){if(this.events)this.events=b.defaults(this.events,g.prototype.events);this.delegateEvents(this.events);b.bindAll(this,"render","remove");this.model.on("change",this.render);this.model.on("destroy",this.remove)},destroyModel:function(a){a.preventDefault();this.model.destroy()},remove:function(){this.$el.remove()}}),f=g.extend({events:{"click .permission":"setPermission"},
initialize:function(){g.prototype.initialize.call(this);b.bindAll(this,"setPermission")},render:function(){var a=this.model.toJSON();a[this.model.get("permission")]=true;this.$el.html(d.Mustache.to_html(this.template,a));return this},setPermission:function(b){this.model.set({permission:a(b.target).data("permission")})}}),c=g.extend({events:{"click .admin":"toggleAdmin","change .group":"setGroup"},initialize:function(){g.prototype.initialize.call(this);b.bindAll(this,"toggleAdmin","setGroup")},render:function(){var a=
this.model.toJSON();if(a.hasCustomGroups=this.options.hasCustomGroups)a.groups=b.map(this.options.groups,function(a){return{name:a.name,slug:a.slug,isSelected:a.slug===this.model.get("group")}}.bind(this));a.isAdmin=this.model.get("group")==="administrators";this.$el.html(d.Mustache.to_html(this.template,a));return this},toggleAdmin:function(){var a=this.$(".admin").is(":checked")?"administrators":"developers";this.setGroup(null,a)},setGroup:function(a,b){this.model.set({group:b?b:this.$(".group").val()})}}),
h=e.View.extend({template:"share-form-template",events:{"submit form":"add","keyup .user-or-email":"toggleAddButton"},initialize:function(){b.bindAll(this,"render","renderShare","toggleAddButton","hideError","showError","add","send");this.collection=new d.share.ShareCollection;this.collection.on("add",this.renderShare);this.collection.on("reset",this.render);this.on("send",this.send)},render:function(){this.$el.html(d.Mustache.to_html(this.template,{disabled:this.disabled}));this.$error=this.$(".error");
this.$userOrEmail=this.$(".user-or-email");this.$addButton=this.$("button");this.$userOrEmail.autocomplete({minLength:3,source:"/xhr/users/",select:function(a,b){this.$userOrEmail.val(b.item.value);this.$("form").submit()}.bind(this),open:function(){var b=a(this);b.val()||b.autocomplete("close")}});this.collection.each(function(a){this.renderShare(a)}.bind(this));return this},renderShare:function(a){a=new this.DetailView({groups:this.options.groups,hasCustomGroups:this.hasCustomGroups,model:a});this.$("tbody").append(a.render().el)},
toggleAddButton:function(){this.$userOrEmail.val()!==""?this.$addButton.removeAttr("disabled"):this.$addButton.attr("disabled","disabled")},hideError:function(){this.$error.addClass("hidden")},showError:function(a,b){this.$error.find(".message")[b?"html":"text"](a).end().removeClass("hidden")},add:function(a){a.preventDefault();this.$userOrEmail.autocomplete("close");var c=this.$userOrEmail.val(),e=b.clone(this.modelSkeleton),f=function(){this.hideError();this.$userOrEmail.val("");this.collection.add(new d.share.Share(e))}.bind(this);
if(!c)return false;if(d.valid.email(c)){e.email=c;f()}else bitbucket.user(c).details(function(a){e=b.extend(e,{username:a.username,displayName:a.first_name||a.last_name?a.first_name+" "+a.last_name:a.username,avatar:a.avatar,bbUserObject:a});f()}).error(function(){this.showError('User "'+c+'" does not exist.')}.bind(this))},send:function(){if(this.collection.length===0){this.showError("Add a user or email address.");return false}var b=a("#share-dialog .dialog-button-panel button"),c=function(){this.disabled=
true;this.render();b.prop("disabled",true)}.bind(this),d=function(){this.disabled=false;this.render();b.removeProp("disabled")}.bind(this);c();var e=this.collection.length;this.collection.each(function(a){a.save()});this.collection.on("save",function(a){--e;a.get("error")||a.destroy();if(e<=0&&this.collection.length===0){d();this.options.dialog.hide();this.trigger("success")}else{d();this.showError("There was a problem processing your request.");this.off("success")}}.bind(this))}}),e=h.extend({initialize:function(){this.DetailView=
f;this.modelSkeleton={permission:"read"};h.prototype.initialize.call(this)},add:function(a){var b=this.$userOrEmail.val();if(d.repo.owner&&b===d.repo.owner.username||d.repo.creator&&b===d.repo.creator.username){this.showError('User "'+b+'" already has access to this repository.');return false}h.prototype.add.call(this,a)},send:function(){this.on("success",function(){d.gaqPush(["atl._trackEvent","Share","Share repo"]);AJS.messages.success({body:"You have successfully shared this repository"})});h.prototype.send.call(this)}}),
i=h.extend({initialize:function(){this.DetailView=c;this.modelSkeleton={group:"developers"};var a;a:{if(this.options.groups.length===2){var d=false,e=false;b.each(this.options.groups,function(a){a.name==="Administrators"&&a.permission==="admin"?d=true:a.name==="Developers"&&a.permission==="write"&&(e=true)});if(d&&e){a=false;break a}}a=true}this.hasCustomGroups=a;h.prototype.initialize.call(this)},send:function(){this.on("success",function(){d.gaqPush(["atl._trackEvent","Share","Share team"]);AJS.messages.success({body:"You have successfully shared this team"})});
h.prototype.send.call(this)}});d.share=d.share||{};d.share.ui=d.share.ui||{};d.share.ui.RepoShareForm=e;d.share.ui.TeamShareForm=i})(window.jQuery,window._,window.Backbone,window.BB);
BB.utils.guard("#share",function(a){var b=new AJS.Dialog({width:480,height:"auto",id:"share-dialog",closeOnOutsideClick:true}),e="#share .share-form",d,g;b.addLink("Manage this repository",null,"manage-repository",a.data("access-url"));var f=$("#share-team").length>0;if(f){b.popup.element.addClass("is-team");b.addLink("Manage this team",null,"manage-team",a.data("groups-url"));e="#share-repository .share-form"}d=(new BB.share.ui.RepoShareForm({el:$(e),dialog:b})).render();b.addHeader("Share");b.addPanel("Invite",
a,"panel-body");a.show();b.addButton("Share",function(){$("#share .tabs-pane:visible").attr("id")==="share-team"?g.trigger("send"):d.trigger("send")},"aui-button aui-style");b.addCancel("Cancel",function(a){a.hide()});AJS.bind("show.dialog",function(a,c){if(c.dialog.id==="share-dialog"){d.collection.reset();g&&g.collection.reset();f&&!g&&$.ajax({url:BB.api.concat("groups",BB.repo.owner.username)}).success(function(a){g=(new BB.share.ui.TeamShareForm({groups:a,el:$("#share-team .share-form"),dialog:b})).render()})}});
var c=$("#share-dialog .manage-repository"),h=$("#share-dialog .manage-team");AJS.bind("tabSelect",function(a,b){if(b.tab.attr("href")==="#share-repository"){c.show();h.hide()}else if(b.tab.attr("href")==="#share-team"){c.hide();h.show()}});$(document.body).on("click","a.share",function(a){a.preventDefault();b.show();BB.gaqPush(["atl._trackEvent","Share","Share repo header"])})});
BB.utils.guard("#repo-admin",function(a){var b=BB.utils.canonicalPathname,e=$("#repo-admin-nav").find("a");BB.initialize.register(function(){var d=e.filter('a[href="'+b()+'"]');e.closest("li").removeClass("aui-nav-selected");d.closest("li").addClass("aui-nav-selected");BB.utils.chosen(a)});a.pjax("#repo-admin-nav a",{container:"#pjax-main",scrollTo:null});BB.utils.ready(".nav-toggle",function(b){var e=b.attr("data-toggle-type"),f=b.data("toggle-type"),c=b.find("input:radio"),h=c.filter(":checked")[0],
i=b.find("button:submit"),j=false;b.submit(function(l){l.preventDefault();l=c.filter(":checked")[0];if(j)return false;h=l;j=true;i.addClass("loading").addClass("disabled").attr("aria-disabled",true).prop("disabled",true);var m=$(h).data(),l={on:m.on,"private":m["private"],authenticated_issue_creation:!$("#allow-anonymous-issues").is(":checked")};if(e=="issues")l.issueservice=m.issueservice;$.ajax({url:b.data("url"),type:"PUT",data:JSON.stringify(l),success:function(){j=false;BB.delay(500,function(){i.removeClass("loading").removeClass("disabled").attr("aria-disabled",
false).prop("disabled",false)});a.toggleClass("has-"+f,m.on);$("#"+f+"-tab").toggleClass("hidden",!m.on)},error:function(a){AJS.messages.error({body:a.responseText});j=false;BB.delay(500,function(){i.removeClass("loading").removeClass("disabled").attr("aria-disabled",false).prop("disabled",false)})}})})})});
BB.utils.guard("#repo-admin",function(){var a=function(){var a=$(this),e=_.all(a.find("input.url"),function(a){var b=BB.valid.url(a.value)||a.value===""&&!a.required;if(!b){var a=$(a),c=a.siblings(".error");if(!c.length){c=$('<div class="error"></div>');a.after(c)}c.html("<div>Invalid URL</div>").show()}return b}),d=a.find("iframe"),d=$(".error",d[0].contentDocument);if(d.length){e=false;a.find(".main-form").prepend(d);d.removeClass("hidden");$(window).scrollTo(d)}e?$.ajax(BB.utils.ajaxOptions(this,
{success:function(a){if(a.valid)window.location.href=a.url;else{$("#pjax-main").html(a.html);BB.initialize()}}})):$(this).find("input:submit").prop({disabled:false})};BB.utils.delegate("#admin-settings-form","submit",function(b){b.preventDefault();var e=$(this);e.find(".main-form .error").remove();var d=e.find("iframe");if($("#project-logo-form #id_image",d[0].contentDocument).val()){d.load(a.bind(e,b));e.find("input:submit").prop({disabled:true});$("#project-logo-form",d[0].contentDocument).submit()}else a.bind(e)()})});
jQuery(function(a){BB.utils.ready("#user-access-template",function(){var b=BB.api.concat("privileges",BB.repo.owner.username,BB.repo.slug),e=BB.api.concat("invitations",BB.repo.owner.username,BB.repo.slug),d=Backbone.Model.extend({initialize:function(){var a=this.get("user"),b;b=a.is_team?a.first_name||a.username:a.first_name&&a.last_name?"{first_name} {last_name}".format(a):a.username;this.set({id:a.username,avatar:a.avatar||BB.images.noAvatar,name:b,username:a.username})},toJSON:function(){var a=
Backbone.Model.prototype.toJSON.call(this);if(a.privilege=="creator"||a.privilege=="owner")a.isEditable=false;else{a.isEditable=true;a[a.privilege]=true}return a},url:function(){return b.toString(this.get("username"))},sync:function(a,b,c){if(a==="update"){c.contentType="text/plain";c.data=b.get("privilege")}return Backbone.sync.call(this,a,b,c)}}),g=Backbone.Collection.extend({model:d,url:b.toString(),comparator:function(a){var b=a.get("privilege");return[b=="owner"?0:1,b=="creator"?0:1,a.get("name").toLowerCase()]},
parse:function(a){return _.map(a,function(a){a.id=a.user.username;return a})}}),f=Backbone.Model.extend({toJSON:function(){var a=Backbone.Model.prototype.toJSON.call(this);a.isEditable=true;a[a.permission]=true;return a},url:function(){return e.toString(this.get("email"))}}),c=Backbone.Collection.extend({model:f,url:e.toString(),comparator:function(a){return a.get("email")},parse:function(a){return _.map(a,function(a){a.id=a.user.email;return a})}}),h=function(b){return b===BB.user.username&&a("#user-account-privilege").data().priv!==
"admin"},i=Backbone.View.extend({tagName:"tr",template:"user-access-template",events:{'click [href="#delete"]':"remove","click .access li[data-privilege]:not(.selected)":"update"},initialize:function(){this.model.on("change",this.render,this);this.model.view=this},render:function(){this.$el.html(BB.Mustache.to_html(this.template,this.model.toJSON()));return this},remove:function(){if(this.removing)return this;this.removing=true;var a=this.$el,b=a.find('a[href="#delete"]'),c=setTimeout(function(){b.addClass("loading")},
200);if(h(this.model.get("username")))if(confirm("You are about to revoke your own admin access to this repository."))this.model.destroy({success:location.reload.bind(location),wait:true});else{this.removing=false;clearTimeout(c);b.removeClass("loading")}else this.model.destroy({success:function(){clearTimeout(c);b.removeClass("loading");a.slideUp(function(){a.remove()})},wait:true});return false},update:function(b){if(!this.removing){h(this.model.get("username"))?confirm("You are about to revoke your own admin access to this repository.")&&
this.model.save({privilege:a(b.target).data("privilege")},{success:location.reload.bind(location),wait:true}):this.model.save({privilege:a(b.target).data("privilege")});return this}}}),j=Backbone.View.extend({tagName:"tr",template:"user-access-template",events:{"click .resend-invitation a":"resend",'click [href="#delete"]':"remove","click .access li[data-privilege]:not(.selected)":"update"},initialize:function(){this.model.on("change",this.render,this);this.model.view=this},render:function(){this.$el.html(BB.Mustache.to_html(this.template,
this.model.toJSON()));return this},resend:function(b){b.preventDefault();a.ajax({url:this.model.url(),type:"POST",data:this.model.toJSON(),success:function(){a(b.target).closest(".resend-invitation").fadeOut(200,function(){a(this).replaceWith('<span class="aui-lozenge aui-lozenge-success">Invitation sent</span>').fadeIn(200)})}})},remove:function(){if(this.removing)return this;this.removing=true;var a=this.$el,b=a.find('a[href="#delete"]'),c=setTimeout(function(){b.addClass("loading")},200);this.model.set({id:this.model.get("email")});
this.model.destroy({success:function(){clearTimeout(c);b.removeClass("loading");a.slideUp(function(){a.remove()})},wait:true});return false},update:function(b){if(!this.removing){this.model.save({id:this.model.get("email"),permission:a(b.target).data("privilege")});return this}}});new (Backbone.View.extend({el:a("#repo-access-pane"),events:{'click button[type="submit"]':"create"},initialize:function(){this.$table=this.$("#user-access");this.$form=this.$("#grant-access");this.$privilege=this.$("#access-level");
this.$username=this.$("#username");this.submitDisabled=false;this.$error=this.$(".error");this.userCollection=new g;this.invitationCollection=new c;a.get(this.userCollection.url,function(b){var c,e,f;f=function(a){var b={avatar:a.avatarUrl};_.each(["username","firstName","lastName","isTeam"],function(c){b[c.replace(/[A-Z]/g,"_$&").toLowerCase()]=a[c]});return b};e=new d({privilege:"owner",user:f(a("#repository-owner-userjson").data().userjson)});var g=a("#repository-creator-userjson");g.length>0&&
g.data().priv.username!==BB.repo.owner.username&&(c=new d({privilege:"creator",user:f(g.data().priv)}));this.userCollection.add(b);this.$table.find("tr.loading").remove();this.$table.find("tr.form").after(this.userCollection.reduce(function(a,b){var c=new i({model:b});c.appView=this;return a.add(c.render().el)}.bind(this),a()));if(c){this.userCollection.add(c);b=new i({model:c,className:"creator"});b.appView=this;this.$table.find("tr.form").after(b.render().el)}this.userCollection.add(e);e=new i({model:e,
className:"owner"});e.appView=this;this.$table.find("tr.form").after(e.render().el);this.$el.show()}.bind(this));a.get(this.invitationCollection.url,function(b){this.invitationCollection.add(b);this.$table.find("tr.loading").remove();this.$table.append(this.invitationCollection.reduce(function(a,b){var c=new j({model:b});c.appView=this;return a.add(c.render().el)}.bind(this),a()));this.$el.show()}.bind(this))},respond:function(a){if(a){this.$error.removeClass("hidden");this.$error.find(".message").text(a)}else{this.$error.addClass("hidden");
this.$error.find(".message").text("")}},create:function(c){c.preventDefault();var e,f=this.$username.val().trim(),g=a(c.target).closest(".repo-access-form").find(".access-level select");if(!this.submitDisabled&&f)if(this.userCollection.get(f))this.respond("{} already has access.".format(f));else{this.submitDisabled=true;e=BB.delay(400,function(){this.$form.addClass("loading");a(c.target).addClass("disabled").prop("disabled",true).attr("aria-disabled",true)}.bind(this));var h=BB.utils.decorate(function(){this.submitDisabled=
false;window.clearTimeout(e);this.$form.removeClass("loading");a(c.target).removeClass("disabled").prop("disabled",false).attr("aria-disabled",false)},this);a.ajax({url:b.toString(f),type:"PUT",contentType:"text/plain",data:g.val(),error:h(function(a){var b,c=true;switch(a.status){case 403:b={html:'<strong>Congratulations, it\'s time to upgrade to the next level! </strong><br> Committers have read-only access. <a href="/plans">Upgrade now!</a>'};break;case 404:if(BB.valid.email(f))if(this.invitationCollection.filter(function(a){return a.get("email")===
f}).length>0)b=f+" has already been invited";else{c=false;a=this.invitationCollection.create({email:f,permission:g.val()});a=new j({model:a});a.appView=this;this.$table.append(a.render().el);this.respond();this.$username.val("")}else b='No user named "'+f+'".';break;default:b=a.responseText}c&&this.respond(b)}),success:h(function(a){var a=new d(a[0]),b=this.userCollection.get(a.get("username"));if(b){b.set({privilege:a.get("privilege")});b.view.render()}else{b=new i({model:a});b.appView=this;b.render();
this.userCollection.add(a);BB.utils.sortedInsert(a,this,this.userCollection)}this.respond();this.$username.val("").focus()}.bind(this))})}}}))})});
jQuery(function(a){BB.utils.ready("#group-access-template",function(){var b=[BB.repo.owner.username,BB.repo.slug],e=BB.api.concat("group-privileges",b),b=BB.api.concat("_group-privileges-to-add",b),d=Backbone.Model.extend({url:function(){var a=this.get("group");return e.toString(a.owner.username,a.slug)},initialize:function(a){a=a.group;this.set({id:a.owner.username+":"+a.slug})},toJSON:function(){var a=Backbone.Model.prototype.toJSON.call(this);a[a.privilege]=true;return a},sync:function(a,b,c){if(a===
"update"){c.contentType="text/plain";c.data=b.get("privilege")}return Backbone.sync.call(this,a,b,c)}}),g=Backbone.Collection.extend({model:d,url:e.toString(),comparator:function(a){return a.get("group").name.toLowerCase()}}),f=Backbone.View.extend({tagName:"tr",template:"group-access-template",events:{'click [href="#delete"]':"clear","click .access li":"update"},initialize:function(){_.bindAll(this,"render");this.model.bind("change",this.render);this.model.view=this},render:function(){a(this.el).html(BB.Mustache.to_html(this.template,
this.model.toJSON()));return this},remove:function(){var b=a(this.el).slideUp(function(){var d=b.siblings().length;b.remove();d||a("#group-access").hide();c()})},clear:function(b){b.preventDefault();if(this.removing)return this;this.removing=true;var c=a(this.el).find('a[href="#delete"]'),d=setTimeout(function(){c.addClass("loading")},200);this.model.destroy({success:this.remove.bind(this),error:function(a,b){this.removing=false;clearTimeout(d);c.removeClass("loading");var e=b.responseText,e=e?e.substr(0,
140):"An unknown error occurred.";this.parent.respond(e)}.bind(this)});return this},update:function(a){this.model.save({privilege:a.target.innerHTML},{success:c});return this}}),c=a.get.bind(a,b.toString(),function(b){var b=[a('<option value="">Select a group\u2026</option>')].concat(_.map(b,function(b){var c=b.owner.username+":"+b.slug;return a("<option>").val(c).text(b.name+" ("+c+")")})),c=a("#groupname").empty();c.append.apply(c,b).trigger("liszt:updated")});new (Backbone.View.extend({el:a("#repo-group-access-pane"),
events:{"click button:submit":"create"},initialize:function(){this.$table=this.$("#group-access");this.$form=this.$("#grant-group-access");this.$error=this.$(".error");c();this.submitDisabled=false;this.collection=new g;this.collection.fetch({success:function(b){this.$table.find("tr.loading").remove();b.length&&this.$table.find("tr.form").after(b.reduce(function(a,b){var c=new f({model:b});c.parent=this;return a.add(c.render().el)},a()))}.bind(this)})},respond:function(a,b){if(a){this.$error.removeClass("hidden");
this.$error.find(".message")[b?"html":"text"](a)}else{this.$error.addClass("hidden");this.$error.find(".message").text("")}},create:function(b){b.preventDefault();var g,j=a("#groupname").val(),l,m=a(b.target).closest(".repo-access-form").find(".access-level select");this.$form.addClass("loading");a(".ui-autocomplete").hide();if(!this.submitDisabled&&j)if(g=this.collection.get(j))this.respond("{owner.username}:{slug} already has access.".format(g));else{this.submitDisabled=true;l=BB.delay(400,function(){this.$form.addClass("loading");
a(b.target).addClass("disabled").prop("disabled",true).attr("aria-disabled",true)}.bind(this));g=BB.utils.decorate(function(){this.submitDisabled=false;window.clearTimeout(l);this.$form.removeClass("loading");a(b.target).removeClass("disabled").prop("disabled",false).attr("aria-disabled",false)},this);a.ajax({url:e.toString(a("#groupname").val().split(":")),type:"PUT",contentType:"text/plain",data:m.val(),error:g(function(a){switch(a.status){case 403:this.respond('<strong>Your private repositories are over their user limit.</strong> Committers have read-only access. <a href="/plans">Upgrade my plan</a>.',
true);break;case 404:this.respond("No group named \u201c"+j+"\u201d.");break;default:this.respond(a.responseText)}}),success:g(function(a){this.respond();a=new d(a[0]);(new f({model:a})).render().parent=this;BB.utils.sortedInsert(a,this).add();this.$table.show();c()})})}}}))})});
BB.utils.guard("#repo-admin",function(){BB.utils.delegate("#admin-services button:submit","click",function(a){a.preventDefault();var a=$(this),b=a.closest("form");if(b.find("select").val()!=0){b=BB.utils.ajaxOptions(b);a.addClass("loading");if(b.data)b.data=b.data+"&";b.data=b.data+(encodeURIComponent(a.attr("name"))+"="+encodeURIComponent(a.attr("value")));var e=new Date;a.hasClass("save")&&a.width(a.outerWidth()).val("Saving...").attr({disabled:"disabled"});b.success=function(a){setTimeout(function(){$("#pjax-main").html(a);
BB.initialize()},Math.max(0,500-(new Date-e)))};$.ajax(b)}})});
(function(){var a=Backbone.Model.extend({initialize:function(a){this.id=a.alias;this.set({avatar:a.avatar||BB.images.noAvatar,display_name:this.displayName()})},displayName:function(){var a=this.get("first_name"),b=this.get("last_name");return a&&b?a+" "+b:this.get("username")},url:function(){return BB.utils.canonicalPathname()+"/"+this.get("username")+"/"+this.get("alias")}}),b=Backbone.Collection.extend({model:a,comparator:function(a){return[a.displayName().toLowerCase(),a.get("alias")]},url:BB.utils.canonicalPathname}),
e=Backbone.View.extend({tagName:"tr",events:{'click a[href="#delete"]':"remove"},initialize:function(){this.$el.html(BB.Mustache.to_html("username-mapping-template",this.model.toJSON()))},remove:function(a){a.preventDefault();this.$el.addClass("waiting");this.model.destroy()}}),d=Backbone.View.extend({events:{submit:"add"},initialize:function(){this.$username=this.$("#username");this.$alias=this.$("#alias");this.$error=this.$(".error");this.$table=this.$("table.widget");this.collection.each(function(a){a.view=
new e({model:a});a.collection=this.collection;this.$table.append(a.view.el)}.bind(this));this.$table.find("tr.loading").remove();this.collection.on("add",function(a){a.view=new e({model:a});a.collection=this.collection;BB.utils.sortedInsert(a,this)},this);this.collection.on("remove",function(a){var b=$(a.view.el);b.slideUp(function(){b.remove()})})},add:function(b){b.preventDefault();var d=this.$username.val().trim(),b=this.$alias.val().trim(),c=[];d||c.push("Username is required.");b||c.push("Alias is required.");
if(c.length)return this.respond(c.join(" "));b=new a({username:d,alias:b});b.save({},{success:function(a){this.collection.add({username:d,first_name:a.get("first_name"),last_name:a.get("last_name"),alias:a.get("committer")});this.$username.val("").focus();this.$alias.val("");this.respond()}.bind(this),error:function(a,b){this.respond($.parseJSON(b.responseText).msg)}.bind(this),wait:true})},respond:function(a){if(a){this.$error.removeClass("hidden");this.$error.find(".message").text(a)}else{this.$error.addClass("hidden");
this.$error.find(".message").text("")}}});BB.utils.ready("#username-mapping",function(a){var e=new b(a.find("form").data("json"));new d({collection:e,el:a})})})();
BB.utils.guard("#repo-admin",function(){BB.utils.ready("#repository-links",function(a){var b=bitbucket.repository(BB.repo.owner.username,BB.repo.slug),e=a.find(".repo-links-list tbody");$(".link-action").each(function(a,b){(new BB.dialog.FormDialog(b,{success:function(){document.location.reload()},error:function(a,b){$(".field-group .error").remove();$("#repo-link-errors").addClass("hidden");var d=BB.utils.processFormErrors(b.responseText);$.each(d,function(a,b){var c=$('[name="'+a+'"]');if(c.length===
0)$("#repo-link-errors").removeClass("hidden").find(".message").text(b);else{var d=$("<div>").addClass("error").text(b);c.after(d)}})}})).bind()});$(".delete-link").click(function(a){a.preventDefault();var g=$(a.target).closest("tr"),a=g.data();b.delete_linkifier(a.id,{success:function(){g.remove();e.find("tr").length||e.append($("<tr><td>There are no links configured.</td><td></td><td></td></tr>"))},error:function(){$("#link-errors").text("There was an error communicating with the server, please try again.")}})})})});
BB.utils.guard("#repo-admin",function(){var a=bitbucket.repository(BB.repo.owner.username,BB.repo.slug);BB.utils.ready("#deploy-keys",function(b){var e=$("#edit-ssh-key");BB.SSHKeys(b,{onEdit:function(b,g){a.update_deploy_key(e.find("#ssh_pk").val(),b,g)},onCreate:function(b,e){a.create_deploy_key(b,e)},onDelete:function(b,e){a.delete_deploy_key(b,e)}})})});
BB.utils.guard("#repo-admin",function(a){a.on("submit","#strip-repository form",function(a){a.preventDefault();_.any($(this).serializeArray(),function(a){return a.name==="action"&&a.value==="confirm-strip"})?$.ajax(BB.utils.ajaxOptions(this,{success:function(a){a.valid?$.pjax({container:"#pjax-main",url:a.url}):$("#pjax-main").html(a.html)}})):$.ajax(BB.utils.ajaxOptions(this,{headers:{"X-PJAX":true},success:function(a){$("#pjax-main").html(a)}}))});BB.utils.ready("#strip-repository .stripping",function(){BB.delay(1E3,
function(){jQuery.pjax({container:"#pjax-main",url:window.location.href})})})});BB.utils.guard("#repo-admin",function(){BB.utils.ready("#transfer-repository",function(a){a.find("#id_user").addClass("bb-user-team-typeahead")})});BB.utils.guard("#repo-admin",function(a){a.on("submit","#delete-repository form",function(){return confirm("This is a destructive operation. Delete repository?")})});
BB.utils.ready("#issues-admin",function(a){var b=$('[name="issue-tracker"]'),e=a.find(".anon-permissions"),a=function(){b.filter(":checked").data("private")?e.slideUp(400):e.slideDown(400)};b.on("click",a);a()});
BB.utils.guard("#repo-admin",function(){var a,b,e,d,g=Backbone.Model.extend({initialize:function(){var a=/^(.)(.+?)s$/.exec(this.category);this.label=a[1].toUpperCase()+a[2]},messages:{"already-exists":function(a){return this.label+' "'+a+'" already exists!'},unknown:function(){return"An unknown error occurred."}},message:function(a){return this.messages[a].apply(this,_.toArray(arguments).slice(1))},validate:function(a){if(this.isNew()&&this.collection.contains(a.name))return this.message("already-exists",
a.name)},url:function(){var a=this.collection.url();return this.id?/^(.*?)\/?$/.exec(a)[1]+"/"+this.id:a}}),f={create:function(a){var b=Backbone.Collection.extend(this.mixin);b.prototype.model=g.extend({category:a});return new b},mixin:{comparator:function(a){return a.get("name").toLowerCase()},contains:function(a){return this.any(function(b){return b.get("name")===a})},url:function(){return window.location.pathname}}},c=Backbone.View.extend({tagName:"tr",events:{'click a[href="#edit"]':"rename",
'click a[href="#default"]':"toggle",'click a[href="#delete"]':"destroy"},initialize:function(){this.$el.html(BB.Mustache.to_html("issues-category-template",{name:this.model.get("name"),singular:/^(.+)s$/.exec(this.model.category)[1]}));this.setDefaultState()},setDefaultState:function(){this.model.get("default")?this.$el.attr({title:"Remove default"}).addClass("default"):this.$el.attr({title:"Set as default"}).removeClass("default")},startWaiting:function(){return this.$el.addClass("waiting")},stopWaiting:function(){return this.$el.removeClass("waiting")},
rename:function(c){c.preventDefault();a.getCurrentPanel().body.find("#edit_category_name").val(this.model.get("name"));d=function(){var a=this.$el,c=this.model.get("name"),d=b.val().trim();d&&d!==c&&this.model.save({name:d},{success:function(b){this.parent.respond();BB.utils.sortedInsert(b,this.parent);a.find("td.name > div").text(d)}.bind(this),error:function(b,e){a.find("td.name > div").text(c);this.parent.respond(this.model.message(e.status===409?"already-exists":"unknown",d))}.bind(this),wait:true})}.bind(this);
a.show()},toggle:function(a){a.preventDefault();this.startWaiting();this.model.save({"default":!this.model.get("default")},{success:function(a){a.view.stopWaiting().trigger("setdefaultitem",a.get("default")?a:null)},wait:true})},destroy:function(a){a.preventDefault();this.startWaiting();this.model.destroy({success:function(a){var b=a.view.stopWaiting();b.slideUp(function(){b.remove()})},wait:true})}}),h=Backbone.View.extend({events:{setdefaultitem:"defaultItem",submit:"add"},initialize:function(){this.$table=
this.$("table.widget");this.$name=this.$("input:text");this.$error=this.$(".error");this.$table.find("tr.form").after(this.collection.reduce(function(a,b){var d=b.view=new c({model:b});d.parent=this;return a.add(d.el)}.bind(this),$()))},defaultItem:function(a,b){this.collection.each(function(a){a.set({"default":a===b});a.view.setDefaultState()})},add:function(a){a.preventDefault();if(a=this.$name.val().trim()){var b=this.collection,d=new b.model;d.collection=b;d.save({name:a},{error:function(a,b){this.respond(b)}.bind(this),
success:function(a){this.respond();a.view=new c({model:a});a.view.parent=this;BB.utils.sortedInsert(a,this).add();this.$name.val("").focus()}.bind(this),wait:true})}},respond:function(a){if(a){this.$error.removeClass("hidden");this.$error.find(".message").text(a)}else{this.$error.addClass("hidden");this.$error.find(".message").text("")}}}),i=Backbone.Collection.extend({comparator:function(a){return a.id.toLowerCase()},toString:function(){return this.map(function(a){return a.id}).join("\n")}}),j=c.extend({initialize:function(){this.$el.html(BB.Mustache.to_html("issues-notifications-template",
{email:this.model.get("id")}))},destroy:function(a){a.preventDefault();this.startWaiting().trigger("removeaddress",{model:this.model,success:function(){var a=this.stopWaiting();a.slideUp(function(){a.remove()});this.model.collection.remove(this.model)}.bind(this)})}}),l=Backbone.View.extend({events:{removeaddress:"remove",submit:"add"},initialize:function(){this.$table=this.$("table.widget");this.$address=this.$('input[type="text"]');this.$error=this.$(".error");this.token=this.$('input[name="csrfmiddlewaretoken"]').val();
this.collection=new i(_.map(this.$el.data("json"),function(a){return{id:a}}));this.$table.find("tr.form").after(this.collection.reduce(function(a,b){b.view=new j({model:b});return a.add(b.view.el)},$()))},sync:function(a,b){$.ajax({url:window.location.pathname,type:"POST",data:{addresses:a,csrfmiddlewaretoken:this.token},success:b.bind(this)})},add:function(a){a.preventDefault();var b=this.$address.val().trim();BB.valid.email(b)?this.collection.get(b)?this.respond(b+" is already listed!"):this.sync(this.collection+
"\n"+b,function(){this.respond();var a=new Backbone.Model({id:b});a.view=new j({model:a});BB.utils.sortedInsert(a,this).add();this.$address.val("")}):this.respond("Invalid email address.")},remove:function(a,b){var c=this.collection;this.sync(c.toString.call(c.reject(function(a){return a===b.model})),b.success)},respond:function(a){if(a){this.$error.removeClass("hidden");this.$error.find(".message").text(a)}else{this.$error.addClass("hidden");this.$error.find(".message").text("")}}});BB.utils.ready("#notifications",
function(a){new l({el:a})});_.each(["components","milestones","versions"],function(c){BB.utils.ready("#issues-"+c,function(g){var i=function(){d&&d();a.hide()};a=new AJS.Dialog({width:450,height:"auto",id:"bb-edit-category"});a.addPanel("main");e=a.getCurrentPanel();e.html('<form class="aui"><div class="field-group"><label>Name</label><input type="text" class="text" id="edit_category_name" name="edit_category_name"/></div></form>');b=e.body.find("#edit_category_name");var j=/^(.+)s$/.exec(c)[1];a.addHeader("Edit "+
j).addButton("Edit",i,"aui-button aui-style").addCancel("Cancel",function(a){a.hide()});e.body.find("form").submit(function(a){a.preventDefault();i()});j=f.create(c);j.reset(g.data("json"));new h({collection:j,el:g})})})});
BB.utils.guard("#repo-admin",function(){BB.utils.ready("#issue-export",function(a){function b(a){if(a.status==="SUCCESS"){a.downloadUrl=a.url;a.title="Issue export complete";a.closeLink=true}return a}var e=BB.progressDialog(a,{template:"export-dialog-template",title:"Issue export",id:"issue-export",height:"210",onComplete:function(a,g){e.update(b(g))},getStatus:function(a){var b="";return b=a.phase?"Exporting: "+a.phase:"Waiting for export to start..."}})})});
BB.utils.guard("#repo-admin",function(){BB.utils.ready("#issue-import",function(a){function b(a){if(a.status==="SUCCESS"){a.finished=true;a.title="Issue import complete";a.closeLink=true}return a}function e(){c.start(d,"get");$("#import-upload-file").val("");a.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled")}var d=a.attr("data-url"),g=$("#import-upload-file"),f=$("#import-upload-form"),c=BB.progressDialog({template:"import-dialog-template",title:"Issue import",id:"issue-import",
height:"210",onComplete:function(a,d){c.update(b(d))},getStatus:function(a){var b="";return b=a.phase?"Importing: "+a.phase:"Waiting for import to start..."}});f.on("submit",function(){$("#import-upload-target").one("load",e);a.addClass("loading").attr({"aria-disabled":true,disabled:true})});BB.uploadHandler(g,{$dropTarget:$("#import"),complete:function(b){if(b.status===202)e();else if(b.status>=400&&b.status<500){b=b.response;f.find(".error-container").empty().text(b);a.removeClass("loading")}},
fileSelected:function(b){if(b.name){f.find(".error-container").empty();a.removeAttr("aria-disabled").removeAttr("disabled")}}}).supports("fileReader")&&a.attr({"aria-disabled":true,disabled:true})})});
(function(a,b,e){var d=function(b,d){var c=b.find(".text"),h=b.data("follow-text")||"Follow",i=b.data("unfollow-text")||"Following",j=b.data("template");c.length||(c=b);if(j){var l=a(e.Mustache.to_html(j,{isFollowing:d}));b.replaceWith(l)}else if(d){b.addClass("following");c.text(i)}else{b.removeClass("following");c.text(h)}return l};a(document).on("toggle-follow","a.follow, button.follow",function(b,e){var c=a(b.target).closest("a.follow,button.follow"),c=d(c,e.isNowFollowing);c.trigger("follow:"+
e.type,e.isNowFollowing)});a(document).on("click","a.follow,button.follow",function(b){b.preventDefault();var f=a(b.target).closest("a.follow,button.follow"),c=f.attr("href")||f.data("url"),b=f.data("restful"),h=f.hasClass("following"),i="POST";f.attr("aria-disabled",true);f=d(f,!h);b&&(i=h?"DELETE":"POST");a.ajax({url:c,type:i,success:function(a){var b=a.following===void 0?a.is_watching:a.following,a=a.type;if(b===void 0)return window.location.pathname=c;var d={repo:["atl._trackEvent","Share","Follow Repo"],
user:["atl._trackEvent","Share","Follow User"],pullrequest:["atl._trackEvent","Notifications","Watch Pull Request"],issue:["atl._trackEvent","Notifications","Watch Issue"],commit:["atl._trackEvent","Notifications","Watch Commit"]};f.trigger("follow:"+a,b);b&&e.gaqPush(["atl._trackPageview","/"+a+"/follow"],d[a])},error:d,complete:function(){f.removeAttr("aria-disabled")}})});a(document).on("ready pjax:end",function(){a(".pullrequest-list, .issues-list").on("click","a.follow",function(b){var b=a(b.target),
d=b.closest(".iterable-item").find(".title, .text").text(),c=(d=/#(\d+):/.exec(d))?d[1]:null,d=!b.hasClass("following"),b=b.data("type"),b=c?b+" #"+c:"this "+b;d?AJS.messages.info({body:"You are now watching "+b+"."}):AJS.messages.info({body:"You are no longer watching "+b+"."})})})})(jQuery,_,BB);
BB.utils.guard("#profile",function(a){function b(a,b){var d=a.data("follow-text")||"Follow",e=a.data("unfollow-text")||"Following";a.toggleClass("following",b).text(b?e:d)}$("button.follow-user").hasClass("following");var e=$("#profile-tabs");if(a.data("ownProfile"))e.on("follow:user","button.follow",function(a,b){var d=$("#profile-following-count").find(".count"),e=+d.text();b?e++:e--;d.text(e<0?0:e)});$("#profile-follow-button, #blank-slate-follow-button").on("follow:user",function(a,c){var d=$("#profile-followers"),
e=$("#profile-followers-count"),g=+e.find(".count").text();c&&!g?d.find("li.empty").addClass("hidden"):!c&&g===1&&d.find("li.empty").removeClass("hidden");d.find("li.current-user").toggleClass("hidden",!c);b($("#profile-follow-button"),c);b($("#blank-slate-follow-button"),c);c?g++:g--;g=g<0?0:g;e.html('<span class="count">'+g+"</span> "+(g==1?"Follower":"Followers"))});e.on("follow:user","button.follow",function(a,b){var d=$(a.target).closest(".user").find(".followers-count"),e=+d.find(".count").text();
b?e++:e--;e=e<0?0:e;d.html('<span class="count">'+e+"</span> "+(e==1?"follower":"followers"))}).on("follow:repo","button.follow",function(a,b){$(a.target).closest(".repository").find(".followers-count").html(' <span class="count">'+b.followers+"</span> "+(b.followers===1?"follower ":"followers "))});var d=e.find("ul.tabs-menu li"),g=e.find("#profile-tab-content");g.on("pjax:end",function(a){var b=g.find("> div:first").attr("id");d.removeClass("active-tab");$("#"+b+"-tab").addClass("active-tab");$(a.target).removeClass("has-mask")}).on("pjax:error",
function(a,b,d){if(b.readyState>0&&d!=="abort"){$(a.target).html("<h2>Oops!</h2><p>Something has gone terribly wrong...</p>");return false}}).on("pjax:beforeSend",function(a){$(a.target).addClass("has-mask")});if($.support.pjax)d.on("click","a",function(a){var b=$(a.target).closest("li");a.preventDefault();$.pjax($.extend({url:$(this).attr("href"),push:true},{container:g,scrollTo:null,timeout:3E4}));g.empty();d.removeClass("active-tab");b.addClass("active-tab")})});
(function(a){a.CommentCountIndicator=function(a,b){this.$countElem=a;this.$commentContainer=b};a.CommentCountIndicator.prototype.decorate=function(){this.$commentContainer.on("comment-count/create",$.proxy(this.updateCount,this));this.$commentContainer.on("comment-count/delete",$.proxy(this.updateCount,this))};a.CommentCountIndicator.prototype.updateCount=function(){var a=this.$commentContainer.find("li.comment:not(.deleted)").length,b=this.$commentContainer.find(".eclipsedcount span").text();b&&
(a=a+parseInt(b));this.$countElem.html(a);a===0?this.$countElem.closest(".count-badge").addClass("zero"):this.$countElem.closest(".count-badge").removeClass("zero")};a.createCommentHandler=function(b,c){function d(a,b,c,f){_.each(a,function(g){if(g.parent_id===b){var j=e(g);if((d(a,g.comment_id,c,j.find(".child-comments"))||!g.deleted)&&(w==="admin"||!g.is_spam))f.find(".new-comment").length?f.find(".new-comment").before(j):f.append(j)}});return _.any(a,function(a){return a.parent_id===b&&!a.deleted})}
function e(b){if(!b.deleted){(w==="admin"||!b.is_spam)&&p++;b.isAuthenticated=a.user.isAuthenticated;b.isEditable=a.user.username===b.username;b.isAdmin=w==="admin";b.utc_created_on=b.utc_created_on.replace(" ","T")}b=$("<li></li>").html(a.Mustache.to_html("comment-template",b));b.addClass("comment");b.find("time").data("title",true).localize();a.localize();return b}function g(){$("#comments-count").text(p)}function l(a){for(var a=$(a),b=a.children(".deleted")&&a.children(".deleted").length===1,c=
a.children(".child-comments").children(),d=false,e=0;e<c.length;e++)l(c[e])||(d=true);if(b&&!d){a.remove();return true}return false}function m(a,b){a.find("p.err0r").text(b)}function n(a){r.find(".highlight").removeClass("highlight");a.addClass("highlight")}function q(){r.find(".highlight").removeClass("highlight");r.find(".focused").removeClass("focused");r.find(".editor textarea").blur();r.find(".comment .editing").each(function(){$(this).removeClass("editing")});r.find(".comment .replying").each(function(){$(this).removeClass("replying")})}
var p=0,w=$("#user-repo-privilege-data").data().priv,r=c.find("#comments-list:not(.line-commenting)");r.delegate(".reply-link","click",function(a){var b,c;q();b=$(this).closest(".comment article");c=b.next(".child-comments");var d;if(c.children(".new-comment").length==0){d=r.children(".new-comment").clone();c.prepend(d)}else d=c.children(".new-comment");b.addClass("replying");d.find(".parent_id").val(b.data("commentId"));m(b,"");d.find("textarea").focus();a.preventDefault()});r.delegate(".edit-link",
"click",function(a){var b,c,d,e;q();e=$(this).closest(".comment article");d=e.data("content");if(e.children(".editor").length==0){b=r.children(".new-comment").find(".editor").clone();e.find(".comment-content").after(b)}else b=e.children(".editor");c=b.find("textarea");c.data("originalComment",d);c.val(d);b.find(".comment_id").val(e.data("commentId"));e.addClass("editing");m(e,"");c.focus();a.preventDefault()});r.bind("keydown",function(a){if(a.keyCode===$.ui.keyCode.ESCAPE){q();a.preventDefault()}});
r.find(".editor").on("keydown",'button[type="submit"]',function(a){a.keyCode===13&&$(this).closest("form.editor").submit()}).on("submit",function(a){var c=$(this),d=c.closest("form.editor"),h=d.find(".parent_id").val(),l=d.find(".comment_id").val(),p=d.find("textarea"),q=p.val(),w;c.attr("aria-disabled",true).attr("disabled",true);if(q==null||q===""){m(d,"Comments can't be empty! Please enter some text.");p.focus();c.removeAttr("aria-disabled").removeAttr("disabled")}else{m(d,"");var u={parent_id:h,
content:q};if(l){q="PUT";w=b.toString(l)}else{q="POST";w=b.toString()}$.ajax({type:q,url:w,data:u,success:function(a){if(l){var b=$("#comment-"+l);b.find(".comment-content").html(a.content_rendered);b.removeClass("editing")}else{a=e(a);a.hide();if(h){var d=$("#comment-"+h),b=d.next(".child-comments");b.append(a);d.removeClass("replying")}else{b=r.children(".new-comment");b.before(a)}n(a);a.fadeIn("fast")}p.val("");c.removeAttr("aria-disabled").removeAttr("disabled");r.find(".focused").removeClass("focused");
g()},error:function(){m(d,"An error occurred while submitting this comment.");c.removeAttr("aria-disabled").removeAttr("disabled")}})}a.preventDefault()});r.delegate(".delete-link","click",function(a){if(confirm("Are you sure you want to remove this comment?")){var c=$(this).closest("article").data("commentId");$.ajax({type:"DELETE",url:b.toString(c),success:function(){$("#comment-"+c).replaceWith('<div class="deleted">Comment deleted</div>');_.each(r.children(),l);p--;g()},error:function(){alert("There was an error removing the comment.")}})}a.preventDefault()});
r.delegate(".editor","focus",function(){var a=$(this).closest(".editor");r.find(".focused").removeClass("focused");a.addClass("focused")});r.delegate(".permlink","click",function(){n($(this).closest(".comment"))});return{initializeComments:function(){var a=r.children(".new-comment");a.find("textarea").val("");a.find(".comment_id").val("");a.find(".parent_id").val("");r.find("button[type=submit]").removeAttr("disabled").removeAttr("aria-disabled");var b=window.location.hash;(a=$("#comments-json").data("user-comments"))&&
a.length&&d(a,null,null,r);/^#comment-/.test(b)&&n($(b).closest(".comment"));g()}}};a.comments=a.comments||{};var b=a.comments.Comment=Backbone.Model.extend({initialize:function(a,b){this.urlRoot=b.urlRoot},idAttribute:"comment_id",parse:function(b){b.isAuthenticated=a.user.isAuthenticated;b.isEditable=b.username===a.user.username;b.isAdmin=$("#user-repo-privilege-data").data().priv==="admin";b.utc_created_on=b.utc_created_on.replace(" ","T");b.convert_markup=b.convert_markup==="True";return b}});
a.comments.ui={};var e=a.comments.ui.GeneralCommentForm=function(a,b){this.endPoint=a;this.comment=this.newModel();this.commentForm=new d(this.comment);this.insertWhere=b?"before":"after";this.$elem=null};e.prototype.newModel=function(){var a=new b({content:""},{urlRoot:this.endPoint.toString()});a.on("sync",_.once(this.insertNewComment),this);return a};e.prototype.decorate=function(a){this.$elem=a;this.commentForm.decorate(a);this.enterDocument();return this};e.prototype.enterDocument=function(){};
e.prototype.insertNewComment=function(a){(new g(a)).render(this.$elem,this.insertWhere);$(document).trigger("comment-added");this.comment=this.newModel();this.commentForm.comment=this.comment;this.commentForm.shrinkSize();this.commentForm.clearContents()};e=a.comments.ui.CommentableDiff=function(a,b,e,i,j){this.endPoint=a;this.filename=b;this.anchor=i;this.destrev=j;this.commentForm=new d;this.$elem=null;this.threads=g.decorateThreads(a.toString(),e,b)};e.prototype.decorate=function(a){this.$elem=
a;this.enterDocument();return this};e.prototype.enterDocument=function(){this.$elem.on("click",".add-line-comment",$.proxy(this.showForm,this));$(this.commentForm).bind("comment-form/cancel",$.proxy(this.hideForm,this));var a=this;_.each(this.threads,function(b){$(b).bind("line-comment/thread-deleted",$.proxy(a.cleanUpThreads,a))})};e.prototype.showForm=function(a){a.preventDefault();this.hideForm();var a=$(a.target),c={content:"",filename:this.filename,anchor:this.anchor,dest_rev:this.destrev},d=
a.parent().data("fnum"),e=a.parent().data("tnum");d&&e||d?c.line_from=d:c.line_to=e;c=new b(c,{urlRoot:this.endPoint.toString()});this.commentForm.comment=c;c.on("sync",_.once(this.insertNewComment),this);a=a.parent();c=a.next(".comment-thread-container");c.length||(c=$('<div class="comment-thread-container"><ol class="comments-list"></ol></div>').insertAfter(a));c.removeClass("existing-comment");a=c.find(".comments-list");this.commentForm.$elem?this.commentForm.$elem.prependTo(a):this.commentForm.render(a);
this.commentForm.showAndFocus()};e.prototype.insertNewComment=function(a){var b=this.commentForm.$elem.parent(".comments-list"),a=(new g(a)).render(b);$(a).bind("line-comment/thread-deleted",$.proxy(this.cleanUpThreads,this));this.threads.push(a);this.hideForm();a.scrollTo();this.commentForm.clearContents();$(document).trigger("comment-added")};e.prototype.acceptLineComments=function(a){var b=this;_.each(a,function(a){$(a).bind("line-comment/thread-deleted",$.proxy(b.cleanUpThreads,b));b.threads.push(a)})};
e.prototype.cleanUpThreads=function(){_.each(this.$elem.find(".comment-thread-container:not(:has(li.comment))"),function(a){$(a).remove()})};e.prototype.hideForm=function(){if(this.commentForm.$elem){var a=this.commentForm.$elem.parent(".comments-list");this.commentForm.$elem.detach();a.children().length||a.parent(".comment-thread-container").remove()}};var d=a.comments.ui.CommentForm=function(a){this.comment=a;this.$convertMarkupWarning=this.$error=this.$preview=this.$cancel=this.$submit=this.$textarea=
this.$editor=this.$elem=null};d.prototype.errorMessages={400:"There was a problem submitting your comment.",403:"You are not permitted to comment.",404:"This comment has been deleted."};d.prototype.decorate=function(a){this.$elem=a;this.renderInternal();this.enterDocument();return this};d.prototype.renderInternal=function(){this.$editor=this.$elem.find("form.editor");this.$textarea=this.$editor.find("textarea");this.$submit=this.$editor.find("button[type=submit]");this.$cancel=this.$editor.find("a.cancel");
this.$preview=this.$editor.find("a.preview");this.$error=this.$elem.find(".error");this.$convertMarkupWarning=this.$elem.find(".convert-markup")};d.prototype.createDom=function(){var b=$.extend({user_avatar_url:a.user.avatarUrl,display_name:a.user.displayName},this.comment?this.comment.attributes:{});this.$elem=$(a.Mustache.to_html("new-comment-template",b))};d.prototype.render=function(a){this.createDom();this.renderInternal();a.prepend(this.$elem);this.enterDocument();return this};d.prototype.enterDocument=
function(){this.$textarea.on("focus",$.proxy(this.expandSize,this));this.$submit.on("click keydown",$.proxy(this.save,this));this.$cancel.on("click",$.proxy(this.cancel,this));this.$preview.on("click",$.proxy(this.preview,this))};d.prototype.expandSize=function(){var b=this.$textarea;this.$editor.addClass("focused");if(!this.$textarea.hasClass("markItUpEditor")){this.$editor.addClass("textarea-preview");this.$textarea.markItUp(a.markItUpSettings());setTimeout(function(){b.trigger("focus")},0)}};d.prototype.shrinkSize=
function(){this.$textarea.markItUpRemove();this.$editor.removeClass("textarea-preview");this.$editor.removeClass("focused")};d.prototype.cancel=function(b){b&&b.preventDefault();this.clearContents();a.utils.editContent(this.$preview,this.$editor);this.shrinkSize();$(this).trigger("comment-form/cancel")};d.prototype.clearContents=function(){this.$textarea.val("");this.clearError()};d.prototype.showAndFocus=function(){this.$editor.show();this.$elem.show();this.$textarea.focus();this.$convertMarkupWarning.toggle(this.comment.get("convert_markup"))};
d.prototype.isSubmitDisabled=function(){return this.$submit.prop("disabled")};d.prototype.disableSubmit=function(){this.$submit.prop("disabled",true).attr("aria-disabled","true")};d.prototype.enableSubmit=function(){this.$submit.prop("disabled",false).removeAttr("aria-disabled")};d.prototype.save=function(b){if(!(b.type==="keydown"&&b.keyCode!==13)){b.preventDefault();var c=this;if(!c.isSubmitDisabled()){var d=setTimeout(function(){c.clearError();c.$editor.addClass("loading")},300);c.disableSubmit();
c.comment.save({content:c.$textarea.val()},{wait:true,complete:function(){clearTimeout(d);c.$editor.removeClass("loading");c.enableSubmit();a.utils.editContent(c.$preview,c.$editor)},error:function(a,b){c.displayError(c.errorMessages[b.status])}})}}};d.prototype.displayError=function(a){this.$error.text(a)};d.prototype.clearError=function(){this.$error.text("")};var g=a.comments.ui.LineComment=function(a){this.comment=a;this.editCommentForm=new d(a);this.replyCommentForm=new d;this.$delete=this.$reply=
this.$edit=this.$replies=this.$content=this.$comment=this.$elem=null};g.decorateThreads=function(a,c,d){for(var e=[],j=0;j<c.length;j++){var l=$("#comment-{}".format(c[j]));if(l.length){var m={comment_id:l.data("comment-id"),content:l.data("content"),convert_markup:l.data("convert-markup")==="True"};if(d)m.filename=d;m=new b(m,{urlRoot:a});e.push((new g(m)).decorate(l,d,a))}}return e};g.prototype.decorate=function(a,c,d){this.$elem=a.parent(".comment");this.$elem.data("modelobj",this);this.findInternal();
this.enterDocument();var e=this;a.parent("li.comment").children(".child-comments").children("li.comment").children("article, .deleted-comment-message").each(function(){var a=$(this),f={comment_id:a.data("comment-id"),content:a.data("content"),convert_markup:a.data("convert-markup")==="True"};if(c)f.filename=c;f=new b(f,{urlRoot:d});a=(new g(f)).decorate(a,c,d);$(a).bind("line-comment/thread-deleted",$.proxy(e.cleanUpThread,e))});return this};g.prototype.scrollTo=function(){var a=0-($(window).height()/
2-this.$elem.height()/2);$.scrollTo(this.$elem,500,{axis:"y",offset:a});return this};g.prototype.createDom=function(){this.$elem=$('<li class="comment">').html(a.Mustache.to_html("comment-template",this.comment.attributes));this.$elem.data("modelobj",this);this.findInternal()};g.prototype.hasReplies=function(){return!!this.$elem.closest(".child-comments").length};g.prototype.findInternal=function(){this.$comment=this.$elem.children("article");this.$replies=this.$elem.children(".child-comments");if(!this.hasReplies())this.$contextDiff=
this.$elem.closest("#comments-list > li.comment:has(.bb-udiff)");this.$content=this.$comment.find(".comment-content");this.$edit=this.$comment.find(".edit-link");this.$reply=this.$comment.find(".reply-link");this.$delete=this.$comment.find(".delete-link");this.$time=this.$comment.find("time")};g.prototype.render=function(a,b){this.createDom();b==="before"?this.$elem.insertBefore(a):b==="after"?this.$elem.insertAfter(a):this.$elem.appendTo(a);this.enterDocument();this.$elem.trigger("comment-count/create");
return this};g.prototype.enterDocument=function(){this.comment.on("change",this.updateContent,this);this.comment.on("destroy",this.removeComment,this);this.$edit.on("click",$.proxy(this.edit,this));this.$reply.on("click",$.proxy(this.reply,this));this.$delete.on("click",$.proxy(this.deleteComment,this));$(this.editCommentForm).bind("comment-form/cancel",$.proxy(this.cancelEdit,this));$(this.replyCommentForm).bind("comment-form/cancel",$.proxy(this.cancelReply,this));this.$elem.hasClass("highlight")&&
setTimeout($.proxy(function(){this.$elem.animate({backgroundColor:"#fff"},{duration:1E3,complete:$.proxy(function(){this.$elem.removeClass("highlight")},this)})},this),2E3);a.localize(this.$time)};g.prototype.edit=function(a){a.preventDefault();this.$comment.addClass("editing");this.editCommentForm.$elem||this.editCommentForm.render(this.$elem);this.editCommentForm.$textarea.val(this.comment.get("content"));this.editCommentForm.$elem.insertAfter(this.$content);this.editCommentForm.showAndFocus()};
g.prototype.reply=function(a){a.preventDefault();a=new b({parent_id:this.comment.get("comment_id"),filename:this.comment.get("filename"),content:""},{urlRoot:this.comment.urlRoot});this.replyCommentForm.comment=a;this.replyCommentForm.$elem?this.replyCommentForm.$elem.prependTo(this.$replies):this.replyCommentForm.render(this.$replies);this.replyCommentForm.showAndFocus();a.on("sync",_.once(this.insertReply),this)};g.prototype.insertReply=function(a){this.replyCommentForm.$elem.detach();a=(new g(a)).render(this.$replies).scrollTo();
$(a).bind("line-comment/deleted",$.proxy(this.cleanUpThread,this));this.replyCommentForm.clearContents();this.$elem.trigger("comment-count/create");$(document).trigger("comment-added")};g.prototype.deleteErrorMessages={404:"Comment has been deleted already.",403:"You do not have permission to delete this message."};g.prototype.deleteComment=function(a){a.preventDefault();confirm("Are you sure you want to delete this comment?")&&this.comment.destroy({wait:true,error:function(a,b){alert(this.deleteErrorMessages[b.status]||
"A problem occurred processing your request.")}.bind(this)})};g.prototype.cleanUpThread=function(){if(!this.$elem.find("article:not(:has(div.deleted-comment-message))").length){this.$elem.remove();$(this).trigger("line-comment/thread-deleted")}this.$contextDiff&&!this.$contextDiff.find(".bb-udiff .comment").length&&this.$contextDiff.remove()};g.prototype.removeComment=function(){this.$comment.replaceWith('<div class="deleted-comment-message">Comment deleted</div>');this.$elem.addClass("deleted");
this.$edit.unbind();this.$delete.unbind();this.$reply.unbind();this.$reply=this.$delete=this.$edit=null;$(this).trigger("line-comment/deleted");this.$elem.trigger("comment-count/delete");this.cleanUpThread()};g.prototype.cancelEdit=function(){this.editCommentForm.$elem.detach();this.$comment.removeClass("editing")};g.prototype.cancelReply=function(){this.replyCommentForm.$elem.detach()};g.prototype.updateContent=function(a){this.$content.html(a.get("content_rendered"));this.cancelEdit()}})(BB);
BB.utils.guard("#commit",function(a){BB.createCommentHandler(BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"changesets",BB.changeset,"comments"),a).initializeComments()});function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=32}var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;
diff_match_patch.prototype.diff_main=function(a,b,e,d){typeof d=="undefined"&&(d=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+this.Diff_Timeout*1E3);if(a==null||b==null)throw Error("Null input. (diff_main)");if(a==b)return a?[[DIFF_EQUAL,a]]:[];typeof e=="undefined"&&(e=true);var g=e,f=this.diff_commonPrefix(a,b),e=a.substring(0,f),a=a.substring(f),b=b.substring(f),f=this.diff_commonSuffix(a,b),c=a.substring(a.length-f),a=a.substring(0,a.length-f),b=b.substring(0,b.length-f),a=this.diff_compute_(a,
b,g,d);e&&a.unshift([DIFF_EQUAL,e]);c&&a.push([DIFF_EQUAL,c]);this.diff_cleanupMerge(a);return a};
diff_match_patch.prototype.diff_compute_=function(a,b,e,d){if(!a)return[[DIFF_INSERT,b]];if(!b)return[[DIFF_DELETE,a]];var g=a.length>b.length?a:b,f=a.length>b.length?b:a,c=g.indexOf(f);if(c!=-1){e=[[DIFF_INSERT,g.substring(0,c)],[DIFF_EQUAL,f],[DIFF_INSERT,g.substring(c+f.length)]];a.length>b.length&&(e[0][0]=e[2][0]=DIFF_DELETE);return e}if(f.length==1)return[[DIFF_DELETE,a],[DIFF_INSERT,b]];if(g=this.diff_halfMatch_(a,b)){b=g[1];f=g[3];a=g[4];g=this.diff_main(g[0],g[2],e,d);e=this.diff_main(b,
f,e,d);return g.concat([[DIFF_EQUAL,a]],e)}return e&&a.length>100&&b.length>100?this.diff_lineMode_(a,b,d):this.diff_bisect_(a,b,d)};
diff_match_patch.prototype.diff_lineMode_=function(a,b,e){var d=this.diff_linesToChars_(a,b),a=d[0],b=d[1],d=d[2],a=this.diff_bisect_(a,b,e);this.diff_charsToLines_(a,d);this.diff_cleanupSemantic(a);a.push([DIFF_EQUAL,""]);for(var g=b=0,f=0,c=d="";b<a.length;){switch(a[b][0]){case DIFF_INSERT:f++;c=c+a[b][1];break;case DIFF_DELETE:g++;d=d+a[b][1];break;case DIFF_EQUAL:if(g>=1&&f>=1){d=this.diff_main(d,c,false,e);a.splice(b-g-f,g+f);b=b-g-f;for(g=d.length-1;g>=0;g--)a.splice(b,0,d[g]);b=b+d.length}g=
f=0;c=d=""}b++}a.pop();return a};
diff_match_patch.prototype.diff_bisect_=function(a,b,e){for(var d=a.length,g=b.length,f=Math.ceil((d+g)/2),c=2*f,h=Array(c),i=Array(c),j=0;j<c;j++){h[j]=-1;i[j]=-1}h[f+1]=0;i[f+1]=0;for(var j=d-g,l=j%2!=0,m=0,n=0,q=0,p=0,w=0;w<f;w++){if((new Date).getTime()>e)break;for(var r=-w+m;r<=w-n;r=r+2){var x=f+r,t;t=r==-w||r!=w&&h[x-1]<h[x+1]?h[x+1]:h[x-1]+1;for(var s=t-r;t<d&&s<g&&a.charAt(t)==b.charAt(s);){t++;s++}h[x]=t;if(t>d)n=n+2;else if(s>g)m=m+2;else if(l){x=f+j-r;if(x>=0&&x<c&&i[x]!=-1){var v=d-i[x];
if(t>=v)return this.diff_bisectSplit_(a,b,t,s,e)}}}for(r=-w+q;r<=w-p;r=r+2){x=f+r;v=r==-w||r!=w&&i[x-1]<i[x+1]?i[x+1]:i[x-1]+1;for(t=v-r;v<d&&t<g&&a.charAt(d-v-1)==b.charAt(g-t-1);){v++;t++}i[x]=v;if(v>d)p=p+2;else if(t>g)q=q+2;else if(!l){x=f+j-r;if(x>=0&&x<c&&h[x]!=-1){t=h[x];s=f+t-x;v=d-v;if(t>=v)return this.diff_bisectSplit_(a,b,t,s,e)}}}}return[[DIFF_DELETE,a],[DIFF_INSERT,b]]};
diff_match_patch.prototype.diff_bisectSplit_=function(a,b,e,d,g){var f=a.substring(0,e),c=b.substring(0,d),a=a.substring(e),b=b.substring(d),f=this.diff_main(f,c,false,g),g=this.diff_main(a,b,false,g);return f.concat(g)};
diff_match_patch.prototype.diff_linesToChars_=function(a,b){function e(a){for(var b="",c=0,e=-1,f=d.length;e<a.length-1;){e=a.indexOf("\n",c);e==-1&&(e=a.length-1);var n=a.substring(c,e+1),c=e+1;if(g.hasOwnProperty?g.hasOwnProperty(n):g[n]!==void 0)b=b+String.fromCharCode(g[n]);else{b=b+String.fromCharCode(f);g[n]=f;d[f++]=n}}return b}var d=[],g={};d[0]="";var f=e(a),c=e(b);return[f,c,d]};
diff_match_patch.prototype.diff_charsToLines_=function(a,b){for(var e=0;e<a.length;e++){for(var d=a[e][1],g=[],f=0;f<d.length;f++)g[f]=b[d.charCodeAt(f)];a[e][1]=g.join("")}};diff_match_patch.prototype.diff_commonPrefix=function(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var e=0,d=Math.min(a.length,b.length),g=d,f=0;e<g;){if(a.substring(f,g)==b.substring(f,g))f=e=g;else d=g;g=Math.floor((d-e)/2+e)}return g};
diff_match_patch.prototype.diff_commonSuffix=function(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var e=0,d=Math.min(a.length,b.length),g=d,f=0;e<g;){if(a.substring(a.length-g,a.length-f)==b.substring(b.length-g,b.length-f))f=e=g;else d=g;g=Math.floor((d-e)/2+e)}return g};
diff_match_patch.prototype.diff_commonOverlap_=function(a,b){var e=a.length,d=b.length;if(e==0||d==0)return 0;e>d?a=a.substring(e-d):e<d&&(b=b.substring(0,e));e=Math.min(e,d);if(a==b)return e;for(var d=0,g=1;;){var f=a.substring(e-g),f=b.indexOf(f);if(f==-1)return d;g=g+f;if(f==0||a.substring(e-g)==b.substring(0,g)){d=g;g++}}};
diff_match_patch.prototype.diff_halfMatch_=function(a,b){function e(a,b,c){for(var d=a.substring(c,c+Math.floor(a.length/4)),e=-1,g="",h,i,x,t;(e=b.indexOf(d,e+1))!=-1;){var s=f.diff_commonPrefix(a.substring(c),b.substring(e)),v=f.diff_commonSuffix(a.substring(0,c),b.substring(0,e));if(g.length<v+s){g=b.substring(e-v,e)+b.substring(e,e+s);h=a.substring(0,c-v);i=a.substring(c+s);x=b.substring(0,e-v);t=b.substring(e+s)}}return g.length*2>=a.length?[h,i,x,t,g]:null}if(this.Diff_Timeout<=0)return null;
var d=a.length>b.length?a:b,g=a.length>b.length?b:a;if(d.length<4||g.length*2<d.length)return null;var f=this,c=e(d,g,Math.ceil(d.length/4)),d=e(d,g,Math.ceil(d.length/2));if(!c&&!d)return null;var c=d?c?c[4].length>d[4].length?c:d:d:c,h,i;if(a.length>b.length){d=c[0];g=c[1];h=c[2];i=c[3]}else{h=c[0];i=c[1];d=c[2];g=c[3]}return[d,g,h,i,c[4]]};
diff_match_patch.prototype.diff_cleanupSemantic=function(a){for(var b=false,e=[],d=0,g=null,f=0,c=0,h=0,i=0,j=0;f<a.length;){if(a[f][0]==DIFF_EQUAL){e[d++]=f;c=i;h=j;j=i=0;g=a[f][1]}else{a[f][0]==DIFF_INSERT?i=i+a[f][1].length:j=j+a[f][1].length;if(g!==null&&g.length<=Math.max(c,h)&&g.length<=Math.max(i,j)){a.splice(e[d-1],0,[DIFF_DELETE,g]);a[e[d-1]+1][0]=DIFF_INSERT;d--;d--;f=d>0?e[d-1]:-1;j=i=h=c=0;g=null;b=true}}f++}b&&this.diff_cleanupMerge(a);this.diff_cleanupSemanticLossless(a);for(f=1;f<a.length;){if(a[f-
1][0]==DIFF_DELETE&&a[f][0]==DIFF_INSERT){b=a[f-1][1];e=a[f][1];d=this.diff_commonOverlap_(b,e);g=this.diff_commonOverlap_(e,b);if(d>=g){if(d>=b.length/2||d>=e.length/2){a.splice(f,0,[DIFF_EQUAL,e.substring(0,d)]);a[f-1][1]=b.substring(0,b.length-d);a[f+1][1]=e.substring(d);f++}}else if(g>=b.length/2||g>=e.length/2){a.splice(f,0,[DIFF_EQUAL,b.substring(0,g)]);a[f-1]=[DIFF_INSERT,e.substring(0,e.length-g)];a[f+1]=[DIFF_DELETE,b.substring(g)];f++}f++}f++}};
diff_match_patch.prototype.diff_cleanupSemanticLossless=function(a){function b(a,b){if(!a||!b)return 5;var h=0;if(a.charAt(a.length-1).match(e)||b.charAt(0).match(e)){h++;if(a.charAt(a.length-1).match(d)||b.charAt(0).match(d)){h++;if(a.charAt(a.length-1).match(g)||b.charAt(0).match(g)){h++;(a.match(f)||b.match(c))&&h++}}}return h}for(var e=/[^a-zA-Z0-9]/,d=/\s/,g=/[\r\n]/,f=/\n\r?\n$/,c=/^\r?\n\r?\n/,h=1;h<a.length-1;){if(a[h-1][0]==DIFF_EQUAL&&a[h+1][0]==DIFF_EQUAL){var i=a[h-1][1],j=a[h][1],l=a[h+
1][1],m=this.diff_commonSuffix(i,j);if(m)var n=j.substring(j.length-m),i=i.substring(0,i.length-m),j=n+j.substring(0,j.length-m),l=n+l;for(var m=i,n=j,q=l,p=b(i,j)+b(j,l);j.charAt(0)===l.charAt(0);){var i=i+j.charAt(0),j=j.substring(1)+l.charAt(0),l=l.substring(1),w=b(i,j)+b(j,l);if(w>=p){p=w;m=i;n=j;q=l}}if(a[h-1][1]!=m){if(m)a[h-1][1]=m;else{a.splice(h-1,1);h--}a[h][1]=n;if(q)a[h+1][1]=q;else{a.splice(h+1,1);h--}}}h++}};
diff_match_patch.prototype.diff_cleanupEfficiency=function(a){for(var b=false,e=[],d=0,g="",f=0,c=false,h=false,i=false,j=false;f<a.length;){if(a[f][0]==DIFF_EQUAL){if(a[f][1].length<this.Diff_EditCost&&(i||j)){e[d++]=f;c=i;h=j;g=a[f][1]}else{d=0;g=""}i=j=false}else{a[f][0]==DIFF_DELETE?j=true:i=true;if(g&&(c&&h&&i&&j||g.length<this.Diff_EditCost/2&&c+h+i+j==3)){a.splice(e[d-1],0,[DIFF_DELETE,g]);a[e[d-1]+1][0]=DIFF_INSERT;d--;g="";if(c&&h){i=j=true;d=0}else{d--;f=d>0?e[d-1]:-1;i=j=false}b=true}}f++}b&&
this.diff_cleanupMerge(a)};
diff_match_patch.prototype.diff_cleanupMerge=function(a){a.push([DIFF_EQUAL,""]);for(var b=0,e=0,d=0,g="",f="",c;b<a.length;)switch(a[b][0]){case DIFF_INSERT:d++;f=f+a[b][1];b++;break;case DIFF_DELETE:e++;g=g+a[b][1];b++;break;case DIFF_EQUAL:if(e+d>1){if(e!==0&&d!==0){c=this.diff_commonPrefix(f,g);if(c!==0){if(b-e-d>0&&a[b-e-d-1][0]==DIFF_EQUAL)a[b-e-d-1][1]=a[b-e-d-1][1]+f.substring(0,c);else{a.splice(0,0,[DIFF_EQUAL,f.substring(0,c)]);b++}f=f.substring(c);g=g.substring(c)}c=this.diff_commonSuffix(f,
g);if(c!==0){a[b][1]=f.substring(f.length-c)+a[b][1];f=f.substring(0,f.length-c);g=g.substring(0,g.length-c)}}e===0?a.splice(b-e-d,e+d,[DIFF_INSERT,f]):d===0?a.splice(b-e-d,e+d,[DIFF_DELETE,g]):a.splice(b-e-d,e+d,[DIFF_DELETE,g],[DIFF_INSERT,f]);b=b-e-d+(e?1:0)+(d?1:0)+1}else if(b!==0&&a[b-1][0]==DIFF_EQUAL){a[b-1][1]=a[b-1][1]+a[b][1];a.splice(b,1)}else b++;e=d=0;f=g=""}a[a.length-1][1]===""&&a.pop();e=false;for(b=1;b<a.length-1;){if(a[b-1][0]==DIFF_EQUAL&&a[b+1][0]==DIFF_EQUAL)if(a[b][1].substring(a[b][1].length-
a[b-1][1].length)==a[b-1][1]){a[b][1]=a[b-1][1]+a[b][1].substring(0,a[b][1].length-a[b-1][1].length);a[b+1][1]=a[b-1][1]+a[b+1][1];a.splice(b-1,1);e=true}else if(a[b][1].substring(0,a[b+1][1].length)==a[b+1][1]){a[b-1][1]=a[b-1][1]+a[b+1][1];a[b][1]=a[b][1].substring(a[b+1][1].length)+a[b+1][1];a.splice(b+1,1);e=true}b++}e&&this.diff_cleanupMerge(a)};
diff_match_patch.prototype.diff_xIndex=function(a,b){var e=0,d=0,g=0,f=0,c;for(c=0;c<a.length;c++){a[c][0]!==DIFF_INSERT&&(e=e+a[c][1].length);a[c][0]!==DIFF_DELETE&&(d=d+a[c][1].length);if(e>b)break;g=e;f=d}return a.length!=c&&a[c][0]===DIFF_DELETE?f:f+(b-g)};
diff_match_patch.prototype.diff_prettyHtml=function(a){for(var b=[],e=/&/g,d=/</g,g=/>/g,f=/\n/g,c=0;c<a.length;c++){var h=a[c][0],i=a[c][1].replace(e,"&amp;").replace(d,"&lt;").replace(g,"&gt;").replace(f,"&para;<br>");switch(h){case DIFF_INSERT:b[c]='<ins style="background:#e6ffe6;">'+i+"</ins>";break;case DIFF_DELETE:b[c]='<del style="background:#ffe6e6;">'+i+"</del>";break;case DIFF_EQUAL:b[c]="<span>"+i+"</span>"}}return b.join("")};
diff_match_patch.prototype.diff_text1=function(a){for(var b=[],e=0;e<a.length;e++)a[e][0]!==DIFF_INSERT&&(b[e]=a[e][1]);return b.join("")};diff_match_patch.prototype.diff_text2=function(a){for(var b=[],e=0;e<a.length;e++)a[e][0]!==DIFF_DELETE&&(b[e]=a[e][1]);return b.join("")};
diff_match_patch.prototype.diff_levenshtein=function(a){for(var b=0,e=0,d=0,g=0;g<a.length;g++){var f=a[g][1];switch(a[g][0]){case DIFF_INSERT:e=e+f.length;break;case DIFF_DELETE:d=d+f.length;break;case DIFF_EQUAL:b=b+Math.max(e,d);d=e=0}}return b=b+Math.max(e,d)};
diff_match_patch.prototype.diff_toDelta=function(a){for(var b=[],e=0;e<a.length;e++)switch(a[e][0]){case DIFF_INSERT:b[e]="+"+encodeURI(a[e][1]);break;case DIFF_DELETE:b[e]="-"+a[e][1].length;break;case DIFF_EQUAL:b[e]="="+a[e][1].length}return b.join("\t").replace(/%20/g," ")};
diff_match_patch.prototype.diff_fromDelta=function(a,b){for(var e=[],d=0,g=0,f=b.split(/\t/g),c=0;c<f.length;c++){var h=f[c].substring(1);switch(f[c].charAt(0)){case "+":try{e[d++]=[DIFF_INSERT,decodeURI(h)]}catch(i){throw Error("Illegal escape in diff_fromDelta: "+h);}break;case "-":case "=":var j=parseInt(h,10);if(isNaN(j)||j<0)throw Error("Invalid number in diff_fromDelta: "+h);h=a.substring(g,g=g+j);f[c].charAt(0)=="="?e[d++]=[DIFF_EQUAL,h]:e[d++]=[DIFF_DELETE,h];break;default:if(f[c])throw Error("Invalid diff operation in diff_fromDelta: "+
f[c]);}}if(g!=a.length)throw Error("Delta length ("+g+") does not equal source text length ("+a.length+").");return e};diff_match_patch.prototype.match_main=function(a,b,e){if(a==null||b==null||e==null)throw Error("Null input. (match_main)");e=Math.max(0,Math.min(e,a.length));return a==b?0:a.length?a.substring(e,e+b.length)==b?e:this.match_bitap_(a,b,e):-1};
diff_match_patch.prototype.match_bitap_=function(a,b,e){function d(a,c){var d=a/b.length,g=Math.abs(e-c);return!f.Match_Distance?g?1:d:d+g/f.Match_Distance}if(b.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var g=this.match_alphabet_(b),f=this,c=this.Match_Threshold,h=a.indexOf(b,e);if(h!=-1){c=Math.min(d(0,h),c);h=a.lastIndexOf(b,e+b.length);h!=-1&&(c=Math.min(d(0,h),c))}for(var i=1<<b.length-1,h=-1,j,l,m=b.length+a.length,n,q=0;q<b.length;q++){j=0;for(l=m;j<l;){d(q,
e+l)<=c?j=l:m=l;l=Math.floor((m-j)/2+j)}m=l;j=Math.max(1,e-l+1);var p=Math.min(e+l,a.length)+b.length;l=Array(p+2);for(l[p+1]=(1<<q)-1;p>=j;p--){var w=g[a.charAt(p-1)];l[p]=q===0?(l[p+1]<<1|1)&w:(l[p+1]<<1|1)&w|((n[p+1]|n[p])<<1|1)|n[p+1];if(l[p]&i){w=d(q,p-1);if(w<=c){c=w;h=p-1;if(h>e)j=Math.max(1,2*e-h);else break}}}if(d(q+1,e)>c)break;n=l}return h};
diff_match_patch.prototype.match_alphabet_=function(a){for(var b={},e=0;e<a.length;e++)b[a.charAt(e)]=0;for(e=0;e<a.length;e++)b[a.charAt(e)]|=1<<a.length-e-1;return b};
diff_match_patch.prototype.patch_addContext_=function(a,b){if(b.length!=0){for(var e=b.substring(a.start2,a.start2+a.length1),d=0;b.indexOf(e)!=b.lastIndexOf(e)&&e.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;){d=d+this.Patch_Margin;e=b.substring(a.start2-d,a.start2+a.length1+d)}d=d+this.Patch_Margin;(e=b.substring(a.start2-d,a.start2))&&a.diffs.unshift([DIFF_EQUAL,e]);(d=b.substring(a.start2+a.length1,a.start2+a.length1+d))&&a.diffs.push([DIFF_EQUAL,d]);a.start1=a.start1-e.length;
a.start2=a.start2-e.length;a.length1=a.length1+(e.length+d.length);a.length2=a.length2+(e.length+d.length)}};
diff_match_patch.prototype.patch_make=function(a,b,e){var d;if(typeof a=="string"&&typeof b=="string"&&typeof e=="undefined"){d=a;b=this.diff_main(d,b,true);if(b.length>2){this.diff_cleanupSemantic(b);this.diff_cleanupEfficiency(b)}}else if(a&&typeof a=="object"&&typeof b=="undefined"&&typeof e=="undefined"){b=a;d=this.diff_text1(b)}else if(typeof a=="string"&&b&&typeof b=="object"&&typeof e=="undefined")d=a;else if(typeof a=="string"&&typeof b=="string"&&e&&typeof e=="object"){d=a;b=e}else throw Error("Unknown call format to patch_make.");
if(b.length===0)return[];for(var e=[],a=new diff_match_patch.patch_obj,g=0,f=0,c=0,h=d,i=0;i<b.length;i++){var j=b[i][0],l=b[i][1];if(!g&&j!==DIFF_EQUAL){a.start1=f;a.start2=c}switch(j){case DIFF_INSERT:a.diffs[g++]=b[i];a.length2=a.length2+l.length;d=d.substring(0,c)+l+d.substring(c);break;case DIFF_DELETE:a.length1=a.length1+l.length;a.diffs[g++]=b[i];d=d.substring(0,c)+d.substring(c+l.length);break;case DIFF_EQUAL:if(l.length<=2*this.Patch_Margin&&g&&b.length!=i+1){a.diffs[g++]=b[i];a.length1=
a.length1+l.length;a.length2=a.length2+l.length}else if(l.length>=2*this.Patch_Margin&&g){this.patch_addContext_(a,h);e.push(a);a=new diff_match_patch.patch_obj;g=0;h=d;f=c}}j!==DIFF_INSERT&&(f=f+l.length);j!==DIFF_DELETE&&(c=c+l.length)}if(g){this.patch_addContext_(a,h);e.push(a)}return e};
diff_match_patch.prototype.patch_deepCopy=function(a){for(var b=[],e=0;e<a.length;e++){var d=a[e],g=new diff_match_patch.patch_obj;g.diffs=[];for(var f=0;f<d.diffs.length;f++)g.diffs[f]=d.diffs[f].slice();g.start1=d.start1;g.start2=d.start2;g.length1=d.length1;g.length2=d.length2;b[e]=g}return b};
diff_match_patch.prototype.patch_apply=function(a,b){if(a.length==0)return[b,[]];var a=this.patch_deepCopy(a),e=this.patch_addPadding(a),b=e+b+e;this.patch_splitMax(a);for(var d=0,g=[],f=0;f<a.length;f++){var c=a[f].start2+d,h=this.diff_text1(a[f].diffs),i,j=-1;if(h.length>this.Match_MaxBits){i=this.match_main(b,h.substring(0,this.Match_MaxBits),c);if(i!=-1){j=this.match_main(b,h.substring(h.length-this.Match_MaxBits),c+h.length-this.Match_MaxBits);if(j==-1||i>=j)i=-1}}else i=this.match_main(b,h,
c);if(i==-1){g[f]=false;d=d-(a[f].length2-a[f].length1)}else{g[f]=true;d=i-c;c=j==-1?b.substring(i,i+h.length):b.substring(i,j+this.Match_MaxBits);if(h==c)b=b.substring(0,i)+this.diff_text2(a[f].diffs)+b.substring(i+h.length);else{c=this.diff_main(h,c,false);if(h.length>this.Match_MaxBits&&this.diff_levenshtein(c)/h.length>this.Patch_DeleteThreshold)g[f]=false;else{this.diff_cleanupSemanticLossless(c);for(var h=0,l,j=0;j<a[f].diffs.length;j++){var m=a[f].diffs[j];m[0]!==DIFF_EQUAL&&(l=this.diff_xIndex(c,
h));m[0]===DIFF_INSERT?b=b.substring(0,i+l)+m[1]+b.substring(i+l):m[0]===DIFF_DELETE&&(b=b.substring(0,i+l)+b.substring(i+this.diff_xIndex(c,h+m[1].length)));m[0]!==DIFF_DELETE&&(h=h+m[1].length)}}}}}b=b.substring(e.length,b.length-e.length);return[b,g]};
diff_match_patch.prototype.patch_addPadding=function(a){for(var b=this.Patch_Margin,e="",d=1;d<=b;d++)e=e+String.fromCharCode(d);for(d=0;d<a.length;d++){a[d].start1=a[d].start1+b;a[d].start2=a[d].start2+b}var d=a[0],g=d.diffs;if(g.length==0||g[0][0]!=DIFF_EQUAL){g.unshift([DIFF_EQUAL,e]);d.start1=d.start1-b;d.start2=d.start2-b;d.length1=d.length1+b;d.length2=d.length2+b}else if(b>g[0][1].length){var f=b-g[0][1].length;g[0][1]=e.substring(g[0][1].length)+g[0][1];d.start1=d.start1-f;d.start2=d.start2-
f;d.length1=d.length1+f;d.length2=d.length2+f}d=a[a.length-1];g=d.diffs;if(g.length==0||g[g.length-1][0]!=DIFF_EQUAL){g.push([DIFF_EQUAL,e]);d.length1=d.length1+b;d.length2=d.length2+b}else if(b>g[g.length-1][1].length){f=b-g[g.length-1][1].length;g[g.length-1][1]=g[g.length-1][1]+e.substring(0,f);d.length1=d.length1+f;d.length2=d.length2+f}return e};
diff_match_patch.prototype.patch_splitMax=function(a){for(var b=this.Match_MaxBits,e=0;e<a.length;e++)if(a[e].length1>b){var d=a[e];a.splice(e--,1);for(var g=d.start1,f=d.start2,c="";d.diffs.length!==0;){var h=new diff_match_patch.patch_obj,i=true;h.start1=g-c.length;h.start2=f-c.length;if(c!==""){h.length1=h.length2=c.length;h.diffs.push([DIFF_EQUAL,c])}for(;d.diffs.length!==0&&h.length1<b-this.Patch_Margin;){var c=d.diffs[0][0],j=d.diffs[0][1];if(c===DIFF_INSERT){h.length2=h.length2+j.length;f=
f+j.length;h.diffs.push(d.diffs.shift());i=false}else if(c===DIFF_DELETE&&h.diffs.length==1&&h.diffs[0][0]==DIFF_EQUAL&&j.length>2*b){h.length1=h.length1+j.length;g=g+j.length;i=false;h.diffs.push([c,j]);d.diffs.shift()}else{j=j.substring(0,b-h.length1-this.Patch_Margin);h.length1=h.length1+j.length;g=g+j.length;if(c===DIFF_EQUAL){h.length2=h.length2+j.length;f=f+j.length}else i=false;h.diffs.push([c,j]);j==d.diffs[0][1]?d.diffs.shift():d.diffs[0][1]=d.diffs[0][1].substring(j.length)}}c=this.diff_text2(h.diffs);
c=c.substring(c.length-this.Patch_Margin);j=this.diff_text1(d.diffs).substring(0,this.Patch_Margin);if(j!==""){h.length1=h.length1+j.length;h.length2=h.length2+j.length;h.diffs.length!==0&&h.diffs[h.diffs.length-1][0]===DIFF_EQUAL?h.diffs[h.diffs.length-1][1]=h.diffs[h.diffs.length-1][1]+j:h.diffs.push([DIFF_EQUAL,j])}i||a.splice(++e,0,h)}}};diff_match_patch.prototype.patch_toText=function(a){for(var b=[],e=0;e<a.length;e++)b[e]=a[e];return b.join("")};
diff_match_patch.prototype.patch_fromText=function(a){var b=[];if(!a)return b;for(var a=a.split("\n"),e=0,d=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;e<a.length;){var g=a[e].match(d);if(!g)throw Error("Invalid patch string: "+a[e]);var f=new diff_match_patch.patch_obj;b.push(f);f.start1=parseInt(g[1],10);if(g[2]===""){f.start1--;f.length1=1}else if(g[2]=="0")f.length1=0;else{f.start1--;f.length1=parseInt(g[2],10)}f.start2=parseInt(g[3],10);if(g[4]===""){f.start2--;f.length2=1}else if(g[4]=="0")f.length2=
0;else{f.start2--;f.length2=parseInt(g[4],10)}for(e++;e<a.length;){g=a[e].charAt(0);try{var c=decodeURI(a[e].substring(1))}catch(h){throw Error("Illegal escape in patch_fromText: "+c);}if(g=="-")f.diffs.push([DIFF_DELETE,c]);else if(g=="+")f.diffs.push([DIFF_INSERT,c]);else if(g==" ")f.diffs.push([DIFF_EQUAL,c]);else if(g=="@")break;else if(g!=="")throw Error('Invalid patch mode "'+g+'" in: '+c);e++}}return b};
diff_match_patch.patch_obj=function(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0};
diff_match_patch.patch_obj.prototype.toString=function(){for(var a=["@@ -"+(this.length1===0?this.start1+",0":this.length1==1?this.start1+1:this.start1+1+","+this.length1)+" +"+(this.length2===0?this.start2+",0":this.length2==1?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],b,e=0;e<this.diffs.length;e++){switch(this.diffs[e][0]){case DIFF_INSERT:b="+";break;case DIFF_DELETE:b="-";break;case DIFF_EQUAL:b=" "}a[e+1]=b+encodeURI(this.diffs[e][1])+"\n"}return a.join("").replace(/%20/g," ")};
this.diff_match_patch=diff_match_patch;this.DIFF_DELETE=DIFF_DELETE;this.DIFF_INSERT=DIFF_INSERT;this.DIFF_EQUAL=DIFF_EQUAL;
(function(a,b){var e=b.FECRU=b.FECRU||{};e.SBS=e.SBS||{};var d=e.SBS.Range=function(a,b){if(!(this instanceof d))return new d(a,b);this.low=a;this.high=b;this.length=b-a+1;return this};d.ofLength=function(a,b){return new d(a,a+b-1)};d.ofLine=function(a){return d.ofLength(a,1)};d.ofLines=function(a,b){return new d(a,b)};d.pointAfterLine=function(a){return new d(a,a-1)};d.pointBeforeLine=function(a){return d.pointAfterLine(a-1)};d.prototype={constructor:d,isPoint:function(){return this.low-1===this.high},
before:function(a){return this.isPoint()&&a.isPoint()?this.high<a.low:this.isPoint()?this.low<=a.low-1:a.isPoint()?this.high<=a.low:this.high<a.low},after:function(a){return a.before(this)},overlaps:function(a){return this.isPoint()&&a.isPoint()?this.equals(a):this.isPoint()?a.overlaps(this):a.isPoint()?this.low-1<=a.low&&a.low<=this.high:this.low<=a.high&&a.low<=this.high},adjacent:function(a){return this.isPoint()&&a.isPoint()?this.equals(a):this.isPoint()?this.low+1===a.low||this.low===a.high:
a.isPoint()?a.adjacent(this):this.high+1===a.low||a.low+1===this.high},expand:function(a){if(a===0)return this;var b;if(this.isPoint()){b=Math.max(1,this.low-(a-1));a=this.low+a}else{b=Math.max(1,this.low-a);a=this.high+a}return new d(b,a)},merge:function(a){if(this.isPoint()&&a.isPoint())return this.equals(a)?this:null;if(this.isPoint())return a.merge(this);if(a.isPoint())return this.overlaps(a)||this.adjacent(a)?this:null;if(this.overlaps(a)||this.adjacent(a)){var b=Math.min(this.low,a.low),a=Math.max(this.high,
a.high);return new d(b,a)}return null},equals:function(a){return this.low===a.low&&this.high==a.high},toString:function(){return"["+this.low+", "+this.high+"]"}};var g=e.SBS.Hunk=function(a,b,c,d){if(!(this instanceof g))return new g(a,b);this.fromRange=a;this.toRange=b;this.fromLines=c;this.toLines=d;this.conflict_=false;return this};g.ofLengths=function(a,b,c,e,f,n){return new g(d.ofLength(a,b),d.ofLength(c,e),f,n)};g.addition=function(a,b,c){return new g(d.pointAfterLine(a),b,[],c)};g.change=function(a,
b,c,d){return new g(a,b,c,d)};g.deletion=function(a,b,c){return new g(a,d.pointAfterLine(b),c,[])};var f=g.prototype;f.isAddition=function(){return this.fromRange.length===0};f.isChange=function(){return this.fromRange.length>0&&this.toRange.length>0};f.isDeletion=function(){return this.toRange.length===0};f.conflict=function(){this.conflict_=true;return this};f.isConflict=function(){return this.conflict_};f.before=function(a){return this.fromRange.before(a.fromRange)&&this.toRange.before(a.toRange)};
f.after=function(a){return this.fromRange.after(a.fromRange)&&this.toRange.after(a.toRange)};f.overlaps=function(a){return this.fromRange.overlaps(a.fromRange)||this.toRange.overlaps(a.toRange)};f.overlapping=function(a){var b=[],c;a:{var d=0;for(c=a.length-1;d<=c;){var e=Math.floor((d+c)/2),f=a[e];if(this.overlaps(f)){c=e;break a}else if(this.before(f))c=e-1;else if(this.after(f))d=e+1;else{c=-1;break a}}c=-1}if(c>=0){for(var g,d=c-1;d>=0&&(g=a[d]).overlaps(this);d=d-1)b.push(g);b.push(a[c]);d=c+
1;for(c=a.length;d<c&&(g=a[d]).overlaps(this);d++)b.push(g)}return b};f.equals=function(a){return this.fromRange.equals(a.fromRange)&&this.toRange.equals(a.toRange)};f.toString=function(){return"-"+(this.fromRange.length===1?this.fromRange.low+"":this.fromRange.low+","+this.fromRange.length)+" +"+(this.toRange.length===1?this.toRange.low+"":this.toRange.low+","+this.toRange.length)};g.prototype=f;var c=e.SBS.Ranges={unzip:function(a){for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d];b.push(e.fromRange);
c.push(e.toRange)}return[b,c]},nonEmpty:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d.length>0&&b.push(d)}return b},expand:function(a,b){for(var d=[],e=0;e<a.length;e++)d.push(a[e].expand(b));return c.merge(d)},mergeAdjacent:function(a,b,c){var e,f;if(a[0].low>1){if(b===0){e=[new d(1,a[0].high)];return e.concat(a.slice(1))}if(b===a.length){b=a[a.length-1];e=a.slice(0,a.length-1);e.push(new d(b.low,c));return e}e=a.slice(0,b-1);c=a[b-1];f=a[b];e.push(new d(c.low,f.high));return e.concat(a.slice(b+
1))}if(b===a.length-1){b=a[a.length-1];e=a.slice(0,a.length-1);e.push(new d(b.low,c));return e}e=a.slice(0,b);c=a[b];f=a[b+1];e.push(new d(c.low,f.high));return e.concat(a.slice(b+2))},expandAtIndex:function(a,b,e,f){var g,n,q;if(a[0].low>1){if(b===0){e=new d(Math.max(1,a[0].low-e),a[0].high);return[e].concat(a.slice(1))}if(b===a.length){b=a[a.length-1];g=a.slice(0,a.length-1);g.push(new d(b.low,Math.min(b.high+e,f)));return g}g=a.slice(0,b-1);n=a[b-1];q=a[b];g.push(new d(n.low,Math.min(n.high+e,
f)));g.push(new d(Math.max(q.low-e,Math.min(n.high+e,f)),q.high));return c.merge(g.concat(a.slice(b)))}if(b===a.length-1){b=a[a.length-1];g=a.slice(0,a.length-1);g.push(new d(b.low,Math.min(b.high+e,f)));return g}g=a.slice(0,b);n=a[b];q=a[b+1];g.push(new d(n.low,Math.min(n.high+e,f)));g.push(new d(Math.max(q.low-e,Math.min(n.high+e,f)),q.high));return c.merge(g.concat(a.slice(b+2)))},merge:function(a){var b=[],c;if(a.length>0){for(var d=a[0],e=1;e<a.length;e++){var f=a[e];if((c=d.merge(f))!==null)d=
c;else{b.push(d);d=f}}b.push(d)}return b}}})(jQuery,this);
(function(a){function b(c,d,e){if(!(this instanceof b))return new b(c,d,e);this.pagesPerBlock_=d;this.linesPerPage_=e;this.blocks_={from:[],to:[]};this.filename_={from:"",to:""};this.incremental_=[];d=BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"changesets",BB.changeset,"diff");a("#compare")&&a("#compare").data("compare-files-url")&&(d=a("#compare").data("compare-files-url"));this.url_=c||d.toString();return this}function e(a,b,c,d){if(!(this instanceof e))return new e(a,b,rawFileData,
d);var f=c.meta;if(!this.numLines)this.numLines=0;if(!f)return null;this.name=f.name;this.filename=f.filename;this.position=f.position;this.maxLineNum=this.numLines=f.numLines;this.longestLine=f.longestLine;this.longestRevisionBlameLength=f.longestRevisionBlameLength;this.longestAuthorBlameLength=f.longestAuthorBlameLength;this.pagesPerBlock=a;this.linesPerPage=b;this.gutterWidths=f.gutterWidths;this.zeroContextRanges_=d;this.blocks={};this.blocksRendered={};this.merge(c);this.lineHeightPx=this.revisionBlameBoxDom=
this.numbersBoxDom=this.scrollBoxDom=null;return this}function d(a){if(!(this instanceof d))return new d(a);this.file_=a;this.name=this.file_.name;this.filename=this.file_.filename;this.position=this.file_.position;this.numLines=this.file_.numLines;this.maxLineNum=this.file_.maxLineNum;this.pagesPerBlock=this.file_.pagesPerBlock;this.linesPerPage=this.file_.linesPerPage;this.blocks=this.file_.blocks;this.lineHeightPx=this.file_.lineHeightPx;return this}function g(a,b,c,e,f){if(!(this instanceof g))return new g(a,
b,c,e,f);this.diffHunks_=a;this.unifiedMap=b;this.from2unified_=this.calculateLineMappings_(b,0);this.to2unified_=this.calculateLineMappings_(b,1);this.zeroContextRanges_=null;this.from_=d.of(c);this.to_=d.of(e);this.renderFile_=this.from_.name===f?this.from_:this.to_;this.name=this.renderFile_.name;this.filename=this.renderFile_.filename;this.position=this.renderFile_.position;this.pagesPerBlock=this.renderFile_.pagesPerBlock;this.linesPerPage=this.renderFile_.linesPerPage;this.numLines=this.unifiedMap.length-
1;this.maxLineNum=Math.max(this.from_.maxLineNum,this.to_.maxLineNum);this.lineHeightPx=this.to_.lineHeightPx;this.blocks={};return this}function f(a,b){if(!(this instanceof f))return new f(a,c);if(typeof b==="number"){var c=Math.max(0,b);this.rangesWithContext_=j.expand(a.zeroContextRanges(),c)}else this.rangesWithContext_=b;this.file_=d.of(a);this.viewport2file=this.calculateViewport2File();this.file2viewport=this.calculateFile2Viewport(this.viewport2file);this.name=a.name;this.filename=a.filename;
this.position=null;this.pagesPerBlock=a.pagesPerBlock;this.linesPerPage=a.linesPerPage;this.numLines=this.viewport2file.length-1;this.maxLineNum=this.viewport2file[this.viewport2file.length-1];if(typeof this.maxLineNum!=="number")this.maxLineNum=this.viewport2file[this.viewport2file.length-2];this.lineHeightPx=this.file_.lineHeightPx;this.blocks={};return this}var c=window.FECRU,h=c.SBS.Range,i=c.SBS.Hunk,j=c.SBS.Ranges,l=b.prototype;l.queueBlocks_=function(b,c){for(var d=0;d<c.length;d++){var e=
c[d],f=this.blocks_[b];a.inArray(e,f)<0&&f.push(e)}};l.from=function(a,b){this.queueBlocks_("from",a);this.filename_.from=b;return this};l.to=function(a,b){this.queueBlocks_("to",a);this.filename_.to=b;return this};l.incremental=function(a){this.incremental_.push(a);return this};l.load=function(b){this.complete_=b;if(this.blocks_.from.length===0&&this.blocks_.to.length===0)b&&b();else{b=this.filename_.from||this.filename_.to;a(document).trigger("diff-load-start",[b]);a.ajax({type:"GET",url:this.url_,
data:{linesPerPage:this.linesPerPage_,fromBlock:this.blocks_.from.shift(),toBlock:this.blocks_.to.shift(),filename:b},dataType:"json",success:a.proxy(this.success_,this)})}};l.success_=function(b){var c=this.filename_.from||this.filename_.to;a(document).trigger("diff-load-end",[c]);for(var c=b[0],b=c.from_file,c=c.to_file,d=0;d<this.incremental_.length;d++)this.incremental_[d](b,c);this.load(this.complete_)};b.prototype=l;l=c.SBS.Permalinker=function(){this.baseUrl_=window.top.location.href.replace(location.hash,
"")};l.prototype.regex_=/^#chg_(.*)_(newline|oldline)(\d+)$/;l.prototype.parse=function(a){if(a=this.regex_.exec(a))return{path:a[1],file:a[2]==="oldline"?"from":"to",line:parseInt(a[3],10)}};l.prototype.url=function(a,b,c){return this.baseUrl_+"#chg_"+b+"_"+(a==="from"?"oldline":"newline")+c};var m=c.SBS.Diff=function(b,c,d,e,f,g,h,i){if(!(this instanceof m))return new m(b,c,d,e,f,g,h,i);this.hunks=b;this.pagesPerBlock=c;this.linesPerPage=d;this.from=e;this.to=f;this.unifiedMap=g;this.note=h;this.url=
i;this.elem_=null;if(!(a.browser.msie&&a.browser.version<9))try{this.diffHighlighting_(new diff_match_patch,b)}catch(j){}return this};m.sideBySideFromData=function(a){for(var b=[],d=0,f=a.hunks.length;d<f;d++){var g=a.hunks[d],h;h=g.type==="add"?new c.SBS.Hunk(c.SBS.Range.pointBeforeLine(g.from_start),c.SBS.Range.ofLength(g.to_start,g.to_count),g.from_lines,g.to_lines):g.type==="mod"?c.SBS.Hunk.ofLengths(g.from_start,g.from_count,g.to_start,g.to_count,g.from_lines,g.to_lines):new c.SBS.Hunk(c.SBS.Range.ofLength(g.from_start,
g.from_count),c.SBS.Range.pointBeforeLine(g.to_start),g.from_lines,g.to_lines);g.conflict&&h.conflict();b[d]=h}d=a.from_pages_per_block;f=a.from_lines_per_page;h=j.unzip(b);g=new e(d,f,a.from_file,h[0]);h=new e(d,f,a.to_file,h[1]);return new m(b,d,f,g,h,a.unified_map,a.note)};m.unified=function(a){return new m(a.hunks,a.pagesPerBlock,a.linesPerPage,new g(a.hunks,a.unifiedMap,a.from,a.to,"from"),new g(a.hunks,a.unifiedMap,a.from,a.to,"to"),a.unifiedMap,a.note,a.url)};m.ofContext=function(a,b){var b=
Math.max(0,b),c=new f(a.to,b);if(a.from.exists()){var d=new f(a.from,b),e=a.contextScrollPositions_(d,c);d.position=e[0];c.position=e[1]}e=a.hunks;c=new m(a.from.exists()?a.hunksWithContext_(e,d,c):a.hunks,a.pagesPerBlock,a.linesPerPage,a.from.exists()?d:{exists:function(){return false}},c,a.unifiedMap,a.note,a.url);c.zeroContextHunks=e;return c};m.expandSkippedSection=function(a,b){var c=a.from,d=a.to,c=new f(c.file_,j.expandAtIndex(c.rangesWithContext_,b,10,a.isUnified()?a.unifiedMap.length:c.maxLineNum)),
d=new f(d.file_,j.expandAtIndex(d.rangesWithContext_,b,10,a.isUnified()?a.unifiedMap.length:d.maxLineNum)),e=a.contextScrollPositions_(c,d);c.position=e[0];d.position=e[1];e=a.zeroContextHunks;c=new m(a.hunksWithContext_(e,c,d),a.pagesPerBlock,a.linesPerPage,c,d,a.unifiedMap,a.note,a.url);c.zeroContextHunks=e;return c};m.expandToInclude=function(b,c,d){var e=b.to.file_.file_,f=(c==="from"?e.from2unified_:e.to2unified_)[d],e=b[c].rangesWithContext_;if(a.grep(e,function(a){return a.overlaps(h.ofLine(f))}).length>
0)return b;for(var g=0,i=0;i<e.length;i++)if(f<e[i].low)break;else g=g+1;return m.expandToInclude(m.expandSkippedSection(b,g),c,d)};m.CONTEXT_LOW=3;m.CONTEXT_MED=20;m.CONTEXT_FULL=-1;var n=m.prototype;n.setElement=function(a){this.elem_=a};n.getElement=function(){return this.elem_};n.ensureVisible=function(a,c){var d=this,e=new b(d.url,d.pagesPerBlock,d.linesPerPage);d.from.exists()&&d.from.queueBlocks(e,a.fromRange);d.to.queueBlocks(e,a.toRange);e.load(function(){d.from.exists()&&d.from.ensureVisible(a.fromRange);
d.to.ensureVisible(a.toRange);c&&c()})};n.isUnified=function(){return this.to.isUnified()};n.filename=function(){return this.from.filename||this.to.filename};n.hasConflicts=function(){for(var a=this.zeroContextHunks||this.hunks,b=0;b<a.length;b++)if(a[b].isConflict())return true;return false};n.hasNote=function(){return!!this.note};n.hasDiffContent=function(){return this.hunks.length>0};n.numContext=function(){return this.from.numContext()};n.contextScrollPositions_=function(a,b){var c=[0],d=[0],
e,f;for(e=1;e<=a.numLines;e++){f=a.viewport2file[e];c[e]=typeof f==="number"?b.file2viewport[a.file_.position[f]]:c[e-1]+1}for(e=1;e<=b.numLines;e++){f=b.viewport2file[e];d[e]=typeof f==="number"?a.file2viewport[b.file_.position[f]]:d[e-1]+1}return[c,d]};n.hunksWithContext_=function(a,b,c){for(var b=b.file2viewport,c=c.file2viewport,d=[],e=0;e<a.length;e++){var f=a[e],g=f.fromRange,f=f.toRange;d.push(new i(new h(b[g.low],b[g.high]),new h(c[f.low],c[f.high])))}return d};n.diffHighlighting_=function(b,
c){function d(a){e.html(a);return e.text()}for(var e=a("<div>"),f=0;f<c.length;f++){var g=c[f];if(g.fromLines&&g.toLines&&g.isChange()&&!g.isConflict()){var h=b.diff_main(d(g.fromLines.join("\n")),d(g.toLines.join("\n")));b.diff_cleanupSemantic(h);g.fromRange.linesHtml=a.map(a.grep(h,a.proxy(this.isFrom_,this)),a.proxy(this.markup_,this)).join("").split("\n");g.toRange.linesHtml=a.map(a.grep(h,a.proxy(this.isTo_,this)),a.proxy(this.markup_,this)).join("").split("\n")}}};n.isFrom_=function(a){a=a[0];
return a===DIFF_DELETE||a===DIFF_EQUAL};n.isTo_=function(a){a=a[0];return a===DIFF_EQUAL||a===DIFF_INSERT};n.markup_=function(b){var c=b[0];return c===DIFF_EQUAL?_.escape(b[1]):a.map(b[1].split("\n"),c===DIFF_DELETE?a.proxy(this.markupRemoved_,this):a.proxy(this.markupAdded_,this)).join("\n")};n.markupRemoved_=function(a){return"<del>"+_.escape(a)+"</del>"};n.markupAdded_=function(a){return"<ins>"+_.escape(a)+"</ins>"};n.hunkBefore=function(b){b=a.inArray(b,this.hunks);return b<=0?null:this.hunks[b-
1]};n.hunkAfter=function(b){b=a.inArray(b,this.hunks);return b<0||b===this.hunks.length-1?null:this.hunks[b+1]};n.hunkAfterFromLine=function(a){return this.searchHunksAfter_(function(b){return a<b.fromRange.low})};n.hunkBeforeFromLine=function(a){return this.searchHunksBefore_(function(b){return b.fromRange.low<a})};n.hunkAfterToLine=function(a){return this.searchHunksAfter_(function(b){return a<b.toRange.low})};n.hunkBeforeToLine=function(a){return this.searchHunksBefore_(function(b){return b.toRange.low<
a})};n.searchHunksAfter_=function(a){for(var b=this.zeroContextHunks||this.hunks,c=0,d=b.length-1,e=null;c<=d;){var f=Math.floor((c+d)/2),g=b[f];if(a(g)){e=g;d=f-1}else c=f+1}return e};n.searchHunksBefore_=function(a){for(var b=this.zeroContextHunks||this.hunks,c=0,d=b.length-1,e=null;c<=d;){var f=Math.floor((c+d)/2),g=b[f];if(a(g)){e=g;c=f+1}else d=f-1}return e};m.prototype=n;var q;e.DELIMITER=">";var n=e,p=function(b){if(!b.revisionBlameBoxDom)b.revisionBlameBoxDom=a("#"+b.name+"-revision-blame-box")[0];
return b.revisionBlameBoxDom},w=function(b){if(!b.authorBlameBoxDom)b.authorBlameBoxDom=a("#"+b.name+"-auth-blame-box")[0];return b.authorBlameBoxDom},r=function(a,b,c){a.pageDom_(b,c);return a.blocks[b][c].numbersDom},x=function(a,b,c){a.pageDom_(b,c);return a.blocks[b][c].revBlameDom},t=function(a,b,c){a.pageDom_(b,c);return a.blocks[b][c].authBlameDom},s=function(a,b,c,d){a.pageDom_(b,c);return a.blocks[b][c].gutterDom[d]},v=e.prototype;v.isUnified=function(){return false};v.numContext=function(){return-1};
v.exists=function(){return!!this.blocks};v.merge=function(a){var b=a.block_num;if(b>=0)this.blocks[b]=a.pages};v.queueBlocks=function(a,b){var c=this;a[c.name](c.blocksToFetch(b),c.filename).incremental(function(a,b){c.merge(c.name==="from"?a:b)})};v.ensureVisible=function(a){if(this.numLines>0)for(var b=this.pagesPerBlock*this.linesPerPage,c=Math.floor((a.high-1)/b),d=Math.floor((a.low-1)/b);d<=c;d++)for(var e=d*b,f=a.low-1-e,e=Math.min(a.high-1-e,(d+1)*b-1),e=Math.floor(e/this.linesPerPage),f=Math.floor(f/
this.linesPerPage);f<=e;f++)(this.isNotInDom_(d,f)||!this.pageDom_(d,f).parentNode)&&this.insertPage_(d,f)};v.blocksToFetch=function(a){for(var b=this.linesPerPage*this.pagesPerBlock,c=Math.floor(a.high/b),d=[],a=Math.floor(a.low/b);a<=c;a++)if(!this.blocks[a]){this.blocks[a]=this.blocksToFetch.loadingSentinel;d.push(a)}return d};v.blocksToFetch.loadingSentinel={loading:true};v.isNotInDom_=function(a,b){return this.blocks[a]&&this.blocks[a][b]&&(!this.blocksRendered[a]||!this.blocksRendered[a][b])};
v.zeroContextRanges=function(){return this.zeroContextRanges_};v.coords_=function(a){var a=a-1,b=this.pagesPerBlock*this.linesPerPage,c=a%b;return{block:Math.floor(a/b),page:Math.floor(c/this.linesPerPage),lineIndex:c%this.linesPerPage}};v.insertPage_=function(b,c){var d=a;if(!this.scrollBoxDom)this.scrollBoxDom=a("#"+this.name+"-box")[0];var d=d(this.scrollBoxDom),e=a;if(!this.numbersBoxDom)this.numbersBoxDom=a("#"+this.name+"-numbers-box")[0];var e=e(this.numbersBoxDom),f=a(p(this)),g=a(w(this)),
h=(b*this.pagesPerBlock+c)*this.linesPerPage*this.lineHeightPx;d[0].appendChild(a(this.pageDom_(b,c)).css("top",h).css("width",d.data("width"))[0]);e[0].appendChild(a(r(this,b,c)).css("top",h)[0]);f.length!==0&&f.children(".content-box")[0].appendChild(a(x(this,b,c)).css("top",h)[0]);g.length!==0&&g.children(".content-box")[0].appendChild(a(t(this,b,c)).css("top",h)[0]);d=function(d,e){e.children(".content-box")[0].appendChild(a(s(this,b,c,d)).css("top",h)[0])};typeof q=="undefined"&&(q=a(".gutter-box"));
e=0;for(f=q.length;e<f;++e)d(e,q.eq(e))};v.pageDom_=function(a,b){var c=this.blocks[a];if(this.isNotInDom_(a,b)){var d=this.evalPage_(a,b),e=this.createPageDom_(d),f=document.createElement("div"),g=(a*this.pagesPerBlock+b)*this.linesPerPage+1;f.className="page line-numbers";for(var h=0,i=d.length;h<i;h++){var j=g+h,m=this.permalinker_.url(this.name,this.filename,j),j=o(d[h],'<a href="'+m+'">'+j+"</a>");f.appendChild(j)}h=a*this.pagesPerBlock+b;e.className=e.className+(h===0?" page-first ":"");f.className=
f.className+(h===0?" page-first ":"");e.id=this.name+"-page-"+a+"-"+h;f.id=this.name+"-numbers-"+a+"-"+h;if(p(this)){g=document.createElement("div");g.className="page revision-blame";i=0;for(j=d.length;i<j;i++){m=o(d[i],"<span>"+(d[i].start?d[i].revision:"&nbsp;")+"</span>",[d[i].blameclass]);g.appendChild(m)}g.id=this.name+"-revision-blame-"+a+"-"+h}else g=document.createElement("div");if(w(this)){i=document.createElement("div");i.className="page author-blame";j=0;for(m=d.length;j<m;j++){var l=o(d[j],
"<span>"+(d[j].start?d[j].author:"&nbsp;")+"</span>");i.appendChild(l)}i.id=this.name+"-auth-blame-"+a+"-"+h}else i=document.createElement("div");h=[];for(j=0;j<d[0].gutters.length;++j){h[j]=document.createElement("div");m=0;for(l=d.length;m<l;m++){var n=o(d[m],d[m].gutters[j]);h[j].appendChild(n)}}c[b]={pageDom:e,numbersDom:f,revBlameDom:g,authBlameDom:i,gutterDom:h}}return c[b].pageDom};v.evalPage_=function(b,c){for(var d=(b*this.pagesPerBlock+c)*this.linesPerPage+1,e=h.ofLength(d,this.linesPerPage),
f=a.grep(this.zeroContextRanges(),function(a){return e.overlaps(a)}),g=this.blocks[b][c],i=0;i<f.length;i++){var j=f[i];if(j.linesHtml)for(var m=0;m<j.length;m++){var l=j.low+m,n=l-d;if(0<=n&&n<this.linesPerPage)g[l-d].html=j.linesHtml[m]}}this.blocksRendered[b]=this.blocksRendered[b]||{};this.blocksRendered[b][c]=true;return g};v.createPageDom_=function(a){var b=document.createElement("div");b.className="page";for(var c=0,d=a.length;c<d;c++)b.appendChild(o(a[c]));return b};v.permalinker_=new l;var o,
y=["addition","change","deletion","conflict","start","end"],A=null;document.createElement("div");if(a.browser.msie)var B=document.createElement("div"),A=function(a){B.innerHTML="<pre>"+a+"</pre>";return B.removeChild(B.firstChild)};else A=function(a){var b=document.createElement("pre");b.innerHTML=a;return b};o=function(a,b,c){for(var b=A((b||a.html)+"\n"),d=[],e=0,f=y.length;e<f;e++){var g=y[e];a[g]&&d.push(g)}c=c||[];e=0;for(f=c.length;e<f;e++)d.push(c[e]);if(a=d.join(" "))b.className=a;return b};
v.longestLineDom=function(){return o(this.longestLine)};n.prototype=v;d.of=function(a){return a instanceof d?a:new d(a)};l=d.prototype;l.isUnified=function(){return this.file_.isUnified()};l.numContext=function(){return this.file_.numContext()};l.exists=function(){return false};l.merge=function(a){return this.file_.merge(a)};l.queueBlocks=function(a,b){return this.file_.queueBlocks(a,b)};l.ensureVisible=function(){};l.pageDom_=function(a,b){return this.file_.pageDom_(a,b)};l.coords_=function(a){return this.file_.coords_(a)};
l.blocksToFetch=function(a){return this.file_.blocksToFetch(a)};l.longestLineDom=function(){return this.file_.longestLineDom()};l.zeroContextRanges=function(){return this.file_.zeroContextRanges()};d.prototype=l;l=g.prototype;l.isUnified=function(){return true};l.numContext=function(){return this.renderFile_.numContext()};l.calculateLineMappings_=function(a,b){for(var c=[0],d=1;d<a.length;d++){var e=a[d][b];e&&(c[e]=d)}return c};l.exists=function(){return true};l.merge=function(){};l.queueBlocks=
function(a,b){var c=this,d=Math.max(1,Math.floor(b.low/this.linesPerPage)*this.linesPerPage),e=Math.ceil(b.high/this.linesPerPage)*this.linesPerPage,d=c.diffHunk_(new h(d,e));a.from(c.from_.blocksToFetch(d.fromRange),c.from_.filename).to(c.to_.blocksToFetch(d.toRange),c.to_.filename).incremental(function(a,b){c.from_.merge(a);c.to_.merge(b)})};l.diffHunk_=function(a){for(var b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MAX_VALUE,e=Number.MIN_VALUE,f=Math.min(this.renderFile_.numLines,a.high),a=
a.low;a<=f;a++){var g=this.unifiedMap[a],j=g[0],g=g[1];if(j){b=j<b?j:b;c=j>c?j:c}if(g){d=g<d?g:d;e=g>e?g:e}}if(b===Number.MAX_VALUE)c=b=0;if(d===Number.MAX_VALUE)e=d=0;return new i(new h(b,c),new h(d,e))};l.ensureVisible=function(a){try{return e.prototype.ensureVisible.call(this,a)}catch(b){}};l.insertPage_=function(a,b){return e.prototype.insertPage_.call(this,a,b)};l.isNotInDom_=function(a,b){return!this.blocks[a]||!this.blocks[a][b]};l.zeroContextRanges=function(){if(this.zeroContextRanges_===
null){for(var a=[],b=0;b<this.diffHunks_.length;b++){var c=this.diffHunks_[b],d=c.fromRange,e=c.toRange,f;c.isDeletion()?f=new h(this.from2unified_[d.low],this.from2unified_[d.high]):c.isChange()?f=new h(this.from2unified_[d.low],this.to2unified_[e.high]):c.isAddition()&&(f=new h(this.to2unified_[e.low],this.to2unified_[e.high]));a.push(f)}this.zeroContextRanges_=a}return this.zeroContextRanges_};l.pageDom_=function(b,c){this.blocks[b]=this.blocks[b]||[];var d=this.blocks[b],e=(b*this.pagesPerBlock+
c)*this.linesPerPage+1,f=e+this.linesPerPage-1;if(this.isNotInDom_(b,c)){var g=document.createElement("div"),h=document.createElement("div"),i=b*this.pagesPerBlock+c;g.className=g.className+("page"+(i===0?" page-first ":""));for(h.className=h.className+("page line-numbers"+(i===0?" page-first ":""));e<=f;e++)if(i=this.unifiedMap[e]){var j=null,m=null;if(m=i[0])j=this.from_;else if(m=i[1])j=this.to_;m=j.coords_(m);m=a(j.pageDom_(m.block,m.page)).children()[m.lineIndex].cloneNode(true);if(/\bchange\b/.test(m.className))m.className=
m.className+(" "+j.name);g.appendChild(m);if(j=i[this.renderFile_.name==="from"?0:1]){i=this.renderFile_.coords_(j);this.renderFile_.pageDom_(i.block,i.page);i=a(this.renderFile_.blocks[i.block][i.page].numbersDom).children()[i.lineIndex].cloneNode(true);if(/\bchange\b/.test(i.className))i.className=i.className+(" "+this.renderFile_.name);e!==1&&j===1&&a(i).removeClass("start");h.appendChild(i)}else{j=this.renderFile_.name==="from"?this.to_:this.from_;i=i[this.renderFile_.name==="from"?1:0];m=j.coords_(i);
j.pageDom_(m.block,m.page);m=a(j.blocks[m.block][m.page].numbersDom).children()[m.lineIndex].cloneNode(true);m.innerHTML=" ";if(/\bchange\b/.test(m.className))m.className=m.className+(" "+j.name);e!==1&&i===1&&a(m).removeClass("start");h.appendChild(m)}}d[c]={pageDom:g,numbersDom:h,revBlameDom:document.createElement("div"),authBlameDom:document.createElement("div"),gutterDom:document.createElement("div")}}return d[c].pageDom};l.coords_=function(a){return e.prototype.coords_.call(this,a)};l.longestLineDom=
function(){var b=a(this.from_.longestLineDom()),c=a(this.to_.longestLineDom());return b.text().length>c.text().length?b[0]:c[0]};g.prototype=l;l=f.prototype;l.isUnified=function(){return this.file_.isUnified()};l.numContext=function(){return this.context};l.calculateViewport2File=function(){for(var a=this.rangesWithContext_,b=[0],c=0,d=0;d<a.length;d++){var e=a[d];d===0&&e.low>1&&b.push({type:"top",index:c++});for(var f=0;f<e.length;f++)e.low+f<=this.file_.numLines&&b.push(e.low+f);d===a.length-1?
e.high<this.file_.numLines&&b.push({type:"bottom",index:c++}):a.length>1&&b.push({type:"skipped",index:c++})}return b};l.calculateFile2Viewport=function(a){var b=[0],c,d,e;for(e=1;e<a.length;e++){d=a[e];if(typeof d==="number")b[d]=e;else if(d.type==="top"){d=a[e+1];for(c=1;c<d;c++)b[c]=1}else if(d.type==="skipped"){c=a[e-1];d=a[e+1];for(c=c+1;c<d;c++)b[c]=e}else if(d.type==="bottom"){c=a[e-1];for(c=c+1;c<=this.file_.numLines;c++)b[c]=e}}return b};l.exists=function(){return this.file_.file_.exists()};
l.merge=function(a){return this.file_.merge(a)};l.fileRange_=function(a){var b=this.viewport2file[a];typeof b!=="number"&&(b=this.viewport2file[a.low+1]);var c=this.viewport2file[Math.min(a.high,this.numLines)];typeof c!=="number"&&(c=this.viewport2file[Math.min(a.high-1,this.numLines-1)]);return new h(b,c)};l.queueBlocks=function(a,b){var c=Math.max(1,Math.floor(b.low/this.linesPerPage)*this.linesPerPage),d=Math.ceil(b.high/this.linesPerPage)*this.linesPerPage,c=this.fileRange_(new h(c,d));return this.file_.queueBlocks(a,
c)};l.ensureVisible=function(a){try{return e.prototype.ensureVisible.call(this,a)}catch(b){}};l.insertPage_=function(a,b){return e.prototype.insertPage_.call(this,a,b)};l.isNotInDom_=function(a,b){return!this.blocks[a]||!this.blocks[a][b]};l.zeroContextRanges=function(){return this.file_.zeroContextRanges()};l.pageDom_=function(b,c){this.blocks[b]=this.blocks[b]||[];var d=this.blocks[b],e=(b*this.pagesPerBlock+c)*this.linesPerPage+1,f=Math.min(e+this.linesPerPage-1,this.numLines);if(this.isNotInDom_(b,
c)){var g=document.createElement("div"),h=document.createElement("div"),i=b*this.pagesPerBlock+c;g.id=this.name+"-page-"+b+"-"+i;h.id=this.name+"-numbers-"+b+"-"+i;g.className="page"+(i===0?" page-first ":"");h.className="page line-numbers"+(i===0?" page-first ":"");for(i=e;i<=f;i++){var j=this.viewport2file[i];if(typeof j==="number"){var j=this.file_.coords_(j),m=a(this.file_.pageDom_(j.block,j.page)).children()[j.lineIndex].cloneNode(true);g.appendChild(m);j=a(this.file_.blocks[j.block][j.page].numbersDom).children()[j.lineIndex].cloneNode(true);
h.appendChild(j)}else if(j.type==="top"){g.appendChild(a('<div class="skipped-container skipped-top"><span> </span></div>')[0]);h.appendChild(a('<div class="skipped-container skipped-top"><span class="ellipsis skipped" data-skipped-index="'+j.index+'" data-page-index="'+(i-e)+'"> </span></div>')[0])}else if(j.type==="skipped"){g.appendChild(a('<div class="skipped-container skipped-middle"><span> </span></div>')[0]);h.appendChild(a('<div class="skipped-container skipped-middle"><span class="ellipsis skipped" data-skipped-index="'+
j.index+'" data-page-index="'+(i-e)+'"> </span></div>')[0])}else if(j.type==="bottom"){g.appendChild(a('<div class="skipped-container skipped-bottom"><span> </span></div>')[0]);h.appendChild(a('<div class="skipped-container skipped-bottom"><span class="ellipsis skipped" data-skipped-index="'+j.index+'" data-page-index="'+(i-e)+'"> </span></div>')[0])}}d[c]={pageDom:g,numbersDom:h,revBlameDom:document.createElement("div"),authBlameDom:document.createElement("div"),gutterDom:document.createElement("div")}}return d[c].pageDom};
l.coords_=function(a){return e.prototype.coords_.call(this,a)};l.longestLineDom=function(){return this.file_.longestLineDom()};f.prototype=l})("undefined"===typeof AJS?jQuery:AJS.$);
(function(a,b,e){var d=e.aperture={},g=FECRU.SBS.Range,f=d.LinedPane=function(a,b,c,d){this.numLines=b;this.lineHeight=d;this.pane_=new a(c,b*d)};f.window=function(a,b,c){return new f(h,a,b,c)};f.scrollable=function(a,b,d){return new f(c,a,b,d)};f.prototype.createDom=function(){};f.prototype.render=function(a){this.createDom();this.pane_.render(a);this.$elem_=this.pane_.$elem_;this.enterDocument()};f.prototype.enterDocument=function(){a(this.pane_).bind("aperture-pane/scroll",a.proxy(this.onScroll_,
this))};f.prototype.exitDocument=function(){a(this.pane_).unbind("aperture-pane/scroll");this.pane_.exitDocument()};f.prototype.$content=function(){return this.pane_.$content()};f.prototype.onScroll_=function(b,c,d){b=Math.floor(d/this.lineHeight)+1;d=d-this.lineTopPx(b);a(this).trigger("aperture-lined-pane/scroll",[b,c,d])};f.prototype.setPaneWidth=function(a){this.pane_.setPaneWidth(a)};f.prototype.scrollx=function(){return this.pane_.scrollx()};f.prototype.scrolly=function(){return this.pane_.scrolly()};
f.prototype.lineTopPx=function(a){return(a-1)*this.lineHeight};f.prototype.scrollToLine=function(a,b,c){b=this.pane_.setScrollLeftNoEvent(b);a=this.pane_.setScrollTopNoEvent(this.lineTopPx(a)+c);return[Math.floor(a/this.lineHeight)+1,b,a%this.lineHeight]};f.prototype.isVisible=function(){return this.pane_.isVisible()};f.prototype.visibleRange=function(){var a=this.pane_.visibleRange();if(a===null)return null;var b=Math.floor(a.low/this.lineHeight)+1,a=Math.min(this.numLines,Math.ceil(a.high/this.lineHeight));
return new g(b,a)};var c=d.Pane=function(a,b){this.contentWidth=a;this.contentHeight=b;this.ignoreVerticalScrolls_=this.ignoreHorizontalScrolls_=this.maxScrollTop_=this.maxScrollLeft_=this.scrollTop_=this.scrollLeft_=0;this.$content_=this.$scroller_=this.$elem_=null};c.template_='<div class="aperture-pane"><div class="aperture-pane-scroller"><div class="aperture-pane-content"></div></div></div>';c.prototype.createDom=function(){this.$elem_=a(c.template_);this.$scroller_=this.$elem_.find(".aperture-pane-scroller");
this.$content_=this.$scroller_.find(".aperture-pane-content")};c.prototype.render=function(a){this.createDom();a.append(this.$elem_);if(typeof this.contentWidth!=="number"){this.$content().append(this.contentWidth);this.contentWidth=this.$elem_.width();this.$content().empty()}this.$content().width(this.contentWidth);if(typeof this.contentHeight!=="number"){this.$content().append(this.contentHeight);this.contentHeight=this.$elem_.height();this.$content().empty()}this.$content().height(this.contentHeight);
this.setScrollBounds_();this.enterDocument()};c.prototype.setPaneWidth=function(a){this.$elem_.width(a);this.setScrollBounds_()};c.prototype.setPaneHeight=function(){this.$elem_.height(height);this.setScrollBounds_()};c.prototype.scrollx=function(){return this.maxScrollLeft_>0};c.prototype.scrolly=function(){return this.maxScrollTop_>0};c.prototype.setScrollBounds_=function(){this.$scroller_.scrollLeft(this.contentWidth).scrollTop(this.contentHeight);this.maxScrollLeft_=this.$scroller_.scrollLeft();
this.maxScrollTop_=this.$scroller_.scrollTop();this.$scroller_.scrollLeft(0).scrollTop(0)};c.prototype.enterDocument=function(){this.$scroller_.bind("scroll.pane",a.proxy(this.onScroll_,this))};c.prototype.exitDocument=function(){this.$scroller_.unbind("scroll.pane")};c.prototype.$content=function(){return this.$content_};c.prototype.onScroll_=function(){var b=this.$scroller_.scrollLeft(),c=this.$scroller_.scrollTop(),d=b!==this.scrollLeft_,e=c!==this.scrollTop_;this.scrollLeft_=b;this.scrollTop_=
c;if(this.ignoreHorizontalScrolls_||this.ignoreVerticalScrolls_){if(this.ignoreHorizontalScrolls_&&d)this.ignoreHorizontalScrolls_=this.ignoreHorizontalScrolls_-1;if(this.ignoreVerticalScrolls_&&e)this.ignoreVerticalScrolls_=this.ignoreVerticalScrolls_-1}else a(this).trigger("aperture-pane/scroll",[b,c])};c.prototype.setScrollLeftNoEvent=function(a){a=Math.max(0,Math.min(this.maxScrollLeft_,a));if(this.scrollLeft_!==a){this.ignoreHorizontalScrolls_=this.ignoreHorizontalScrolls_+1;this.$scroller_.scrollLeft(a)}return a};
c.prototype.setScrollTopNoEvent=function(a){a=Math.max(0,Math.min(this.maxScrollTop_,a));if(this.scrollTop_!==a){this.ignoreVerticalScrolls_=this.ignoreVerticalScrolls_+1;this.$scroller_.scrollTop(a)}return a};c.prototype.isVisible=function(){return true};c.prototype.visibleRange=function(){return g.ofLength(this.$scroller_.scrollTop(),this.$elem_.height())};var h=d.WindowPane=function(a,c){this.contentWidth=a;this.contentHeight=c;this.offsetTop_=this.$content_=this.$elem_=this.$window_=null;this.proxyScroll_=
b.bind(this.onScroll_,this)};h.prototype.createDom=function(){this.$window_=a(e);this.$elem_=a('<div class="aperture-pane-content">')};h.prototype.render=function(a){this.createDom();a.append(this.$elem_);if(typeof this.contentWidth!=="number"){this.$content().append(this.contentWidth);this.contentWidth=this.$content().width();this.$content().empty()}this.$content().width(this.contentWidth);if(typeof this.contentHeight!=="number"){this.$content().append(this.contentHeight);this.contentHeight=this.$elem_.height();
this.$content().empty()}this.$content().height(this.contentHeight);this.offsetTop_=this.$content().offset().top;this.enterDocument()};h.prototype.enterDocument=function(){this.$window_.bind("scroll",this.proxyScroll_)};h.prototype.exitDocument=function(){this.$window_.unbind("scroll",this.proxyScroll_)};h.prototype.$content=function(){return this.$elem_};h.prototype.onScroll_=function(){this.offsetTop_=this.$content().offset().top;var b=this.$window_.scrollTop();if(this.isVisible(b)){var c=this.$window_.scrollLeft(),
b=Math.max(0,b-this.offsetTop_);a(this).trigger("aperture-pane/scroll",[c,b])}};h.prototype.setPaneWidth=function(){};h.prototype.scrollx=function(){return false};h.prototype.scrolly=function(){return false};h.prototype.setScrollLeftNoEvent=function(a){a=Math.max(0,a);this.$window_.scrollLeft(a);return this.$window_.scrollLeft()};h.prototype.setScrollTopNoEvent=function(a){a=Math.max(0,a);this.$window_.scrollTop(a+this.offsetTop_);return this.$window_.scrollTop()-this.offsetTop_};h.prototype.isVisible=
function(a){var b=this.$window_.height(),c=this.offsetTop_+this.contentHeight<a;return!(a+b<this.offsetTop_||c)};h.prototype.visibleRange=function(){var a=this.$window_.scrollTop(),b=this.$window_.height(),c=this.isVisible(a),d=c&&a<=this.offsetTop_,e=c&&this.offsetTop_+this.contentHeight<=a+this.$window_.height();return c?d&&e?g.ofLength(0,this.contentHeight):d?g.ofLength(0,b-(this.offsetTop_-a)):e?new g(a-this.offsetTop_,this.contentHeight):g.ofLength(a-this.offsetTop_,b):null}})($,_,this);
(function(a,b,e){var d=e.diffract={},g=FECRU.SBS.Hunk,f=aperture.LinedPane,c=d.UnifiedDiff=function(a,b){this.udiff_=a;this.numLines_=this.udiff_.to.numLines;this.lineHeight=b;this.focusOffset=5;this.pane_=f.window(this.numLines_,928,b);this.fromNumbers_=new h(this.udiff_.from,b);this.unifiedLines_=new i(this.udiff_.to,b);this.$elem_=null};c.prototype.createDom=function(){};c.prototype.render=function(b){this.createDom();this.pane_.render(b);this.$elem_=this.pane_.$content().addClass("diffract diffract-udiff");
b.append(this.$elem_);this.fromNumbers_.render(this.pane_.$content());this.unifiedLines_.render(this.pane_.$content());this.unifiedLines_.setPaneWidth(892);this.unifiedLines_.scrollx()&&this.$elem_.css("margin-bottom",a.getScrollbarWidth());this.showVisibleLines_();this.enterDocument()};c.prototype.enterDocument=function(){a(this.pane_).bind("aperture-lined-pane/scroll",a.proxy(this.showVisibleLines_,this));this.fromNumbers_.$elem_.add(this.unifiedLines_.$elem_).delegate(".skipped","click.skipped",
a.proxy(this.expandSkipped_,this))};c.prototype.exitDocument=function(){a(this.pane_).unbind("aperture-lined-pane/scroll");a([this.fromNumbers_.$elem_,this.unifiedLines_.$elem_]).undelegate("click.skipped");this.fromNumbers_.exitDocument();this.unifiedLines_.exitDocument();this.pane_.exitDocument()};c.prototype.showVisibleLines_=function(){var a=this.pane_.visibleRange();a&&this.udiff_.ensureVisible(new g(a,a))};c.prototype.expandSkipped_=function(b){b=a(b.target).closest(".skipped");a(this).trigger("diffract-skipped/click",
[b,b.data("skipped-index")])};c.prototype.contextFile_=function(){return this.udiff_.to};c.prototype.unifiedFile_=function(){return this.contextFile_().file_.file_};c.prototype.scrollToFromLine=function(a){a=this.unifiedFile_().from2unified_[a];return this.scrollToUnifiedLine(a)};c.prototype.scrollToToLine=function(a){a=this.unifiedFile_().to2unified_[a];return this.scrollToUnifiedLine(a)};c.prototype.scrollToUnifiedLine=function(a){var b=this.contextFile_(),a=b.file2viewport[a];if(typeof b.viewport2file[a]===
"number"){a=Math.max(1,a-this.focusOffset);this.pane_.scrollToLine(a,0,0);return true}return false};c=d.SideBySideDiff=function(a,b){this.sbsdiff_=a;this.lineHeight=b;this.focusOffset=5;this.height_=this.width_=null;this.fromHunkMap_=new l(this.sbsdiff_.hunks,"from",this.sbsdiff_.from.numLines,b);this.fromFile_=new i(this.sbsdiff_.from,b);this.segments_=new j(a,b);this.toFile_=new i(this.sbsdiff_.to,b);this.toHunkMap_=new l(this.sbsdiff_.hunks,"to",this.sbsdiff_.to.numLines,b);this.$elem_=null};c.prototype.createDom=
function(){this.$elem_=a('<div class="diffract diffract-sbsdiff">');this.height_!==null&&this.setHeight(this.height_)};c.prototype.render=function(a){this.createDom();a.append(this.$elem_);this.fromHunkMap_.render(this.$elem_);this.fromFile_.render(this.$elem_);this.segments_.render(this.$elem_);this.toFile_.render(this.$elem_);this.toHunkMap_.render(this.$elem_);this.setWidth(this.width_);this.enterDocument()};c.prototype.setWidth=function(a){this.width_=a;if(this.$elem_){a=a-30-18;this.fromFile_.setPaneWidth(Math.floor(a/
2)-1);this.segments_.setPaneWidth(30);this.toFile_.setPaneWidth(Math.ceil(a/2)-1);this.$elem_.parent().length===1&&this.scrollbars()}};c.prototype.setHeight=function(a){this.height_=a;if(this.$elem_){this.$elem_.height(a);this.$elem_.parent().length===1&&this.scrollbars()}};c.prototype.scrollbars=function(){this.fromHunkMap_.scrollbars(this.fromFile_.scrollx(),this.fromFile_.scrolly());this.toHunkMap_.scrollbars(this.toFile_.scrollx(),this.toFile_.scrolly());this.fromFile_.$elem_.toggleClass("all-lines-visible",
!this.fromFile_.scrolly());this.toFile_.$elem_.toggleClass("all-lines-visible",!this.toFile_.scrolly())};c.prototype.enterDocument=function(){a([this.fromFile_,this.toFile_]).bind("scrollable-file-pane/scroll",a.proxy(this.onScroll_,this));a([this.fromHunkMap_,this.toHunkMap_]).bind("hunk-map/click",a.proxy(this.onHunkMapClick_,this))};c.prototype.exitDocument=function(){a([this.fromFile_,this.toFile_]).unbind("scrollable-file-pane/scroll");a([this.fromHunkMap_,this.toHunkMap_]).unbind("hunk-map/click");
this.fromHunkMap_.exitDocument();this.fromFile_.exitDocument();this.segments_.exitDocument();this.toFile_.exitDocument();this.toHunkMap_.exitDocument()};c.prototype.onScroll_=function(a,b,c,d){var a=a.target,e=a===this.fromFile_?this.toFile_:this.fromFile_,f=a.file_.position,h=Math.min(b+this.focusOffset,a.numLines),i=f[h],f=(h=f[h-1]===i)?this.lineHeight:d,i=Math.max(h?0:1,i-this.focusOffset),c=e.scrollToLine(i,c,f),i=c[0],f=c[2],c=new g(this.fromFile_.visibleRange(),this.toFile_.visibleRange());
this.sbsdiff_.ensureVisible(c);a=a===this.fromFile_;this.segments_.draw(c.overlapping(this.sbsdiff_.hunks),a?b:i,a?d:f,a?i:b,a?f:d)};c.prototype.onHunkMapClick_=function(a,b){(a.target===this.fromHunkMap_?this.fromFile_:this.toFile_).scrollToLineAndFire(b-this.focusOffset,0,0)};c.prototype.scrollToFirstHunk=function(){var a=this.sbsdiff_.hunks[0];a.isAddition()?this.toFile_.scrollToLineAndFire(a.toRange.low-this.focusOffset,0,0):this.fromFile_.scrollToLineAndFire(a.fromRange.low-this.focusOffset,
0,0)};var h=d.FileNumbers=function(a,b){this.file_=a;this.lineHeight=b;this.$elem_=null};h.prototype.createDom=function(){this.$elem_=a('<div class="file-numbers">');this.file_.lineHeightPx=this.lineHeight;this.file_.numbersBoxDom=this.$elem_[0];this.file_.scrollBoxDom=a("<div>")[0]};h.prototype.render=function(a){this.createDom();a.append(this.$elem_);this.enterDocument()};h.prototype.enterDocument=function(){};h.prototype.exitDocument=function(){};var i=d.ScrollableFilePane=function(a,b){this.file_=
a;this.lineHeight=b;this.numLines=a.numLines;this.numbers_=f.scrollable(a.numLines,35,b);this.lines_=f.scrollable(a.numLines,this.file_.longestLineDom(),b);this.$elem_=null};i.prototype.createDom=function(){this.$elem_=a('<div class="scrollable-file-pane">')};i.prototype.render=function(a){this.createDom();a.append(this.$elem_);this.numbers_.render(this.$elem_);this.lines_.render(this.$elem_);this.numbers_.$elem_.addClass("scrollable-file-pane-numbers");this.numbers_.$content().addClass("file-numbers");
this.lines_.$elem_.addClass("scrollable-file-pane-lines");this.lines_.$content().addClass("file-lines");this.file_.lineHeightPx=this.lineHeight;this.file_.numbersBoxDom=this.numbers_.$content()[0];this.file_.scrollBoxDom=this.lines_.$content()[0];this.enterDocument()};i.prototype.setPaneWidth=function(a){this.numbers_.setPaneWidth(35);this.lines_.setPaneWidth(a-35)};i.prototype.scrollx=function(){return this.lines_.scrollx()};i.prototype.scrolly=function(){return this.lines_.scrolly()};i.prototype.enterDocument=
function(){a(this.lines_).bind("aperture-lined-pane/scroll",a.proxy(this.onScroll_,this))};i.prototype.exitDocument=function(){a(this.lines_).unbind("aperture-lined-pane/scroll");this.numbers_.exitDocument();this.lines_.exitDocument()};i.prototype.onScroll_=function(b,c,d,e){this.numbers_.scrollToLine(c,d,e);a(this).trigger("scrollable-file-pane/scroll",[c,d,e])};i.prototype.scrollToLine=function(a,b,c){a=this.lines_.scrollToLine(a,b,c);this.numbers_.scrollToLine(a[0],a[1],a[2]);return a};i.prototype.scrollToLineAndFire=
function(b,c,d){b=this.scrollToLine(b,c,d);a(this).trigger("scrollable-file-pane/scroll",b)};i.prototype.visibleRange=function(){return this.lines_.visibleRange()};var j=e.SegmentPane=function(a,b){this.sbsdiff=a;this.lineHeight=b;this.canvas_=this.$elem_=this.width=null;this.visiblePaths_=[]};j.prototype.createDom=function(){this.$elem_=a('<div class="segment-pane">');this.canvas_=new Raphael(this.$elem_[0]);this.width!==null&&this.setPaneWidth(this.width)};j.prototype.render=function(a){this.createDom();
a.append(this.$elem_);this.enterDocument()};j.prototype.enterDocument=function(){};j.prototype.exitDocument=function(){};j.prototype.setPaneWidth=function(a){this.width=a;if(this.$elem_!==null){this.$elem_.width(a);this.canvas_.setSize(a,this.$elem_.height())}};j.STROKE="#ccc";j.prototype.add_={stroke:"#ccffcc",fill:"#ccffcc"};j.prototype.del_={stroke:"#ffdddd",fill:"#ffdddd"};j.prototype.mod_={stroke:"#f4f4f4",fill:"#f4f4f4"};j.prototype.con_={stroke:"#ffffe0",fill:"#ffffe0"};j.prototype.border_=
{stroke:"#ccc",fill:"#ccc"};j.prototype.createPath_=function(a){var b=this.canvas_.path();a.isConflict()?b.attr(this.con_):a.isAddition()?b.attr(this.add_):a.isChange()?b.attr(this.mod_):a.isDeletion()&&b.attr(this.del_);return b};j.prototype.createBorder_=function(){var a=this.canvas_.path();a.attr(this.border_);return a};j.prototype.lineTopPx=function(a){return(a-1)*this.lineHeight};j.prototype.lineBottomPx=function(a){return a*this.lineHeight};j.prototype.draw=function(a,b,c,d,e){var f,g;f=0;for(g=
this.visiblePaths_.length;f<g;f++)this.visiblePaths_[f].hide();this.visiblePaths_=[];f=0;for(g=a.length;f<g;f++){var h=a[f],i=h.fromRange,j=h.toRange,l=this.width,y=h.path||(h.path=this.createPath_(h));h.isAddition()?y.attr("path",[["M",0,this.lineBottomPx(i.low-b+1)-c+1],["L",l,this.lineTopPx(j.low-d+1)-e+1],["V",this.lineBottomPx(j.high-d+1)-e],["Z"]]):h.isChange()?y.attr("path",[["M",0,this.lineTopPx(i.low-b+1)-c+1],["L",l,this.lineTopPx(j.low-d+1)-e+1],["V",this.lineBottomPx(j.high-d+1)-e],["L",
0,this.lineBottomPx(i.high-b+1)-c],["Z"]]):h.isDeletion()&&y.attr("path",[["M",0,this.lineTopPx(i.low-b+1)-c+1],["V",this.lineBottomPx(i.high-b+1)-c],["L",l,this.lineBottomPx(j.low-d+1)-e+1],["Z"]]);y.show();this.visiblePaths_.push(y);y=h.borderPath||this.createBorder_();if(h.isAddition()){if(h.isConflict()&&typeof h.isConflictStart!=="boolean"){var A=this.sbsdiff.hunkBefore(h),B=this.sbsdiff.hunkAfter(h);h.isConflictStart=B&&B.isConflict()&&B.isChange();h.isEntireConflict=!(A&&A.isConflict()&&A.isChange())&&
!(B&&B.isConflict()&&B.isChange())}h.isConflict()&&!h.isEntireConflict?h.isConflictStart?y.attr("path",[["M",0,this.lineBottomPx(i.low-b+1)-c+1],["L",l,this.lineTopPx(j.low-d+1)-e]]):y.attr("path",[["M",l,this.lineBottomPx(j.high-d+1)-e],["L",0,this.lineBottomPx(i.low-b+1)-c+1]]):y.attr("path",[["M",0,this.lineBottomPx(i.low-b+1)-c+1],["L",l,this.lineTopPx(j.low-d+1)-e],["M",l,this.lineBottomPx(j.high-d+1)-e],["L",0,this.lineBottomPx(i.low-b+1)-c+1]])}else h.isChange()&&!h.isConflict()?y.attr("path",
[["M",0,this.lineTopPx(i.low-b+1)-c+1],["L",l,this.lineTopPx(j.low-d+1)-e+1],["M",l,this.lineBottomPx(j.high-d+1)-e],["L",0,this.lineBottomPx(i.high-b+1)-c]]):h.isDeletion()&&y.attr("path",[["M",l,this.lineBottomPx(j.low-d+1)-e+1],["L",0,this.lineTopPx(i.low-b+1)-c],["M",0,this.lineBottomPx(i.high-b+1)-c],["L",l,this.lineBottomPx(j.low-d+1)-e+1]]);y.show();this.visiblePaths_.push(y)}};var l=d.HunkMap=function(a,c,d,e){this.hunks=b.filter(a,function(a){return c==="from"?a.isDeletion()||a.isChange():
a.isAddition()||a.isChange()});this.numLines=d;this.lineHeight=e;this.side=c;this.$elem_=this.$window_=null};l.prototype.createDom=function(){this.$window_=a(e);this.$elem_=a('<div class="hunk-map">');for(var b=this.side==="from",c=b?"<del>":"<ins>",d=0;d<this.hunks.length;d++){var f=this.hunks[d],g=b?f.fromRange:f.toRange,f=a(c).toggleClass("change",f.isChange()).toggleClass("conflict",f.isConflict()).css({top:this.percent(g.low-1)+"%",height:this.percent(g.length)+"%"});this.$elem_.append(f)}};
l.prototype.percent=function(a){return a/this.numLines*100};l.prototype.render=function(a){this.createDom();a.append(this.$elem_);this.enterDocument()};l.prototype.enterDocument=function(){this.$elem_.bind("click.hunk-map",a.proxy(this.onClick_,this))};l.prototype.exitDocument=function(){this.$elem_.unbind("click.hunk-map")};l.prototype.onClick_=function(b){b=b.clientY-(this.$elem_.offset().top-this.$window_.scrollTop());b=Math.round(b/this.$elem_.height()*this.numLines);b=Math.min(Math.max(1,b),
this.numLines);a(this).trigger("hunk-map/click",[b])};l.prototype.scrollbars=function(b,c){var d=this.$elem_.parent().height(),e=a.getScrollbarWidth(),f=c?e:0;this.$elem_.css({marginTop:f,height:Math.min(this.numLines*this.lineHeight,d-f-(f+(b?e:0)))})}})($,_,this);
(function(a,b,e){var a=e.refract={},d=aperture.LinedPane,b=a.UnifiedDiff=function(a,b){this.numLines_=a;this.lineHeight=b;this.focusOffset=5;this.pane_=d.window(this.numLines_,938,b);this.fromNumbers_=new g;this.unifiedLines_=new f;this.$elem_=null};b.prototype.decorate=function(a){this.pane_.decorate(a);this.$elem_=this.pane_.$content().addClass("diffract diffract-udiff");this.renderInternal();return this};b.prototype.renderInternal=function(){this.fromNumbers_.decorate(this.pane_.$content().children("div").eq(0));
this.unifiedLines_.decorate(this.pane_.$content().children("div").eq(1));this.unifiedLines_.setPaneWidth(902);this.enterDocument()};b.prototype.enterDocument=function(){};b.prototype.exitDocument=function(){};var g=a.FileNumbers=function(){this.$elem_=null};g.prototype.decorate=function(a){this.$elem_=a.addClass("file-numbers");this.renderInternal();return this};g.prototype.renderInternal=function(){};var f=a.ScrollableFilePane=function(a){this.numbers_=d.scrollable(a,35,18);this.lines_=d.scrollable(a,
600,18);this.$elem_=null};f.prototype.decorate=function(a){this.$elem_=a.addClass("scrollable-file-pane");this.renderInternal();return this};f.prototype.renderInternal=function(){this.numbers_.decorate(this.$elem_.children("div").eq(0));this.lines_.decorate(this.$elem_.children("div").eq(1));this.numbers_.$elem_.addClass("scrollable-file-pane-numbers");this.numbers_.$content().addClass("file-numbers");this.lines_.$elem_.addClass("scrollable-file-pane-lines");this.lines_.$content().addClass("file-lines");
this.enterDocument()};f.prototype.enterDocument=function(){};f.prototype.exitDocument=function(){};f.prototype.setPaneWidth=function(a){this.numbers_.setPaneWidth(35);this.lines_.setPaneWidth(a-35)}})(jQuery,_,this);
(function(a,b,e){var d=FECRU.SBS.Diff,g=FECRU.SBS.Permalinker,f=diffract.UnifiedDiff,c=diffract.SideBySideDiff,h=e.BitbucketPatch=function(b,c){var e=this;this.filenames_={};this.diffs_=[];this.deferred_=[];this.waitForDiffToLoad=a.Deferred();this.diffEndpoint=c||BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"changesets",BB.changeset,"diff").toString();a.ajax({type:"GET",url:this.diffEndpoint,success:function(f){b.each(function(b,g){var h=a(g),i=h.hasClass("deferred");if(i){i=h.attr("data-filename");
h=new l(i,e.diffEndpoint);e.deferred_.push(h);e.filenames_[i]=h}else{h=d.sideBySideFromData(f[b]);if(c)h.url=c;i=e.newDiffRenderer(h,i);e.diffs_.push(i);e.filenames_[h.filename()]=i;this.$elem_=null}});e.waitForDiffToLoad.resolve()}});this.$elem_=null};h.prototype.newDiffRenderer=function(a){return a.hasNote()&&!a.hasDiffContent()?new i(a):new j(a)};h.prototype.createDom=function(){this.$elem_=a('<div class="bb-patch">')};h.prototype.render=function(a){var b=this;this.waitForDiffToLoad.done(function(){b.createDom();
b.$elem_.appendTo(a);for(var c=0;c<b.diffs_.length;c++)b.diffs_[c].render(b.$elem_);for(c=0;c<b.deferred_.length;c++)b.deferred_[c].render(b.$elem_);b.enterDocument();b.scrollToPermalink_()})};h.prototype.enterDocument=function(){a(this.deferred_).bind("deferred-diff/load",a.proxy(this.fetchDeferred_,this));a(document).bind("diff-load-start",a.proxy(this.loadingStart_,this)).bind("diff-load-end",a.proxy(this.loadingEnd_,this));a(e).bind("hashchange",a.proxy(this.scrollToPermalink_,this))};h.prototype.exitDocument=
function(){a(this.deferred_).unbind("deferred-diff/load")};h.prototype.fetchDeferred_=function(b,c){var d=this.diffEndpoint.toString();a.ajax({type:"GET",url:this.filenames_[c].url||d.toString(),data:{filename:c,meta:true},success:a.proxy(this.insertDeferred_,this)})};h.prototype.insertDeferred_=function(b){var b=d.sideBySideFromData(b[0]),c=this.newDiffRenderer(b),f=this.filenames_[b.filename()];f.exitDocument();f.$elem_.empty();var h=a.inArray(this.deferred_,b.filename());h>=0&&delete this.deferred_[h];
c.render(f.$elem_);f.$elem_.replaceWith(c.$elem_);this.filenames_[b.filename()]=c;(c=(new g).parse(e.location.hash))&&c.path===b.filename()&&this.scrollToPermalink_()};h.prototype.loadingStart_=function(a,b){var c=this.filenames_[b];c&&c.$elem_.addClass("loading-diff")};h.prototype.loadingEnd_=function(a,b){var c=this.filenames_[b];c&&c.$elem_.removeClass("loading-diff")};h.prototype.scrollToPermalink_=function(b){var c=(new g).parse(e.top.location.hash);if(c){var d=this.filenames_[c.path];if(d instanceof
l)this.fetchDeferred_(null,c.path);else if(d){var f=a.browser.webkit,h=c.file==="from"?d.scrollToFromLine:d.scrollToToLine;!b&&f?setTimeout(function(){h.call(d,c.line)},200):h.call(d,c.line)}}};var i=function(a){this.heading_=new n(a.filename(),a.hasConflicts());this.note_=new w(a.note);this.$elem_=null};i.prototype.createDom=function(){this.$elem_=a('<section class="bb-udiff iterable-item"></section>')};i.prototype.render=function(a){this.createDom();this.$elem_.appendTo(a);this.heading_.render(this.$elem_);
this.note_.render(this.$elem_);this.enterDocument()};i.prototype.enterDocument=function(){};i.prototype.exitDocument=function(){};var j=function(b){var c=d.ofContext(d.unified(b),j.CONTEXT),e=c.filename();this.sbsdiff=b;this.diff_=c;this.heading_=new n(e,c.hasConflicts());this.sbsbutton_=a.browser.msie&&a.browser.version<9?null:new q(b,e);this.note_=c.hasNote()?new w(c.note):null;this.unifiedDiff_=new f(c,18);this.$elem_=this.hoverTimeout_=null};j.CONTEXT=3;j.prototype.createDom=function(){this.$elem_=
a('<section class="bb-udiff iterable-item"></section>')};j.prototype.render=function(a){this.createDom();a.append(this.$elem_);this.heading_.render(this.$elem_);this.sbsbutton_&&this.sbsbutton_.render(this.heading_.$elem_);this.note_&&this.note_.render(this.$elem_);this.unifiedDiff_.render(this.$elem_);this.enterDocument()};j.prototype.enterDocument=function(){a(this.unifiedDiff_).bind("diffract-skipped/click",a.proxy(this.expandSkipped,this));this.unifiedDiff_.$elem_.on("mouseenter",".skipped",a.proxy(this.mouseenter_,
this));this.unifiedDiff_.$elem_.on("mouseleave",".skipped",a.proxy(this.mouseleave_,this))};j.prototype.exitDocument=function(){a(this.unifiedDiff_).unbind("diffract-skipped/click")};j.prototype.replaceDiff_=function(a){this.unifiedDiff_.exitDocument();this.unifiedDiff_.$elem_.remove();this.diff_=a;this.unifiedDiff_=new f(this.diff_,18);this.unifiedDiff_.render(this.$elem_);this.enterDocument()};j.prototype.expandSkipped=function(a,b,c){BB.gaqPush(["atl._trackEvent","Code","Expand unified diff"]);
b.tooltip("hide");this.replaceDiff_(d.expandSkippedSection(this.diff_,c))};j.prototype.mouseenter_=function(c){c=a(c.target).closest(".skipped");this.hoverTimeout_=setTimeout(b.bind(this.hover_,this,c),200)};j.prototype.hover_=function(a){a.tooltip(this.tipsySettings_);a.tooltip("show")};j.prototype.mouseleave_=function(b){clearTimeout(this.hoverTimeout_);a(b.target).closest(".skipped").tooltip("hide")};j.prototype.tipsySettings_={title:function(){return"Show more lines"},gravity:"s",trigger:"manual"};
j.prototype.scrollToFromLine=function(a){if(1<=a&&a<=this.sbsdiff.from.numLines&&!this.unifiedDiff_.scrollToFromLine(a)){this.replaceDiff_(d.expandToInclude(this.diff_,"from",a));this.scrollToFromLine(a)}};j.prototype.scrollToToLine=function(a){if(1<=a&&a<=this.sbsdiff.to.numLines&&!this.unifiedDiff_.scrollToToLine(a)){this.replaceDiff_(d.expandToInclude(this.diff_,"to",a));this.scrollToToLine(a)}};var l=function(a,b){this.filename=a;this.url=b;this.heading_=new n(a,false);this.note_=new w("Click to load.");
this.$elem_=null};l.prototype.createDom=function(){this.$elem_=a('<section class="bb-deferred-diff iterable-item"></section>')};l.prototype.render=function(a){this.createDom();this.$elem_.appendTo(a);this.heading_.render(this.$elem_);this.note_.render(this.$elem_);this.enterDocument()};l.prototype.enterDocument=function(){this.note_.$elem_.bind("click.deferred-diff",a.proxy(this.load_,this))};l.prototype.exitDocument=function(){this.note_.$elem_.unbind("click.deferred-diff")};l.prototype.load_=function(){if(!this.isLoading()){this.note_.$elem_.addClass("loading");
this.note_.setNote("Loading...");a(this).trigger("deferred-diff/load",[this.filename])}};l.prototype.isLoading=function(){return this.note_.$elem_.hasClass("loading")};var m=function(a){this.diff_=a;this.heading_=new n(a.filename(),a.hasConflicts());this.note_=a.hasNote()?new w(a.note):null;this.sbsDiff_=new c(a,18);this.$elem_=null};m.prototype.createDom=function(){this.$elem_=a('<section class="bb-sbs-diff"></section>')};m.prototype.render=function(a){this.createDom();this.$elem_.appendTo(a);this.heading_.render(this.$elem_);
this.note_&&this.note_.render(this.$elem_);this.sbsDiff_.render(this.$elem_);this.enterDocument()};m.prototype.enterDocument=function(){a(document).bind("diff-load-start",a.proxy(this.loadingStart_,this)).bind("diff-load-end",a.proxy(this.loadingEnd_,this))};m.prototype.exitDocument=function(){};m.prototype.loadingStart_=function(a,b){b===this.diff_.filename()&&this.$elem_.addClass("loading-diff")};m.prototype.loadingStart_=function(a,b){b===this.diff_.filename()&&this.$elem_.removeClass("loading-diff")};
m.prototype.setWidth=function(a){this.sbsDiff_.setWidth(a)};m.prototype.setHeight=function(a){this.sbsDiff_.setHeight(a)};m.prototype.scrollToFirstHunk=function(){this.sbsDiff_.scrollToFirstHunk()};var n=function(a,b){this.filename_=a;this.conflicts_=b};n.prototype.createDom=function(){var b=this.filename_.split("/"),b=b.join('<span class="slash">/</span>');this.$elem_=a('<div class="heading"><h1></h1></div>');this.$elem_.attr("id","chg-"+this.filename_).toggleClass("conflicts",this.conflicts_).find("h1").html(b)};
n.prototype.render=function(a){this.createDom();this.$elem_.appendTo(a);this.enterDocument()};n.prototype.enterDocument=function(){};n.prototype.exitDocument=function(){};var q=function(a,c){this.diff_=a;this.filename_=c;this.sbsDiff_=new m(a);this.id_=b.uniqueId("side-by-side-");this.$container_=this.$elem_=null};q.prototype.createDom=function(){this.$elem_=a(['<div class="diff-actions"><ul><li class="sbs-item"><a class="execute click sbs" href="#',this.id_,'">side-by-side diff</a></li><li class="view-file-item"><a class="view-file">view file</a></li></ul><div class="bb-patch" id="',
this.id_,'"></div></div>'].join(""));var b=BB.changeset||"tip";this.$elem_.find("a.view-file").attr("href","/"+BB.repo+"/src/"+b+"/"+this.filename_);this.$container_=this.$elem_.children("div").hide()};q.prototype.render=function(a){this.createDom();this.$elem_.appendTo(a);this.enterDocument()};q.prototype.enterDocument=function(){var b=this;this.$elem_.find("a.sbs").fancybox({autoSize:false,margin:30,width:"97%",height:"97%",scrolling:"no",afterShow:function(){a(this.element).trigger("sbsOpen")},
afterClose:function(){a(this.element).trigger("sbsClose")},helpers:{overlay:{opacity:0.7}}}).bind("sbsOpen",function(){b.onDialogOpen_.apply(b)}).bind("sbsClose",function(){b.onDialogClose_.apply(b)})};q.prototype.exitDocument=function(){};q.prototype.onDialogOpen_=function(){BB.gaqPush(["atl._trackEvent","Code","Invoke SBS diff"]);a("#fancybox-wrap").css({position:"fixed",top:15,left:15});this.$container_.show();this.sbsDiff_.setHeight(this.$container_.parent().height()-60-(this.diff_.hasNote()?
59:0));this.sbsDiff_.setWidth(this.$container_.parent().width());this.$container_.children().length===0&&this.sbsDiff_.render(this.$container_);setTimeout(a.proxy(this.sbsDiff_.scrollToFirstHunk,this.sbsDiff_),0)};q.prototype.onDialogClose_=function(){this.$container_.hide()};BB.diff=BB.diff||{};var p=BB.diff.DiffActions2=function(a,c){this.filename_=a;this.endpoint=c;this.id_=b.uniqueId("side-by-side-")};p.prototype.decorate=function(b){this.$elem_=b;this.$elem_.attr("id",this.id_);this.$container_=
a('<div class="bb-sbs-patch"></div>').appendTo(this.$elem_);this.$container_.attr("id",this.id_+"-content");this.enterDocument()};p.prototype.withDiff=function(b){if(this.diff_)b(this.diff_);else{var c=this;a.ajax({type:"GET",data:{filename:c.filename_,meta:true},url:c.endpoint,success:function(a){c.diff_=FECRU.SBS.Diff.sideBySideFromData(a[0]);c.diff_.url=c.endpoint;b(c.diff_)}})}};p.prototype.withSbsDiff=function(a){this.withDiff(function(b){a(new m(b))})};p.prototype.enterDocument=function(){var b=
this;this.$elem_.find("a.sbs").attr("href","#"+b.id_+"-content").fancybox({autoSize:false,margin:30,width:"97%",height:"97%",scrolling:"no",afterShow:function(){a(this.element).trigger("sbsOpen")},afterClose:function(){a(this.element).trigger("sbsClose")},helpers:{overlay:{opacity:0.7}}}).bind("sbsOpen",function(){b.onDialogOpen_.apply(b)}).bind("sbsClose",function(){b.onDialogClose_.apply(b)})};p.prototype.onDialogOpen_=function(){var b=this;BB.gaqPush(["atl._trackEvent","Code","Invoke SBS diff"]);
a("#fancybox-wrap").css({position:"fixed",top:15,left:15});b.withSbsDiff(function(c){b.withDiff(function(d){b.$container_.show();c.setHeight(b.$container_.parent().height()-60-(d.hasNote()?59:0));c.setWidth(b.$container_.parent().width());b.$container_.children().length===0&&c.render(b.$container_);setTimeout(a.proxy(c.scrollToFirstHunk,c),0)})})};p.prototype.onDialogClose_=function(){this.$container_.hide()};var w=function(a){this.note_=a;this.$elem_=null};w.prototype.createDom=function(){this.$elem_=
a('<div class="message"><p></p></div>');this.setNote(this.note_)};w.prototype.render=function(a){this.createDom();this.$elem_.appendTo(a);this.enterDocument()};w.prototype.enterDocument=function(){};w.prototype.exitDocument=function(){};w.prototype.setNote=function(a){this.note_=a;this.$elem_&&this.$elem_.find("p").text(a)};var r=BB.diff.ContextExpander=function(a,b,c,d,e){this.url=a;this.diff=d;this.identifier=b;this.showComments=!!c;this.commentUrlRoot=e;this.$elem=null};r.prototype.tipsySettings_=
{title:function(){return"Show more lines"},delayIn:500,gravity:"s",offset:-3,live:true};r.prototype.decorate=function(a){this.$elem=a;this.enterDocument();this.loadHiddenContextComments()};r.prototype.enterDocument=function(){this.$elem.on("click",".skipped-container .ellipsis",a.proxy(this.expand,this));this.$elem.find(".skipped-container .ellipsis").tooltip(this.tipsySettings_)};r.prototype.loadHiddenContextComments=function(){var c=this.$elem.data("linecommentroots")||{},d=this;b.each(b.keys(c),
function(e){if(!a("#comment-{}".format(e)).length){var f=c[e],e=d.$elem.find(".skipped-container"),e=b.find(e,function(b){b=a(b);b=d.data(b);return f.line_from?b.above_fnum>f.line_from||!b.above_fnum:b.above_tnum>f.line_to||!b.above_tnum});a(e).find(".ellipsis").trigger("click",f)}})};r.prototype.expand=function(b,c){b.preventDefault();this.$elem.find(".skipped-container .ellipsis").tooltip("hide");var d=a(b.target).closest(".skipped-container");if(!d.hasClass("disabled")){d.addClass("disabled");
var e=setTimeout(function(){d.addClass("loading")},300),f=this;a.ajax({url:f.url,data:f.data(d,c),complete:function(){clearTimeout(e);d.removeClass("disabled loading")},statusCode:{200:function(b){var e=d.closest(".bb-udiff").data("filename"),g=a(b.lines);a(".tipsy").remove();f.setPermalinks(g);if(c&&!d.hasClass("last")){var h=d.next();g.find(".skipped-bottom.last").closest(".skipped-container").attr("style","counter-reset: fromLines {} toLines {}".format(h.data("fnum")-1,h.data("tnum")-1));g.find(".skipped-bottom.last").removeClass("skipped-bottom last").addClass("skipped-middle")}c&&
!d.hasClass("first")&&g.find(".skipped-top.first").removeClass("skipped-top first").addClass("skipped-middle");d.replaceWith(g);if(b.thread_ids){b=BB.comments.ui.LineComment.decorateThreads(f.commentUrlRoot,b.thread_ids,e);f.diff&&f.diff.acceptLineComments(b)}},204:function(){d.remove()}}})}};r.prototype.data=function(a,b){var c=a.prev(),d=a.next(),e={};if(c.length){e.below_fnum=c.data("fnum");e.below_tnum=c.data("tnum")}if(d.length){e.above_fnum=d.data("fnum");e.above_tnum=d.data("tnum")}if(b){if(b.line_from)e.include_fnum=
b.line_from;if(b.line_to)e.include_tnum=b.line_to}if(!this.showComments)e.nocomments=true;return e};r.prototype.setPermalinks=function(b){var c=/(F\d+)?(T\d+)?$/,d=this.identifier;b.find(".line-numbers").each(function(){var b=a(this),e=b.attr("id").match(c);if(e[1]||e[2]){var f="L"+d;e[1]&&(f=f+e[1]);e[2]&&(f=f+e[2]);b.attr({id:f,href:"#"+f})}})};BB.utils.ready("#commit-header .participants",function(b){BB.participants.ui.collectionFrom(b).done(function(b){var c=a("#commit-header");(new BB.participants.ui.ParticipantsStripTruncated({el:c.find("#participants").find("ol"),
collection:b,avatarLimit:5,rightAlignDialog:true})).render();(new BB.participants.ui.ApproveButton({el:c.find(".approve-button"),collection:b})).render();b.bind("approved",function(a){a&&c.find("a.follow").trigger("toggle-follow",{type:"commit",isNowFollowing:true})});a(document).on("comment-added",function(){b.trigger("participants:refresh");c.find("a.follow").trigger("toggle-follow",{type:"commit",isNowFollowing:true})})})});var x=BB.diff.DeferredLargeDiff={};x.setupDeferredDiffMarkers=function(c,
d,f){a("#commit-files-summary li.truncated").each(function(d,e){b.defer(function(b){var b=a(b),d=b.data("file-identifier"),e=b.find("a.execute").text(),f=b.hasClass("file-conflicts"),g=b.find(".count-badge .count").text(),d={diffidentifier:d,filename:e,conflicts:f};g!=="0"&&(d.eclipsedcount=g);var h=a(BB.Mustache.to_html("diff-too-big-template",d));c.append(h);b.on("click",function(){h.find(".load-diff").click()})},e)});c.on("click",".load-diff",function(c){c.preventDefault();var g=a(c.target).closest(".bb-udiff"),
h=g.data("identifier"),i=a('#commit-files-summary li[data-file-identifier="{}"]'.format(h)),c=a('<div class="mask">'),j=a("#compare"),l=j.attr("data-anchor"),m=j.attr("data-dest-rev");g.find(".too-big-message .title").append(c);c.show();a.ajax({type:"GET",url:e.location,data:{file:h},success:function(c){var e=a(c),c=e.find('section[data-identifier="{}"]'.format(h)),e=e.find('#commit-files-summary li[data-file-identifier="{}"]'.format(h)),j=c.data("filename"),n=c.data("compare-files-url"),q=b.keys(c.data("linecommentroots")||
{}),s=BB.comments.ui.CommentableDiff,t=BB.CommentCountIndicator,x;if(c.length){g.replaceWith(c);i.replaceWith(e);if(d){(new t(e.find(".count-badge .count"),c)).decorate();x=(new s(f,j,q,l,m)).decorate(c)}(new p(j,n)).decorate(c.find(".diff-actions"));(new r(c.data("expand-context-url")+encodeURI(j),c.data("identifier"),true,x,f?f.toString():"")).decorate(c)}else{g.find(".too-big-message .try-again").hide();g.find(".too-big-message .try-again-failed").show();g.find(".mask").remove()}}})})};var t=function(){var b=
a("#changeset-diff"),c=a(".file-diff-placeholder");if(b.length===1&&c.length)(new h(c)).render(b);else if(b.length==1&&!a("#pullrequest").length){var d=BB.comments.ui.CommentableDiff,e=BB.diff.DiffActions2,f=BB.diff.ContextExpander,g=BB.comments.ui.GeneralCommentForm,i=BB.comments.ui.LineComment,j=a("#comment-info"),l=j.data("comment-url"),c=j.data("general-thread-ids"),m=j.data("file-line-thread-ids"),b=b.find(".bb-patch-unified");b.find(".bb-udiff, .comment-content .bb-udiff").each(function(){var b=
a(this),c=b.data("filename"),g=b.data("compare-files-url"),h=b.parent().is(".comment-content"),i;m&&(i=(new d(l,c,m[c]||[])).decorate(b));var j=BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"changesets",BB.changeset,"comments").toString();(new e(c,g)).decorate(b.find(".diff-actions"));(new f(b.data("expand-context-url")+encodeURI(c),b.data("identifier"),!h,i,j)).decorate(b)});if(c){(new g(l,true)).decorate(a("#comments-list.line-commenting > li.new-comment"));i.decorateThreads(l,
c);var g=a("#general-comments .comment-count"),i=a("#comments-list"),n=BB.CommentCountIndicator;(new n(g,i)).decorate()}a("#commit-files-summary").on("click",".comments-link",function(b){var c=a(b.target).data("file-path");if(c=a(document.getElementById("chg-"+c)).find("li.comment").first().data("modelobj")){c.scrollTo();b.preventDefault()}});a("#commit-files-summary .count-badge").each(function(b,c){var d=a(c),e=d.find(".count"),d=a(document.getElementById("chg-"+d.find(".comments-link").data("file-path")));
(new n(e,d)).decorate()});x.setupDeferredDiffMarkers(b,c,l)}};a(t);a(document).on("pjax:end",t)})($,_,this);(function(a){a(function(){a(".bb-patch-unified .diffract-udiff").each(function(){var b=a(this);(new refract.UnifiedDiff(b.data("num-lines"),18)).decorate(b)})})})(jQuery,_,this);
(function(){function a(a){a.find(".image-diff").each(function(a,b){var g=$(b),f=g.find(".diff"),c=g.find(".image-diff-toolbar");if(g.find(".binary img").length===2){g=new AJS.ImageDiffer(f,c);g.init()}})}BB.utils.ready("#changeset-diff",a);BB.utils.ready("#source-diff",a)})();
function BranchRenderer(a,b,e){var d=[[153,153,0],[0,153,0],[0,153,153],[0,0,153],[153,0,153],[153,153,0],[0,0,0]],g=[[191,191,64],[64,191,64],[64,191,191],[64,64,191],[191,64,191],[191,191,64],[64,64,64]];this.canvas=a||document.getElementById("graph");if(!this.canvas.getContext)this.canvas=window.G_vmlCanvasManager.initElement(this.canvas);this.ctx=this.canvas.getContext("2d");this.ctx.strokeStyle="rgb(0, 0, 0)";this.ctx.fillStyle="rgb(0, 0, 0)";this.max_column=1;this.bg=[0,4];this.cell=[2,0];this.$container=
b;this.colorIdx=e;this.scale=function(a){this.cell_height=this.box_size=Math.floor(a/1.2);this.bg_height=a};this.setColor=function(a,b){var e=b?d:g,e="rgb("+e[a%e.length].join(", ")+")";this.ctx.strokeStyle=e;this.ctx.fillStyle=e};this.render=function(a,b){for(var b=b||2,e=0;e<a.length;++e){var g=a[e];if(g!=null){var j=g[1],l=j[0],j=this.colorIdx||j[1],g=g[2],m;m=this.$container?this.$container.find(".chg_"+e+" :first-child"):$("#chg_"+e+" :first-child");this.scale(19);this.cell[1]=this.cell[1]+m.outerHeight();
this.bg[1]=this.bg[1]+this.bg_height;for(var n=0;n<g.length;++n){var q=g[n],p=q[0],w=q[1],r=this.colorIdx||q[2],q=m.position().top+b,x=400-(this.cell[0]+this.box_size*p-1+this.bg_height-2),t=q+m.outerHeight()+1,s=400-(1+this.box_size*w+this.bg_height-2),v=x,o=(t-q)/2+q,y=s,A=t-(t-q)/2,B=null;if(p>this.max_column)this.max_column=p;if(w>this.max_column)this.max_column=w;this.setColor(r,true);var u=this.ctx.strokeStyle;if(e==0){q=q-20;B=this.ctx.createLinearGradient(s,t,x,q)}else if(e==a.length-1){t=
t+20;B=this.ctx.createLinearGradient(x,q,s,t)}if(B){B.addColorStop(0,u);B.addColorStop(0.8,"white");this.ctx.strokeStyle=B;this.ctx.fillStyle=B}this.ctx.beginPath();this.ctx.moveTo(x,q);if(p==w)this.ctx.lineTo(s,t);else{for(var D=a[e+1],k=void 0,E=0;E<g.length;++E)if(g[E][0]===g[E][1]&&g[E][1]===w){k=g[E];break}if(e!=a.length-1&&D!==void 0&&k!==void 0&&D[1][0]!=w&&D[2][w]!==void 0&&D[2][w][0]==w){r="rgba("+d[r%d.length].join(", ")+", 0.05)";if(B===null){p=Math.min(0.75+0.75*(Math.abs(p-w)+1)/20,0.98);
B=this.ctx.createLinearGradient(x,q,s,t);B.addColorStop(0,u);B.addColorStop(p,u);B.addColorStop(1,r)}else{p=Math.max(0.25-0.25*(Math.abs(p-w)+1)/7,0.02);B.addColorStop(0,r);B.addColorStop(p,u)}this.ctx.strokeStyle=B;this.ctx.fillStyle=B}this.ctx.bezierCurveTo(v,o,y,A,s,t)}this.ctx.stroke()}if(e!=0){g=m.position().top+b;l=400-(Math.round(this.cell[0]*19/2*l+3)+15-l*4);this.ctx.beginPath();this.setColor(j,false);this.ctx.arc(l,g,3,0,Math.PI*2,true);this.ctx.fill()}}}}}BB.commits={};
BB.commits.pjaxOptions={timeout:5E4};
BB.utils.guard("#commits",function(a){var b=a.find(".pjax"),e=a.find(".aui-tabs"),d=$("#commit-filter"),g=$("#feature-branches-filter");BB.commits.pjaxOptions.container=b;a.pjax(".paginator a",BB.commits.pjaxOptions);a.pjax(".aui-tabs a",BB.commits.pjaxOptions);a.pjax(".commit-list .commit-labels a",BB.commits.pjaxOptions);a.pjax("#show-all",BB.commits.pjaxOptions);a.pjax("#branches-list a.branch-name",BB.commits.pjaxOptions);$(document).pjax("#inline-dialog-branch-dialog .filter-list a",BB.commits.pjaxOptions);
$(document).bind("pjax:start",function(){b.addClass("has-mask");$("#inline-dialog-branch-dialog").remove()});$(document).bind("pjax:timeout",function(){AJS.messages.error({body:"Request has timed out. Refreshing..."})});$(document).bind("pjax:end",function(a){a=$(a.relatedTarget);if(a.closest(".aui-tabs").length){e.find(".active-tab").removeClass("active-tab");a.closest("li").addClass("active-tab")}b.removeClass("has-mask");if(a.hasClass("branch-name")){e.find(".active-tab").removeClass("active-tab");
e.find("#commit-tab").addClass("active-tab")}var c=e.find(".active-tab").attr("id");d.addClass("hidden").removeClass("front-filter");g.addClass("hidden").removeClass("front-filter");if(a.parents(".aui-tabs").length){d.find("input").val("");g.find("input").val("")}if(c=="commit-tab"){if(!b.find("#show-all").length){d.removeClass("hidden").addClass("front-filter");a=$("#corrected-search").attr("data-value");c=d.find("input");a&&(a!="tip"&&!c.is(":focus"))&&c.val(a)}}else c=="featurebranches-tab"&&$("#branches-list").length&&
g.removeClass("hidden").addClass("front-filter");BB.localize()})});BB.utils.ready("#commits-graph",function(a){a.find("canvas").remove();var b=a.parent().height()+80;a.parent();var e=JSON.parse(a.attr("data-graph"));if(e&&e.length){a.height(b);$('<canvas id="graph"></canvas>').attr("height",b).attr("width",a.width()).appendTo(a);document.createElement("canvas").getContext&&(new BranchRenderer).render(e,54)}});
BB.utils.ready(".commit-list",function(a){var b;b=AJS.InlineDialog(a.find(".unmapped-user"),"unmapped-user",function(a,d,g){b.refresh();a.html(BB.Mustache.to_html("unmapped-author-dialog",{link:$(d).attr("href"),raw_author:$(d).data("raw-author")}));g&&g()})});
BB.utils.guard("#commits",function(a){var b=$("#commit-filter, #feature-branches-filter"),e=b.find('input[type="search"]'),d=$("#commit-filter").find("a.help"),g=$("#commit-filter-help");d.on("click",function(a){a.preventDefault();g.toggleClass("hidden");$(a.target).toggleClass("bb-inline-dialog-anchor")});var f;e.on("keyup",function(a){clearTimeout(f);var b=$(this);if(a.keyCode!=13&&b!=$("#corrected-search").data("value")){var d=b.closest("form");f=setTimeout(function(){d.submit()},300)}});if($.browser.webkit)e.on("search",
function(){var a=$(this);a.val()||a.closest("form").submit()});b.on("submit",function(b){b.preventDefault();var e=$(this),b=e.data("url"),f=encodeURIComponent(e.find("input").val()),e=e.attr("id")=="commit-filter"?"/":"?filter=",b=f?b+e+f:b,b={container:a.find(".pjax"),url:b};g.addClass("hidden");d.find("span").removeClass("bb-inline-dialog-anchor");$(".more-action-menu.active").trigger("aui-button-invoke");b=$.extend({},BB.commits.pjaxOptions,b);$.pjax(b)})});
BB.utils.guard("#commit-header",function(){$.each(["parents","branches","tags"],function(a,b){AJS.InlineDialog($(".truncated-"+b+"-count"),"extra-"+this,function(a,d,g){a.append($(".extra-"+b));g&&g()})})});
BB.utils.guard("#commits",function(){var a=0;BB.utils.ready("#branches",function(b){function e(a,b,d){var e=a.find(".commits-graph").html(""),g=a.height(),l=$('<canvas class="graph"></canvas>'),d=d||e.data("graph");e.height(g);l.attr("height",g).attr("width",e.width()).appendTo(e);document.createElement("canvas").getContext&&(new BranchRenderer(l[0],a,b+1)).render(d,16)}var d=b.find("li.branch");_.each(d,function(a,b){var d=$(a),g=false;if(!d.hasClass("no-commits")){e(d,b);d.on("click",".more a",
function(a){function f(){clearTimeout(n);d.removeClass("has-mask");g=false}a.preventDefault();if(!g){g=true;var m=d.find(".commit-list tbody"),n=setTimeout(function(){d.addClass("has-mask")},300),q=0,p={url:d.data("moreUrl"),method:"GET",data:{pageTotal:m.find("tr").length+5,branchName:d.find(".branch-name").text(),more:true},success:function(a){if(a.unavailable)if(q<3){setTimeout(function(){$.ajax(p)},q*2E3);q++}else{d.addClass("failed");f()}else{d.removeClass("failed");m.empty();_.each(a.csets,
function(b,c){var d=$(BB.Mustache.to_html("changeset-template",{cset:b,idx:c+1,cset_short_hash:b.hash.substring(0,7),commentcount:a.commentcount[b.hash],approvalcount:a.approvalcount[b.hash]}));m.append(d)});a.hasMore||d.find(".more").remove();e(d,b,a.graph);BB.localize(d.find("time"));f()}},error:function(a,b){AJS.messages.error(d.find(".message-bar"),{body:b});f()}};$.ajax(p)}})}});if(b.hasClass("calculating")){var g=setTimeout(function(){var b=$.extend({url:window.location.href},BB.commits.pjaxOptions);
$.pjax(b);a++},a*2E3);a>1?b.find(".aui-message").show():BB.commits.pjaxOptions.container.addClass("has-mask");$(document).one("pjax:end",function(){clearTimeout(g)})}b.find("a.sync-branch").each(function(a,c){var d=$(c),e=b.attr("data-compare-slug"),g=b.attr("data-main-branch"),l=d.attr("data-branch"),m=b.attr("data-compare-url"),n=d.attr("data-conflict-url");BB.mergeDialog(d,{id:"merge-"+l,getData:function(){return{action:m,source:"{}::{}".format(e,g),sourceBranch:g,sourceRepo:e,dest:"{}::{}".format(e,
l),destBranch:l,destRepo:e,sameRepo:true,canCloseBranch:false,hasConflicts:false,mergeCommands:"",commitMessageSlug:g,syncBranch:true}},success:function(){BB.messages.addMessage("{} successfully synced with {}.".format(l,g));window.location.reload(true)},conflictUrl:n})});$("nav.more-actions-dropdown").on("click","a.close-branch",function(a){a.preventDefault();var c=$(a.target),a=c.attr("data-branch"),e=c.attr("data-api-url");if(!c.hasClass("disabled")){if(BB.repo.scm=="hg")var c="Are you sure you want to close {}?".format(a),
g="Failed to close {}.".format(a),j="{} successfully closed.".format(a);else{c="This is a destructive operation. Are you sure you want to delete {}?".format(a);g="Failed to delete {}.".format(a);j="{} successfully deleted.".format(a)}confirm(c)&&$.ajax(e,{dataType:"text",type:"DELETE",success:function(){BB.messages.addMessage(j);var a=b.find(".paginator .prev-page");a.length===0||d.length>1?window.location.reload(true):window.location.href=a.attr("href")},error:function(){alert(g)}})}})})});
(function(a,b,e,d){d.participants={};a=d.participants.Participant=e.Model.extend({idAttribute:"username",isNew:function(){return!this.get("last_updated_on")},parse:function(a){return a.user?b.extend({last_updated_on:a.utc_liked_on,approved:true,reviewers:true},a.user):a},url:function(){return this.collection.likesUrl+"/"+this.get("username")}});d.participants.Participants=e.Collection.extend({model:a,initialize:function(a,b){this.url=b.url;this.likesUrl=b.likesUrl;this.noun=b.noun},comparator:function(a){var b=
(new Date).getTime(),c=a.get("last_updated_on");return[a.get("approved")?1:0,c?d.utils.apiUtcToDate(c).getTime():b]},includes:function(a,d){return b.any(d||this,function(b){return b.get("username")===a})},approved:function(a){return this.some(function(b){return b.get("username")===a&&b.get("approved")})},lastNParticipants:function(a,d,c){function e(a){return a.get("username")===d}c=this.filter(c);if(c.length<=a)return c;a=b.tail(c,c.length-a);if(d&&this.includes(d,c)&&!b.find(a,e)){a.shift();a.unshift(b.find(c,
e))}return a},remainingParticipants:function(a,d,c){function e(a){return a.get("username")!==d}c=this.filter(c);if(c.length<=a)return[];if(b.find(c,function(a){return a.get("username")===d})){c=b.filter(c,e);a=a-1}return b.initial(c,a)}})})(jQuery,_,Backbone,BB);
(function(a,b,e,d){d.participants.ui={showParticipantsDialog:function(d,e,c,h){d.html("");d.addClass("show-participants-dialog");var i=a("<ol></ol>");d.append(i);b.each(e,function(a){i.append(this.participantHtml(a,c))},this);h&&h()},participantHtml:function(b,e,c){var h=b.attributes;h.date=b.get("last_updated_on")?a.localize(d.utils.apiUtcToDate(b.get("last_updated_on"))):void 0;h.size=c||24;h.noun=e;return a(d.Mustache.to_html("participant-template",h))},collectionFrom:function(b,e){var c=a.Deferred(),
h=new d.participants.Participants([],{url:b.data("participants-url"),likesUrl:b.data("likes-url"),noun:b.data("noun")});h.fetch({data:{avatar_size:e||24},success:function(a){c.resolve(a)}});return c},rightAlignDialogOptions:{calculatePositions:d.inlineDialog.alignRight()},leftAlignDialogOptions:{arrowOffsetX:-8}}})(jQuery,_,Backbone,BB);
$(function(){var a=BB.participants.ui.ParticipantsStrip=Backbone.View.extend({initialize:function(){this.condition=this.options.condition||function(){return true};this.avatarSize=this.options.avatarSize;this.emptyTemplate=this.options.emptyTemplate;this.collection.bind("reset",this.render,this);this.collection.bind("participants:refresh",_.bind(this.refreshParticipants,this))},refreshParticipants:function(){this.collection.fetch()},render:function(){this.renderAvatars()},processParticipantsList:function(a){return a},
renderAvatarsCompleted:function(){},renderAvatars:function(){this.$el.empty();this.$el.removeClass("loading");var a=this.collection.filter(this.condition),e=this.processParticipantsList(a);if(e.length){this.$el.removeClass("empty");e.reverse();_.each(e,this.addAvatar,this)}else{this.$el.addClass("empty");this.emptyTemplate&&this.$el.append(BB.Mustache.to_html(this.emptyTemplate))}this.renderAvatarsCompleted(a)},addAvatar:function(a){a=BB.participants.ui.participantHtml(a,this.collection.noun,this.options.avatarSize);
this.$el.append(a)}});BB.participants.ui.ParticipantsStripTruncated=a.extend({initialize:function(a){this.constructor.__super__.initialize.apply(this,[a]);this.avatarLimit=this.options.avatarLimit||5;this.rightAlignDialog=this.options.rightAlignDialog},events:{"show-all.participants":"showAll"},processParticipantsList:function(a){var e=BB.user.username;a.length>this.avatarLimit&&(a=this.collection.lastNParticipants(this.avatarLimit-1,e,this.condition));return a},renderAvatarsCompleted:function(a){var e=
this.$el,a=a.length-(this.avatarLimit-1);if(a>1){e.append($('<li><a class="truncated-count badge" href="#">{}</a></li>'.format(a)));a=this.rightAlignDialog?BB.participants.ui.rightAlignDialogOptions:BB.participants.ui.leftAlignDialogOptions;AJS.InlineDialog(e.find(".truncated-count"),"remaining-participants",function(a,b,f){e.trigger("show-all.participants",{container:a,callback:f})},a)}},showAll:function(a,e){var d=this.collection.remainingParticipants(this.avatarLimit-1,BB.user.username,this.condition);
BB.participants.ui.showParticipantsDialog(e.container,d,this.collection.noun,e.callback)}})});
$(function(){BB.participants.ui.ParticipantsCount=Backbone.View.extend({initialize:function(){this.templateName=this.options.templateName;this.condition=this.options.condition;this.dialogId=this.options.dialogId;this.expandCount=this.options.expandCount;this.rightAlignDialog=this.options.rightAlignDialog;this.collection.bind("reset",this.render,this);this.collection.bind("participants:refresh",_.bind(this.render,this))},events:{"click a.ignore":"ignoreClick","show-all.participants":"showAll"},showAll:function(a,
b){var e=this.collection.filter(this.condition);BB.participants.ui.showParticipantsDialog(b.container,e,this.collection.noun,b.callback)},render:function(){var a=this.$el,b=a.find("a"),e=this.collection.filter(this.condition).length,d=$(BB.Mustache.to_html(this.templateName,{count:e,plural:e!=1}));b.replaceWith(d);$("#inline-dialog-"+this.dialogId).remove();this.expandCount&&e?AJS.InlineDialog(d,this.dialogId,function(b,d,c){a.trigger("show-all.participants",{container:b,callback:c})},this.rightAlignDialog?
BB.participants.ui.rightAlignDialogOptions:BB.participants.ui.leftAlignDialogOptions):d.addClass("ignore")},ignoreClick:function(a){a.preventDefault()}})});
$(function(){var a=BB.user.username;BB.participants.ui.ApproveButton=Backbone.View.extend({initialize:function(){this.$button=this.$el;this.collection.bind("reset",this.render,this);this.collection.bind("participants:refresh",_.bind(this.render,this))},events:{click:"toggle"},toggle:function(b){b.preventDefault();var e=this.$button,d=this.collection,g=d.approved(a);if(!e.hasClass("disabled")){e.addClass("disabled");e.prop("disabled",true);e.attr("aria-disabled",true);var f=setTimeout(function(){e.addClass("loading")},
300),b={success:function(){d.fetch({complete:function(){clearTimeout(f);e.removeClass("disabled loading");e.prop("disabled",false);e.attr("aria-disabled",false)}});d.trigger("approved",!g)},error:function(a,b){AJS.messages.error({body:b.responseText})},wait:true};if(g){this.analytics(false);d.find(function(b){return b.get("username")==a}).destroy(b)}else{this.analytics(true);d.create({username:a},b)}}},render:function(){var b=this.collection.approved(a);this.$button.find("span").text(b?"Unapprove":
"Approve")},analytics:function(a){BB.gaqPush(["atl._trackEvent","Likes",this.collection.noun,a?"Like":"Unlike"])}})});
BB.utils.guard("#list-pullrequests",function(a){a.on("pjax:start",function(){a.find(".mask").show()});a.on("pjax:end",function(){a.find(".filter-control li").removeAttr("aria-pressed");var b=$("#pullrequest-pjax").find("table").data("list-status");$("#"+b+"-link").closest("li").attr("aria-pressed","true");a.find(".mask").hide()});var b=$("#pullrequest-pjax");b.pjax(".paginator a");a.pjax(".filter-control a",b,{scrollTo:null,timeout:3E4})});
(function(a,b,e){var d=function(){this.$line=this.$window=null};d.prototype.regex=/(F\d+)?(T\d+)?$/;d.prototype.oldRegex=/_(oldline|newline)(\d+)$/;d.prototype.cssClass="permalinked";d.prototype.isLinePermalink=function(a){a=this.regex.exec(a);return!(!a[1]&&!a[2])};d.prototype.translateHash=function(a){var d=this.oldRegex.exec(a);if(d[1]&&d[2]){var a=a.substring(5),a=a.substring(0,a.length-(d[1]+d[2]).length-1),c="L"+a+{oldline:"F",newline:"T"}[d[1]]+d[2];if(document.getElementById(c))return c;if(a=
document.getElementById("chg-"+a)){d=b(a).find("div.common").filter("[{}={}]".format({oldline:"data-fnum",newline:"data-tnum"}[d[1]],d[2]));if(d.length===1)return d.find(".line-numbers").attr("id")}}return null};d.prototype.decorate=function(a){this.$window=a;this.enterDocument()};d.prototype.enterDocument=function(){this.$window.bind("hashchange",b.proxy(this.highlightLine,this))};d.prototype.highlightLine=function(){var d=a.location.hash;if(this.oldRegex.test(d)){if(d=this.translateHash(d))a.location.hash=
d}else if(this.isLinePermalink(d))if(d=document.getElementById(d.substring(1))){this.$line!==null&&this.$line.removeClass(this.cssClass);this.$line=b(d).addClass(this.cssClass)}};BB.utils.guard("#pullrequest.view-pullrequest",function(g){function f(a){var d=a.find("#general-thread-ids"),e=b("#activity-list.line-commenting > li.new-comment");d.length&&j.decorateThreads(m.toString(),d.data("value"));e.length&&(new l(m,false)).decorate(e);c(a.find(".pr-line-thread-ids"))}function c(a){a.length&&e.each(a.data("value"),
function(a){e.each(a,function(a,b){j.decorateThreads(m.toString(),a,b)})})}BB.prCommentHandler=BB.createCommentHandler(BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"pullrequests",BB.pullrequest,"comments"),g);BB.prCommentHandler.initializeComments();g.find(".description img").each(function(a,c){var d=b(c),e=d.attr("src");d.wrap("<a></a>").closest("a").addClass("image-link").attr({href:e,rel:"pr-image",target:"_blank"})});g.find(".description a.image-link").fancybox({loop:false,
nextEffect:"fade",prevEffect:"fade"});var h=(new BB.dialog.FormDialog("#fulfill-pullrequest",{onUpdateContents:function(a){var a=a.popup.element,b=-(new Date).getTimezoneOffset();a.find('input[name="tzoffset"]').val(b)},success:function(b,c){c.result?a.location=c.result:setTimeout(BB.utils.checkTask.bind(this,c.url,this.error.bind(this)),1E3)},error:function(a){this.complete_();this.displayError({title:"Unable to merge",body:a,closeable:false})},complete:function(){},isStaticContent:true,width:700})).bind();
(new BB.dialog.FormDialog("#reject-pullrequest")).bind();b("#pullrequest-actions .update-tooltip").each(function(){var a=b(this),c=b("#edit-pullrequest"),d=AJS.Cookie.read("pullrequest-last-seen",null),e=a.attr("data-newest-change");if(d!==e){c.addClass("bb-inline-dialog-anchor");a.removeClass("hidden")}a.on("click",".close",function(b){b.preventDefault();AJS.Cookie.save("pullrequest-last-seen",e);a.addClass("hidden");c.removeClass("bb-inline-dialog-anchor")})});if(b("#pull-request-attrs").data("status")===
"open"){var i=function(){h.disable();b("#fulfill-pullrequest").attr("aria-disabled",true).attr("title","Cannot merge due to conflicts")};g.hasClass("mergeimpossible")&&i();g.hasClass("conflicts")?i():b(document).bind("bb:compare",function(){if(b("#compare-metadata").data("has-conflicts")){g.addClass("conflicts");i()}});b(".pullrequest-metadata time").localize()}var j=BB.comments.ui.LineComment,l=BB.comments.ui.GeneralCommentForm,m=BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"pullrequests",
BB.pullrequest,"comments");BB.utils.exists("#activity-list",function(){var a=b("#pr-tab-content");f(a)});BB.participants.ui.collectionFrom(g,32).done(function(a){BB.utils.exists(".approve-button",function(b){(new BB.participants.ui.ApproveButton({el:b,collection:a})).render();(new BB.participants.ui.ParticipantsCount({el:g.find(".approvals"),collection:a,condition:function(a){return a.get("approved")},templateName:"pullrequest-approval-count-template",dialogId:"all-approvers",rightAlignDialog:true})).render()});
BB.utils.exists(".reviewers-group .participants ol",function(b){(new BB.participants.ui.ParticipantsStrip({el:b,collection:a,condition:function(a){return a.get("username")!=BB.pullrequestAuthor},avatarSize:32,emptyTemplate:"no-reviewers-template"})).render()});BB.utils.exists(".author ol",function(b){(new BB.participants.ui.ParticipantsStrip({el:b,collection:a,condition:function(a){return a.get("username")==BB.pullrequestAuthor},avatarSize:32})).render()});a.bind("approved",function(a){a&&g.find("a.follow").trigger("toggle-follow",
{type:"pullrequest",isNowFollowing:true})});b(document).on("comment-added approval-changed.pullrequest",function(b){a.trigger("participants:refresh");b.type=="comment-added"&&g.find("a.follow").trigger("toggle-follow",{type:"pullrequest",isNowFollowing:true})})});g.find(".compare-widget-container .compare-widget").each(function(a,c){var d=b(c),e=false;AJS.InlineDialog(d,"repo-details-"+a,function(a,c,f){e||a.addClass("pullrequest-branch-details-dialog").append(b(BB.Mustache.to_html("branch-details-template",
{display_name:d.attr("data-user-display-name"),username:d.attr("data-user-name"),user_avatar:d.attr("data-user-avatar"),user_url:d.attr("data-user-url"),repo_name:d.attr("data-repo-name"),repo_avatar:d.attr("data-repo-avatar"),repo_url:d.attr("data-repo-url"),branch_name:d.attr("data-branch-name"),branch_url:d.attr("data-branch-url"),branch_state:d.attr("data-branch-state"),commit_id:d.attr("data-commit-id"),commit_url:d.attr("data-commit-url"),size:24})));e=true;f&&f()},{arrowOffsetX:-8})});BB.utils.exists("#pullrequest-navigation",
function(h){var i=b("#pr-tab-content"),n=h.find(".menu-item"),r=true,x=BB.diff.DiffActions2,t=BB.diff.ContextExpander,s=BB.comments.ui.CommentableDiff;(new d).decorate(b(a));var v=null;i.on("pjax:beforeSend",function(){var b=a.location.hash;v===null&&b&&(v=b)});var o=function(a,c){var d=b("#fulfill-pullrequest");if(a){g.addClass("conflicts");d.attr("aria-disabled",true).attr("title","Cannot merge due to conflicts")}if(c){g.addClass("mergeimpossible");d.attr("aria-disabled",true).attr("title","Cannot merge");
b("#explain-mergeimpossible").length==0&&b("#pr-menu-activity").click()}},y=null,A=function(){var d=n.filter(".active-tab").find("a").data("tab-link-id"),g=b("#pr-tab-content-wrapper");n.find("#pr-menu-"+d);var h,j;y===null&&(y=b("#diff-tab-preload").children());if(d==="diff"){var l=b("#compare");h=l.attr("data-anchor");j=l.attr("data-dest-rev");y.appendTo(b("#diff-tab-preload"))}else y.detach();g.removeClass("diff commits activity");g.addClass(d);i.removeClass("has-mask");if(v){g=b(v).parent("li.comment");
if(document.getElementById(v.substr(1))){g.length&&g.addClass("highlight");a.location.hash=v;v=void 0}else if(d==="diff"){g=i.find(".pr-line-thread-ids").data("value")||{};if(e.any(e.values(g),function(a){return e.any(e.values(a),function(a){return e.any(a,function(a){return"#comment-{}".format(a)===v})})})){b("#pr-menu-activity").click();return}}}i.find(".bb-patch-unified .bb-udiff, .comment-content .bb-udiff").each(function(){var a=b(this),c=a.data("filename"),f=a.data("compare-files-url"),g,l=
a.parent().is(".comment-content");if(d==="diff"){g=i.find(".pr-line-thread-ids");var n=[],o=a.data("filename");g.length&&e.each(g.data("value"),function(a){n=e.union(n,a[o])});g=(new s(m,o,n,h,j)).decorate(a)}(new x(c,f)).decorate(a.find(".diff-actions"));(new t(a.data("expand-context-url")+encodeURI(c),a.data("identifier"),!l,g,m.toString())).decorate(a)});if(d==="diff"){g=b("#pr-tab-info");o(g.data("isconflicted"),g.data("mergeimpossible"));b(".comments-link").on("click",function(c){var d=b(c.target).closest("a.comments-link").data("file-path"),
d=b(document.getElementById("chg-"+d)),e=d.find(".comment article").first();e.length===0&&(e=d);b(a).scrollTo(e,500,{axis:"y",offset:-50});c.preventDefault()});b(".eclipsedcount").hoverIntent({over:b.noop,out:function(){BB.gaqPush(["atl._trackEvent","Pull Request","Eclipsed Comments","Hovered icon"])}});b(".eclipsedcount").on("click",function(a){var d=b(a.target),e=d.data("dialog");if(!(a.which>1||a.metaKey||a.ctrlKey)){a.preventDefault();BB.gaqPush(["atl._trackEvent","Pull Request","Eclipsed Comments",
"Viewed"]);if(e)e.show();else{var e=d.closest(".commentable-diff"),a=e.data("filename"),f=b('<div class="maskable has-mask"></div>'),e=e.data("eclipsed-comment-view-url");b.ajax({url:e,data:{file:a}}).success(function(a){f.html(a).removeClass("has-mask");a=f.find(".pr-line-thread-ids");c(a);f.find(".bb-patch-unified .bb-udiff, .comment-content .bb-udiff").each(function(){var a=b(this),c=a.data("filename"),d=a.parent().is(".comment-content");(new t(a.data("expand-context-url")+encodeURI(c),a.data("identifier"),
!d,false,m.toString())).decorate(a)})});e=new AJS.Dialog({width:1E3,height:"auto",id:"eclipsed-dialog-{}".format(a),closeOnOutsideClick:true});e.addHeader("Comments on prior versions","eclipsed-comments-heading");e.addPanel("Comments on prior versions",f,"eclipsed-comments-panel-body");e.addLink("Close",function(a){a.hide()});d.data("dialog",e);e.show();f.addClass("has-mask")}}});var g=b("#general-comments .comment-count"),l=b("#comments-list"),r=BB.CommentCountIndicator,q=BB.diff.DeferredLargeDiff;
(new r(g,l)).decorate();b("#commit-files-summary .count-badge").each(function(a,c){var d=b(c),e=d.find(".count"),d=b(document.getElementById("chg-"+d.find(".comments-link").data("file-path")));(new r(e,d)).decorate()});q.setupDeferredDiffMarkers(i.find(".bb-patch-unified"),true,m)}d==="activity"&&f(i)};if(b("#diff-tab-preload").length){var B=b("#general-thread-ids"),u=b("#comments-list.line-commenting > li.new-comment");B.length&&j.decorateThreads(m.toString(),B.data("value"));u.length&&(new l(m,
true)).decorate(u)}i.on("pjax:end",A);i.on("pjax:error",function(a,b,c){if(b.readyState>0&&c!=="abort"){i.html("<h2>Error</h2><p>We were unable to load this page.</p>");return false}});i.on("pjax:beforeSend",function(){var a=b("#pr-tab-content-wrapper");b("#pr-tab-content").addClass("has-mask");r||a.removeClass("diff commits activity");r=false});var D={container:i,scrollTo:null,timeout:3E4},B=b("#pr-tab-info").data("active-tab-on-load"),u=b("#pr-menu-{}".format(B));if(u.length){u=u.attr("href");b.support.pjax?
b.pjax(b.extend({url:u,replace:true},D)):i.load(u+"?_ajax=1",A);if(B!=="diff"&&g.data("unknown-conflict-state")){A=g.data("conflict-state-url");b.ajax({url:A}).done(function(a){o(a.isconflicted,a.mergeimpossible)})}}if(b.support.pjax)h.on("click","li a",function(a){if(!(a.which>1||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey)){a.preventDefault();h.find("li").removeClass("active-tab");b(this).closest(".menu-item").addClass("active-tab");i.empty();b.pjax(b.extend({url:b(this).attr("href"),push:true},
D))}})});g.on("follow:pullrequest",".sidebar a.follow",function(a,c){b(this).closest("li").toggleClass("watching",c)});var n=false;b(document).on("click","#aui-message-bar .follow-pullrequest",function(a){a.preventDefault();if(!n){a=g.find(".sidebar a.follow");if(!a.hasClass("following")){n=true;g.one("follow:pullrequest",".sidebar a.follow",function(){n=false});a.click()}}})})})(this,$,_);
BB.utils.guard("#pullrequest-form",function(a){function b(){var a=g.find("select[name=source]"),b=d.find("select[name=dest]");if(!(a.length===0||b.length===0)){var c=BB.compare.parse(a.val()).branch,a=b.val();b.find('option[value$="::"]').remove();if(b.find('option[value$=":'+c+'"]').length===0){var e='<option value="{0}::">{1} (new branch)</option>'.format(),c=$(e(h.val(),c)),e=_.sortedIndex(b.find("option").get(),c.get(),function(a){return $(a).text()});e===0?c.insertBefore(b.find("option").get(0)):
c.insertAfter(b.find("option").get(e-1))}b.val(a).trigger("liszt:updated")}}function e(a,b){var c=a.find(".error");if(!c||c.length===0){c=$('<div class="error"></div>');a.append(c)}var d=$("<div></div>");d.text(b);c.append(d)}var d=a.find("#pull-into"),g=a.find("#pull-from"),f=a.find(".compare-widget-container"),c=a.find("#id_source_repo"),h=a.find("#id_dest_repo");a.find("textarea").markItUp(BB.markItUpSettings());c.prop({disabled:true}).trigger("liszt:updated").prop({disabled:false});var i=$("#id_title"),
j=$("#id_description");if(i.length&&j.length){var c=function(a){var b=a.data();b.val=a.val();return function(c){a.val(b.val=c)}},l=c(i),m=c(j);$(document).bind("bb:compare",function(){var b=$("#compare-metadata"),c=b.data("commit-count")!==0;a.find("button:submit").attr({disabled:!c,"aria-disabled":!c});if(!a.hasClass("update")&&!a.data("has-errors")&&i.val()===i.data("val")&&j.val()===j.data("val")){var c=f.find('[name="source"]').val(),d=f.find('[name="dest"]').val(),e='ul[data-source="{0}"][data-dest="{1}"]'.format(),
c=$("#updateable-prs").children(e(c,d)).children();if(c.length===1){l(c.data("title"));m(c.data("description"))}else{b.data("commit-count")===1?l($("#compare-content").find(".commit-list td.text").text().trim()):l("");m("")}}})}f.change(b);b();if($("#id_new_branch").prop("checked")===true){var c=g.find("select[name=source]"),n=d.find("select[name=dest]");if(c.length&&n.length){n.val(n.find('option[value$="::"]').val());n.change()}}d.on("change","select[name=dest]",function(){var a=BB.compare.parse($(this).val()).branch;
$("#id_new_branch").prop({checked:!a})});BB.utils.exists("#updateable-prs",function(b){var c=b.children("ul");c.length!==0&&f.change(function(){var d=$(this),e=d.find('[name="source"]').val(),d=d.find('[name="dest"]').val();if(e&&d){e=c.filter('[data-source="'+e+'"]').filter('[data-dest="'+d+'"]');c.not(e).hide();e.show();e=e.children();d=e.length;a.find("input:submit").val(d===1?"Update pull request #"+e.data("local-id"):"Send pull request");b.addClass("hidden");d&&b.removeClass("hidden").find("strong").text(d>
1?d+" existing pull requests will be superseded":"An existing pull request will be updated")}}).change()});BB.utils.exists("#id_reviewers_group",function(a){function b(i){f.find("li[data-username="+i+"]").addClass("hidden");d.push(i);$.ajax({dataType:"json",url:"/{}/pull-request/xhr/reviewer/{}/".format(h.val(),i),success:function(b){g.append($("<option></option>").attr({value:b.username,"data-avatar-url":b.avatar,selected:"selected"}).text(b.display_name));c();a.find(".error").empty()},error:function(b){var d;
try{d=JSON.parse(b.responseText)}catch(f){d=[]}b=d.error||"An unexpected error occurred";a.find(".error").empty();e(a,b);c()}})}function c(){g.trigger("liszt:updated");var a=f.find("li:not(.hidden)").length>0;$("#suggested").toggleClass("hidden",!a)}var d=[],f=a.find("#suggested ul"),g=a.find("#participants");g.find("option").each(function(a,b){d.push($(b).val())});d.push(BB.pullrequestAuthor||BB.user.username);d.forEach(function(a){f.find("li[data-username="+a+"]").addClass("hidden")});c();g.chosen({placeholder_text:"Start typing to search for a user",
result_formatter:function(a){a.html=a.html.trim();var b=a.disabled?"You cannot remove somebody who has already contributed":"";return $("<div>").append($("<img>").addClass("avatar avatar16").attr("src",a.attributes["data-avatar-url"].value).attr("title",b).attr("alt",a.html+" avatar")).html()+$("<div>").append($("<span>").text(a.html).attr("title",b)).html()}}).on("liszt:showing_dropdown",function(a,b){$(b.chosen.dropdown).addClass("hidden")}).on("change",function(a,b){var e=b.deselected;d=_.without(d,
e);g.find("option[value="+e+"]").remove();f.find("li[data-username="+e+"]").removeClass("hidden");setTimeout(function(){c()},0)});$("#participants_chzn .chzn-choices").addClass("text").find(".search-field input").addClass("bb-reviewer-typeahead");f.on("click","ul li",function(a){b($(a.target).closest("li").attr("data-username"))});var i=function(a,b,c){return d.indexOf(a.id)!==-1?false:BB.mention.TypeaheadUserModel.matcher(a,b,c)},j=BB.mention.ui.ReviewersTypeahead=BB.typeahead.ui.TypeaheadCompletion.extend({events:{"keydown .bb-reviewer-typeahead":"onKeyDown",
"keyup .bb-reviewer-typeahead":"onKeyUp","keypress .bb-reviewer-typeahead":"onKeyPress","focus .bb-reviewer-typeahead":"onFocus"},initialize:function(a){BB.typeahead.ui.TypeaheadCompletion.prototype.initialize.call(this,_.extend({results:new BB.mention.ui.UserSuggestions,hide:false,focus:false},a));this.$chzn=$("#participants_chzn");this.$chznChoices=this.$chzn.find(".chzn-choices");this.$searchInput=this.$chzn.find("li.search-field input");this.lastHeight=this.$chzn.height();this.$dialog=$("#"+this.results.$el.attr("id"))},
onKeyDown:function(a){var b=this;setTimeout(function(){var c=a.target.value;a.which===b.BACKSPACE&&!c?b.hideSuggestions(a.target):BB.typeahead.ui.TypeaheadCompletion.prototype.onKeyDown.call(b,a)},0)},onKeyUp:function(){var a=+this.$dialog.css("top").slice(0,-2)+this.$chzn.height()-this.lastHeight;this.$dialog.css({top:a});this.lastHeight=this.$chzn.height()},showSuggestions:function(a){if(!this.isWithinCodeBlock(a)&&!this.shouldSuppressSuggestions()){this.setShowingState(a,true);this.results.$el.is(":visible")||
this.$chznChoices.attr({"aria-owns":this.results.$el.attr("id"),"aria-haspopup":"true"}).addClass("aui-dropdown2-trigger").trigger("aui-button-invoke")}},complete:function(a){BB.typeahead.ui.TypeaheadCompletion.prototype.complete.call(this,a);b(this.results.replacementText());var c=this.$searchInput;c.blur();setTimeout(function(){c.focus()},0)}});if($("#mention-result").length){var l=_.map(f.find("li"),function(a){var a=$(a),b=a.text().trim().split(" ");return new BB.mention.TypeaheadUserModel({first_name:b[0],
last_name:b[1],username:a.attr("data-username"),avatar_url:a.find("img").attr("src")})}),i=new BB.mention.ui.UserDataSet(l,{model:BB.mention.TypeaheadUserModel,matcher:i,queryEndpoint:"/xhr/user-mention",queryParamKey:"term"});(new j({source:i,el:$("#participants_chzn")[0]})).render()}});a.on("submit",function(){var b=a.find("#participants .non-reviewer").detach(),c=a.serialize(),d=a.attr("action");a.find("#submitPrButton").addClass("loading").attr({disabled:true,"aria-disabled":true});a.find(".error").empty();
$.ajax({type:"POST",url:d,data:c,success:function(c){if(c.errors){_.each(c.errors,function(c,d){var f=a.find("#id_{}_group".format(d));_.each(c,function(c){a.find("#participants").prepend(b);e(f,c)})});$("#submitPrButton").removeClass("loading").removeAttr("disabled").removeAttr("aria-disabled")}else c.result?window.location=c.result:setTimeout(function(){BB.utils.checkTask(c.url,function(){a.find("#submitPrButton").removeClass("loading").removeAttr("disabled",false).removeAttr("aria-disabled",false)})},
1E3)}});return false});BB.utils.exists("#id_close_anchor_branch",function(a){function b(c){e=a.prop("checked");a.prop({checked:false,disabled:true});d.addClass("disabled").attr({title:c})}var c=$("#pullrequest-form"),d=a.next("label"),e=null,g=function(){var f=BB.compare.parse(c.find("select[name=source]").val()),g=c.find("select[name=dest]"),h=BB.compare.parse(g.val()),g=!!g.data("denyBranchDeletion");d.html('Close <span class="branch-name">'+_.escape(f.branch)+"</span> after the pull request is merged");
if(g)b("Branch deletion is disabled for this repository");else if(f.repo!==h.repo)b("Close branch functionality is not available across repositories");else if(f.branch===BB.repo.mainbranch.name)b("You're not permitted to close the main branch");else{a.prop({disabled:false});if(e!==null){a.prop("checked",e);e=null}d.removeClass("disabled").removeAttr("title")}};f.bind("bb:compare:change",g);g()})});BB.PRLiveUpdate=BB.PRLiveUpdate||{};
AJS.toInit(function(a){BB.PRLiveUpdate.SmartTimer=function(b,e){function d(){if(!((new Date).getTime()-c<f.inactivity)){i=0;g()}c=(new Date).getTime()}function g(){h&&clearTimeout(h);h=setTimeout(function(){b();g()},i=Math.min((new Date).getTime()-c<f.inactivity?f.min:i*f.multiplier,f.max))}var f=a.extend({min:2E4,max:36E5,multiplier:1.25,inactivity:3E5},e),c=(new Date).getTime(),h=null,i=0;a(window).focus(d);a("body").click(d);return{start:function(){g()},stop:function(){clearTimeout(h);h=null}}};
BB.utils.exists("#pullrequest",function(b){var e=b.data("updates-url"),d=b.data("last-updated"),g=document.title,b=function(){a.ajax({url:e,data:{since:d}}).done(function(b){var e=a("#pullrequest .qr-notice"),f=b.commentsAdded.concat(b.commentsReplied);getName=function(b){if(typeof b==="string")return"Anonymous user";var c,d=a('<a href=""></a>');c=!b.first_name&&!b.last_name?b.username:"{} {}".format(b.first_name,b.last_name);d.text(c).attr("href","/{}".format(b.username));return d.clone().wrap("<p>").parent().html()};
if(b.prDetailsModified||b.anchorMoved||b.destRevMoved){var g={item_type_class:"qr-notice-type-page",notice_text:"This pull request has been updated",show_label:"Reload",ignore_label:"Ignore"},g=a(BB.Mustache.to_html("notice-item-template",g));e.find(".qr-notice-type-page").remove();e.append(g)}f.length>0&&_.each(f,function(b){var c=e.find(".qr-notice-type-new-comments"),d=parseInt(c.find(".item-count").text()||"0"),f="New {}".format(d===0?"comment":"comments"),b={item_type_class:"qr-notice-type-new-comments",
count:d+1,notice_text:f,show_label:"Reload",show_anchor:"#comment-{}".format(b.evt.reference_id),ignore_label:"Ignore"},b=a(BB.Mustache.to_html("notice-item-template",b));c.remove();e.append(b)});b.commentsEdited.length>0&&_.each(b.commentsEdited,function(b){var c=e.find(".qr-notice-type-edit-comments"),d=parseInt(c.find(".item-count").text()||"0"),f="{} edited".format(d===0?"Comment":"Comments"),b={item_type_class:"qr-notice-type-edit-comments",count:d+1,notice_text:f,show_label:"Reload",show_anchor:"#comment-{}".format(b.evt.reference_id),
ignore_label:"Ignore"},b=a(BB.Mustache.to_html("notice-item-template",b));c.remove();e.append(b)});b.commentsDeleted.length>0&&_.each(b.commentsDeleted,function(){var b=e.find(".qr-notice-type-delete-comments"),c=parseInt(b.find(".item-count").text()||"0"),c={item_type_class:"qr-notice-type-delete-comments",notice_text:"{} deleted".format(c===0?"Comment":"Comments"),count:c+1,show_label:"Reload",ignore_label:"Ignore"},c=a(BB.Mustache.to_html("notice-item-template",c));b.remove();e.append(c)});b.approvalsAdded.length>
0&&_.each(b.approvalsAdded,function(b){var c="approval-user-{}".format(b.user.username),d=e.find(".qr-notice-type-approval."+c),b="{} has approved this pull request".format(getName(b.user)),b=a(BB.Mustache.to_html("notice-item-template",{item_type_class:"qr-notice-type-approval",item_identifier_class:c,notice_text:b,ignore_label:"Dismiss"}));d.remove();e.find(".qr-notice-type-approval."+c).remove();e.append(b)});b.approvalsRemoved.length>0&&_.each(b.approvalsRemoved,function(b){var c="approval-user-{}".format(b.user.username),
d=e.find(".qr-notice-type-approval."+c),b="{} has unapproved this pull request".format(getName(b.user)),b=a(BB.Mustache.to_html("notice-item-template",{item_type_class:"qr-notice-type-approval",item_identifier_class:c,notice_text:b,ignore_label:"Dismiss"}));d.remove();e.find(".qr-notice-type-approval."+c).remove();e.append(b)});(b.approvalsAdded.length||b.approvalsRemoved.length)&&a(document).trigger("approval-changed.pullrequest");if(b.viewers.length>0){f="";g=b.viewers.length===1?"is":"are";if(b.viewers.length>
2)f="{} people".format(b.viewers.length);else for(var m=0;m<b.viewers.length;m++)f=m===0&&b.viewers.length===2?f+(getName(b.viewers[m])+" and "):f+getName(b.viewers[m]);g={item_type_class:"qr-notice-type-watchers",notice_text:"{} {} viewing this pull request".format(f,g)};g=a(BB.Mustache.to_html("notice-item-template",g));e.find(".qr-notice-type-watchers").remove();e.prepend(g)}else{e.find(".qr-notice-type-watchers").remove();e.find(".qr-notice-item").length===0&&e.hide()}e.find(".qr-notice-item").length>
0&&e.show();c();d=b.lastModified})},f=function(b){b.preventDefault();var b=a(b.target).closest(".qr-notice-item"),d=b.closest(".qr-notice");b.remove();d.find(".qr-notice-item").length===0&&d.hide();c()},c=function(){var b=_.map(a(".qr-notice").find(".qr-notice-item:not(.qr-notice-type-watchers)"),function(b){return parseInt(a(b).find(".item-count").text()||"1")}).reduce(function(a,b){return a+b},0);document.title=b>0?"({}) {}".format(b,g):g};a("#pullrequest .qr-notice").on("click",".qr-notice-show",
function(b){b.preventDefault();var c=a(b.target).data("show-anchor");if(c)location.hash=c;location.reload(true);f(b)});a("#pullrequest .qr-notice").on("click",".qr-notice-ignore",f);if(e&&d){(new BB.PRLiveUpdate.SmartTimer(b)).start();b()}})});
BB.utils.guard("#quick-update-pr",function(a){a.on("click",function(b){b.preventDefault();b=a.attr("href");if(!a.hasClass("loading")){a.addClass("loading");var e=function(b){var e=$("<div></div>"),f="An error occurred while updating.",c="Try refreshing this page or editing the pull request directly.";if(b)if($.isArray(b)&&b.length){_.each(b,function(a){$("<p></p>").text(a).appendTo(e)});c=e.html()}else{f=b;c=null}AJS.messages.error({title:f,body:c});a.removeClass("loading")};$.ajax({type:"POST",url:b,
data:{_quick_update:1},error:function(){e()},success:function(a){a.errors?e(a.errors):a.result?window.location=a.result:setTimeout(function(){BB.utils.checkTask(a.url,e)},1E3)}})}})});
BB.mergeDialog=function(a,b){b=$.extend({getData:function(){},success:function(a){window.location=a},width:700},b);(new BB.dialog.FormDialog(a,{success:function(a,d){d.result?b.success.call(this,d.result):d.error?this.error(d.error,d):setTimeout(BB.utils.checkTask.bind(this,d.url,this.error.bind(this),b.success.bind(this)),1E3)},error:function(a,d){this.complete_();d.conflicts&&b.conflictUrl&&(a=a+' <a href="{}">View the conflicts</a>.'.format(b.conflictUrl));this.displayError({title:"Unable to merge",
body:a,closeable:false})},complete:function(){},onUpdateContents:function(a){var b=a.popup.element,g=-(new Date).getTimezoneOffset(),f=b.find("form").data("hasConflicts");b.find('input[name="tzoffset"]').val(g);if(f){b.find(".dialog-button-panel").empty();a.addCancel("Close",function(a){a.hide()})}},id:b.id,template:"merge-form-template",templateData:b.getData,width:b.width})).bind()};BB.compare={parse:function(a){a=a.split(":");return{repo:a.shift(),hash:a.shift()||null,branch:a.join(":")||null}}};
jQuery(function(a){var b=a("#compare-toolbar"),e=a("#compare-form");a.fn.findWidget=function(){var b=this.attr("id");if(!b)return this;b=a("#"+b+"_chzn");return b.length?b:this};var d=function(a,b){var c='[data-repo="{0}"]'.format();return a.filter(c(b))},g=function(a,b,c){var f=BB.compare.parse(b),g=BB.compare.parse(c),h=e.find("#id_source_repo"),i=e.find("#id_dest_repo"),j=a.find('[data-field="source"]'),a=a.find('[data-field="dest"]'),j=d(j,f.repo),a=d(a,g.repo);j.val(b).trigger("liszt:updated");
a.val(c).trigger("liszt:updated");h.val(f.repo).trigger("bb:compare:repo:change").trigger("liszt:updated");i.val(g.repo).trigger("bb:compare:repo:change").trigger("liszt:updated")};a(".compare-widget-form:not(.deleted)").each(function(){var b=a(this),c=b.find(".repo-field"),d=b.find(".repo-avatar-link"),e=b.find(".branch-field"),f='[data-repo="{0}"]'.format();c.on("bb:compare:repo:change",function(){d.hide().filter(f(c.val())).show();var a=e.filter(f(c.val()));a.attr({name:a.attr("data-field")}).findWidget().show();
e.not(a).removeAttr("name").findWidget().hide()});c.change(function(){a(this).trigger("bb:compare:repo:change").trigger("bb:compare:change")});e.change(function(){a(this).trigger("bb:compare:change")});c.filter(":visible").chosen();e.chosen();c.change()});var f=function(a,b,c){var d=function(a){a=BB.compare.parse(a);return{repo:a.repo,cset:a.hash||encodeURI(a.branch)}},e="{0}/{1}".format(BB.repo.owner.username,BB.repo.slug),b=d(b),c=d(c),d=function(a,b,c){return a==e&&!c?b:"{0}{1}{2}".format(a,c?
"+":":",b)};return c.cset?"{0}{1}..{2}".format(a,d(b.repo,b.cset),d(c.repo,c.cset)):"{0}{1}..{2}".format(a,d(b.repo,b.cset,true),c.repo)},c=a(".compare-widget-container"),h=a("#compare-content"),i=null,j=true;h.on("pjax:error",function(a){a.preventDefault()});h.on("pjax:start",function(){h.addClass("has-mask")});h.on("pjax:end",function(b,c,d){e.length&&(d&&d.state.source&&d.state.dest)&&g(e,d.state.source,d.state.dest);h.removeClass("has-mask");h.find(".bb-patch-unified .bb-udiff, .comment-content .bb-udiff").each(function(){var b=
a(this),c=b.data("filename"),d=b.data("compare-files-url"),e=BB.diff.ContextExpander;(new BB.diff.DiffActions2(c,d)).decorate(b.find(".diff-actions"));(new e(b.data("expand-context-url")+encodeURI(c),b.data("identifier"),false)).decorate(b)});a(document).trigger("bb:compare")});c.bind("bb:compare:change",function(){var d=a(this),e=h.attr("data-full-url"),g=d.find('[name="source"]').val(),l=d.find('[name="dest"]').val();if(!e){if(!g||!l||d.data("compare-view-disabled"))return;e=f(h.attr("data-base-url"),
g,l)}e=e+window.location.hash;b.removeClass("has-conflicts");if(c.data("pjax")&&a.support.pjax)a.pjax({container:"#compare-content",url:e,push:!j,scrollTo:null,timeout:0,state:{source:g,dest:l}});else{if(i&&i.readyState<4){i.onreadystatechange=a.noop;i.abort()}i=a.ajax({url:e,beforeSend:function(){h.trigger("pjax:start")},complete:function(){h.trigger("pjax:end")},success:function(b){h.html(b);a(document).trigger("bb:compare")}})}j=false});var l=function(a,b){var c=a.find('.menu-item a[href="{}"]'.format(b)).closest(".menu-item");
if(c.length!==0){a.find(".menu-item.active-tab").removeClass("active-tab");a.find(".tabs-pane.active-pane").removeClass("active-pane");c.addClass("active-tab");a.find(b+".tabs-pane").addClass("active-pane")}};a(window).on("hashchange",function(){l(a("#compare-tabs"),window.location.hash)});a(document).bind("bb:compare",function(){a(function(){var d=a("#compare-tabs"),e=a("#compare-content"),g=a("#changeset-diff"),h=a(".file-diff-placeholder"),i=c.find('[name="source"]').val(),j=c.find('[name="dest"]').val(),
m=BB.api.concat("repositories",BB.repo.owner.username,BB.repo.slug,"comparefiles").toString(),e=e.attr("data-files-url")||f(m,i,j),i=a("#compare-metadata"),j=i.data("hasConflicts");i.data("hasChanges");c.length===1&&h.length&&(new BitbucketPatch(h,e)).render(g);b.toggleClass("has-conflicts",j);window.location.hash&&l(d,window.location.hash);AJS.tabs.setup();d.find(".menu-item a").on("click",function(){window.location.hash=a(this).attr("href")});d.on("click",'a[href="#diff"]',function(){BB.gaqPush(["atl._trackEvent",
"Compare","Diff tab"])}).on("click",'a[href="#commits"]',function(){BB.gaqPush(["atl._trackEvent","Compare","Commits tab"])})})});var m=a("#compare-create-pr"),n=a("#compare-merge"),q=c.data("pr-source-choices")||[],p=c.data("pr-dest-choices")||[],w=function(a,b){for(var c=BB.compare.parse(a),d=null,e=0;e<b.length;++e){var f=b[e],g=BB.compare.parse(f);if(c.repo==g.repo){if(c.hash==g.hash&&c.branch==g.branch)return f;d===null&&c.branch==g.branch&&(d=f)}}return d};a(document).bind("bb:compare",function(){var b=
a(this),c=b.find('[name="source"]').val(),d=b.find('[name="dest"]').val(),b=a("#compare-metadata").data("hasChanges");if(!(m.length===0||!q||!p)){c=w(c,q);d=w(d,p);if(c&&d&&b){m[0].search="source={0}&dest={1}".format(c,d);m.removeClass("disabled").removeAttr("aria-disabled")}else{m[0].search="";m.addClass("disabled").attr("aria-disabled",true)}}});a(document).bind("bb:compare",function(){var b=a("#compare-metadata"),c=b.data("hasConflicts");b.data("hasChanges")&&!c?n.removeClass("disabled").removeAttr("aria-disabled"):
n.addClass("disabled").attr("aria-disabled",true)});m.bind("click",function(b){a(this).hasClass("disabled")&&b.preventDefault()});BB.mergeDialog(n,{getData:function(){var b=e.find('[name="source"]'),c=b.find('[value="{}"]'.format(b.val())),d=c.text(),f=e.find("#id_source_repo").val(),g=e.find('[name="dest"]'),h=g.find('[value="{}"]'.format(g.val())),i=h.text(),j=e.find("#id_dest_repo").val(),l=e.find('label[for="id_source_repo"] .repo-avatar-link').filter('[data-repo="{}"]'.format(f)).find("img"),
m=e.find('label[for="id_dest_repo"] .repo-avatar-link').filter('[data-repo="{}"]'.format(j)).find("img"),n=a("#compare-metadata").data("hasConflicts"),k=!!g.data("denyBranchDeletion"),p=false,h=f==j?d:h.data("mainbranch")&&d==i?f:"{}/{}".format(f,d);f==j&&(!c.data("mainbranch")&&!k)&&(p=true);return{action:document.location.pathname,source:b.val(),sourceBranch:d,sourceRepo:f,sourceAvatar:l.attr("src"),sourceAvatarAltText:l.attr("alt"),dest:g.val(),destBranch:i,destRepo:j,destAvatar:m.attr("src"),
destAvatarAltText:m.attr("alt"),sameRepo:f==j,canCloseBranch:p,hasConflicts:n,mergeCommands:n&&a("#merge-commands-content").html(),commitMessageSlug:h}}});e.find("#compare-swap-link a").click(function(a){a.preventDefault();var a=e.find('[name="source"]').val(),b=e.find('[name="dest"]').val();g(e,b,a);c.trigger("bb:compare:change")});c.trigger("bb:compare:change")});
BB.utils.guard("#issue-view",function(a){a.data();var b=function(){window.location.reload(true)},e=/[(](BB-\d+)[)]/.exec($("#issue-title").text()),d=a.find("#jira");d.toggle(location.pathname.startsWith("/site/master/"));d.length&&e&&d.text("View in JIRA").attr({href:"https://bitbucket.atlassian.net/browse/"+e[1]});a.find("#issue-delete-link").click(function(a){confirm("This is a destructive operation. Delete issue?")||a.preventDefault()});a.find(".issue-attrs").find(".watchers").find("a").click(function(a){a.preventDefault();
$.post($(this).attr("href"),b)});$("ul.issue-attachment-list").find("a.image-attachment").fancybox({loop:false,nextEffect:"fade",prevEffect:"fade"});BB.utils.exists("#jira-issue-box",function(a){var b=a.find("a.close");b.on("click",function(d){d.preventDefault();$.ajax({type:"PUT",url:BB.api.concat("user","preferences",BB.user.username,"dismiss-jira-box-"+b.data("repo-id")),data:{value:"True"},complete:function(){a.animate({opacity:0},200,function(){$(this).animate({height:0},200,function(){a.remove()})})}})})});
var g=new AJS.Dialog({width:700,height:"auto",id:"issue-attachment-dialog",closeOnOutsideClick:true}),f=$(BB.Mustache.to_html("attachment-dialog-template"));f.find("textarea").markItUp(BB.markItUpSettings());g.addHeader("Attach files");g.addPanel("Attach",f,"panel-body");g.addButton("Attach",function(){f.submit()});g.addCancel("Cancel",function(a){a.hide()});$(".issue-attach-link").click(function(a){a.preventDefault();g.show()});BB.localize()});
BB.utils.guard("#issues-comments",function(a){function b(b){b.find("textarea").val("").markItUpRemove();b.removeClass("textarea-preview");b.removeClass("focused");if(a.hasClass("commentable")){b.closest(".comment article").removeClass("editing");b.closest(".new-comment").length||b.closest("form").detach()}}var e=$("#issue-view").data(),d=function(){window.location.reload(true)},g=bitbucket.repository(BB.repo.owner.username,BB.repo.slug);a.find("dd.comment").each(function(){var a=$(this),b=a.text().trim();
_.any([/^Duplicate of #\d+[.]$/,/^Issue #\d+ was marked as a duplicate of this issue[.]$/],function(a){return a.test(b)})&&a.nextUntil().remove()});a.hasClass("commentable")&&a.append($(BB.Mustache.to_html("new-comment-template",{user_avatar_url:BB.user.avatarUrl,display_name:BB.user.displayName,content:""})));a.on("focus",".editor textarea",function(c){var d=$(c.target).closest(".editor");a.find(".editor.focused").each(function(){d[0]!=this&&b($(this))});c=$(this).closest(".editor");a.find(".focused").removeClass("focused");
c.addClass("focused");var e=c.find("textarea");if(!e.hasClass("markItUpEditor")){c.addClass("textarea-preview");e.markItUp(BB.markItUpSettings());setTimeout(function(){e.trigger("focus")},0)}});a.on("click",".editor .cancel",function(a){a.preventDefault();var d=$(this).closest(".editor");BB.utils.editContent($(a.target),d);b(d)});var f=$("#issue-comment, .new-comment");f.on("click keydown",'a[href="#submit"], button:submit',function(a){if(!(a.type==="keydown"&&a.keyCode!==13)){a.preventDefault();
var a=$(a.target),b=f.find("textarea").val();a.addClass("loading");a.attr("aria-disabled",true);a.prop("disabled",true);g.create_issue_comment(e.localId,{content:b},d)}});a.on("click keydown",".issue-comment .aui-button-primary",function(a){var b=$(a.target).closest(".comment article");if(!(a.type==="keydown"&&a.keyCode!==13)){a.preventDefault();a=b.find("textarea").val();b=b.data("comment-id");g.update_issue_comment(e.localId,b,{content:a},{success:d,error:function(a){a.status==401&&alert("You must be logged in to post a comment.")}})}});
a.on("click",".edit-comment-link",function(b){b.preventDefault();b=$(b.target).closest(".comment-content, .comment");if(a.hasClass("commentable")){var d,e,f;f=$(this).closest(".comment article");e=f.data("content");b=$(BB.Mustache.to_html("new-comment-template",{user_avatar_url:BB.user.avatarUrl,display_name:BB.user.displayName,content:e,convert_markup:f.data("convert-markup")==="True"})).find("form");a.append(b);f.find(".comment-content").after(b);d=b.find("textarea");d.data("originalComment",e);
b.find(".comment_id").val(f.data("commentId"));f.addClass("editing");d.focus()}else{b.addClass("edit-comment-mode");b.find("article").addClass("editing");b.find(".editor textarea").focus()}});$(".edit-comment").each(function(){var a=$(this);a.find("a.button, button").click(function(){var b=a.find("textarea").val(),f=a.data("comment-id");g.update_issue_comment(e.localId,f,{content:b},{success:d,error:function(a){if(a.status==401){alert("You must be logged in to post a comment.");d()}}})})})});
BB.utils.guard("#issues",function(a){BB.utils.exists("#issues #id_attachments",function(a){var b=a.closest("#attachments").find(".attachment-list"),g=typeof a[0].files!="undefined";a.change(function(){b.children(".pending").remove();b.children(".empty").remove();g&&_.each(this.files,function(a){$('<li class="pending"></li>').text(a.name).appendTo(b)})})});var b=a.find(".attachment-list");b.on("click",'a[href="#delete-attachment"]',function(a){a.preventDefault();if(confirm("Are you sure you want to delete this attachment?")){var d=
$(this),a=b.data("deleteUrl");$.ajax({url:a,type:"POST",data:{delete_attachment_id:d.data("id"),csrfmiddlewaretoken:$('input[name="csrfmiddlewaretoken"]').val()},success:function(){d.closest("li").remove()}})}})});
BB.utils.guard("#issue-form",function(a){a.css({position:"absolute",left:-9999}).show();var b=a.find("select");b.not("#id_responsible").addClass("nosearch");b.filter("#id_component, #id_milestone, #id_version").each(function(){var a=this.id.replace("id_","");$(this).data().placeholder="Select a {}\u2026".format(a)});BB.utils.chosen(a,{allow_single_deselect:true});a.removeAttr("style");a.find("#id_content, #id_comment, .edit-comment textarea, #id_update_comment").markItUp(BB.markItUpSettings());a.find("#assign-to-me").click(function(b){var d=
$(b.target).attr("data-username");b.preventDefault();a.find("#id_responsible").val(d).trigger("liszt:updated")})});
BB.utils.guard("#issues-list",function(a){var b={"~":"contains","^":"starts with",$:"ends with","!":"not"},e={},d=a.find(".issues-list").data("qs");d&&_.each(d.split("&"),function(a){var c,d,g,a=a.split("=");c=a[0];g=decodeURIComponent(a[1]);a=g.substr(0,1);if(_.has(b,a)){g=g.substr(1);d=b[a]+" "}else d="";(e[c]||(e[c]=[])).push(c==="responsible"&&!g?a==="!"?"someone":"no one":d+'"'+g+'"')});var g={q:"query",reported_by:"reporter",responsible:"assignee"},d=_.map(_.keys(e).sort(),function(a){return"<b>{label!esc}:</b>\n{value!esc}".format({label:g[a]||
a,value:e[a].sort().join(" or ")})});a.find("#issues-filter-criteria").html(d.join(" "))});
BB.utils.guard("#workflow-dropdown",function(a){var b=$("#issue-view"),e=b.data();a.find('[data-transition-to="{curr}"], [data-transition-to="{next}"]'.format({curr:e.status,next:b.find("#change-state").find("a").data("transition-to")})).remove();var d=new AJS.Dialog({width:700,height:"auto",id:"issue-transition-dialog",closeOnOutsideClick:true}),g=$(BB.Mustache.to_html("transition-dialog-template")),f=g.find(".error"),c=function(a){f.removeClass("hidden");f.find(".message").text(a)},h=bitbucket.repository(BB.repo.owner.username,
BB.repo.slug),i={success:function(){window.location.reload(true)},error:function(a){a.status===404?c("The duplicate issue does not exist"):c("An unexpected error occurred.")}},j;g.submit(function(a){a.preventDefault();l()});g.find("#id_transition_comment").markItUp(BB.markItUpSettings());var l=function(){var a=g.find("#id_transition_comment").val(),a={status:j,comment:a},b=d.popup.element.find(".transition-issue-button");b.addClass("loading").attr({"aria-disabled":true,disabled:true});if(j===6){var f=
g.find("#id_duplicate_issue").val();if(f=/\d+/.exec(f))if(+f[0]===e.localId){c("Invalid issue number");b.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled")}else{i.type="POST";i.url=g.data("duplicateUrl");i.data=a;a.duplicate=f[0];$.ajax(i)}else{c("Invalid issue number");b.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled")}}else h.update_issue(e.localId,a,i)};d.addHeader("Transition issue");d.addPanel("Transition",g,"panel-body");d.addButton("Change",l,
"aui-button transition-issue-button");d.addCancel("Cancel",function(a){a.hide()});b=function(a){a.preventDefault();var b=$(this),a=b.attr("title");j=b.data("transition-to");b=j==6;g.find(".duplicate").toggle(b);g.find(".comment").toggle(!b);f.addClass("hidden");d.addHeader(a?a:"Transition issue");d.show()};a.find("[data-transition-to]").click(b);$("#change-state").click(b)});
BB.utils.guard("#issues-query-builder",function(a){var b=a.find("form.query-form").data(),e=a.find("#filters"),d={init:function(a,b){var g;if(a)for(g in a)a[g].type==="select"&&a[g].options.length<=0&&$('#addfilter option[value="'+a[g].name+'"]').remove();$("#addfilter").bind("change",function(){this.selectedIndex>0&&d.create(this.options[this.selectedIndex].value)}).chosen();e.html("");if(!_.isEmpty(b))for(g in b)for(var i=0;i<b[g].length;i++)d.create(g,b[g][i][0],b[g][i][1])},generate_select:function(a,
b,d){/^responsible\d+$/.test(a)?b.unshift({text:"unassigned",value:""}):/^(?:component|milestone|version)\d+$/.test(a)&&b.unshift({text:"unset",value:""});var e=document.createElement("select");e.name=a;for(var g=0;g<b.length;g++){if(typeof b[g]==="object"){a=new Option(b[g].text,b[g].value);if(b[g].value===d)a.selected=true}else{a=new Option(b[g],b[g]);if(b[g]===d)a.selected=true}e.options[e.options.length]=a;e.className="nosearch"}return e},generate_remove_button:function(){return $('<a class="icon filter-remove">Remove filter</a>')[0]},
remove:function(){var a=$(this).parent().parent();if(a.attr("class")===a.next("li").attr("class")){var b=a.find(".filter-header").text();a.next("li").find(".filter-header").text(b)}a.remove()},generate_comp_select:function(a,b,d){var e={text:[{text:"contains",value:"~"},{text:"doesn't contain",value:"!~"},{text:"begins with",value:"^"},{text:"ends with",value:"$"},{text:"is",value:""},{text:"is not",value:"!"}],select:[{text:"is",value:""},{text:"is not",value:"!"}]};if(b==="text"||b==="select")return this.generate_select(a,
e[b],d)},create:function(a,b,h){var i=g[a],j=false,l=1;if($("#filters li").hasClass("filter_"+a)){j=true;l=$("#filters li.filter_"+a).length+1}var m=$("<li></li>");m.addClass("filter_"+a);var n=$('<div class="filter-header"></div>');j?n.text("or"):n.text(i.header);m.append(n);n=$('<div class="filter-comp"></div>');if(i.type==="text"||i.type==="select"){var q=d.generate_comp_select("comp_"+i.name+l,i.type,b);n.append(q);setTimeout(function(){$(q).chosen()},0)}m.append(n);var b=$('<div class="filter-query"></div>'),
p;if(i.type==="text"){p=$("<input/>");p.attr("type","text");p.attr("name",a+l);p.val(h?h:"");p.attr("size",30)}else i.type==="select"&&(p=this.generate_select(a+l,i.options,h));if(p){b.append(p);i.type=="select"&&setTimeout(function(){$(p).chosen()},0)}m.append(b);h=$("<div></div>");i=this.generate_remove_button();h.append(i);m.append(h);$(i).click(d.remove);if(j){$("#filters .filter_"+a+":last").after(m);$("#filters .filter_"+a+" div").removeClass("last-of-type");$("#filters .filter_"+a+":last div").addClass("last-of-type")}else e.append(m);
$("#addfilter").get(0).selectedIndex=0}},g={title:{name:"title",type:"text",header:"Title"},content:{name:"content",type:"text",header:"Description"},version:{name:"version",type:"select",header:"Version",options:b.versions},milestone:{name:"milestone",type:"select",header:"Milestone",options:b.milestones},component:{name:"component",type:"select",header:"Component",options:b.components},kind:{name:"kind",type:"select",header:"Type",options:b.kinds},status:{name:"status",type:"select",header:"Status",
options:b.statuses},priority:{name:"priority",type:"select",header:"Priority",options:b.priorities},responsible:{name:"responsible",type:"select",header:"Assignee",options:b.responsibles},reported_by:{name:"reported_by",type:"text",header:"Reported by"}};d.init(g,b.query);a.find("#filters-filters").find(".cancel").click(function(a){a.preventDefault();window.history.back()})});
BB.utils.guard("#repo-getting-started",function(a){var b=a.find("ul.tabs li"),e=a.find(".tab-pane");a.find("ul.tabs li a, a.tab-jump").click(function(a){var g=$(a.target).attr("href").substring(1),f=b.find('[href="#'+g+'"]').closest("li");a.preventDefault();f.length||(f=b.filter(":first"));b.filter(".selected").removeClass("selected");f.closest("li").addClass("selected");e.filter(".selected").removeClass("selected");$("#"+g).addClass("selected")})});
BB.utils.guard("#source-container",function(a){var b=$(document);BB.utils.ready("#inline-image",function(a){var b=a.find("a.show-image");b.click(function(e){var c=$('<img src="" alt="">');c.attr("src",b.attr("href"));c.prependTo(a);b.remove();e.preventDefault()})});var e={container:"#source-container",timeout:5E3};a.pjax(".pjax-trigger",e);b.pjax("#inline-dialog-changesets-dialog .file-history-widget a",e);b.pjax("#inline-dialog-branch-dialog .filter-list a",e);b.on("pjax:start",function(){a.find(".mask").show();
$("#inline-dialog-branch-dialog").remove();$("#inline-dialog-changesets-dialog").remove();$("#inline-dialog-diff-dialog-diff1").remove();$("#inline-dialog-diff-dialog-diff2").remove()});b.on("pjax:timeout",function(){AJS.messages.error({body:"Request has timed out. Refreshing..."})});b.on("pjax:end",function(){a.find(".mask").hide();BB.localize()});AJS.InlineDialog("#embed-link","embed-dialog",function(a,b,e){b=$(b);if(!a.find(".embed").length){b=BB.Mustache.to_html("embed-template",{url:b.attr("href")});
a.append(b)}e&&e();setTimeout(function(){$("#embed-code").select()},0)},{calculatePositions:BB.inlineDialog.alignRight()});BB.utils.ready("#source-list",function(a){var b=a.find(".date.deferred").first();if(!(b.length<1)){b.addClass("loading");$.ajax({url:window.location.href,data:{_lastmod:"1"},success:function(b){$(b).each(function(){var b,e;b=$(this);if(e=b.data("for")){e=a.find(e);e.removeClass("deferred");return e.html(b)}});BB.localize()},complete:function(){b.removeClass("loading")}})}})});
BB.utils.guard("#source-container",function(){BB.utils.ready("#source-view",function(a){a=a.find("#file-history-trigger");BB.ChangesetSelector(a,"changesets-dialog").init()})});
BB.utils.guard("#source-container",function(){BB.utils.ready("#source-diff",function(a){function b(){var a=c.getSelectedChangeset(),b=h.getSelectedChangeset();if(a.startsWith(b)||b.startsWith(a)){g.removeClass("hidden");g.find(".message").text("You cannot diff the same commit.");return false}g.text("");$.pjax({container:"#source-container",url:window.location.pathname,data:{diff1:a,diff2:b,at:f||""},success:function(a){$("#source-container").html(a)}});return true}var e=a.find("#diff1-history-trigger"),
d=a.find("#diff2-history-trigger"),g=a.find(".error"),f=a.data("at"),c,h;c=BB.ChangesetSelector(e,"diff-dialog-diff1",{onSelect:b});c.init();h=BB.ChangesetSelector(d,"diff-dialog-diff2",{onSelect:b});h.init()})});
BB.utils.guard("#downloads",function(a){var b=$("#downloads-count"),e=+b.text();a.find("a[data-id]").click(function(a){a.preventDefault();var g=$(this),a=g.data();if(confirm('Permanently delete "{filename}"?'.format(a))){g.addClass("deleting");$.post(g.attr("href"),{file_id:a.id},function(){var a=g.closest("tr");if(a.siblings().length){a.remove();b.text(e=e-1)}else window.location.reload()})}});BB.utils.exists("#add-download",function(){var a=$("#upload-file-form"),b=a.find("#file"),e=a.find("#key"),
c=a.find("#content-type"),h=a.find('button[type="submit"]');h.attr({"aria-disabled":true,disabled:true});b.change(function(){h.removeAttr("aria-disabled").removeAttr("disabled")});a.submit(function(){var h=b.val().match(/[^\/\\]*$/)[0];c.val($.ajax({url:"/site/mimeguess/"+h,async:false,dataType:"json"}).responseText);e[0].value=e[0].value+h;a.find('input[name="Content-Disposition"]').attr("value","attachment; filename="+h)})});BB.utils.exists("#upload-captcha-form",function(a){var b=a.attr("action"),
e=$("#upload-file-form").addClass("hidden"),c=$("#captcha-wrong");a.removeClass("hidden");a.submit(function(){$.getJSON(b,$(this).serialize(),function(b){if(b.status=="success"){e.find('[name="Policy"]').val(b.policy);e.find('[name="Signature"]').val(b.signature);e.removeClass("hidden");a.addClass("hidden")}else b.status=="fail"&&c.removeClass("hidden")});return false})})});
BB.utils.guard("#wiki-edit",function(a){var b={markdown:"Markdown",creole:"Creole",rest:"reStructuredText",textile:"Textile"},e=a.find(".textarea-preview"),a=e.data("markup-type");$("#id_data").markItUp(BB.markItUpSettings(a,{wikiHelp:true}));if(e.hasClass("wiki-syntax")){var d=$("#dropdown-wiki-lang"),g=$("#markItUpId_data .markItUpButton.language");g.find("a").text(b[a]);g.removeClass("hidden").find("a").append('<span class="aui-icon-dropdown"></span>').addClass("aui-dropdown2-trigger aui-style-default").attr("aria-haspopup",
"true").attr("aria-owns","dropdown-wiki-lang").attr("data-container","#markItUpId_data");d.on("click","a",function(a){a.preventDefault();a=$(this).data("markupLang");e.attr("data-markup-type",a).find("[class^=markup-type]").removeClass().addClass("markup-type-"+a);g.find("a").text(b[a]).append('<span class="aui-icon-dropdown"></span>');$("#id_markup_type").val(a)}).on({"aui-dropdown2-show":function(){var a=e.attr("data-markup-type");d.find("li a").removeClass("active");d.find('a[data-markup-lang="'+
a+'"]').addClass("active")}})}});
BB.utils.guard("#registration",function(a){var b=a.find('input:radio[name="is_team"]'),e;b.change(function(){e&&e.unbindAll();var b=a.find("#id_is_team_1").prop("checked");e=b?new BB.widgets.CalculatedInput($("#id_team_name"),$("#id_username"),BB.utils.toUsername):new BB.widgets.CalculatedInput($("#id_first_name, #id_last_name"),$("#id_username"),function(a,b){return BB.utils.toUsername(!b?a:a.substr(0,1)+b)});a.toggleClass("team",b).trigger("change:team",[b]).find('input[type="text"]:visible').first().focus()});b.change();
a.find("form").submit(function(){var b=a.find("#id_username");b.val(b.val().trim())});b=$("#team-members");BB.widgets.user(b,{userField:$("#id_usernames"),adminUsersField:$("#id_admin_usernames"),allowAddSelf:false,allowInvitations:true,invitationField:$("#id_addresses"),adminInvitationsField:$("#id_admin_addresses")});b.bind("bb:userwidget.invite-added",function(){BB.gaqPush(["atl._trackEvent","Share","Invitation - Register Team"])});b=$("#id_email");b.val()===""&&b.val(BB.utils.queryStringMap().prefilled_email||
"");BB.utils.exists("#team-vs-individual-help-trigger",function(a){AJS.InlineDialog(a,"team-vs-individual-help",function(a,b,c){a.html($(".help-box").html());c&&c()})})});BB.utils.guard("#registration-form, #create-team-form",function(a){a.find('input[type="text"]:visible').first().focus()});
BB.utils.guard(".team-members-form",function(a){function b(){return(!a.is("#registration-form")||a.parent().hasClass("team"))&&!(c&&h&&i)}var e=a.find(".submit"),d=e.find("button"),g=e.find(".description"),f=a.find("#id_agree");BB.utils.chosen(a);var c=true,h=true,i=!f.length||f.prop("checked");d.prop("disabled",b());d.attr("aria-disabled",b());f.change(function(){i=f.prop("checked");d.prop("disabled",b());d.attr("aria-disabled",b())});$("#registration").bind("change:team",function(a,c){d.prop("disabled",
b());d.attr("aria-disabled",b());g.toggle(c)});a.find(".team-members-widget-container").bind("change:members",function(e,f,i){c=f;h=i;c&&h?g.text(""):c?g.text("You must select at least one admin to continue."):g.text("You must add a {} to continue.".format(a.is("#convert-team-form")?"developer":"member"));d.prop("disabled",b());d.attr("aria-disabled",b())})});BB.utils.guard("#create-team-form",function(){new BB.widgets.CalculatedInput($("#id_team_name"),$("#id_username"),BB.utils.toUsername)});
BB.utils.guard("#create-team #team-members",function(a){BB.widgets.user(a,{allowInvitations:true,userInput:a.find("#team-member"),userField:$("#id_usernames"),adminUsersField:$("#id_admin_usernames"),invitationField:$("#id_addresses"),adminInvitationsField:$("#id_admin_addresses"),initialUsers:BB.user.username?[{avatar:BB.user.avatarUrl,display_name:BB.user.displayName,username:BB.user.username}]:[],initialAdmins:BB.user.username?[BB.user.username]:[],allowAddSelf:true});a.bind("bb:userwidget.invite-added",
function(){BB.gaqPush(["atl._trackEvent","Share","Invitation - Create Team"])})});BB.utils.guard("#create-team-link",function(a){a.click(function(){BB.gaqPush(["atl._trackEvent","Share","Create Team Menu Link"])})});
BB.utils.guard("#convert-team",function(a){var b=a.find("form"),a=b.find("#id_username");a.prop("type")!="hidden"&&a.prop({readonly:true});BB.utils.exists("#team-groups",function(){function a(b){var d=b.parents(".team-group").find(".collaborator-privilege input"),b=b.prop("checked");d.prop({disabled:b});b&&d.prop({checked:b})}var d=b.find("#team-groups .admin-privilege input");d.each(function(){a($(this))});d.click(function(){a($(this))})});BB.utils.exists("#team-members",function(a){var b=a.find("#id_usernames"),
g=a.find("#id_addresses");BB.widgets.user(a,{userField:b,adminUsersField:$("#id_admin_usernames"),allowAddSelf:false,allowInvitations:true,invitationField:g,adminInvitationsField:$("#id_admin_addresses")});a.bind("bb:userwidget.invite-added",function(){BB.gaqPush(["atl._trackEvent","Share","Invitation - Convert Team"])});!b.val()&&!g.val()&&$.ajax({type:"GET",url:"/!api/1.0/privileges/{}".format(BB.user.username),data:{filter:"write"}}).done(function(b){_.each(b,function(b){b.user.username!==BB.user.username&&
a.trigger("adduser.user-widget",{user:b.user,errorOnDuplicate:false})})})});BB.utils.exists("#convert-team-login",function(a){a.find("#id_username").val(a.data("username"))})});$(document).on("change","#notification-body input[type=checkbox]",function(){var a=$(this),b=a.parent().parent();a.prop("checked")?b.addClass("selected"):b.removeClass("selected")});
$(document).on("change","#notification-form header input[type=checkbox]",function(){var a=$(this);$("#notification-body input[type=checkbox]").prop("checked",a.prop("checked")).change()});$(document).on("change","#notification-form",function(){var a=$(this);$("#notification-toolbar").find("button").prop("disabled",a.find(":checked").length===0)});$(document).on("click","#notification-compose-form a.cancel",function(){window.history.back()});BB.utils.guard("#notification-compose-form",function(a){a.find("#id_recipient").addClass("bb-user-team-typeahead")});
(function(a){var b={expires:365};a("a.switch-login").click(function(e){e.preventDefault();e=a(this).attr("href").slice(1);a(".login-box, .registration-box").attr("data-method",e);a.cookie("login-method",e,b)});a("#openid-form #providers a").click(function(e){var d=a(this);a("#openid-form #providers a").removeClass("selected");d.addClass("selected");a("#openid-form .provider").removeClass("selected");e.preventDefault();if(d.data("url").indexOf("{id}")===-1){a("#openid-form .buttons").removeClass("selected");
a("#openid-form").trigger("submit")}else{a.cookie("openid-provider",d.attr("href"),b);a("#openid-form .buttons").addClass("selected")}a(d.attr("href")).addClass("selected").find("input").focus()});a("#openid-form").submit(function(){var b=a("#openid-form #providers .selected").data("url"),d=a("#openid-form .provider.selected input").val();a("#openid_provider").val(b.replace("{id}",d));a("#openid_username").val(d)})})(jQuery);
$(".connect-button").on("click","button",function(){var a=/(google|facebook|twitter|github)-button/.exec($(this).attr("class"))[1],b=$("#login").length>0?"Login":"Registration";BB.gaqPush(["atl._trackEvent","Social registration",b,a])});
BB.utils.guard("#account-admin",function(a){var b={"#custom-domain":"/account/cnames/","#email-addresses":"/account/email/","#plans-and-billing":"/account/plans-and-billing/","#ssh-keys":"/account/ssh-keys/"}[window.location.hash];b&&window.location.replace(b);var e=a.find("#account-admin-nav");e.children().first().find("a").click(function(){e.find("aui-nav-selected").removeClass("aui-nav-selected");$(this).closest("li").addClass("aui-nav-selected")})});
BB.utils.guard("#account-admin-header",function(a){function b(a,b,f){if(a.find("ol").length)f&&f();else{var c=$(b).data("currentUser");e.then(function(b){var e=$("<ol>").addClass("user-dropdown");_.each(b,function(a){a.privilege==="admin"&&a.username!=c&&e.append($(BB.Mustache.to_html("target-user-template",a)))});a.append(e);f&&f()})}}var e=$.Deferred();$(document).bind("teams-loaded.account-admin",function(a,b){e.resolve(b.teams)});a=a.find("#target-user-selector");a.hasClass("disabled")||AJS.InlineDialog(a,
"target-user-dialog",b)});
(function(a,b,e,d){d.email={};var b=d.email.Email=e.Model.extend({idAttribute:"email"}),g=d.email.EmailList=e.Collection.extend({model:b,initialize:function(a,b){this.emailsApi=b.emailsApi},comparator:function(a){return[a.get("primary")?0:1,a.get("active")?0:1,a.get("email").toLowerCase()]},url:function(){return this.emailsApi.toString()}});d.email.ui={};var f=d.email.ui.EmailView=e.View.extend({tagName:"tr",template:"email-template",events:{'click [href="#delete"]':"deleteEmail",'click [href="#resend"]':"resend",
'click [href="#set-as-primary"]':"setAsPrimary"},initialize:function(){this.model.on("change",this.render,this)},render:function(a){a=typeof a==="boolean"&&a;this.$el.html(d.Mustache.to_html(this.template,this.model.toJSON()));a&&this.model.get("primary")&&this.highlight();return this},highlight:function(){var a=this.$el.addClass("highlight");setTimeout(function(){a.animate({backgroundColor:"#fff"},{duration:1E3,complete:function(){a.removeClass("highlight")}})},1E3)},markSent:function(){this.$(".status").addClass("sent").hide().html("<div>confirmation sent</div>").fadeIn("slow");
return this},resend:function(a){a.preventDefault();this.model.save();this.markSent();return this},deleteEmail:function(a){a.preventDefault();this.model.destroy({wait:true,error:function(a,b){var c=b.responseText;this.parent.respond(c?c.substr(0,140):"An unknown error occurred.")}.bind(this)});return this},setAsPrimary:function(a){a.preventDefault();this.model.save({primary:true},{wait:true,success:function(){AJS.messages.success({body:"Your primary email address has been updated."})}})}}),c=d.email.ui.EmailListView=
e.View.extend({events:{"submit form":"onSubmit"},initialize:function(){this.submitDisabled=false;this.$table=this.$("table.widget");this.$form=this.$("form");this.$inputRow=this.$("tr.form");this.$emailAddress=this.$("#email-input");this.$error=this.$(".error");this.collection.on("add",this.emailAdd,this);this.collection.on("remove",this.emailRemove,this);this.collection.on("reset",this.render,this);this.collection.on("change:primary",this.reorder,this)},render:function(b){this.$inputRow.nextAll().remove();
this.collection.reduceRight(function(a,c){var d=new f({model:c});d.parent=this;this.$inputRow.after(d.render(b).el);return this}.bind(this),a());return this},reorder:function(a){var b=this.collection.find(function(b){return b.get("email")!==a.get("email")&&b.get("primary")});b&&b.set({primary:false},{silent:true});this.collection.sort();this.render(true)},emailAdd:function(a){var b=new f({model:a}),a=this.collection.indexOf(a);b.parent=this;this.$inputRow.nextAll().eq(a-1).after(b.render().el);b.highlight();
this.respond()},emailRemove:function(a,b,c){var d=this.$inputRow.nextAll().eq(c.index);d.slideUp(function(){d.remove()});this.respond()},_reword:function(a){return/not a valid email address/.test(a)?"Invalid email address.":a},respond:function(a){if(a){a=this._reword(a);this.$error.removeClass("hidden").find(".message").text(a)}else this.$error.addClass("hidden").find(".message").text("")},onSubmit:function(a){a.preventDefault();a=this.$emailAddress.val().trim();if(!this.submitDisabled&&a)if(this.collection.get(a.toLowerCase()))this.respond("You've already added this email address.");
else{var b=this;b.submitDisabled=true;var c=d.delay(400,function(){b.$form.addClass("loading")});b.collection.create({email:a},{wait:true,complete:function(){window.clearTimeout(c);b.$form.removeClass("loading");b.submitDisabled=false},error:function(a,c){return b.respond(c.responseText)},success:function(){b.$emailAddress.val("");b.respond()}})}}});d.utils.guard("#account-email",function(b){b=new g([],{emailsApi:d.api.concat("users",b.attr("data-target-user"),"emails")});new c({el:a("#email-pane")[0],
collection:b});b.fetch()})})(jQuery,_,Backbone,BB);
BB.utils.guard("#account-ssh-keys",function(a){var b=a.attr("data-target-user"),e=bitbucket.user(b),d=$("#edit-ssh-key");BB.SSHKeys(a,{onEdit:function(a,b){e.update_ssh_key(d.find("#ssh_pk").val(),a,b)},onCreate:function(a,b){e.add_ssh_key(a,b)},onDelete:function(a,b){e.remove_ssh_key(a,b)}});BB.utils.exists("#import-keys",function(a){a.on("click",function(){var b=a.data("import-url");a.addClass("loading");$.ajax({url:b}).success(function(b){a.removeClass("loading");if(b.length>0){AJS.messages.success({body:b.length+
" keys imported from GitHub"});setTimeout(function(){window.location.reload(true)},500)}else AJS.messages.error({body:"Import failed. Are your keys already associated with another Bitbucket account?"})})})})});
(function(){BB.groups={};var a=BB.groups.GroupMember=Backbone.Model.extend({idAttribute:"username",group_:null,group:function(){return this.group_},setGroup:function(a){this.group_=a;return this},url:function(){var a=this.group();if(a)a=a.isMine()?BB.api.toString("groups",a.owner().get("username"),a.get("slug"),"members",this.get("username")):BB.api.toString("group-privileges",a.get("targetUser").username,a.owner().get("username"),a.get("slug"),{"private":true});else{a=Backbone.Model.prototype.url.call(this);
this.isNew()&&(a=a+this.get("username"))}return a},displayName:function(a){var b=this.attributes;return(!b.first_name||!b.last_name?"{username}":a?"{first_name} {last_name} ({username})":"{first_name} {last_name}").format(b)},avatarUrl:function(){return this.get("avatar")||BB.images.noAvatar},toJSON:function(){var a=Backbone.Model.prototype.toJSON.call(this);a.displayName=this.displayName();a.avatarUrl=this.avatarUrl();return a}}),b=BB.groups.GroupMembers=Backbone.Collection.extend({model:a,group_:null,
group:function(){return this.group_},setGroup:function(a){this.group_=a;this.invoke("setGroup",a)},comparator:function(a){return a.displayName().toLowerCase()},url:function(){return BB.api.concat("groups",this.group().get("owner").username).toString(this.group().get("slug"),"members")}}),e=BB.groups.Repository=Backbone.Model.extend({displayName:function(){return this.get("owner").username+"/"+this.get("slug")}});BB.groups.Repositories=Backbone.Collection.extend({model:e});e=BB.groups.Group=Backbone.Model.extend({idAttribute:"slug",
groupMembers_:null,owner_:null,repositories_:null,initialize:function(a){this.parseOwner_(a);this.parseGroupMembers_(a);if(this.get("owner").is_team)this.privilege=new d({group:this,privilege:null})},parse:function(a){this.parseGroupMembers_(a);return a},parseGroupMembers_:function(a){if(a.members){this.groupMembers()===null&&this.setGroupMembers(new b);this.groupMembers().reset(a.members);delete a.members}},parseOwner_:function(b){this.setOwner(new a(b.owner))},groupMembers:function(){return this.groupMembers_},
setGroupMembers:function(a){this.groupMembers_=a;this.groupMembers_.setGroup(this);return this},owner:function(){return this.owner_},setOwner:function(a){this.owner_=a;return this},repositories:function(){return this.repositories_},setRepositories:function(a){this.repositories_=a;return this},displayName:function(){return"{}:{}".format(this.owner().get("username"),this.get("slug"))},isMine:function(){return this.owner().get("username")===this.get("targetUser").username},toJSON:function(){var a=Backbone.Model.prototype.toJSON.call(this);
if(this.groupMembers())a.members=this.groupMembers().toJSON();a.auto_add?a[a.permission]=true:a.no=true;return a},isLastAccountAdminGroup:function(a){a=this.collection.accountAdminGroups(a);return a.length===1&&_.indexOf(a,this)>=0}});BB.groups.Groups=Backbone.Collection.extend({idAttribute:"slug",model:e,initialize:function(a,b){this.targetUser=b.targetUser},url:function(){return BB.api.concat("groups",this.targetUser).toString()},comparator:function(a){return a.displayName().toLowerCase()},accountAdminGroups:function(a){var b=
this.filter(function(a){return a.privilege.get("privilege")==="admin"});return _.filter(b,function(b){return b.groupMembers().filter(function(b){return b.get("username")===a}).length===1})}});BB.groups.Message=Backbone.Model.extend({defaults:{title:null}});var d=BB.groups.GroupAccountPrivilege=Backbone.Model.extend({toJSON:function(){var a={privilege:this.get("privilege")};a[a.privilege]=true;return a},parse:function(a){return{privilege:a?_.values(a)[0]:null}},url:function(){var a=this.get("group"),
b=a.get("owner").username,a=a.get("slug");return BB.api.toString("users",b,"privileges",b,a)},sync:function(a,b,c){a!=="read"&&(a=b.get("privilege")?"update":"delete");var d=c.error;c.error=function(a,b){if(a.status===404)return c.success(null,b,a);d(a)};return Backbone.sync.call(this,a,b,c)}})})(this,jQuery);
(function(a,b){BB.groups.ui={};var e,d=BB.groups.ui.GroupMemberView=Backbone.View.extend({model:BB.groups.GroupMember,tagName:"tr",className:"group-member",errors_:{401:"You must be logged in to remove a member.",403:"You are not authorized to remove this member."},events:{'click a[href="#delete"]':"removeMember"},removeMember:function(a){a.preventDefault();if(this.model.get("username")===BB.user.username){a=this.model.collection.group();if(a.get("owner").is_team&&a.isLastAccountAdminGroup(BB.user.username)){alert("You cannot revoke your own account admin access.");
return}}this.toggleSpinner();this.model.destroy({error:this.removeMemberError.bind(this),wait:true})},render:function(){this.$el.html(BB.Mustache.to_html("group-member-template",this.model.toJSON()));return this},remove:function(){this.$el.slideUp(function(){this.$el.remove()}.bind(this));this.toggleSpinner()},removeMemberError:function(a,b){this.toggleSpinner();var c=this.errors_[b.status],d=this.$el.closest(".group-members").find(".error-bar");AJS.messages.error(d,{body:c||"There was a problem processing your request."})},
toggleSpinner:function(){this.$('a[href="#delete"]').toggleClass("loading")}}),g=BB.groups.ui.GroupMembersFormView=Backbone.View.extend({className:"group-members",errors_:{400:"You cannot add yourself to one of your own groups.",404:"The requested user does not exist.",409:"The user is already in the group."},events:{"submit form":"addMember"},collectionView_:null,initialize:function(){this.collectionView_=new BB.backbone.ui.CollectionView({collection:this.collection,view:d,tagName:"tbody"})},addMember:function(a){a.preventDefault();
var a=this.$("input.username"),b=a.val().trim();if(b){this.toggleSpinner();this.collection.create({username:b},{wait:true,success:_.bind(this.addMemberSuccess,this),error:_.bind(this.addMemberError,this)})}else a.focus()},addMemberSuccess:function(){this.toggleSpinner();this.clearError();this.$("input.username").val("").blur().focus()},clearError:function(){this.$el.find(".error-bar .aui-message").closeMessage()},addMemberError:function(a,b){this.clearError();if(b.status===404&&BB.valid.email(a.get("username"))){this.addMemberSuccess();
this.$el.trigger("bb:groups:invite",[a.get("username")])}else{this.toggleSpinner();this.$("input.username").blur().focus();AJS.messages.error(this.$el.find(".error-bar"),{body:this.errors_[b.status]||"There was a problem processing your request."})}},toggleSpinner:function(){this.$("input.username").toggleClass("loading")},render:function(){if(this.collectionView_.el.parentNode)this.collectionView_.render();else{this.$el.html(BB.Mustache.to_html("group-members-template",this.collectionView_.collection.group().toJSON())).find("table.widget.users thead").after(this.collectionView_.render().el);
this.$("input.username").autocomplete({minLength:3,source:"/xhr/users/"})}return this}}),f=BB.groups.ui.GroupView=Backbone.View.extend({tagName:"li",className:"group-view",membersView_:null,privilegeView_:null,events:{"click .delete-group":"deleteGroup","change .access":"updatePermission"},initialize:function(){this.membersView_=new g({collection:this.model.groupMembers()});this.privilegeView_=this.model.privilege?new c({model:this.model.privilege}):null;this.model.view=this},errors_:{400:"A group with that name already exists.",
404:"This group no longer exists."},deleteGroup:function(a){a.preventDefault();if(!this.$el.hasClass("waiting"))if(this.model.get("owner").is_team&&this.model.isLastAccountAdminGroup(BB.user.username)&&BB.user.username!==e)alert("You cannot revoke your own account admin access.");else{a="Are you sure you want to delete the group {0}?".format();if(confirm(a(this.model.displayName()))){this.dialog.unbind().remove();this.model.destroy({wait:true,error:this.groupError.bind(this)})}}},select:function(a,
b){this.$(".access ."+(b.auto_add?b.permission:"no")).addClass("selected").siblings().removeClass("selected")},groupError:function(a,b){alert(this.errors_[b.status]||"There was a problem processing your request.")},updatePermission:function(a){var c=this.$el.closest("li"),d=b(a.target),f;if(!d.is(":disabled")){f=setTimeout(function(){c.addClass("loading")},300);d.addClass("waiting").prop({disabled:true,"aria-disabled":true});var g=this.model.attributes,h="{owner.username}/{slug}".format(g),p=d.val();
p==="no"&&(p=null);var w=function(e){clearTimeout(f);c.removeClass("loading");d.removeClass("waiting").prop({disabled:false,"aria-disabled":false});e.length===0||confirm("This will update the group's permissions on "+e.length+" of your repositories.")?this.model.save({auto_add:!!p,permission:p},{wait:true,success:this.select.bind(this),error:this.groupError.bind(this)}):b(a.target).val(g.permission||"no")}.bind(this);g.permission?BB.account.groupPrivileges(function(a){a=a[h];w(a?a[g.permission]:[])},
e):bitbucket.user(e).repositories(function(a){BB.account.groupPrivileges(function(b){var c={};_.each(a,function(a){c["{owner}/{slug}".format(a)]=1});(b=b[h])&&_.each([].concat(b.read,b.write,b.admin),function(a){delete c[a]});w(_.keys(c))},e)})}},remove:function(){var a=this.$el.slideUp(function(){b("#no-groups").toggle(!a.siblings().length);a.remove()})},editGroupError:function(a,b){var c=a.find("div.error"),d;d=b.status?this.errors_[b.status]||"There was a problem processing your request.":b;c.removeClass("hidden");
c.find(".message").text(d)},editGroup:function(a){var b=this.model.get("name"),c=a.find(".group-name-input").val(),d=this.dialog;c===b?d.close():c?this.model.save({name:c},{wait:true,success:function(){d.unbind().remove()}.bind(this),error:function(b,c){this.editGroupError(a,c)}.bind(this)}):this.editGroupError(a,"Name is required.")},render:function(){var a=this.$el;a.attr("id","group:"+this.model.get("slug")).addClass("group-cid-{}".format(this.model.cid));this.privilegeView_&&this.privilegeView_.$el.detach();
this.membersView_.$el.detach();a.html(BB.Mustache.to_html("group-template",this.model.toJSON()));this.privilegeView_&&a.find("header").append(this.privilegeView_.render().el);a.append(this.membersView_.render().el);a.data("identifier","{owner.username}/{slug}".format(this.model.attributes));if(this.dialog&&this.model.get("slug")==this.dialog.slug)return this;this.dialog=(new BB.dialog.FormDialog("#groups .group-cid-{} .edit-group".format(this.model.cid),{id:"edit-group-"+this.model.get("slug"),useLiveEvents:true,
template:"group-form-template",templateData:{isNew:false,slug:this.model.get("slug")},submit:this.editGroup.bind(this),onUpdateContents:function(a){var a=a.popup.element.find("form"),b=this.model.get("name");a.find(".group-name-input").val(b)}.bind(this)})).bind();this.dialog.slug=this.model.get("slug");return this}}),c=BB.groups.ui.GroupAccountPrivilegeView=Backbone.View.extend({className:"group-account-privileges",initialize:function(){this.model.on("change",this.render,this)},events:{"change input":"update"},
errors:{403:"You no longer have account admin access."},render:function(){if(this.$el.children().length)switch(this.model.get("privilege")){case "admin":this.$admin.prop({checked:true});this.$collaborator.prop({checked:true,disabled:true});break;case "collaborator":this.$admin.prop({checked:false});this.$collaborator.prop({checked:true,disabled:false});break;default:this.$admin.prop({checked:false});this.$collaborator.prop({checked:false,disabled:false})}else{this.$el.html(BB.Mustache.to_html("team-privileges-template",
this.model.toJSON()));this.$admin=this.$("input[name=admin]");this.$collaborator=this.$("input[name=collaborator]")}return this},update:function(){var a;a=this.$admin.prop("checked")?"admin":this.$collaborator.prop("checked")?"collaborator":null;if(this.model.get("privilege")==="admin"&&a!=="admin"&&this.model.get("group").isLastAccountAdminGroup(BB.user.username)&&BB.user.username!==e){alert("You cannot revoke your own account admin access.");this.render()}else this.model.save({privilege:a},{wait:true,
error:_.bind(this.error,this,this.model.previousAttributes())})},error:function(a,b,c){alert(this.errors[c.status]||"An unexpected error occurred.");b.set(a)}}),h=BB.groups.ui.GroupsAdminView=Backbone.View.extend({className:"groups-admin",errors_:{400:"A group with that name already exists.",401:"You are not authorized to add a new group.",404:"You user account no longer exists or has been moved."},groupsView_:null,initialize:function(a){this.isTeam=!!a.isTeam;this.groupsView_=new BB.backbone.ui.CollectionView({collection:this.collection,
view:f,tagName:"ol"});var c=bitbucket.user(e);c.invitations(function(a){var c={};_.each(a,function(a){_.each(a.groups,function(b){(c[b]||(c[b]=[])).push(a)})});this.collection.each(function(a){var d=a.view.$("table.widget.invitations tbody");_.each(_.sortBy(c["{owner.username}/{slug}".format(a.attributes)],function(a){return a.email.toLowerCase()}),function(a){d.append(b(BB.Mustache.to_html("group-invitation-template",a)))})})}.bind(this));BB.utils.delegate("#groups-container > ol > li.group-view",
"bb:groups:invite",function(d,e){var f=b(this);c.invite(e,f.data("identifier"),function(){for(var a=f.find("table.widget.invitations"),c=a.children(".invitation"),d=0,g=c.length;d<g;d=d+1){var h=b(c[d]);if(e.toLowerCase()<h.data("email").toLowerCase()){h.before(b(BB.Mustache.to_html("group-invitation-template",{email:e})));return}}a.append(b(BB.Mustache.to_html("group-invitation-template",{email:e})))});BB.gaqPush(["atl._trackEvent","Share","Invite To Group - "+(a.isTeam?"Team":"Individual")])});
BB.utils.delegate('.invitation a[href="#delete"]',"click",function(a){a.preventDefault();var d=b(a.target).closest("tr");c.uninvite(d.data("email"),d.closest("li.group-view").data("identifier"),function(){d.remove()})});BB.utils.delegate(".invitation .resend-invitation a","click",function(a){a.preventDefault();var d=b(a.target).closest("tr");c.invite(d.data("email"),d.closest("li[data-identifier]").data("identifier"),function(){b(a.target).closest(".resend-invitation").fadeOut(200,function(){b(this).replaceWith('<span class="aui-lozenge aui-lozenge-success">Invitation sent</span>').fadeIn(200)})})})},
addGroup:function(c){this.dialog.$form_.find("div.error").addClass("hidden");var d=c.find(".group-name-input");if(c=d.val().trim())this.collection.create({name:c,owner:{username:e,is_team:this.isTeam}},{wait:true,success:function(c){a.location.hash="#group:"+c.get("slug");d.val("");this.dialog.close();b("#no-groups").hide()}.bind(this),error:this.addGroupError.bind(this)});else{d.focus();this.showError("You must provide a group name.")}},addGroupError:function(a,b){this.showError(this.errors_[b.status]||
"There was a problem processing your request.")},showError:function(a){var b=this.dialog.$form_.find("div.error");b.removeClass("hidden");b.find(".message").text(a)},render:function(){var a=this.groupsView_.render().$el;b("#no-groups").toggle(!a.children().length);a.detach();this.$el.empty().append(a);this.dialog=(new BB.dialog.FormDialog("#add-group",{id:"add-group",template:"group-form-template",templateData:{isNew:true},submit:this.addGroup.bind(this)})).bind();return this}});jQuery(function(a){BB.utils.guard("#groups",
function(b){e=b.attr("data-target-user");var c=b.find("#groups-container"),d=c.data("account-privileges"),b=new BB.groups.Groups([],{targetUser:e});c.addClass("loading");b.fetch({success:function(b){c.removeClass("loading");b.each(function(a){var b=a.get("owner").username,c=a.get("slug");if(a.get("owner").is_team)a.privilege=new BB.groups.GroupAccountPrivilege({group:a,privilege:d["{}/{}".format(b,c)]||null})});(new h({el:c,collection:b,isTeam:c.data("is-team")})).render();var e=a(location.hash.replace(/:/,
"\\:"));e.length&&BB.delay(500,function(){var b=e.closest("li").offset().top-20;a(document.body).scrollTop(b)})}})})})})(this,jQuery);
(function(a,b){BB.plans={};BB.plans.GroupMemberships=b.Collection.extend({model:BB.groups.GroupMember,url:function(){},comparator:function(a){return a.group().displayName().toLowerCase()}});var e=BB.plans.UserGroupMemberships=b.Model.extend({user_:null,memberships_:null,user:function(){return this.user_},setUser:function(a){this.user_=a;return this},memberships:function(){return this.memberships_},setMemberships:function(a){this.memberships_=a;return this},sync:function(a,b,e){e.success()},toJSON:function(){var a=
this.user().toJSON();a.groupsCount=this.memberships().length;return a}});BB.plans.AllUsersGroupMemberships=b.Collection.extend({model:e,comparator:function(a){a=a.user_;return[a.get("username")===BB.user.username?0:1,a.displayName().toLowerCase()]}})})(jQuery,Backbone);
BB.utils.guard("#plans-and-billing",function(a){var a=a.data(),b=BB.targetUser={username:a.targetUsername,avatarUrl:a.targetAvatar,isTeam:a.targetIsTeam,displayName:a.targetDisplayName};BB.plans.ui={};$(document).bind("teams-loaded.account-admin",function(a,d){var g=[];_.each(d.teams,function(a){if(a.privilege==="admin"){if(b.username==a.username)a.isTarget=true;g.push(a)}});if(g.length>1){var f=new AJS.Dialog({width:450,height:"auto",id:"bb-change-plan"}),c,h;f.addPanel("main");c=f.getCurrentPanel();
c.html('<form class="aui top-label"><p>You are an admin of multiple accounts. Please confirm the account you would like to change:</p><fieldset class="group user"><legend><span>User</span></legend></fieldset></form>');h=c.body;_.each(g,function(a){h.find("form fieldset.group").append($(BB.Mustache.to_html("plan-user-template",a)))});f.addHeader("Change plan").addButton("Confirm",function(){var a=["account/user",h.find("form .user input:checked").val(),"plans"].join("/");window.location="/"+a+"/"},
"aui-button aui-style").addCancel("Cancel",function(a){a.hide()});$("#change-plan-form").find("button").click(function(a){a.preventDefault();f.show()})}});BB.utils.guard("#access-via-groups",function(a){function d(c){var d={},f={},g={},h="{owner.username}:{slug}".format();_.each(a.data("groups"),function(a){a.owner={username:b.username};c.push({group:a})});_.each(c,function(a){var c=a.group,e;if(!(e=f[h(c)])){c.targetUser=b;e=(f[h(c)]=new BB.groups.Group(c)).setRepositories(new BB.groups.Repositories)}var i=
e;i.repositories().add(g[a.repo]||new BB.groups.Repository(a.repository));i.groupMembers().each(function(a){if(a.get("username")!==b.username){a.setGroup(i);var c=d[a.get("username")];if(!c){c=d[a.get("username")]=new BB.plans.UserGroupMemberships;c.setUser(a).setMemberships(new BB.plans.GroupMemberships)}c.memberships().any(function(b){return h(b.group().attributes)===h(a.group().attributes)})||c.memberships().add(a)}})});return(new BB.plans.AllUsersGroupMemberships).reset(_.values(d))}var g=BB.plans.ui.GroupMembershipView=
Backbone.View.extend({model:BB.groups.GroupMember,tagName:"li",render:function(){this.$el.html(BB.Mustache.to_html("account-group-membership-template",this.model.group()));return this}}),f=BB.plans.ui.UserGroupMembershipsView=Backbone.View.extend({model:BB.plans.UserGroupMemberships,tagName:"tr",userView_:null,events:{'click a[href="#delete"]':"deleteAll"},initialize:function(){this.collectionView_=new BB.backbone.ui.CollectionView({view:g,collection:this.model.memberships(),tagName:"ol",className:"children"})},
deleteAll:function(a){a.preventDefault();var b=this.collectionView_.collection,c=function(){var a=b.first();a?a.destroy({wait:true,success:c}):h()};confirm("You are about to:\n\n- remove {displayName!esc} from all of your groups\n\n- for each other group {displayName!esc} is a member of, revoke its access to your private repositories\n".format(this.model.user()))&&c()},render:function(){var a=this.$el,b=this.model.user().get("username");a.addClass("data-username user").data("username",b).append($(BB.Mustache.to_html("account-access-group-template",
this.model.toJSON())));b===BB.user.username&&a.find('a[href="#delete"]').remove();a.data("groups",this.model.memberships());return this}}),c=BB.plans.ui.AccessViaGroupsView=Backbone.View.extend({userGroupViews_:null,el:"#access-via-groups table",initialize:function(){this.userGroupViews_=new BB.backbone.ui.CollectionView({collection:this.collection,view:f,tagName:"tbody"})},render:function(){this.$("tbody").remove();this.$el.append(this.userGroupViews_.render().el);var a=AJS.InlineDialog('#access-via-groups a[href="#groups"]',
"access-groups",function(b,c,d){c=$(c).closest("tr");c=new BB.backbone.ui.CollectionView({view:g,collection:c.data("groups"),tagName:"ol"});b.empty();b.append($(c.render().el));a.refresh();d&&d()},{useLiveEvents:true});return this}}),h,i=$("#plans-and-billing"),j=BB.api.toString("group-privileges",b.username,{"private":true});h=function(){$.get(j,function(a){(new c({collection:d(a)})).render()});i.trigger("bb:account:updatecount")};h()});BB.utils.guard("#direct-access",function(a){var d=a.data("users");
_.each(d,function(a){a.displayName=a.first_name&&a.last_name?"{first_name} {last_name}".format(a):a.username});var d=_.sortBy(d,function(a){return a.displayName.toLowerCase()}),g=a.find("table.widget tbody");g.empty();var f=$(BB.Mustache.to_html("direct-access-user-template",_.extend({},b,{avatar:BB.account.avatar(b.avatarUrl,16)})));f.removeClass("data-username");f.find("a").remove();b.isTeam||f.appendTo(g);_.each(d,function(a){g.append($(BB.Mustache.to_html("direct-access-user-template",a)))});
var c=function(a){var b=$("<ol>");_.each(_.keys(a),function(a){b.append($(BB.Mustache.to_html("direct-access-repo-template",{repo:a})))});return b},h=AJS.InlineDialog('#direct-access a[href="#repos"]',"direct-access",function(a,d,e){var f=$(d),g=f.closest("tr");if(!f.hasClass("loading")){a.empty();if(g.data("repos")){a.append(c(g.data("repos")));h.refresh();e&&e()}else{f.addClass("loading");var q=g.data("username");bitbucket.user(b.username).privileges(bitbucket.flags.access.direct,function(b){b=
_.reduce(b,function(a,b,c){(b=b[q])&&(a[c]=b);return a},{});f.removeClass("loading");g.data("repos",b);a.append(c(b));h.refresh();e&&e()})}}},{useLiveEvents:true});a.delegate('a[href="#delete"]',"click",function(c){c.preventDefault();var c=$(this),d=c.closest("tr"),c=c.data("confirm-msg")||"Are you sure?";confirm(c)&&$.ajax({url:BB.api.toString("privileges",b.username,{"private":true,username:d.data("username")}),type:"DELETE",success:function(){a.trigger("bb:account:updatecount");d.slideUp(function(){d.remove()})}})})})});
BB.utils.guard("#oauth-consumers",function(a){function b(){if(!c.find("tbody tr").length){var a=$('<tr class="empty"><td>You have no consumers configured.</td><td></td></tr>');c.find("tbody").append(a)}}var e=a.attr("data-target-user"),d=bitbucket.user(e),g=(new BB.dialog.FormDialog('a[href="#add-consumer"]',{id:"add-consumer",template:"oauth-consumer-form-template",templateData:{isNew:true},submit:function(a){var b=a.find(".error");b.addClass("hidden");d.create_consumer(a.serialize(),{error:function(a){b.removeClass("hidden");
b.find(".message").text(a.responseText);g.complete_()},success:function(a){c.find("tr.empty").remove();var b=$(BB.Mustache.to_html("oauth-consumer-template",a));$(b[0]).data(a).addClass("revealed");c.append(b);g.complete_();g.close()}})}})).bind(),f=(new BB.dialog.FormDialog('a[href="#edit"]',{id:"edit-consumer",useLiveEvents:true,template:"oauth-consumer-form-template",templateData:{isNew:false},onUpdateContents:function(a,b){var c=a.popup.element.find("form"),d=b.closest("tr").data();c.find('input[name="name"]').val(d.name);
c.find('textarea[name="description"]').val(d.description);c.find('input[name="url"]').val(d.url);c.find("#consumer-id").val(d.id)},submit:function(a){var b=a.find(".error");b.addClass("hidden");var e=a.find("#consumer-id").val();d.update_consumer(e,a.serialize(),{error:function(a){b.removeClass("hidden");b.find(".message").text(a.responseText);f.complete_()},success:function(a){var b=c.find("#consumer-"+a.id),d=b.next();b.find("td.name span").text(a.name);d.find("li span.description").text(a.description);
d.find("li span.url").text(a.url);b.addClass("revealed");b.data(a);f.complete_();f.close()}})}})).bind(),c=a.find("table.widget");_.each(a.data("consumers"),function(a){a=$(BB.Mustache.to_html("oauth-consumer-template",a)).data(a);c.append(a)});c.find("tr.loading").remove();b();c.delegate('a[href="#delete"]',"click",function(a){a.preventDefault();var c=$(this).closest("tr");d.delete_consumer(c.data("id"),{success:function(){c.next().remove();c.remove();b()}})});c.delegate("td.name a","click",function(a){a.preventDefault();
$(this).closest("tr").toggleClass("revealed")})});
BB.utils.guard("#connected-accounts",function(a){var b=a.data("password-change-url");a.find("table.widget tbody");a.on("click",'a[href="#delete"]',function(a){a.preventDefault();var d=$(this).closest("tr"),g=d.find("script").html(),f=d.data("type"),c=d.data("pk"),h=BB.api.concat("user","3rdparty",f);$.ajax({type:"DELETE",url:h.toString(c),success:function(){if(f!=="openid")$(a.target).closest("div").replaceWith(g);else{var b=d.closest("tbody");d.remove();if(b.find("tr").length===0){$("h2").remove();
b.closest("table").remove()}}if(f=="github"){d.find(".github-import").remove();$("#import-github-repo-link").remove()}},error:function(){AJS.messages.error({body:'Please <a href="'+b+'">set a password</a> before disconnecting this account'})}})})});BB.utils.guard("#delete-account",function(a){a.on("submit","form",function(){return confirm("This is a destructive operation. Delete account?")})});
(function(a,b,e,d){d.notifications={};var g=d.notifications.EmailPreferences=e.Model.extend({idAttribute:"key"}),f=d.notifications.EmailPreferences=e.Collection.extend({model:g,initialize:function(a,b){this.prefsApi=b.prefsApi},url:function(){return this.prefsApi.toString()},findByKey:function(a){return this.find(function(b){return b.attributes.key==a})}});d.notifications.ui={};var c=d.notifications.ui.EmailPreferencesView=e.View.extend({events:{"click input.checkbox":"updatePreferences","click #toggle-email":"toggleEmail"},
togglePreference:function(a,b){var c=this.collection.findByKey(a);if(c){b&&b(false);c.destroy({success:function(){AJS.messages.success({body:"Email preferences updated."})},error:function(a){AJS.messages.error({body:"Email preferences failed to update."});this.collection.add(a);b&&b(true)}.bind(this)})}else{c=new g({key:a,value:true});this.collection.add(c);b&&b(true);c.save({},{success:function(){AJS.messages.success({body:"Email preferences updated."})},error:function(){AJS.messages.error({body:"Email preferences failed to update."});
this.collection.remove(c);b&&b(false)}.bind(this)})}},updatePreferences:function(b){var c=a(b.target),b=a(b.target).attr("name");this.togglePreference(b,function(a){a?c.attr("checked","checked"):c.removeAttr("checked")})},toggleEmail:function(b){b.preventDefault();var c=this.$el.find("form"),e=a(b.target);c.hasClass("disabled")||d.dialog.Alert({title:"Disable email",content:d.Mustache.to_html("disable-email-confirmation-template")});this.togglePreference("enabled",function(b){var f=a(d.Mustache.to_html("toggle-email-button-template",
{enabled:b}));b?c.removeClass("disabled"):c.addClass("disabled");e.replaceWith(f)})}});d.utils.guard("#account-notifications",function(e){var i=e.find("form"),j={enabled:!i.hasClass("disabled"),mentions:i.find("#id_mentions").is(":checked"),direct_messages:i.find("#id_direct_messages").is(":checked"),access_changes:i.find("#id_access_changes").is(":checked"),atl_updates:i.find("#id_atl_updates").is(":checked"),bb_updates:i.find("#id_bb_updates").is(":checked")},l=[];b.map(j,function(a,b){a&&l.push(new g({key:b,
value:a}))});j=new f(l,{prefsApi:d.api.concat("user","emailpreferences",e.attr("data-target-user"))});new c({el:e[0],collection:j});i.find("div.description").each(function(b,c){var d=a(c);d.tooltip({title:function(){return d.text()}})})})})(jQuery,_,Backbone,BB);
AJS.ProgressiveDataSet=Backbone.Collection.extend({initialize:function(a,b){b||(b={});if(b.matcher)this.matcher=b.matcher;if(b.model)this.model=b.model;this._idAttribute=(new this.model).idAttribute;this._maxResults=b.maxResults||5;this._queryData=b.queryData||{};this._queryParamKey=b.queryParamKey||"q";this._queryEndpoint=b.queryEndpoint||"";this.value=null;this.queryCache={};this.activeQueryCount=0;_.bindAll(this,"query","respond")},url:function(){return this._queryEndpoint},query:function(a){var b,
e;this.value=a;e=this.getFilteredResults(a);this.respond(a,e);if(a&&this._queryEndpoint&&!this.hasQueryCache(a)&&this.shouldGetMoreResults(e)){b=this.fetch(a);this.activeQueryCount++;this.trigger("activity",{activity:true});b.always(_.bind(function(){this.activeQueryCount--;this.trigger("activity",{activity:!!this.activeQueryCount})},this));b.done(_.bind(function(b,e,f){this.addQueryCache(a,b,f)},this));b.done(_.bind(function(){var b=a;a=this.value;e=this.getFilteredResults(a);this.respond(a,e,b)},
this))}},getQueryData:function(a){var b=_.isFunction(this._queryData)?this._queryData(a):this._queryData,b=_.extend({},b);b[this._queryParamKey]=a;return b},fetch:function(a){a={add:true,data:this.getQueryData(a)};return Backbone.Collection.prototype.fetch.call(this,a)},add:function(){return!((new Backbone.Collection([{id:1},{id:1}])).length>1)?Backbone.Collection.prototype.add:function(a,b){var e={},d=this._idAttribute;this.each(function(a){e[a.get(d)]=true});var g=_.filter(a,function(a){a=a instanceof
Backbone.Model?a.get(d):a[d];return!e[a]});return Backbone.Collection.prototype.add.call(this,g,b)}}(),respond:function(a,b,e){this.trigger("respond",{query:a,results:b,remoteQuery:e});return b},matcher:function(){},getFilteredResults:function(a){var b=[],b=this.filter(function(b){return true==this.matcher(b,a,this.getQueryData(a))},this);this._maxResults&&(b=_.first(b,this._maxResults));return b},addQueryCache:function(a,b,e){var d=this.queryCache,b=this.parse(b,e);d[a]=_.pluck(b,this._idAttribute)},
hasQueryCache:function(a){return this.queryCache.hasOwnProperty(a)},findQueryCache:function(a){return this.queryCache[a]},shouldGetMoreResults:function(a){return a.length<this._maxResults},setMaxResults:function(a){this._maxResults=a;this.value&&this.respond(this.value,this.getFilteredResults(this.value))}});
(function(a){a(function(){b.simulator=a('<div id="textarea_simulator"/>').css({position:"absolute",top:0,left:0,visibility:"hidden"}).appendTo(document.body)});var b={primaryStyles:["fontFamily","fontSize","fontWeight","fontVariant","fontStyle","paddingLeft","paddingTop","paddingBottom","paddingRight","marginLeft","marginTop","marginBottom","marginRight","borderLeftColor","borderTopColor","borderBottomColor","borderRightColor","borderLeftStyle","borderTopStyle","borderBottomStyle","borderRightStyle",
"borderLeftWidth","borderTopWidth","borderBottomWidth","borderRightWidth","lineHeight","outline","letterSpacing","wordSpacing","textAlign","verticalAlign"],specificStyle:{"word-wrap":"break-word","overflow-x":"hidden","overflow-y":"auto"},toHtml:function(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").split(" ").join('<span style="white-space:prev-wrap">&nbsp;</span>')},getCaretPosition:function(e){var d=b,g=this,f=g[0],c=g.offset();if(a.browser.msie){f.focus();e=document.selection.createRange();
a("#hskeywords").val(f.scrollTop);return{left:e.boundingLeft-c.left,top:parseInt(e.boundingTop)-c.top+f.scrollTop+document.documentElement.scrollTop+parseInt(g.getComputedStyle("fontSize"))}}d.simulator.empty();a.each(d.primaryStyles,function(a,b){g.cloneStyle(d.simulator,b)});d.simulator.css(a.extend({width:g.width(),height:g.height()},d.specificStyle));var e=e||0,c=g.val(),h=g.getCursorPosition()+e,e=c.substring(0,h),h=c.substring(h),e=a('<span class="before"/>').html(d.toHtml(e)),c=a('<span class="focus"/>'),
h=a('<span class="after"/>').html(d.toHtml(h));d.simulator.append(e).append(c).append(h);e=c.offset();h=d.simulator.offset();return{top:e.top-h.top-f.scrollTop+parseInt(g.getComputedStyle("fontSize")),left:c[0].offsetLeft-d.simulator[0].offsetLeft-f.scrollLeft}}};a.fn.extend({getComputedStyle:function(b){if(this.length!=0){var d=this[0],g=this.css(b);return g=g||(a.browser.msie?d.currentStyle[b]:document.defaultView.getComputedStyle(d,null)[b])}},cloneStyle:function(b,d){var g=this.getComputedStyle(d);
g&&a(b).css(d,g)},cloneAllStyle:function(a){var b=this[0],g;for(g in b.style){var f=b.style[g];typeof f=="string"||typeof f=="number"?this.cloneStyle(a,g):NaN}},getCursorPosition:function(){var b=this[0],d=0;if("selectionStart"in b)d=b.selectionStart;else if("selection"in document){var g=document.selection.createRange();if(parseInt(a.browser.version)>6){b.focus();d=document.selection.createRange().text.length;g.moveStart("character",-b.value.length);d=g.text.length-d}else{var f=document.body.createTextRange();
for(f.moveToElementText(b);f.compareEndPoints("StartToStart",g)<0;d++)f.moveStart("character",1);for(g=0;g<=d;g++)b.value.charAt(g)=="\n"&&d++;b=b.value.split("\n").length-1;d=d-b}}return d},getCaretPosition:b.getCaretPosition})})(jQuery);
(function(a){function b(a,b,g){this.leftRegex=RegExp((a||/(?:^|\s)(\S+)/).source+"$");this.rightRegex=RegExp("^"+(b||/(\S*)/).source);this.maxLength=g>0?g:128}b.VERSION="0.2";b.startsWith=function(a){return new b(RegExp(["(?:^|\\s)(",a,"[^",a,"\\s]*)"].join("")))};b.prototype.token=function(a,b){var g;if(typeof a==="string")g=a;else{g=a.value;b=a.selectionStart}var f=g.slice(0,b);g=g.slice(b);var c=f.slice(-this.maxLength),f=g.slice(0,this.maxLength),c=(g=c.match(this.leftRegex))?g[1]:"",f=(g=f.match(this.rightRegex))?
g[1]:"";return{value:c?c+f:"",prefix:c,suffix:c?f:"",toString:function(){return this.value}}};b.prototype.replace=function(a,b,g){var f;if(typeof a==="string")f=a;else{f=a.value;g=b;b=a.selectionStart}var c=this.token(f,b);if(f&&!c.value)return typeof a==="string"?f:false;var h=f.slice(0,b);f=f.slice(b);h=[h.slice(0,h.length-c.prefix.length),g,f.slice(c.suffix.length)].join("");if(typeof a==="string")return h;g=g.length-c.prefix.length;a.value=h;a.setSelectionRange(b+g,b+g);return true};a.Cursores=
b})(this);
(function(a,b,e,d){a=a.BB;a.typeahead={};a.typeahead.TypeaheadModel=e.Model.extend({replacementText:function(){return this.get(this.idAttribute)},toHighlightedJSON:function(a){var b=this.toJSON();b[this.idAttribute]=this.constructor.highlightSubstring(b[this.idAttribute],a);return b}},{highlight:function(a,b){b=b.toLowerCase();return b.length===0||a.toLowerCase().indexOf(b)!==0?d.escape(b):["<em>",d.escape(a.slice(0,b.length)),"</em>",d.escape(a.slice(b.length))].join("")},highlightSubstring:function(a,b){var b=
b.toLowerCase(),e=this.splitWords(a);if(!e.length||!b)return d.escape(a);for(var g=[];e.length;)if(e.join("").toLowerCase().indexOf(b)===0){g.push(this.highlight(e.join(""),b));break}else g.push(d.escape(e.shift(),b));return g.join("")},splitWordsRegExp:/\s+/,splitWords:function(a){for(var b=[],d=a.split(this.splitWordsRegExp);d.length;){var e=d.shift();if(e){var g=a.indexOf(e);g>0&&b.push(a.slice(0,g));b.push(e);a=a.slice(g+e.length)}}a&&b.push(a);return b},startsWith:function(a,b){var d=this.splitWords(a.toLowerCase());
if(!d.length)return false;/\s+/.test(d[0])&&d.shift();for(b=b.toLowerCase();d.length;){if(d.join("").indexOf(b)===0)return true;d=d.slice(2)}return false},matcher:function(a,b){return!b?true:this.startsWith(a.replacementText(),b)}});a.typeahead.ui={};a.typeahead.ui.TypeaheadView=e.View.extend({tagName:"a",className:"interactive",template:function(){throw"NotImplemened";},initialize:function(a){this.query=a.query||""},render:function(){this.$el.html(this.template(this.model.toHighlightedJSON(this.query)));
return this},setQuery:function(a){this.query=a;return this.render()}});a.typeahead.ui.TypeaheadSuggestions=e.View.extend({tagName:"div",className:"bb-typeahead-suggestions aui-dropdown2 aui-style-default",viewClass:function(){throw"NotImplemented";},callToActionHtml:function(){throw"NotImplemented";},noResultHtml:function(){throw"NotImplemented";},initialize:function(){this.$ul=b("<ul></ul>");this.$el.append(this.$ul);this.$el.attr("id",d.uniqueId("bb-typeahead-suggestions-"));this.$el.css("z-index",
5E3);this.views={};this.models=[];this.index=0},render:function(a){if(!a)return this;var c=this;c.models=c.sortedResults(a.results,a.query);c.$ul.removeClass("bb-typeahead-suggestions-none").children("li").detach().find("a").removeClass("active");c.models.length?d.each(c.models,function(d,e){var g=d.get(d.idAttribute),l;(l=c.views[g])?l.setQuery(a.query):l=c.views[g]=new (c.viewClass())({model:d,query:a.query});l.render();l.$el.attr("data-model-id",d.get(d.idAttribute));e===0&&l.$el.addClass("active");
c.$ul.append(b('<li class="bb-typeahead-item">').append(l.el))}):a.query?c.$ul.addClass("bb-typeahead-suggestions-none").append(this.noResultHtml({query:a.query,searching:a.searching})):c.$ul.addClass("bb-typeahead-suggestions-none").append(this.callToActionHtml({}));return c},sortedResults:function(a){return a},activeModel:function(){var a=this.$ul.find("a.active").attr("data-model-id");return a?d.find(this.models,function(b){return b.get(b.idAttribute)===a}):null},replacementText:function(){var a=
this.activeModel();return a?a.replacementText():null}});var g=a.typeahead.ui.TypeaheadCompletion=e.View.extend({BACKSPACE:8,DELETE:46,ESC:27,ENTER:13,LEFT:37,RIGHT:39,events:{"keydown .bb-typeahead-input":"onKeyDown","keypress .bb-typeahead-input":"onKeyPress","focus .bb-typeahead-input":"onFocus"},initialize:function(a){this.hide=d.has(a,"hide")?!!a.hide:true;this.focus=d.has(a,"focus")?!!a.focus:true;this.source=a.source;this.source.on("respond",this.respond,this);this.results=a.results;this.results.$el.on("aui-dropdown2-show aui-dropdown2-hide",
d.bind(this.onToggleDropdownVisibility,this)).appendTo("body");this.results.$el.delegate(".bb-typeahead-item","click",d.bind(this.complete,this));this.showingSuggestions=false;this.currentEl=null;this.escPressed=false;this.searchingTimeout=null},respond:function(a){var c=this,e=a.query||"",g=!!e&&!c.source.hasQueryCache(e);if(c.hide&&e&&!a.results.length)(!c.showingSuggestions||g)&&c.hideSuggestions(c.currentEl);else{c.showSuggestions(c.currentEl);c.results.render(d.extend(a,{searching:g}))}clearTimeout(c.searchingTimeout);
g&&!a.results.length?c.searchingTimeout=setTimeout(function(){b(c.currentEl).addClass("bb-typeahead-searching")},300):b(c.currentEl).removeClass("bb-typeahead-searching")},onKeyDown:function(a){this.currentEl=a.target;if(a.which===this.BACKSPACE||a.which===this.DELETE)this.queueQuery(a.target);else if(this.showingSuggestions)switch(a.which){case this.LEFT:case this.RIGHT:this.queueQuery(a.target);break;case this.ESC:a.preventDefault();a.stopPropagation();this.escPressed=true;this.hideSuggestions(a.target)}},
shouldStopSuggesting:function(){return false},shouldSuppressSuggestions:function(){return this.escPressed},stopSuppressingSuggestions:function(){this.escPressed=false},isWithinCodeBlock:function(){return false},onKeyPress:function(a){if(a.which!==0&&a.which!==this.ENTER){var b=a.target;this.currentEl=b;this.shouldStopSuggesting(a)?this.hideSuggestions(b):this.queueQuery(b)}},onFocus:function(a){var c=this,d=a.target;c.currentEl=d;setTimeout(function(){if(c.focus&&!d.value&&b(d).attr("data-bb-typeahead-focus")!==
"false"){b(d).attr("data-bb-typeahead-focus","false");c.queueQuery(d)}},200)},hideSuggestions:function(a){this.results.$el.is(":visible")&&b(a).trigger("aui-button-invoke");this.setShowingState(a,false)},cursor:function(){return new Cursores(/(.*)/,/(.*)/)},queryTerm:function(a){return this.cursor().token(a).value},queueQuery:function(a){var b=this;setTimeout(function(){!a.value&&b.shouldSuppressSuggestions()&&b.stopSuppressingSuggestions();var d=b.queryTerm(a);d!==null?b.source.query(d):b.hideSuggestions(a)},
0)},onToggleDropdownVisibility:function(a){this.setShowingState(this.currentEl,a.type==="aui-dropdown2-show")},setShowingState:function(a,c){(this.showingSuggestions=c)||b(a).removeClass("aui-dropdown2-trigger")},showSuggestions:function(a){if(!this.isWithinCodeBlock(a)&&!this.shouldSuppressSuggestions()){this.setShowingState(a,true);this.results.$el.is(":visible")||b(a).attr({"aria-owns":this.results.$el.attr("id"),"aria-haspopup":"true"}).addClass("aui-dropdown2-trigger").trigger("aui-button-invoke")}},
complete:function(a){var c=a.type==="click"?this.currentEl:a.target,d=this.results.replacementText();if(d!==null){this.replaceText(c,d);a.type==="click"&&b.browser.mozilla&&b(c).focus()}this.hideSuggestions(c)},replaceText:function(a,b){this.cursor().replace(a,b)}});a.typeahead.ui.MentionCompletion=g.extend({events:{"keydown .bb-mention-input":"onKeyDown","keypress .bb-mention-input":"onKeyPress"},initialize:function(a){g.prototype.initialize.call(this,d.extend({hide:false,focus:false},a));this.atSignCursor=
Cursores.startsWith("@");this.results.$el.on("aui-dropdown2-show",d.bind(this.setAbsolutePosition,this)).addClass("aui-dropdown2-tailed")},cursor:function(){return this.atSignCursor},isWithinCodeBlock:function(){return false},shouldStopSuggesting:function(a){if(String.fromCharCode(a.which)!==" ")return false;var b=this.results.models.length,d=this.cursor().token(a.target).prefix.slice(1),a=this.source.hasQueryCache(d),e=b===0,b=b===1&&this.results.replacementText()===d;return a&&(e||b)},onKeyPress:function(a){g.prototype.onKeyPress.call(this,
a);var b=String.fromCharCode(a.which);!this.isWithinCodeBlock(a.target)&&(this.shouldSuppressSuggestions()&&!this.showingSuggestions&&b==="@")&&g.prototype.stopSuppressingSuggestions.call(this)},setAbsolutePosition:function(){var a=this.currentEl,c=b(a),d=a.selectionStart,e=this.cursor().token(a);a.setSelectionRange(d-e.prefix.length,d-e.prefix.length);var g=c.getCaretPosition();a.setSelectionRange(d-(e.prefix.length-1),d-(e.prefix.length-1));e=c.getCaretPosition();a.setSelectionRange(d,d);a=c.offset();
this.results.$el.css({top:a.top+e.top+2,left:a.left+g.left+(e.left-g.left)/2-28,"min-width":350,"max-width":350})},queryTerm:function(a){a=this.cursor().token(a);return a.value?a.value.slice(1):null},replaceText:function(a,b){g.prototype.replaceText.call(this,a,"@"+b+(a.selectionStart===a.value.length?" ":""))}})})(this,jQuery,Backbone,_);
(function(a,b,e,d){var g=a.BB;g.mention={};var f=g.typeahead.TypeaheadModel,a=g.typeahead.ui.TypeaheadView,e=g.typeahead.ui.TypeaheadSuggestions,c=g.typeahead.ui.TypeaheadCompletion,h=g.typeahead.ui.MentionCompletion,i=g.mention.TypeaheadUserModel=f.extend({idAttribute:"username",initialize:function(a){var b=[];if(a){a.first_name&&b.push(a.first_name);a.last_name&&b.push(a.last_name)}this.displayName=b.length?b.join(" "):null},toJSON:function(){var a=f.prototype.toJSON.call(this);if(this.displayName!==
null)a.display_name=this.displayName;return a},toHighlightedJSON:function(a){var b=this.toJSON(),c=this.constructor;if(b.display_name)b.display_name=c.highlightSubstring(b.display_name,a);b.username=c.highlightSubstring(b.username,a);return b},sortKeys:function(a){var b=this.displayName===null?this.get("username"):this.displayName;return[!(a.toLowerCase()===this.get("username").toLowerCase()&&!this.get("is_team")),this.get("is_team"),!this.get("is_teammate"),!(this.usernameMatch(a)||this.displayNameMatch(a)),
b.toLowerCase(),this.get("username").toLowerCase()]},usernameMatch:function(a){return f.startsWith(this.get("username"),a)},displayNameMatch:function(a){return this.displayName!==null&&f.startsWith(this.displayName,a)},keywordMatch:function(a){return d.any(this.get("keywords"),function(b){return f.startsWith(b,a)})}},{matcher:function(a,b,c){c=c.include_teams||!a.get("is_team");if(!b)return c;var d=a.usernameMatch(b),e=a.displayNameMatch(b),a=a.keywordMatch(b);return c&&(d||e||a)}}),j=g.mention.MentionUserModel=
i.extend({},{matcher:function(a,b,c){return a.get("username")===g.user.username?false:i.matcher(a,b,c)}});g.mention.ui={};var l=g.mention.ui.TypeaheadUser=a.extend({template:d.bind(g.Mustache.to_html,null,"mention-result"),render:function(){if(this.$el.children().length)return this;this.$el.addClass(this.model.get("is_team")?"bb-typeahead-team":"bb-typeahead-user");this.$el.append(this.template(this.model.toHighlightedJSON(this.query)));return this},setQuery:function(a){var b=this.model.toHighlightedJSON(a);
b.display_name&&this.$(".display-name").html(b.display_name);this.$(".username").html(b.username);this.query=a}}),m=g.mention.ui.UserSuggestions=e.extend({className:e.prototype.className+" bb-user-suggestions",callToActionHtml:d.bind(g.Mustache.to_html,null,"mention-call-to-action"),noResultsTemplate:d.bind(g.Mustache.to_html,null,"mention-no-results"),noResultHtml:function(a){return a.query.length>=3?this.noResultsTemplate(a):this.callToActionHtml(a)},viewClass:function(){return l},sortedResults:function(a,
b){return d.sortBy(a,function(a){return a.sortKeys(b)})}}),n=g.mention.ui.MentionAutocomplete=h.extend({initialize:function(a){h.prototype.initialize.call(this,d.extend({results:new m},a));this.usernameCursor=new Cursores(/(?:^|\s)(@[^@.,?!'"\s]*)/,/([^.,?!'"\s]+)/);this.relaxedCursor=new Cursores(/(?:^|\s)(@$|@[^@\s][^@\n]*)/,/([^.,?!'"\s]+)/)},cursor:function(){return this.showingSuggestions?this.relaxedCursor:this.usernameCursor},isWithinCodeBlock:function(a){var b=a.value.substring(0,a.selectionEnd),
a=a.value.substring(0,a.selectionEnd).split("\n"),a=a[a.length-1],b=b.split("```").length%2===0,a=a.indexOf("    ")===0;return b||a}}),q=g.mention.ui.UserTypeahead=c.extend({events:{"keydown .bb-user-typeahead":"onKeyDown","keypress .bb-user-typeahead":"onKeyPress","focus .bb-user-typeahead":"onFocus"},initialize:function(a){c.prototype.initialize.call(this,d.extend({results:new m},a))}}),p=g.mention.ui.UserAndTeamTypeahead=q.extend({events:{"keydown .bb-user-team-typeahead":"onKeyDown","keypress .bb-user-team-typeahead":"onKeyPress",
"focus .bb-user-team-typeahead":"onFocus"}}),w=g.mention.ui.UserDataSet=AJS.ProgressiveDataSet.extend({hasQueryCache:function(a){return a.length<3||AJS.ProgressiveDataSet.prototype.hasQueryCache.call(this,a)}});b(function(){if(b("#mention-result").length){var a=[];g.user.id&&(a=d.map(b("#recently-mentioned-"+g.user.id).data("value"),function(a){return new i(a)}));var c=b("body")[0],e={model:i,matcher:i.matcher,queryEndpoint:"/xhr/user-mention",queryParamKey:"term"},f=new w(a,e),h=new w(a,d.extend({},
e,{model:j,matcher:j.matcher})),a=new w(a,d.extend(e,{queryData:{include_teams:true}}));(new n({source:h,el:c})).render();(new q({source:f,el:c})).render();(new p({source:a,el:c})).render()}})})(this,jQuery,Backbone,_);
BB.utils.guard("#importing",function(a){function b(){$.post(i,f)}function e(b){a.removeClass("error-state warning-state success-state");l.empty();n.find(".progress").css({width:b+"%"})}function d(){if(c!=="failed")if(w===0)g("warning","Your import is currently in the queue");else if(p===100){g("success","Import completed successfully");clearInterval(x);BB.delay(1E3,function(){location.href=h})}else q===100||q-p>0?e(p=p+(10-p%10)):p<w&&e(p++)}function g(b,c){a.addClass(b+"-state");l.empty();AJS.messages[b](l,
{title:c,closeable:false})}function f(a){var d,e=a.log.join("").replace(/\s+$/,"");c=a.state;if(e===r){d=m.children().last()[0];if(/\.\.\.$/.test(d.innerHTML))d.innerHTML=d.innerHTML+"."}else{d=e.replace(r,"");r=e;q=a.percentage;w=a.percentage_upon_subtask_completion;_.each(d.replace(/\n{2,}/g,"\n").split("\n"),function(a){var b=$("<li>");m.append(b.append(a.replace(/^\[(.*)\] /,function(a,c){b.append($(document.createElement("time")).attr("data-relative","false").attr("datetime",c).localize("HH:MM:ss"));
return" "})))});m.scrollTop(9E5)}switch(a.state){case "running":setTimeout(b,1E3);break;case "success":h.length&&(q=100);break;default:g("error","Your import has failed. For more information, check the log below. You can also try your import again.")}}var c=a.data("status"),h=a.data("success-url"),i=a.data("rest-url"),j=$(BB.Mustache.to_html("progress-status-template")).appendTo(a),l=j.find("#progress-status-container"),m=j.find("#progress-logs"),n=j.find("#progress-bar"),q=a.data("percentage"),p=
0,w=a.data("subtask-percentage"),r,x;if(c==="success"){g("success","Import completed successfully");b()}else if(c==="failed")b();else{e(p);d();x=setInterval(d,500);b();BB.gaqPush(["atl._trackEvent","Importer",function(){analyticsData=analyticsData||{};if(analyticsData.source==="source-goog")return"Google Code, "+analyticsData.scm;var a=[analyticsData.scm,analyticsData.auth?"auth":"no auth"];analyticsData.scm==="svn"&&a.push("no history");return a.join(", ")}()])}});
BB.utils.guard("#repo-content",function(){var a=BB.repo.id,b="recently-viewed-repos_"+BB.user.id,e=$.cookie(b),e=e?e.split(","):[],d=_.indexOf(e,""+a);~d&&e.splice(d,1);$.cookie(b,[a].concat(e.slice(0,4)).join(),{path:"/",expires:1E6})});BB.utils.guard("#qseries form",function(a){function b(a){a.closest("div.radio").prevAll().addClass("apply")}a=a.find("div.radio input");a.change(function(){var a=$(this);$("div.radio").removeClass("apply");a.is(":checked")&&b(a)});b(a.filter(":checked"))});
